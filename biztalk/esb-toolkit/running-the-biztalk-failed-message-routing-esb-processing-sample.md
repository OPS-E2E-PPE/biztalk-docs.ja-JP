---
title: BizTalk を実行するには、メッセージ ルーティング ESB 処理サンプルが失敗しました |。Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d2a536a0-cfc8-4ba3-adcd-2b8b580bff85
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8181c426bac76885b7e06aea93c9c3bb32dc1564
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65292562"
---
# <a name="running-the-biztalk-failed-message-routing-esb-processing-sample"></a><span data-ttu-id="5980d-102">BizTalk を実行するには、メッセージ ルーティング ESB 処理サンプルが失敗しました。</span><span class="sxs-lookup"><span data-stu-id="5980d-102">Running the BizTalk Failed Message Routing ESB Processing Sample</span></span>
<span data-ttu-id="5980d-103">Microsoft BizTalk できませんでしたメッセージ ルーティング ESB 処理サンプルでは、使用する方法を示します、[!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)]管理、シリアル化、および BizTalk ですべての条件下で発生した例外を表示する汎用メカニズムとして例外管理フレームワークサーバー。</span><span class="sxs-lookup"><span data-stu-id="5980d-103">The Microsoft BizTalk Failed Message Routing ESB Processing sample demonstrates how you can use the [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] Exception Management Framework as a universal mechanism to manage, serialize, and render exceptions occurring under all conditions in BizTalk Server.</span></span> <span data-ttu-id="5980d-104">これには、BizTalk 失敗のメッセージのルーティング メカニズムと障害によって生成されたメッセージから、オーケストレーション内で、例外管理フレームワークによって生成される例外が含まれます。</span><span class="sxs-lookup"><span data-stu-id="5980d-104">This includes exceptions generated by the BizTalk Failed Message Routing mechanism and fault messages generated by the Exception Management Framework from within an orchestration.</span></span>  
  
 <span data-ttu-id="5980d-105">BizTalk 失敗のメッセージのルーティング メカニズムは、BizTalk Server のエラー処理の機能使用すると、デザイナーは、従来の代替手段としてのエラーのメッセージの自動処理を指定できます (ここで既定値) の動作を配置するには「保留」キューにメッセージが失敗しました。</span><span class="sxs-lookup"><span data-stu-id="5980d-105">The BizTalk Failed Message Routing mechanism is the error-handling facility of BizTalk Server; by using it, the designer can designate automated handling of messaging failures as an alternative to the traditional (now default) behavior of placing failed messages in the "Suspended" queue.</span></span> <span data-ttu-id="5980d-106">これは、処理のルートに、エラー メッセージを送信ポートやオーケストレーションなど、サブスクライブしているルーティング先を自動化できます。</span><span class="sxs-lookup"><span data-stu-id="5980d-106">This automated handling routes an error message to any subscribing routing destination, such as a send port or an orchestration.</span></span> <span data-ttu-id="5980d-107">エラー メッセージは、元のメッセージとすべての以前昇格させたプロパティが降格とメッセージ コンテキストに昇格し、特定のメッセージング失敗に関連する選択したプロパティの複製です。</span><span class="sxs-lookup"><span data-stu-id="5980d-107">The error message is a clone of the original message with all previously promoted properties demoted and with selected properties related to the specific messaging failure promoted into the message context.</span></span>  
  
 <span data-ttu-id="5980d-108">受信ポートまたは送信ポートでメッセージのルーティングに失敗しました BizTalk メカニズムを有効にするのには、選択、**失敗したメッセージのルーティングを有効にする**チェック ボックスを図 1 に示すようにします。</span><span class="sxs-lookup"><span data-stu-id="5980d-108">To enable the BizTalk Failed Message Routing mechanism on a receive port or a send port, select the **Enable routing for failed messages** check box, as shown in Figure 1.</span></span>  
  
 <span data-ttu-id="5980d-109">![ルーティングを有効になっている](../esb-toolkit/media/ch6-enabledrouting.gif "Ch6 EnabledRouting")</span><span class="sxs-lookup"><span data-stu-id="5980d-109">![Enabled Routing](../esb-toolkit/media/ch6-enabledrouting.gif "Ch6-EnabledRouting")</span></span>  
  
 <span data-ttu-id="5980d-110">**図 1**</span><span class="sxs-lookup"><span data-stu-id="5980d-110">**Figure 1**</span></span>  
  
 <span data-ttu-id="5980d-111">**BizTalk 失敗のメッセージのルーティング メカニズムを有効にします。**</span><span class="sxs-lookup"><span data-stu-id="5980d-111">**Enabling the BizTalk Failed Message Routing mechanism**</span></span>  
  
 <span data-ttu-id="5980d-112">ただし、エラーや障害のオーケストレーションで発生しているのと同様のメカニズムはありません。</span><span class="sxs-lookup"><span data-stu-id="5980d-112">However, there is not a similar mechanism for errors or failures occurring in an orchestration.</span></span> <span data-ttu-id="5980d-113">代わりに、オーケストレーションの例外ハンドラー内のコードは、BizTalk 失敗のメッセージのルーティング メカニズムの機能をエミュレートするには、例外管理フレームワーク API を活用を実行することができます。</span><span class="sxs-lookup"><span data-stu-id="5980d-113">Instead, code within the exception handler of an orchestration can take advantage of the Exception Management Framework API to emulate the functionality of the BizTalk Failed Message Routing mechanism.</span></span>  
  
 <span data-ttu-id="5980d-114">このサンプルで EAIProcess.RequestPort_FILE という名前の受信場所は、場所 \Source\Samples\Exception Handling\Test\Filedrop\EAIProcess.RequestPort にコピーされたファイルを取得します。</span><span class="sxs-lookup"><span data-stu-id="5980d-114">In this sample, the receive location named EAIProcess.RequestPort_FILE picks up files copied to the location \Source\Samples\Exception Handling\Test\Filedrop\EAIProcess.RequestPort.</span></span>  
  
 <span data-ttu-id="5980d-115">さらに、すべてをという名前の汎用的な送信ポートがあります。Exceptions_FILE 例外管理フレームワークの一部としてインストールされている、GlobalFaultProcessor パイプラインを使用するように構成します。</span><span class="sxs-lookup"><span data-stu-id="5980d-115">Additionally, there is a generic send port named ALL.Exceptions_FILE configured to use the GlobalFaultProcessor pipeline installed as part of the Exception Management Framework.</span></span> <span data-ttu-id="5980d-116">このポートは、システムで発生しているすべての例外をサブスクライブ、図 2 に示すように失敗したメッセージのメッセージをルーティングおよび ESB エラーのメッセージの両方の BizTalk します。</span><span class="sxs-lookup"><span data-stu-id="5980d-116">This port subscribes to all exceptions occurring in the system, both BizTalk failed message routing messages and ESB fault messages, as shown in Figure 2.</span></span>  
  
 <span data-ttu-id="5980d-117">![送信ポート](../esb-toolkit/media/ch6-sendport.gif "Ch6 SendPort")</span><span class="sxs-lookup"><span data-stu-id="5980d-117">![Send Port](../esb-toolkit/media/ch6-sendport.gif "Ch6-SendPort")</span></span>  
  
 <span data-ttu-id="5980d-118">**図 2**</span><span class="sxs-lookup"><span data-stu-id="5980d-118">**Figure 2**</span></span>  
  
 <span data-ttu-id="5980d-119">**すべて。例外の送信ポートのサブスクリプションのすべての種類のエラーまたは例外**</span><span class="sxs-lookup"><span data-stu-id="5980d-119">**The ALL.Exceptions send port subscription for all types of failure or exception**</span></span>  
  
 <span data-ttu-id="5980d-120">例外管理フレームワークでは、1 つの形式をすべての例外を正規化し、場所 \Source\Samples\Exception Handling\Test\Filedrop\All_Exceptions を Microsoft InfoPath 処理命令を使用してそれらをシリアル化します。</span><span class="sxs-lookup"><span data-stu-id="5980d-120">The Exception Management Framework normalizes all exceptions to a single format and serializes them using a Microsoft InfoPath processing instruction to the location \Source\Samples\Exception Handling\Test\Filedrop\All_Exceptions.</span></span>  
  
## <a name="installation"></a><span data-ttu-id="5980d-121">インストール</span><span class="sxs-lookup"><span data-stu-id="5980d-121">Installation</span></span>  
 <span data-ttu-id="5980d-122">すべての例外管理サンプルでは、同じコア サービスと BizTalk アプリケーションのアイテムのセットを使用します。</span><span class="sxs-lookup"><span data-stu-id="5980d-122">All the exception management samples use the same set of core services and BizTalk application artifacts.</span></span> <span data-ttu-id="5980d-123">そのため、すべての例外管理サンプルを実行できる例外管理サンプル アイテム 1 回だけをインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="5980d-123">Therefore, you have to install the exception management sample artifacts only once to be able to run all the exception management samples.</span></span> <span data-ttu-id="5980d-124">例外管理サンプルをインストールする方法については、次を参照してください。[例外管理サンプルをインストールする](../esb-toolkit/installing-the-exception-management-samples.md)します。</span><span class="sxs-lookup"><span data-stu-id="5980d-124">For information about how to install the exception management samples, see [Installing the Exception Management Samples](../esb-toolkit/installing-the-exception-management-samples.md).</span></span>  
  
## <a name="running-the-sample-application"></a><span data-ttu-id="5980d-125">サンプル アプリケーションを実行します。</span><span class="sxs-lookup"><span data-stu-id="5980d-125">Running the Sample Application</span></span>  
 <span data-ttu-id="5980d-126">**BizTalk できませんでしたメッセージ ルーティング ESB 処理サンプルを実行するには**</span><span class="sxs-lookup"><span data-stu-id="5980d-126">**To run the BizTalk Failed Message Routing ESB Processing sample**</span></span>  
  
1.  <span data-ttu-id="5980d-127">最初にこのサンプルを実行する前に、受信場所と送信ポートの URL を指している \Source\Samples\Exception Handling\Test\Filedrop フォルダーに適切なディレクトリを確認します。</span><span class="sxs-lookup"><span data-stu-id="5980d-127">Before you run this sample for the first time, make sure that the receive location and send port URL point to the appropriate directories in the \Source\Samples\Exception Handling\Test\Filedrop folder.</span></span> <span data-ttu-id="5980d-128">受信場所が EAIProcess.RequestPort、フォルダーを指定し、送信ポートの URL は All_Exceptions フォルダーを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5980d-128">The receive location should specify the folder EAIProcess.RequestPort, and the send port URL should specify the folder All_Exceptions.</span></span>  
  
2.  <span data-ttu-id="5980d-129">GlobalBank.ESB アプリケーションが実行されていない場合は、BizTalk 管理コンソールを使用して開始します。</span><span class="sxs-lookup"><span data-stu-id="5980d-129">If the GlobalBank.ESB application is not already running, use the BizTalk Administration Console to start it.</span></span>  
  
3.  <span data-ttu-id="5980d-130">(\Source\Samples\Exception Handling\Test\Filedrop フォルダー) 内の EAIProcess.RequestPort をという名前の受信場所フォルダーにフォルダー \Source\Samples\Exception Handling\Test\Data から FlatFileReceive_in.txt をという名前のファイルをコピーします。</span><span class="sxs-lookup"><span data-stu-id="5980d-130">Copy the file named FlatFileReceive_in.txt from the folder \Source\Samples\Exception Handling\Test\Data into the receive location folder named EAIProcess.RequestPort (in the \Source\Samples\Exception Handling\Test\Filedrop folder).</span></span>  
  
4.  <span data-ttu-id="5980d-131">このメッセージは、テキスト ファイルであり、例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="5980d-131">This message is a text file, and it will cause an exception.</span></span> <span data-ttu-id="5980d-132">(\Source\Samples\Exception Handling\Test\Filedrop フォルダーにある) All_Exceptions という名前のフォルダーを開き、エラー メッセージを適切なテンプレートを使用して InfoPath に開くをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="5980d-132">Open the folder named All_Exceptions (in the \Source\Samples\Exception Handling\Test\Filedrop folder), and then double-click the fault message to open it into InfoPath using the appropriate template.</span></span> <span data-ttu-id="5980d-133">InfoPath のレンダリングを許可するにこと ESB 例外処理メカニズムが、コンテンツを適切にシリアルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="5980d-133">You will see that the ESB Exception Handling mechanism serializes the content appropriately to allow InfoPath to render it.</span></span>  
  
5.  <span data-ttu-id="5980d-134">次に、コピー、EAIProcess.RequestPort にフォルダー \Source\Samples\Exception Handling\Test\Data から soapmessage [1] .xml という名前のファイルには、場所のフォルダーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="5980d-134">Next, copy the file named soapmessage[1].xml from the folder \Source\Samples\Exception Handling\Test\Data into the EAIProcess.RequestPort receive location folder.</span></span>  
  
6.  <span data-ttu-id="5980d-135">このメッセージは、CDATA セクションを含む XML ドキュメントであり、例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="5980d-135">This message is an XML document that contains a CDATA section, and it will cause an exception.</span></span> <span data-ttu-id="5980d-136">All_Exceptions 出力フォルダーを開き、エラー メッセージを InfoPath に開くをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="5980d-136">Open the All_Exceptions output folder and double-click the fault message to open it into InfoPath.</span></span> <span data-ttu-id="5980d-137">InfoPath のレンダリングを許可するにこと ESB 例外処理メカニズムがこのコンテンツを適切にシリアルが表示されます。</span><span class="sxs-lookup"><span data-stu-id="5980d-137">You will see that the ESB Exception Handling mechanism serializes this content appropriately to allow InfoPath to render it.</span></span>  
  
7.  <span data-ttu-id="5980d-138">最後に、コピー、EAIProcess.RequestPort にフォルダー \Source\Samples\Exception Handling\Test\Data から Csqzav01.pdf をという名前のファイルは受信場所です。</span><span class="sxs-lookup"><span data-stu-id="5980d-138">Finally, copy the file named Csqzav01.pdf from the folder \Source\Samples\Exception Handling\Test\Data into the EAIProcess.RequestPort receive location.</span></span>  
  
8.  <span data-ttu-id="5980d-139">このメッセージは、PDF ファイルであり、例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="5980d-139">This message is a PDF file, and it will cause an exception.</span></span> <span data-ttu-id="5980d-140">All_Exceptions 出力フォルダーを開き、InfoPath で開かれることに、エラー メッセージをダブルクリックします。</span><span class="sxs-lookup"><span data-stu-id="5980d-140">Open the All_Exceptions output folder and double-click the fault message to open it in InfoPath.</span></span> <span data-ttu-id="5980d-141">ESB 例外処理メカニズムがシリアル化し、Base 64 エンコード、コンテンツのレンダリングの InfoPath を許可することが表示されます。</span><span class="sxs-lookup"><span data-stu-id="5980d-141">You will see that the ESB Exception Handling mechanism serializes and Base-64 encodes the content to allow InfoPath to render it.</span></span>