---
title: ESB エラー プロセッサ パイプライン |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a57752b1-8bca-4534-9e5b-7ce721a9490a
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 03a31833947c755e2434c563a28412427af901fc
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65399809"
---
# <a name="the-esb-fault-processor-pipeline"></a><span data-ttu-id="7e3de-102">ESB エラー プロセッサ パイプライン</span><span class="sxs-lookup"><span data-stu-id="7e3de-102">The ESB Fault Processor Pipeline</span></span>
<span data-ttu-id="7e3de-103">[!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)]という名前のすべての送信ポートをインストールします。例外、ESBFaultProcessor を使用する送信パイプラインです。</span><span class="sxs-lookup"><span data-stu-id="7e3de-103">The [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] installs a send port named ALL.Exceptions that uses the ESBFaultProcessor send pipeline.</span></span> <span data-ttu-id="7e3de-104">図 1 は、すべてのプロパティを示します。例外は、ポートを送信します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-104">Figure 1 shows the properties of the ALL.Exceptions send port.</span></span>  
  
 <span data-ttu-id="7e3de-105">![すべての例外の送信ポート](../esb-toolkit/media/ch4-allexceptionssendport.gif "Ch4 AllExceptionsSendPort")</span><span class="sxs-lookup"><span data-stu-id="7e3de-105">![All Exceptions Send Port](../esb-toolkit/media/ch4-allexceptionssendport.gif "Ch4-AllExceptionsSendPort")</span></span>  
  
 <span data-ttu-id="7e3de-106">**図 1**</span><span class="sxs-lookup"><span data-stu-id="7e3de-106">**Figure 1**</span></span>  
  
 <span data-ttu-id="7e3de-107">**すべての構成。例外の送信ポート、ESBFaultProcessor パイプラインの使用を含む**</span><span class="sxs-lookup"><span data-stu-id="7e3de-107">**The configuration of the ALL.Exceptions send port, including its use of the ESBFaultProcessor pipeline**</span></span>  
  
 <span data-ttu-id="7e3de-108">ESBFaultProcessor パイプラインには、次のパイプライン コンポーネントが含まれています。ESB 例外エンコーダー、ESB ビジネス アクティビティ監視 (BAM) 追跡ツール、および ESB 変換します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-108">The ESBFaultProcessor pipeline contains the following pipeline components: ESB Exception Encoder, ESB Business Activity Monitoring (BAM) Tracker, and ESB Transform.</span></span>  
  
 <span data-ttu-id="7e3de-109">すべて。例外は、ポートをサブスクライブするすべての ESB エラー メッセージと BizTalk 失敗のメッセージのルーティング メカニズムによって生成されたすべてのメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-109">The ALL.Exceptions send port subscribes to all ESB fault messages and to all messages generated by the BizTalk Failed Message Routing mechanism.</span></span> <span data-ttu-id="7e3de-110">図 2 は、すべてのプロパティの設定、フィルターを示します。例外は、ポートを送信します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-110">Figure 2 shows the filter property settings of the ALL.Exceptions send port.</span></span>  
  
 <span data-ttu-id="7e3de-111">![送信ポートのフィルター処理](../esb-toolkit/media/ch4-filtersendport.gif "Ch4 FilterSendPort")</span><span class="sxs-lookup"><span data-stu-id="7e3de-111">![Filter Send Port](../esb-toolkit/media/ch4-filtersendport.gif "Ch4-FilterSendPort")</span></span>  
  
 <span data-ttu-id="7e3de-112">**図 2**</span><span class="sxs-lookup"><span data-stu-id="7e3de-112">**Figure 2**</span></span>  
  
 <span data-ttu-id="7e3de-113">**すべてのフィルター プロパティ。例外の送信ポートは、ポートのサブスクリプションを定義します。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-113">**The filter property of the ALL.Exceptions send port defines the port subscription**</span></span>  
  
## <a name="the-fault-processor-pipeline-exception-encoder-component"></a><span data-ttu-id="7e3de-114">エラー プロセッサ パイプライン例外エンコーダー コンポーネント</span><span class="sxs-lookup"><span data-stu-id="7e3de-114">The Fault Processor Pipeline Exception Encoder Component</span></span>  
 <span data-ttu-id="7e3de-115">ESB 例外エンコーダー パイプライン コンポーネントは、ESB 失敗オーケストレーションの例外ルーティング メカニズムと ESB 例外レポートに準拠する標準のメッセージに BizTalk 失敗のメッセージのルーティング メカニズムで生成されたエラー メッセージを正規化します。スキーマです。</span><span class="sxs-lookup"><span data-stu-id="7e3de-115">The ESB Exception Encoder pipeline component normalizes fault messages generated in the ESB Failed Orchestration Exception Routing mechanism and the BizTalk Failed Message Routing mechanism into canonical messages that comply with the ESB Exception Reporting schema.</span></span>  
  
 <span data-ttu-id="7e3de-116">オーケストレーションの例外ルーティングの失敗の例外では、コンポーネントが拡充し、すべてのエラー メッセージのプロパティ、XLANG メッセージ、コンテキストのプロパティをシリアル化と**System.Exception**情報を XML メッセージにします。</span><span class="sxs-lookup"><span data-stu-id="7e3de-116">For a Failed Orchestration Exception Routing exception, the component enriches and serializes all fault message properties, XLANG messages, context properties, and **System.Exception** information into an XML message.</span></span>  
  
 <span data-ttu-id="7e3de-117">メッセージをルーティングできませんでした例外では、コンポーネントは、アプリケーション名と、その他のアンビエント プロパティを追加することで、データを強化し、スキーマ名前空間、送信 XML メッセージの内容に適用します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-117">For a Failed Message Routing exception, the component enriches the data by adding the application name and other ambient properties, and it applies the schema namespace to the outbound XML message content.</span></span>  
  
 <span data-ttu-id="7e3de-118">必要に応じて、ESB 例外エンコーダー パイプライン コンポーネントは、Microsoft の InfoPath 処理命令、送信メッセージにも適用できます。</span><span class="sxs-lookup"><span data-stu-id="7e3de-118">Optionally, the ESB Exception Encoder pipeline component can also apply Microsoft InfoPath processing instructions to the outbound message.</span></span> <span data-ttu-id="7e3de-119">InfoPath の命令を変更するには、デザイン ビューで、パイプライン コンポーネントのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-119">You can modify the InfoPath instructions by setting the properties of the pipeline component in design view.</span></span> <span data-ttu-id="7e3de-120">次の 3 つのデザイン時プロパティでは、ESB 例外エンコーダー パイプライン コンポーネントの実行時の動作に影響します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-120">The following three design time properties affect the run-time behavior of the ESB Exception Encoder pipeline component:</span></span>  
  
- <span data-ttu-id="7e3de-121">**EscapeCDATA します。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-121">**EscapeCDATA.**</span></span> <span data-ttu-id="7e3de-122">このプロパティは、コンポーネントが、エスケープがかどうかを決定します**CDATA**のセクションでは、InfoPath が正しく表示にできるようにメッセージが永続化します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-122">This property determines whether the component will escape any **CDATA** sections found in persisted messages so that InfoPath can display them correctly.</span></span>  
  
- <span data-ttu-id="7e3de-123">**FaultDocumentNamespace します。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-123">**FaultDocumentNamespace.**</span></span> <span data-ttu-id="7e3de-124">このプロパティの既定値を持つ **http://schemas.microsoft.biztalk.practices.esb.com/exceptionhandling**します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-124">This property has a default value of **http://schemas.microsoft.biztalk.practices.esb.com/exceptionhandling**.</span></span> <span data-ttu-id="7e3de-125">永続化されたメッセージのカスタムの送信の名前空間を使用するように変更できます。</span><span class="sxs-lookup"><span data-stu-id="7e3de-125">This can be modified to use a custom outbound namespace for the persisted messages.</span></span>  
  
- <span data-ttu-id="7e3de-126">**ProcessingInstruction します。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-126">**ProcessingInstruction.**</span></span> <span data-ttu-id="7e3de-127">このプロパティは、フォールトの ESB 例外レポート スキーマに準拠している任意の InfoPath 処理命令を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="7e3de-127">This property can contain any InfoPath processing instruction that complies with the ESB Exception Reporting fault schema.</span></span> <span data-ttu-id="7e3de-128">[!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)]次の処理命令に準拠している InfoPath テンプレートが含まれています。</span><span class="sxs-lookup"><span data-stu-id="7e3de-128">The [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] includes an InfoPath template that conforms to the following processing instruction.</span></span>  
  
  ```  
  <?mso-infoPathSolution solutionVersion="1.0.0.346" productVersion="11.0.6565"  
  PIVersion="1.0.0.0"   
  href=file:///\\localhost\publish\Microsoft.Practices.ESB.ExceptionHandling.InfoPath.Reporting.xsn  
  name="urn:schemas-microsoft-com:office:infopath:  
  Microsoft-Practices-ESB-ExceptionHandling-InfoPath-Reporting:  
  http---schemas-microsoft-biztalk-practices-esb-com-exceptionhandling"  
  language="en-us" ?><?mso-application progid="InfoPath.Document"?>  
  ```  
  
## <a name="the-fault-processor-pipeline-bam-tracker-component"></a><span data-ttu-id="7e3de-129">エラー プロセッサ パイプライン BAM の追跡ツール コンポーネント</span><span class="sxs-lookup"><span data-stu-id="7e3de-129">The Fault Processor Pipeline BAM Tracker Component</span></span>  
 <span data-ttu-id="7e3de-130">ESB BAM の追跡ツールのパイプライン コンポーネントは、ESB 例外エンコーダー コンポーネントからメッセージを受信し、ESB 例外管理フレームワークのインストール中に作成された BAM プライマリ インポート テーブルを選択したエラーのデータを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="7e3de-130">The ESB BAM Tracker pipeline component receives the message from the ESB Exception Encoder component and writes selected fault data to the BAM primary import tables created during the installation of the ESB Exception Management Framework.</span></span>  
  
 <span data-ttu-id="7e3de-131">ESB BAM の追跡ツール コンポーネントを使用して、 **GetEventStream** BAM プライマリ インポート データベースにアクティビティのレコードと、次のフィールドを追加するパイプラインのコンテキストのメソッド。</span><span class="sxs-lookup"><span data-stu-id="7e3de-131">The ESB BAM Tracker component uses the **GetEventStream** method of the pipeline context to add the following fields as an activity record to the BAM Primary Import database:</span></span>  
  
- <span data-ttu-id="7e3de-132">**アプリケーション**</span><span class="sxs-lookup"><span data-stu-id="7e3de-132">**Application**</span></span>  
  
- <span data-ttu-id="7e3de-133">**[説明]**</span><span class="sxs-lookup"><span data-stu-id="7e3de-133">**Description**</span></span>  
  
- <span data-ttu-id="7e3de-134">**FaultSeverity**</span><span class="sxs-lookup"><span data-stu-id="7e3de-134">**FaultSeverity**</span></span>  
  
- <span data-ttu-id="7e3de-135">**サービス名**</span><span class="sxs-lookup"><span data-stu-id="7e3de-135">**ServiceName**</span></span>  
  
- <span data-ttu-id="7e3de-136">**ErrorType**</span><span class="sxs-lookup"><span data-stu-id="7e3de-136">**ErrorType**</span></span>  
  
- <span data-ttu-id="7e3de-137">**FaultCode**</span><span class="sxs-lookup"><span data-stu-id="7e3de-137">**FaultCode**</span></span>  
  
- <span data-ttu-id="7e3de-138">**MachineName**</span><span class="sxs-lookup"><span data-stu-id="7e3de-138">**MachineName**</span></span>  
  
- <span data-ttu-id="7e3de-139">**メッセージ Id**</span><span class="sxs-lookup"><span data-stu-id="7e3de-139">**MessageID**</span></span>  
  
- <span data-ttu-id="7e3de-140">**DateTime**</span><span class="sxs-lookup"><span data-stu-id="7e3de-140">**DateTime**</span></span>  
  
- <span data-ttu-id="7e3de-141">**FaultDescription**</span><span class="sxs-lookup"><span data-stu-id="7e3de-141">**FaultDescription**</span></span>  
  
- <span data-ttu-id="7e3de-142">**Scope**</span><span class="sxs-lookup"><span data-stu-id="7e3de-142">**Scope**</span></span>  
  
- <span data-ttu-id="7e3de-143">**FailureCategory**</span><span class="sxs-lookup"><span data-stu-id="7e3de-143">**FailureCategory**</span></span>  
  
- <span data-ttu-id="7e3de-144">**FaultGenerator**</span><span class="sxs-lookup"><span data-stu-id="7e3de-144">**FaultGenerator**</span></span>  
  
- <span data-ttu-id="7e3de-145">**ServiceInstanceID**</span><span class="sxs-lookup"><span data-stu-id="7e3de-145">**ServiceInstanceID**</span></span>  
  
  <span data-ttu-id="7e3de-146">ESB BAM の追跡ツール コンポーネントがメッセージ id を使用して (、 **MessageID**プロパティ) として BAM アクティビティの id ESB エラー メッセージの値。</span><span class="sxs-lookup"><span data-stu-id="7e3de-146">The ESB BAM Tracker component uses the message identifier (the **MessageID** property) value of the ESB fault message as the BAM activity ID.</span></span> <span data-ttu-id="7e3de-147">ESB BAM の追跡ツールのコンポーネントは、実行時の動作を変更するために設定できます 2 つのデザイン時プロパティを公開します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-147">The ESB BAM Tracker component exposes two design time properties that you can set to change its run-time behavior:</span></span>  
  
- <span data-ttu-id="7e3de-148">**有効。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-148">**Enabled.**</span></span> <span data-ttu-id="7e3de-149">このプロパティは、コンポーネントは、メッセージを処理し、BAM データベースに書き込むかどうかを決定します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-149">This property determines whether the component will process the message and write it to the BAM database.</span></span> <span data-ttu-id="7e3de-150">設定すると**False**コンポーネントは、パイプラインの次のコンポーネントにメッセージを送信するだけです。</span><span class="sxs-lookup"><span data-stu-id="7e3de-150">When set to **False**, the component just sends the message to the next component in the pipeline.</span></span>  
  
- <span data-ttu-id="7e3de-151">**FaultDocumentNamespace します。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-151">**FaultDocumentNamespace.**</span></span> <span data-ttu-id="7e3de-152">このプロパティの既定値を持つ **http://schemas.microsoft.biztalk.practices.esb.com/exceptionhandling**します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-152">This property has a default value of **http://schemas.microsoft.biztalk.practices.esb.com/exceptionhandling**.</span></span>  
  
## <a name="the-fault-processor-pipeline-transform-component"></a><span data-ttu-id="7e3de-153">エラー プロセッサ パイプライン コンポーネントを変換します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-153">The Fault Processor Pipeline Transform Component</span></span>  
 <span data-ttu-id="7e3de-154">ESB エラー プロセッサ パイプラインでは、ESB の変換のパイプライン コンポーネントを使用して、BizTalk SQL アダプター (ExceptionSql.xsd) のスキーマに一致する形式でエンコードされた ESB エラー メッセージに変換する BizTalk マップを実行します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-154">The ESB Fault Processor pipeline uses the ESB Transform pipeline component to execute a BizTalk map that translates the encoded ESB fault message into a format that matches the schema for the BizTalk SQL Adapter (ExceptionSql.xsd).</span></span> <span data-ttu-id="7e3de-155">コンポーネントは、ESB 管理ポータルのデータベースに、ESB エラー メッセージを挿入する SQL アダプターにし、変換後のメッセージを渡します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-155">The component then passes the transformed message to the SQL Adapter, which inserts the ESB fault message into the ESB Management Portal database.</span></span>  
  
 <span data-ttu-id="7e3de-156">ESB の変換のパイプライン コンポーネントは、実行時の動作を変更するのには変更可能な 3 つのデザイン時プロパティを公開します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-156">The ESB Transform pipeline component exposes three design-time properties that can be modified to change its run-time behavior:</span></span>  
  
- <span data-ttu-id="7e3de-157">**有効。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-157">**Enabled.**</span></span> <span data-ttu-id="7e3de-158">このプロパティは、有効またはコンポーネントを無効にします。</span><span class="sxs-lookup"><span data-stu-id="7e3de-158">This property enables or disables the component.</span></span>  
  
- <span data-ttu-id="7e3de-159">**検証します。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-159">**Validate.**</span></span> <span data-ttu-id="7e3de-160">このプロパティは、メッセージを検証する必要かどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-160">This property specifies whether a message needs to be validated.</span></span>  
  
- <span data-ttu-id="7e3de-161">**MapName します。**</span><span class="sxs-lookup"><span data-stu-id="7e3de-161">**MapName.**</span></span> <span data-ttu-id="7e3de-162">このプロパティには、ESB 管理ポータルのデータベース内のストレージは、メッセージを変換するために実行する必要がありますマップの名前が含まれています。</span><span class="sxs-lookup"><span data-stu-id="7e3de-162">This property contains the name of the map that must be executed to translate the message for storage in the ESB Management Portal database.</span></span> <span data-ttu-id="7e3de-163">既定値は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="7e3de-163">The following is the default value.</span></span>  
  
  ```  
  Microsoft.Practices.ESB.ExceptionHandling.Maps.FaultMessage_to_ExceptionSql,  
  Microsoft.Practices.ESB.ExceptionHandling.Maps,  
  Version=2.0.0.0,  
  Culture=neutral,  
  PublicKeyToken=c2c8b2b87f54180a  
  ```  
  
  <span data-ttu-id="7e3de-164">すべてのパイプライン コンポーネントの実行が完了した後、BizTalk SQL Server データベース アダプターは、ESB 管理ポータルのデータベースに、エラー メッセージを挿入します。</span><span class="sxs-lookup"><span data-stu-id="7e3de-164">After all the pipeline components finish executing, the BizTalk SQL Server database adapter inserts the fault message into the ESB Management Portal database.</span></span>