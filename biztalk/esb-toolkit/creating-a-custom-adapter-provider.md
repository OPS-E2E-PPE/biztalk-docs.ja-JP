---
title: "カスタム アダプター プロバイダーの作成 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: bb93acf8-fd9d-4315-8690-f0c152a954b5
caps.latest.revision: "2"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1f70855621f03011c92be7b04b844122d98be48f
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2017
---
# <a name="creating-a-custom-adapter-provider"></a><span data-ttu-id="198b9-102">カスタム アダプター プロバイダーの作成</span><span class="sxs-lookup"><span data-stu-id="198b9-102">Creating a Custom Adapter Provider</span></span>
<span data-ttu-id="198b9-103">前のセクションで説明されていると、競合回避モジュールの実行、後に、動的な解決サービスは、結果は、エンドポイント (変換ではない) かどうかをチェックします。</span><span class="sxs-lookup"><span data-stu-id="198b9-103">After a resolver executes, as described in the previous sections, the dynamic resolution service checks whether the result is an endpoint (not a transformation).</span></span> <span data-ttu-id="198b9-104">サービスのインスタンスであるアダプター マネージャー インスタンスを作成、エンドポイントである場合の**AdapterMgr**クラスです。</span><span class="sxs-lookup"><span data-stu-id="198b9-104">If it is an endpoint, the service instantiates the adapter manager, which is an instance of the **AdapterMgr** class.</span></span>  
  
 <span data-ttu-id="198b9-105">アダプター マネージャーは、検証し、トランスポートの種類および送信トランスポートの場所を修正します。</span><span class="sxs-lookup"><span data-stu-id="198b9-105">The adapter manager validates and fixes the transport type and the outbound transport location.</span></span> <span data-ttu-id="198b9-106">トランスポートの種類がまだない解決された場合、および URL が"http"または"https"で始まる場合は、アダプター マネージャーは、トランスポートの種類を"Wcf-wshttp"を設定します。</span><span class="sxs-lookup"><span data-stu-id="198b9-106">If the transport type is still not resolved, and if the URL begins with either "http" or "https", the adapter manager sets the transport type to "WCF-WSHttp".</span></span>  
  
 <span data-ttu-id="198b9-107">次に、アダプター マネージャーは、トランスポートの種類が、有効な Microsoft BizTalk Server アダプターに相当し、そのプロパティの名前空間が返されますことを確認します。</span><span class="sxs-lookup"><span data-stu-id="198b9-107">Next, the adapter manager verifies that the transport type equates to a valid Microsoft BizTalk Server adapter, and then it returns its property namespace.</span></span> <span data-ttu-id="198b9-108">このプロセスは、すべてのアダプターの 1 回だけ実行し、同じアダプターを使用するその他の受信メッセージのクエリを繰り返しを避けるために、キャッシュに結果を格納します。</span><span class="sxs-lookup"><span data-stu-id="198b9-108">This process runs only once for all adapters and stores the results in a cache to avoid repeated queries for other incoming messages that use the same adapter.</span></span>  
  
 <span data-ttu-id="198b9-109">アダプター マネージャーが、トランスポートの種類を使用して (なし、"**://**"サフィックス) を適切なアダプター プロバイダーを確認します。</span><span class="sxs-lookup"><span data-stu-id="198b9-109">The adapter manager uses the transport type (without the "**://**" suffix) to determine the appropriate adapter provider.</span></span> <span data-ttu-id="198b9-110">アダプター プロバイダーは、カスタム アセンブリを実装する必要がありますが、 **IAdapterProvider**インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="198b9-110">An adapter provider is a custom assembly that must implement the **IAdapterProvider** interface.</span></span> <span data-ttu-id="198b9-111">アダプター プロバイダーのプロパティを使用して、**解決**構造体、**ディクショナリ**を有効にするメッセージのすべてのプロトコル固有のプロパティを設定する競合回避モジュールによって生成されたインスタンス、Microsoft BizTalk Server ランタイム エンジンを動的な解決を実行します。</span><span class="sxs-lookup"><span data-stu-id="198b9-111">The adapter provider uses the properties of the **Resolution** structure in the **Dictionary** instance generated by the resolver to set all the protocol-specific properties of the message that enables the Microsoft BizTalk Server run-time engine to perform dynamic resolution.</span></span>  
  
 <span data-ttu-id="198b9-112">同様に (前のセクションで説明)、競合回避モジュールで動的解決メカニズムを使用してエントリ Esb.config 構成ファイルで見つけますアダプター プロバイダーです。</span><span class="sxs-lookup"><span data-stu-id="198b9-112">Like with the resolver (described in the previous section), the dynamic resolution mechanism uses entries in the Esb.config configuration file to locate adapter providers.</span></span> <span data-ttu-id="198b9-113">次の XML は、構成ファイルのセクションを示しています。</span><span class="sxs-lookup"><span data-stu-id="198b9-113">The following XML shows the section of the configuration file.</span></span>  
  
```xml  
<adapterProviders cacheManager= "Adapter Providers Cache Manager"  absoluteExpiration="3600">  
     <adapterProvider name="WCF-WSHttp" type="Microsoft.Practices.ESB.Adapter.WcfWSHttp.AdapterProvider, Microsoft.Practices.ESB.Adapter.WcfWSHttp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="Http,Https" />  
     <adapterProvider name="WCF-BasicHttp" type="Microsoft.Practices.ESB.Adapter.WcfBasicHttp.AdapterProvider, Microsoft.Practices.ESB.Adapter.WcfBasicHttp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="Http,Https" />  
     <adapterProvider name="WCF-Custom" type="Microsoft.Practices.ESB.Adapter.WcfCustom.AdapterProvider, Microsoft.Practices.ESB.Adapter.WcfCustom, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="mssql" />  
     <adapterProvider name="SMTP" type="Microsoft.Practices.ESB.Adapter.SMTP.AdapterProvider, Microsoft.Practices.ESB.Adapter.SMTP, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="smtp" />  
     <adapterProvider name="FTP" type="Microsoft.Practices.ESB.Adapter.FTP.AdapterProvider, Microsoft.Practices.ESB.Adapter.FTP, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22">  
          <adapterConfig>  
               <add name="DefaultUsername" value="anonymous" />  
               <add name="DefaultPassword" value="" />  
          </adapterConfig>  
     </adapterProvider>  
     <adapterProvider name="MQSeries" type="Microsoft.Practices.ESB.Adapter.MQSeries.AdapterProvider, Microsoft.Practices.ESB.Adapter.MQSeries, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="MQS" adapterAssembly="MQSeries, Version=3.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />  
     <adapterProvider name="FILE" type="Microsoft.Practices.ESB.Adapter.FILE.AdapterProvider, Microsoft.Practices.ESB.Adapter.FILE, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="File" />  
</adapterProviders>  
```  
  
## <a name="creating-a-custom-adapter-provider"></a><span data-ttu-id="198b9-114">カスタム アダプター プロバイダーの作成</span><span class="sxs-lookup"><span data-stu-id="198b9-114">Creating a Custom Adapter Provider</span></span>  
 <span data-ttu-id="198b9-115">アダプター マネージャー (のインスタンス、 **AdapterMgr**クラス) は構成ファイルにアダプター プロバイダーを検索し、適切なアセンブリを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="198b9-115">The adapter manager (an instance of the **AdapterMgr** class) looks up the adapter provider in the configuration files and loads the appropriate assembly.</span></span> <span data-ttu-id="198b9-116">動的解決メカニズムの具象実装が読み込まれているすべてのキャッシュ、 **IAdapterProvider**インターフェイスの構成情報とアセンブリの読み込み時に、いくつかの受信メッセージを使用して繰り返される読み取りを回避するのには同じアダプター プロバイダーです。</span><span class="sxs-lookup"><span data-stu-id="198b9-116">The dynamic resolution mechanism caches all loaded concrete implementations of the **IAdapterProvider** interface to avoid repeated reading of configuration information and assembly loading when several incoming messages use the same adapter provider.</span></span>  
  
 <span data-ttu-id="198b9-117">アダプター マネージャーが最後に、実行、 **SetEndPoint**の具象実装のメソッド、 **IAdapterProvider**インターフェイス、およびパイプライン コンポーネントは、BizTalk にメッセージを返しますメッセージ ボックス データベースです。</span><span class="sxs-lookup"><span data-stu-id="198b9-117">Finally, the adapter manager executes the **SetEndPoint** method of the concrete implementation of the **IAdapterProvider** interface, and the pipeline component returns the message to the BizTalk Message Box database.</span></span>  
  
 <span data-ttu-id="198b9-118">**カスタム アダプター プロバイダーを作成するには**</span><span class="sxs-lookup"><span data-stu-id="198b9-118">**To create a custom adapter provider**</span></span>  
  
1.  <span data-ttu-id="198b9-119">派生するアセンブリを作成、 **BaseAdapterProvider**基底クラスとが含まれています、 **SetEndPoint**エンドポイントにメッセージのコンテキスト プロパティを設定するメソッド。</span><span class="sxs-lookup"><span data-stu-id="198b9-119">Create an assembly that derives from the **BaseAdapterProvider** base class and contains a **SetEndPoint** method that sets the endpoint context properties of the message.</span></span>  
  
2.  <span data-ttu-id="198b9-120">使用して Esb.config 構成ファイルに追加して、アダプターのプロバイダーを登録、  **\<adapterProvider\>** としてアダプターの名前を持つ要素、**名前**属性クラスの完全修飾名、**型**属性、モニカーとして、**モニカー**属性 (複数の値は、コンマで区切る必要があります)、および必要に応じて、アセンブリの実際のアダプターとして、 **adapterAssembly**属性。</span><span class="sxs-lookup"><span data-stu-id="198b9-120">Register the adapter provider by adding it to Esb.config configuration files using an **\<adapterProvider\>** element with a name for the adapter as the **name** attribute, the fully qualified name of the class as the **type** attribute, the moniker as the **moniker** attribute (multiple values should be separated by a comma), and optionally the assembly of the actual adapter as the **adapterAssembly** attribute.</span></span>  
  
3.  <span data-ttu-id="198b9-121">グローバル アセンブリ キャッシュに新しいアセンブリを登録します。</span><span class="sxs-lookup"><span data-stu-id="198b9-121">Register the new assembly in the global assembly cache.</span></span>