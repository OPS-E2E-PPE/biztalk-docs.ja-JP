---
title: BTAHL7 によるメッセージのルーティング |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- routing, about routing
- routing, messages
- messages, routing
- BTAHL7, message routing
ms.assetid: 555696c7-6023-44eb-b13d-cf7527bbc92f
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6b4223648bc62cf748640a9528a831deafdafa2c
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65292930"
---
# <a name="how-btahl7-routes-messages"></a><span data-ttu-id="b19ab-102">BTAHL7 によるメッセージのルーティング方法</span><span class="sxs-lookup"><span data-stu-id="b19ab-102">How BTAHL7 Routes Messages</span></span>
<span data-ttu-id="b19ab-103">Microsoft BizTalk Accelerator 用 HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) メッセージの処理の Microsoft の機能を活用して[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]が HL7 メッセージングの要件に固有のいくつかの方法で拡張することもできます。</span><span class="sxs-lookup"><span data-stu-id="b19ab-103">Microsoft BizTalk Accelerator for HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) leverages the message processing capabilities of Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], but also extends it in several ways that are specific to HL7 messaging requirements.</span></span>  

## <a name="routing-overview"></a><span data-ttu-id="b19ab-104">ルーティングの概要</span><span class="sxs-lookup"><span data-stu-id="b19ab-104">Routing overview</span></span>

<span data-ttu-id="b19ab-105">HL7 は、基幹業務 (LOB) システムからメッセージを受信し、MLLP アダプターを使用してそれらを受信する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b19ab-105">HL7 receives messages from a Line of Business (LOB) system, and may receive them using the MLLP adapter.</span></span> <span data-ttu-id="b19ab-106">LOB システムに MLLP アダプターを接続する[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]over TCP ポート、およびし MLLP アダプターにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-106">The LOB system connects to MLLP adapter on [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] over a TCP port, and then sends messages to the MLLP adapter.</span></span>

<span data-ttu-id="b19ab-107"> **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)]と以前のバージョン*\*、HL7 MLLP 受信 MLLP への接続に、リモート LOB システムのトランスポート アダプター待機します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-107">In **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] and older versions**, the HL7 MLLP receive transport adapter waits for the remote LOB system to connect to MLLP.</span></span> <span data-ttu-id="b19ab-108">接続すると、リモート LOB システム、LOB システム送信に MLLP を使用して、メッセージ、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-108">Once the remote LOB system connects, the LOB system sends the messages using MLLP to the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="b19ab-109">具体的な内容は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="b19ab-109">Specifically:</span></span> 

1. <span data-ttu-id="b19ab-110">リモートの LOB システムは、ローカルの MLLP アダプターに接続する[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]TCP ポートを使用</span><span class="sxs-lookup"><span data-stu-id="b19ab-110">The remote LOB system connects to the MLLP adapter on the local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] using a TCP port</span></span> 
2. <span data-ttu-id="b19ab-111">受信場所が、BTA4HL7 MLLP アダプターは、接続を受け入れます</span><span class="sxs-lookup"><span data-stu-id="b19ab-111">The BTA4HL7 receive location with MLLP Adapter accepts the connection</span></span> 
3. <span data-ttu-id="b19ab-112">リモートの LOB システムに 1 つまたは複数のメッセージを配信します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-112">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="b19ab-113">リモートの LOB システムを切断します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-113">The remote LOB system disconnects</span></span>

<span data-ttu-id="b19ab-114"> **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)]以降のバージョン*\*、MLLP アダプターで LOB システムへの接続が開始され、MLLP への LOB システム プッシュ メッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-114">In **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] and newer versions**, the connection to the LOB system is initiated by the MLLP adapter, and then the LOB system pushes messages to the MLLP receive.</span></span> <span data-ttu-id="b19ab-115">つまり、リモート LOB システムは、メッセージングを MLLP に送信する前に、接続の待機します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-115">In other words, the remote LOB system waits for the connection before sending messagings to MLLP.</span></span> <span data-ttu-id="b19ab-116">具体的な内容は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="b19ab-116">Specifically:</span></span> 

1. <span data-ttu-id="b19ab-117">ローカル[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]TCP ポートを使用して、リモート LOB システムに接続します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-117">The local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] connects to the remote LOB system using a TCP port</span></span> 
2. <span data-ttu-id="b19ab-118">BTA4HL7 接続の受信場所の MLLP アダプターを開始します</span><span class="sxs-lookup"><span data-stu-id="b19ab-118">The BTA4HL7 receive location with MLLP adapter initiates the connection</span></span> 
3. <span data-ttu-id="b19ab-119">リモートの LOB システムに 1 つまたは複数のメッセージを配信します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-119">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="b19ab-120">リモートの LOB システムを切断します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-120">The remote LOB system disconnects</span></span> 

<span data-ttu-id="b19ab-121">旧バージョンとの互換性のためには、リモート LOB システムが接続を開始元の既定の動作使用できます。</span><span class="sxs-lookup"><span data-stu-id="b19ab-121">For backwards-compatibility, you can use the original default behavior where the remote LOB system initiates the connections.</span></span> <span data-ttu-id="b19ab-122">このオプションは、MLLP で構成可能な受信場所のプロパティ。</span><span class="sxs-lookup"><span data-stu-id="b19ab-122">This option is configurable in the MLLP receive location properties.</span></span> 
 
<span data-ttu-id="b19ab-123">HL7 メッセージを受信すると、HL7 に送信し、受信パイプライン。</span><span class="sxs-lookup"><span data-stu-id="b19ab-123">Once the HL7 message is received, it is then submitted to an HL7 receive pipeline.</span></span> <span data-ttu-id="b19ab-124">このパイプラインでは、HL7 の逆アセンブラーは、メッセージを解析し、適切なスキーマ定義と検証の構成に従ってメッセージを検証します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-124">Within this pipeline, the HL7 disassembler will parse the message, and will validate the message according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="b19ab-125">(成功またはエラー)、この時点では、受信確認メッセージがあります、HL7 が生成されたメッセージと関連する受信確認の構成の有効性に従ってします。</span><span class="sxs-lookup"><span data-stu-id="b19ab-125">At this point, an HL7 acknowledgment message may be generated (success or error), according to the validity of the message and the relevant acknowledgment configuration.</span></span> <span data-ttu-id="b19ab-126">ここでは、メッセージ インスタンスと省略可能な受信確認の処理およびルーティングをさらに、メッセージ ボックス データベースには、パイプラインが送信されます。</span><span class="sxs-lookup"><span data-stu-id="b19ab-126">From here, the pipeline will submit the message instance and optional acknowledgment to the MessageBox database for further processing and routing.</span></span>  
  
 <span data-ttu-id="b19ab-127">メッセージ インスタンスが、メッセージ ボックス データベースが到着すると[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]フィルターに基づくサブスクリプションを確認し、HL7 送信パイプラインを通じて送信ポート (MLLP ポート可能性があります) を 1 つまたは複数のメッセージをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="b19ab-127">Once a message instance arrives in the MessageBox database, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] checks filter-based subscriptions and routes the message to one or more send ports (possibly MLLP ports) through an HL7 send pipeline.</span></span> <span data-ttu-id="b19ab-128">送信パイプラインは、適切なスキーマの定義と検証の構成に従ってメッセージ インスタンスを検証可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b19ab-128">The send pipeline may validate the message instances according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="b19ab-129">検証を加え、送信メッセージの MSH セグメントで特定のフィールド値をオーバーライドすることです。</span><span class="sxs-lookup"><span data-stu-id="b19ab-129">In addition to validation, it is possible to override certain field values in the MSH segment of the outgoing message.</span></span> <span data-ttu-id="b19ab-130">この上書き機能は、メッセージにサブスクライブしている複数のポートと受信側アプリケーションごとに MSH のセグメント値内で一意の期待場合に特に便利です。</span><span class="sxs-lookup"><span data-stu-id="b19ab-130">This override ability is especially useful if multiple ports have subscribed to a message and each receiving application has unique expectations within the MSH segment values.</span></span>  
  
 <span data-ttu-id="b19ab-131">他のすべてではもちろん、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]送信し、受信ポートの機能が使用可能 MLLP 送信ポートのパラメーターなど、選択したポートの種類に固有のいくつかの機能と共に、HL7 メッセージになります。</span><span class="sxs-lookup"><span data-stu-id="b19ab-131">Of course, all of the other [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] send and receive port capabilities will be available to HL7 messages, along with some capabilities that may be unique to the selected port type, such as MLLP send-port parameters.</span></span> <span data-ttu-id="b19ab-132">関連する例[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]機能は、送信メッセージに変換マップを適用することになります。</span><span class="sxs-lookup"><span data-stu-id="b19ab-132">An example of the relevant [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] capabilities would be the ability to apply a transformation map to an outbound message.</span></span>  
  
## <a name="how-routing-works"></a><span data-ttu-id="b19ab-133">ルーティングの動作</span><span class="sxs-lookup"><span data-stu-id="b19ab-133">How Routing Works</span></span>

<span data-ttu-id="b19ab-134">[!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)]ルート HL7 メッセージに従って、メッセージ ボックス データベースを管理するサブスクリプションのインスタンス。</span><span class="sxs-lookup"><span data-stu-id="b19ab-134">The [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] routes HL7 message instances according to subscriptions that the MessageBox database manages.</span></span> <span data-ttu-id="b19ab-135">これらのサブスクリプションでは、送信ポートごとに定義されたフィルターを使用します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-135">These subscriptions use filters that you define for each send port.</span></span> <span data-ttu-id="b19ab-136">ベースのルーティング フィルター例にはが含まれます受信ポートの ID や HL7 メッセージの種類 (ADT ^ A03、たとえば) アプリケーション (MSH3.1 値) を送信します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-136">Example filters might include routing based on receive port ID and/or HL7 message type (ADT^A03, for example) and/or sending application (MSH3.1 value).</span></span>  
  
 <span data-ttu-id="b19ab-137">設定するだけでなく[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]として HL7 メッセージ インスタンスに影響を与える HL7 に固有のメッセージング構成を実行する必要があるサブスクリプションの場合、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]にルーティングします。</span><span class="sxs-lookup"><span data-stu-id="b19ab-137">In addition to setting up [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] subscriptions, you need to perform some HL7-specific messaging configuration that will affect HL7 message instances as [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] routes them.</span></span> <span data-ttu-id="b19ab-138">この追加の構成では、一意の HL7 検証規則の受信確認の自動生成および MSH 値をオーバーライドする機能を適用することができます。</span><span class="sxs-lookup"><span data-stu-id="b19ab-138">This additional configuration enables you to apply unique HL7 validation rules, automatic generation of acknowledgments, and the ability to override MSH values.</span></span> [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] <span data-ttu-id="b19ab-139">この構成はパーティ レベルで適用します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-139">applies this configuration at the party level.</span></span> <span data-ttu-id="b19ab-140">BizTalk エクスプ ローラーでパーティを定義し、関連する HL7 構成内で実行する必要がある[!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)]構成エクスプ ローラー。</span><span class="sxs-lookup"><span data-stu-id="b19ab-140">You need to define parties within BizTalk Explorer and perform the related HL7 configuration within [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] Configuration Explorer.</span></span>  
  
 <span data-ttu-id="b19ab-141">複数の送信ポートのメッセージをサブスクライブするには、一意の HL7 メッセージングの構成 (たとえば、検証または MSH の上書き) を適用するには、パーティ間の関連付けを作成および送信ポートを必要があります。</span><span class="sxs-lookup"><span data-stu-id="b19ab-141">To apply unique HL7 messaging configuration (for example, validation or MSH overrides) to multiple send ports that subscribe to a message, you need to create associations between parties and send ports.</span></span> <span data-ttu-id="b19ab-142">BizTalk エクスプ ローラーでパーティのプロパティとしては、パーティの送信ポートの関連付けを構成します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-142">You configure party-to-send port associations as party properties within BizTalk Explorer.</span></span>  
  
 <span data-ttu-id="b19ab-143">複数の送信ポートにメッセージをルーティング HL7 必要がありますまたは複数の送信ポートに一意の HL7 処理構成を適用しない、送信ポートをパーティに関連付ける手順から除外できます。</span><span class="sxs-lookup"><span data-stu-id="b19ab-143">If you do not need to route HL7 messages to multiple send ports, or apply unique HL7 processing configuration to multiple send ports, you can eliminate the step of associating parties with send ports.</span></span> <span data-ttu-id="b19ab-144">この場合、 [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] HL7 メッセージ (MSH 3.1) で、受信側のアプリケーション フィールドを介して、HL7 メッセージング構成をパーティを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="b19ab-144">In this case, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] associates the party with its HL7 messaging configuration through the receiving application field in the HL7 message (MSH 3.1).</span></span> <span data-ttu-id="b19ab-145">このような状況が HL7 interrogative (要求/応答) で発生する最も可能性の高いメッセージ交換します。</span><span class="sxs-lookup"><span data-stu-id="b19ab-145">This situation is most likely to occur in an HL7 interrogative (request/response) message exchange.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b19ab-146">参照</span><span class="sxs-lookup"><span data-stu-id="b19ab-146">See Also</span></span>  
 [<span data-ttu-id="b19ab-147">メッセージの検証</span><span class="sxs-lookup"><span data-stu-id="b19ab-147">Message Validation</span></span>](../../adapters-and-accelerators/accelerator-hl7/message-validation.md)