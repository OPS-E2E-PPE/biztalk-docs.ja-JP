---
title: BTAHL7 でメッセージをルーティングする方法 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- routing, about routing
- routing, messages
- messages, routing
- BTAHL7, message routing
ms.assetid: 555696c7-6023-44eb-b13d-cf7527bbc92f
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 61dd223a014ae8ea7de35d8d73f1a7cf7ef35449
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22205098"
---
# <a name="how-btahl7-routes-messages"></a><span data-ttu-id="c8b69-102">BTAHL7 でメッセージをルーティングする方法</span><span class="sxs-lookup"><span data-stu-id="c8b69-102">How BTAHL7 Routes Messages</span></span>
[!INCLUDE[btsCoName](../../includes/btsconame-md.md)]<span data-ttu-id="c8b69-103">BizTalk Accelerator 用 HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)])、メッセージ処理の機能を活用して[!INCLUDE[btsCoName](../../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]、HL7 メッセージング要件に固有のいくつかの方法で拡張することも、します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-103"> BizTalk Accelerator for HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) leverages the message processing capabilities of [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], but also extends it in several ways that are specific to HL7 messaging requirements.</span></span>  

## <a name="routing-overview"></a><span data-ttu-id="c8b69-104">ルーティングの概要</span><span class="sxs-lookup"><span data-stu-id="c8b69-104">Routing overview</span></span>

<span data-ttu-id="c8b69-105">HL7 は、基幹業務 (LOB) システムからメッセージを受信し、MLLP アダプターを使用してそれらを受け取ることがあります。</span><span class="sxs-lookup"><span data-stu-id="c8b69-105">HL7 receives messages from a Line of Business (LOB) system, and may receive them using the MLLP adapter.</span></span> <span data-ttu-id="c8b69-106">LOB システムに MLLP アダプターを接続する[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]TCP ポート、および、送信メッセージ MLLP アダプターを経由します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-106">The LOB system connects to MLLP adapter on [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] over a TCP port, and then sends messages to the MLLP adapter.</span></span>

<span data-ttu-id="c8b69-107"> **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)]と以前のバージョン**、HL7 MLLP の受信 MLLP に接続するリモートの LOB システムのトランスポート アダプターを待機します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-107">In **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] and older versions**, the HL7 MLLP receive transport adapter waits for the remote LOB system to connect to MLLP.</span></span> <span data-ttu-id="c8b69-108">リモートの LOB システム接続するいると、LOB システム メッセージを送信しますに MLLP を使用して、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="c8b69-108">Once the remote LOB system connects, the LOB system sends the messages using MLLP to the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="c8b69-109">具体的な内容は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="c8b69-109">Specifically:</span></span> 

1. <span data-ttu-id="c8b69-110">ローカル MLLP アダプターに接続するリモートの LOB システム[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]TCP ポートを使用します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-110">The remote LOB system connects to the MLLP adapter on the local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] using a TCP port</span></span> 
2. <span data-ttu-id="c8b69-111">受信場所が、BTA4HL7 MLLP アダプターは、接続を受け入れます</span><span class="sxs-lookup"><span data-stu-id="c8b69-111">The BTA4HL7 receive location with MLLP Adapter accepts the connection</span></span> 
3. <span data-ttu-id="c8b69-112">1 つまたは複数のメッセージを配信するリモートの LOB システム</span><span class="sxs-lookup"><span data-stu-id="c8b69-112">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="c8b69-113">リモートの LOB システムの接続が切断します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-113">The remote LOB system disconnects</span></span>

<span data-ttu-id="c8b69-114"> **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)]以降のバージョン**MLLP アダプターによって、LOB システムへの接続が開始され、MLLP への LOB システム プッシュ メッセージを受信し、します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-114">In **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] and newer versions**, the connection to the LOB system is initiated by the MLLP adapter, and then the LOB system pushes messages to the MLLP receive.</span></span> <span data-ttu-id="c8b69-115">つまり、リモートの LOB システム待機 MLLP にメッセージングを送信する前に接続します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-115">In other words, the remote LOB system waits for the connection before sending messagings to MLLP.</span></span> <span data-ttu-id="c8b69-116">具体的な内容は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="c8b69-116">Specifically:</span></span> 

1. <span data-ttu-id="c8b69-117">ローカル[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]TCP ポートを使用してリモートの LOB システムに接続するには</span><span class="sxs-lookup"><span data-stu-id="c8b69-117">The local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] connects to the remote LOB system using a TCP port</span></span> 
2. <span data-ttu-id="c8b69-118">受信場所 MLLP アダプターを開始、接続が、BTA4HL7</span><span class="sxs-lookup"><span data-stu-id="c8b69-118">The BTA4HL7 receive location with MLLP adapter initiates the connection</span></span> 
3. <span data-ttu-id="c8b69-119">1 つまたは複数のメッセージを配信するリモートの LOB システム</span><span class="sxs-lookup"><span data-stu-id="c8b69-119">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="c8b69-120">リモートの LOB システムの接続が切断します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-120">The remote LOB system disconnects</span></span> 

<span data-ttu-id="c8b69-121">下位互換性を行うこともできます、元の既定の動作、リモートの LOB システムが接続を開始します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-121">For backwards-compatibility, you can use the original default behavior where the remote LOB system initiates the connections.</span></span> <span data-ttu-id="c8b69-122">このオプションは構成可能で、MLLP 受信場所のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="c8b69-122">This option is configurable in the MLLP receive location properties.</span></span> 
 
<span data-ttu-id="c8b69-123">HL7 メッセージを受信すると、HL7 に送信し、受信パイプラインです。</span><span class="sxs-lookup"><span data-stu-id="c8b69-123">Once the HL7 message is received, it is then submitted to an HL7 receive pipeline.</span></span> <span data-ttu-id="c8b69-124">このパイプラインでは、HL7 逆アセンブラーは、メッセージを解析し、適切なスキーマ定義と検証の構成に従ってメッセージを検証します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-124">Within this pipeline, the HL7 disassembler will parse the message, and will validate the message according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="c8b69-125">(成功またはエラー)、この時点では、受信確認メッセージがあります、HL7 が生成されたメッセージと関連する受信確認の構成の有効性に従ってします。</span><span class="sxs-lookup"><span data-stu-id="c8b69-125">At this point, an HL7 acknowledgment message may be generated (success or error), according to the validity of the message and the relevant acknowledgment configuration.</span></span> <span data-ttu-id="c8b69-126">ここでは、メッセージ インスタンスと省略可能な受信確認をさらに処理し、ルーティング、メッセージ ボックス データベースには、パイプラインが送信されます。</span><span class="sxs-lookup"><span data-stu-id="c8b69-126">From here, the pipeline will submit the message instance and optional acknowledgment to the MessageBox database for further processing and routing.</span></span>  
  
 <span data-ttu-id="c8b69-127">メッセージ ボックス データベースに到着するメッセージ インスタンスと[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]フィルターに基づくサブスクリプションをチェックし、HL7 送信パイプラインを通じて送信ポート (MLLP ポート可能性があります) を 1 つまたは複数のメッセージをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="c8b69-127">Once a message instance arrives in the MessageBox database, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] checks filter-based subscriptions and routes the message to one or more send ports (possibly MLLP ports) through an HL7 send pipeline.</span></span> <span data-ttu-id="c8b69-128">送信パイプラインは、適切なスキーマ定義と検証の構成に従ってメッセージ インスタンスを検証可能性があります。</span><span class="sxs-lookup"><span data-stu-id="c8b69-128">The send pipeline may validate the message instances according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="c8b69-129">検証を加え、送信メッセージの MSH セグメントでは、特定のフィールド値をオーバーライドすることです。</span><span class="sxs-lookup"><span data-stu-id="c8b69-129">In addition to validation, it is possible to override certain field values in the MSH segment of the outgoing message.</span></span> <span data-ttu-id="c8b69-130">この上書き機能は、複数のポートがメッセージにサブスクライブしているし、各受信側のアプリケーションが MSH セグメント値内で一意の期待場合に特に便利です。</span><span class="sxs-lookup"><span data-stu-id="c8b69-130">This override ability is especially useful if multiple ports have subscribed to a message and each receiving application has unique expectations within the MSH segment values.</span></span>  
  
 <span data-ttu-id="c8b69-131">もちろん、その他のすべて[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]ポートの送受信を行う機能は MLLP 送信ポートのパラメーターなど、選択したポートの種類に対して一意である可能性がありますをいくつかの機能に加えて、HL7 メッセージに使用できます。</span><span class="sxs-lookup"><span data-stu-id="c8b69-131">Of course, all of the other [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] send and receive port capabilities will be available to HL7 messages, along with some capabilities that may be unique to the selected port type, such as MLLP send-port parameters.</span></span> <span data-ttu-id="c8b69-132">関連する例[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]機能は、送信メッセージに、変換マップを適用する機能になります。</span><span class="sxs-lookup"><span data-stu-id="c8b69-132">An example of the relevant [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] capabilities would be the ability to apply a transformation map to an outbound message.</span></span>  
  
## <a name="how-routing-works"></a><span data-ttu-id="c8b69-133">ルーティングのしくみ</span><span class="sxs-lookup"><span data-stu-id="c8b69-133">How Routing Works</span></span>

<span data-ttu-id="c8b69-134">[!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)]ルート HL7 メッセージに従って、メッセージ ボックス データベースを管理するサブスクリプションのインスタンス。</span><span class="sxs-lookup"><span data-stu-id="c8b69-134">The [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] routes HL7 message instances according to subscriptions that the MessageBox database manages.</span></span> <span data-ttu-id="c8b69-135">これらのサブスクリプションでは、送信ポートごとに定義されたフィルターを使用します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-135">These subscriptions use filters that you define for each send port.</span></span> <span data-ttu-id="c8b69-136">ベースのルーティングの例のフィルターを含めることが受信ポートの ID および HL7 メッセージの種類 (ADT ^ 例については、A03) アプリケーション (MSH3.1 値) を送信します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-136">Example filters might include routing based on receive port ID and/or HL7 message type (ADT^A03, for example) and/or sending application (MSH3.1 value).</span></span>  
  
 <span data-ttu-id="c8b69-137">設定するだけでなく[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]として HL7 メッセージ インスタンスに影響を与える HL7 に固有のメッセージング構成を実行する必要があります、サブスクリプション[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]それにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="c8b69-137">In addition to setting up [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] subscriptions, you need to perform some HL7-specific messaging configuration that will affect HL7 message instances as [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] routes them.</span></span> <span data-ttu-id="c8b69-138">この追加の構成では、一意の HL7 検証規則、受信確認の自動生成 MSH 値を上書きする機能を適用することができます。</span><span class="sxs-lookup"><span data-stu-id="c8b69-138">This additional configuration enables you to apply unique HL7 validation rules, automatic generation of acknowledgments, and the ability to override MSH values.</span></span> [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)]<span data-ttu-id="c8b69-139">この構成はパーティ レベルで適用します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-139"> applies this configuration at the party level.</span></span> <span data-ttu-id="c8b69-140">BizTalk エクスプ ローラーでパーティを定義し、内で関連する HL7 構成を実行する必要があります[!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)]構成エクスプ ローラー。</span><span class="sxs-lookup"><span data-stu-id="c8b69-140">You need to define parties within BizTalk Explorer and perform the related HL7 configuration within [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] Configuration Explorer.</span></span>  
  
 <span data-ttu-id="c8b69-141">メッセージをサブスクライブする複数の送信ポートに一意の HL7 メッセージの構成 (たとえば、検証または MSH オーバーライド) を適用するには、パーティ間の関連付けを作成し、ポートを送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c8b69-141">To apply unique HL7 messaging configuration (for example, validation or MSH overrides) to multiple send ports that subscribe to a message, you need to create associations between parties and send ports.</span></span> <span data-ttu-id="c8b69-142">BizTalk エクスプ ローラーでパーティのプロパティとしては、パーティの送信ポートの関連付けを構成します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-142">You configure party-to-send port associations as party properties within BizTalk Explorer.</span></span>  
  
 <span data-ttu-id="c8b69-143">複数の送信ポートにメッセージをルーティング HL7 必要または複数の送信ポートに一意の HL7 処理の構成を適用しない、送信ポートとパーティの関連付けの手順を除外できます。</span><span class="sxs-lookup"><span data-stu-id="c8b69-143">If you do not need to route HL7 messages to multiple send ports, or apply unique HL7 processing configuration to multiple send ports, you can eliminate the step of associating parties with send ports.</span></span> <span data-ttu-id="c8b69-144">この場合、 [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] HL7 メッセージ (MSH 3.1) の受信側のアプリケーション フィールドを介して、HL7 メッセージング構成に、パーティを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="c8b69-144">In this case, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] associates the party with its HL7 messaging configuration through the receiving application field in the HL7 message (MSH 3.1).</span></span> <span data-ttu-id="c8b69-145">この状況は、HL7 interrogative (要求/応答) に発生する最も可能性の高いメッセージ交換します。</span><span class="sxs-lookup"><span data-stu-id="c8b69-145">This situation is most likely to occur in an HL7 interrogative (request/response) message exchange.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c8b69-146">参照</span><span class="sxs-lookup"><span data-stu-id="c8b69-146">See Also</span></span>  
 [<span data-ttu-id="c8b69-147">メッセージの検証</span><span class="sxs-lookup"><span data-stu-id="c8b69-147">Message Validation</span></span>](../../adapters-and-accelerators/accelerator-hl7/message-validation.md)