---
title: Oracle データベースの変更が複数の通知の受信場所 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 6d273517-9527-4208-99be-97c8a92f176d
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a9eec853c133f57320b2ecca106cc497205eda28
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22215754"
---
# <a name="receive-oracle-database-change-notifications-on-multiple-receive-locations"></a><span data-ttu-id="aecbc-102">Oracle データベースの変更が複数の通知の受信場所</span><span class="sxs-lookup"><span data-stu-id="aecbc-102">Receive Oracle Database change notifications on multiple receive locations</span></span>
<span data-ttu-id="aecbc-103">同じデータベース内の複数の受信場所が同じテーブル (例: ACCOUNTACTIVITY) のクエリ通知を受信するように構成の異なる BizTalk アプリケーションの一部として作成が存在するシナリオを検討してください。</span><span class="sxs-lookup"><span data-stu-id="aecbc-103">Consider a scenario where you have multiple receive locations created as part of different BizTalk applications configured to receive query notifications for the same table (e.g. ACCOUNTACTIVITY) in the same database.</span></span> <span data-ttu-id="aecbc-104">同じテーブルには、数百のレコードを挿入、すべての受信場所は、通知メッセージを受け取ります。</span><span class="sxs-lookup"><span data-stu-id="aecbc-104">If a hundred records are inserted into the same table, all the receive locations will get the notification message.</span></span> <span data-ttu-id="aecbc-105">効果的に間で通知を受信する複数の受信場所、このような形でその受信場所のいずれかで、通知が受信した場合、BizTalk アプリケーションから、操作を呼び出すことができます、その他の受信場所、同じ通知を取得できません。</span><span class="sxs-lookup"><span data-stu-id="aecbc-105">To effectively receive notifications across multiple receive locations, you can call operations from your BizTalk application in such a way that if a notification is received by one receive location, the other receive location does not get the same notification.</span></span> <span data-ttu-id="aecbc-106">そのため、できます。 実質的に複数の場所で受信した負荷分散通知します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-106">So, you can effectively load-balance notifications received on multiple locations.</span></span>  
  
 <span data-ttu-id="aecbc-107">受信通知の負荷を分散するためのオーケストレーションを設定するために必要なタスクは、のものと同じ[受信 Oracle データベースの変更通知増分を使用して BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-incrementally-using-biztalk-server.md)です。</span><span class="sxs-lookup"><span data-stu-id="aecbc-107">The tasks required to set up an orchestration to load-balance receiving notifications are same as that for [Receiving Oracle Database Change Notifications Incrementally Using BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-incrementally-using-biztalk-server.md).</span></span> <span data-ttu-id="aecbc-108">このトピックの一覧のみ、2 つの方法の違い。</span><span class="sxs-lookup"><span data-stu-id="aecbc-108">This topic lists the only the difference between the two approaches.</span></span>  
  
## <a name="load-balancing-query-notifications-across-multiple-receive-locations"></a><span data-ttu-id="aecbc-109">受信場所を複数のクエリ通知の負荷分散</span><span class="sxs-lookup"><span data-stu-id="aecbc-109">Load-Balancing Query Notifications Across Multiple Receive Locations</span></span>  
 <span data-ttu-id="aecbc-110">などのトピックの「[受信 Oracle データベースの変更通知増分を使用して BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-incrementally-using-biztalk-server.md)、PROCESS_RECORDS プロシージャを実行してインクリメンタル通知を構成します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-110">Like in the topic [Receiving Oracle Database Change Notifications Incrementally Using BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-incrementally-using-biztalk-server.md), you configured incremental notifications by executing a PROCESS_RECORDS procedure.</span></span> <span data-ttu-id="aecbc-111">負荷分散を構成するに通知しているレコードを削除するストアド プロシージャを実行する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="aecbc-111">To configure load-balancing, you could execute a stored procedure that deletes the records that have been notified for.</span></span> <span data-ttu-id="aecbc-112">たとえば、次の定義を持つストアド プロシージャ NOTIFY_LOAD_BALANCE があるとします。</span><span class="sxs-lookup"><span data-stu-id="aecbc-112">For example, consider a stored procedure NOTIFY_LOAD_BALANCE with the following definition:</span></span>  
  
```  
PROCEDURE NOTIFY_LOAD_BALANCE (TABLE_DATA OUT SYS_REFCURSOR) IS  
  var int;  
BEGIN  
  SELECT TID INTO var FROM ACCOUNTACTIVITY WHERE ROWNUM = 1 FOR UPDATE;  
  OPEN TABLE_DATA FOR SELECT * FROM ACCOUNTACTIVITY WHERE TID = var;  
  DELETE FROM ACCOUNTACTIVITY WHERE TID = var;  
END NOTIFY_LOAD_BALANCE;  
```  
  
 <span data-ttu-id="aecbc-113">BizTalk アプリケーションの一部としてこのストアド プロシージャを実行するときに通知が受信した既にレコードは削除されます。</span><span class="sxs-lookup"><span data-stu-id="aecbc-113">When you execute this stored procedure as part of the BizTalk application, the record for which notification is already received gets deleted.</span></span> <span data-ttu-id="aecbc-114">そのため、他の通知の場所を取得次のレコードの。</span><span class="sxs-lookup"><span data-stu-id="aecbc-114">So, the other receive location gets notification for the next record.</span></span>  
  
 <span data-ttu-id="aecbc-115">通知を受信するための負荷分散を構成する必要がありますの大まかな手順のとおりです。</span><span class="sxs-lookup"><span data-stu-id="aecbc-115">Here are the high-level steps you must perform to configure load-balancing for receiving notifications.</span></span>  
  
1.  <span data-ttu-id="aecbc-116">スキーマを作成**通知**(受信操作) と**NOTIFY_LOAD_BALANCE**プロシージャ (送信操作)。</span><span class="sxs-lookup"><span data-stu-id="aecbc-116">Create schema for **Notification** (inbound operation) and **NOTIFY_LOAD_BALANCE** procedure (outbound operation).</span></span>  
  
2.  <span data-ttu-id="aecbc-117">オーケストレーションを追加し、通知を受け取る、プロシージャを実行および手順については、応答を取得する 3 つのメッセージを追加します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-117">Add an orchestration and add three messages for receiving notification, executing the procedure, and getting response for the procedure.</span></span>  
  
3.  <span data-ttu-id="aecbc-118">オーケストレーションを作成するには、送信図形と受信図形、メッセージの構築図形、およびポートを追加します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-118">Create an orchestration by adding Send and Receive shapes, Construct Message shape, and ports.</span></span> <span data-ttu-id="aecbc-119">メッセージを構築するため、同じのサンプル コードを使用するには NOTIFY_LOAD_BALANCE ストアド プロシージャを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-119">You can use the same sample code for constructing a message to invoke the NOTIFY_LOAD_BALANCE stored procedure.</span></span> <span data-ttu-id="aecbc-120">操作を実行中に注意してください[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理コンソールで、NOTIFY_LOAD_BALANCE 手順については、要求メッセージ C:\TestLocation\MessageIn の場所にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aecbc-120">Note that while performing the operation in [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console, you must have the request message for the NOTIFY_LOAD_BALANCE procedure in the location C:\TestLocation\MessageIn.</span></span> <span data-ttu-id="aecbc-121">これを行うで作成されたオーケストレーションの一部として、コード スニペットを呼び出すので[受信 Oracle データベースの変更通知増分を使用して BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-incrementally-using-biztalk-server.md) XML C:\ 内に存在した要求に基づいて要求メッセージを作成TestLocation\MessageIn です。</span><span class="sxs-lookup"><span data-stu-id="aecbc-121">You do so because the code snippet you invoke as part of the orchestration created in [Receiving Oracle Database Change Notifications Incrementally Using BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-incrementally-using-biztalk-server.md) creates a request message based on the request XML present in C:\TestLocation\MessageIn.</span></span>  
  
4.  <span data-ttu-id="aecbc-122">構築し、アプリケーションを展開します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-122">Build and deploy the application.</span></span> <span data-ttu-id="aecbc-123">負荷分散を示すためには、展開する必要ありますこのオーケストレーションには、少なくともを持つ 2 つの異なるコンピューターに[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]と[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]インストールします。</span><span class="sxs-lookup"><span data-stu-id="aecbc-123">To demonstrate load-balancing, you must deploy this orchestration at least on two different computers that have [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] and [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] installed.</span></span>  
  
5.  <span data-ttu-id="aecbc-124">[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]両方のコンピューターで、管理コンソールでは、Wcf-custom または Wcf-oracledb のバインディング プロパティの次の受信場所を指定します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-124">In the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console on both the computers, specify the following binding properties for the WCF-Custom or WCF-OracleDB receive location:</span></span>  
  
    |<span data-ttu-id="aecbc-125">プロパティのバインド</span><span class="sxs-lookup"><span data-stu-id="aecbc-125">Binding Property</span></span>|<span data-ttu-id="aecbc-126">値</span><span class="sxs-lookup"><span data-stu-id="aecbc-126">Value</span></span>|  
    |----------------------|-----------|  
    |<span data-ttu-id="aecbc-127">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="aecbc-127">**InboundOperationType**</span></span>|<span data-ttu-id="aecbc-128">これを設定して**通知**です。</span><span class="sxs-lookup"><span data-stu-id="aecbc-128">Set this to **Notification**.</span></span>|  
    |<span data-ttu-id="aecbc-129">**NotificationPort**</span><span class="sxs-lookup"><span data-stu-id="aecbc-129">**NotificationPort**</span></span>|<span data-ttu-id="aecbc-130">ODP.NET が Oracle データベースからデータベースの変更通知をリッスンするように開く必要があるポート番号を指定します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-130">Specifies the port number that ODP.NET must open to listen for database change notification from Oracle database.</span></span> <span data-ttu-id="aecbc-131">これは、Windows ファイアウォールの例外一覧に追加する必要があります同じポート番号を設定します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-131">Set this to the same port number that you must have added to the Windows Firewall exceptions list.</span></span> <span data-ttu-id="aecbc-132">Windows ファイアウォールの例外リストにポートを追加する方法については、次を参照してください。 [http://go.microsoft.com/fwlink/?LinkID=196959](http://go.microsoft.com/fwlink/?LinkID=196959)です。</span><span class="sxs-lookup"><span data-stu-id="aecbc-132">For instructions on how to add ports to Windows Firewall exceptions list, see [http://go.microsoft.com/fwlink/?LinkID=196959](http://go.microsoft.com/fwlink/?LinkID=196959).</span></span> <span data-ttu-id="aecbc-133">**重要:** これを既定値は-1 を設定する場合は、通知メッセージを受け取るための Windows ファイアウォールを完全に無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aecbc-133">**Important:**  If you set this to the default value of -1, you will have to completely disable Windows Firewall to receive notification messages.</span></span>|  
    |<span data-ttu-id="aecbc-134">**NotificationStatement**</span><span class="sxs-lookup"><span data-stu-id="aecbc-134">**NotificationStatement**</span></span>|<span data-ttu-id="aecbc-135">これを設定します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-135">Set this to:</span></span><br /><br /> <span data-ttu-id="aecbc-136">`SELECT TID,ACCOUNT,PROCESSED FROM SCOTT.ACCOUNTACTIVITY WHERE PROCESSED = ‘n’`**注:** スキーマ名とテーブル名を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aecbc-136">`SELECT TID,ACCOUNT,PROCESSED FROM SCOTT.ACCOUNTACTIVITY WHERE PROCESSED = ‘n’` **Note:**  You must specify the table name along with the schema name.</span></span> <span data-ttu-id="aecbc-137">たとえば、 `SCOTT.ACCOUNTACTIVITY`のようにします。</span><span class="sxs-lookup"><span data-stu-id="aecbc-137">For example, `SCOTT.ACCOUNTACTIVITY`.</span></span>|  
    |<span data-ttu-id="aecbc-138">**NotifyOnListenerStart**</span><span class="sxs-lookup"><span data-stu-id="aecbc-138">**NotifyOnListenerStart**</span></span>|<span data-ttu-id="aecbc-139">これを設定して**True**です。</span><span class="sxs-lookup"><span data-stu-id="aecbc-139">Set this to **True**.</span></span>|  
  
6.  <span data-ttu-id="aecbc-140">BizTalk アプリケーションを起動します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-140">Start the BizTalk application.</span></span>  
  
7.  <span data-ttu-id="aecbc-141">通知の受信を開始するには、ACCOUNTACTIVITY テーブルに数百のレコードを挿入します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-141">To start receiving notifications, insert a hundred records into the ACCOUNTACTIVITY table.</span></span> <span data-ttu-id="aecbc-142">中に、NOTIFY_LOAD_BALANCE プロシージャを呼び出すことの要求 XML が C:\TestLocation\MessageIn で使用できるになっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-142">While doing so, make sure the request XML for invoking the NOTIFY_LOAD_BALANCE procedure is available in C:\TestLocation\MessageIn.</span></span>  
  
8.  <span data-ttu-id="aecbc-143">ここで、BizTalk アプリケーションによって通知メッセージが削除されて (両方のコンピューター) 上の場所を監視します。</span><span class="sxs-lookup"><span data-stu-id="aecbc-143">Monitor the location (on both the computers) where the BizTalk application will be dropping the notification messages.</span></span> <span data-ttu-id="aecbc-144">挿入、数百レコードの 1 つの場所を取得するレコードの一部の通知、他の場所は、残りのレコードの通知を取得中に表示されます。</span><span class="sxs-lookup"><span data-stu-id="aecbc-144">You will notice that of the hundred records inserted, one location gets notifications for some records while the other location gets notification for the remaining records.</span></span> <span data-ttu-id="aecbc-145">同時に、両方の場所では、数百のすべてのレコードの通知を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="aecbc-145">Together, both the locations will get notification for all the hundred records.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aecbc-146">参照</span><span class="sxs-lookup"><span data-stu-id="aecbc-146">See Also</span></span>  
 [<span data-ttu-id="aecbc-147">BizTalk Server を使用して増分値 Oracle データベースの変更通知を受け取る</span><span class="sxs-lookup"><span data-stu-id="aecbc-147">Receiving Oracle Database Change Notifications Incrementally Using BizTalk Server</span></span>](../../adapters-and-accelerators/adapter-oracle-database/receive-oracle-database-change-notifications-incrementally-using-biztalk-server.md)