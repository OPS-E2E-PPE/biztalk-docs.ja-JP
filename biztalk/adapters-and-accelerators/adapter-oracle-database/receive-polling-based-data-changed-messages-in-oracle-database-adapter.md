---
title: Oracle データベース アダプターのポーリングに基づいたデータ変更メッセージを受信 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- polling-base notification, support for
ms.assetid: 043afb88-701c-41d8-8b8e-84702bd0d984
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4d4516a87392a2291ef1f58dde06188106f49a8f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65376173"
---
# <a name="receive-polling-based-data-changed-messages-in-oracle-database-adapter"></a><span data-ttu-id="33e1f-102">Oracle データベース アダプターのポーリングに基づいたデータ変更メッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-102">Receive polling-based data-changed messages in Oracle Database adapter</span></span>
<span data-ttu-id="33e1f-103">[!INCLUDE[adapteroracle](../../includes/adapteroracle-md.md)] Oracle データベースをポーリングすることによってポーリングに基づいたデータ変更メッセージの受信をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="33e1f-103">The [!INCLUDE[adapteroracle](../../includes/adapteroracle-md.md)] supports receiving polling-based data-changed messages by polling the Oracle database.</span></span> <span data-ttu-id="33e1f-104">アダプターは、によって、アプリケーションにメッセージを提供します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-104">The adapter delivers the messages to your application by:</span></span>  

- <span data-ttu-id="33e1f-105">データがポーリングに使用できるかどうかを判断する SQL SELECT クエリを実行します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-105">Executing a SQL SELECT query to determine whether data is available for polling.</span></span> <span data-ttu-id="33e1f-106">定期的にまたは継続的には、SQL SELECT クエリを実行するアダプターを構成することができます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-106">You can configure the adapter to execute the SQL SELECT query periodically or continuously.</span></span>  

- <span data-ttu-id="33e1f-107">Oracle のテーブルまたはビューに対して SQL SELECT クエリの実行や、実行は、プロシージャ、関数、またはパッケージ化されたプロシージャおよび関数を格納します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-107">Executing a SQL SELECT query against an Oracle table or view or executing stored procedures, functions, or packaged procedures and functions.</span></span>  

- <span data-ttu-id="33e1f-108">Oracle データベースで、省略可能な後ポーリング PL/SQL コード ブロックを実行しています。</span><span class="sxs-lookup"><span data-stu-id="33e1f-108">Executing an optional post-poll PL/SQL code block on the Oracle database.</span></span> <span data-ttu-id="33e1f-109">ターゲット内のクエリ対象のレコードにフィールドを更新する、または別のテーブルまたはビューにクエリのレコードを移動する、次のコード ブロックがよく使用されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-109">This code block is often used to update a field on the queried records in the target or to move the queried records to another table or view.</span></span>  

- <span data-ttu-id="33e1f-110">結果のクエリ結果を返す、POLLINGSTMT 操作またはストアド プロシージャ、関数、またはパッケージ化されたプロシージャおよびポーリング操作として公開されている関数を呼び出すことによって設定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-110">Returning the query results in a result set by invoking the POLLINGSTMT operation or the stored procedures, functions, or packaged procedures and functions that are exposed as polling operations.</span></span>  

  <span data-ttu-id="33e1f-111">アダプターは、すべての Oracle トランザクション内でこれらの操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-111">The adapter executes all of these operations inside of an Oracle transaction.</span></span>  

  <span data-ttu-id="33e1f-112">アダプターでは、同じアプリケーションで公開することにより Oracle 成果物の複数のデータ変更メッセージを受信することもできます、`PollingId`接続 URI のパラメーター。</span><span class="sxs-lookup"><span data-stu-id="33e1f-112">The adapter also enables you to receive data-changes messages for multiple Oracle artifacts in the same application by exposing a `PollingId` parameter in the connection URI.</span></span> <span data-ttu-id="33e1f-113">このパラメーターは、POLLINGSTMT 操作のターゲットの名前空間を変更します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-113">This parameter modifies the target namespace of the POLLINGSTMT operation.</span></span>  

## <a name="change-the-target-namespace-of-pollingstmt"></a><span data-ttu-id="33e1f-114">POLLINGSTMT のターゲットの名前空間を変更します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-114">Change the target namespace of POLLINGSTMT</span></span>  
 <span data-ttu-id="33e1f-115">POLLINGSTMT 操作のターゲットの名前空間を変更するには、設定、`PollingId`接続 URI の文字列パラメーターをクエリします。</span><span class="sxs-lookup"><span data-stu-id="33e1f-115">You can modify the target namespace of the POLLINGSTMT operation by setting the `PollingId` query string parameter in the connection URI.</span></span> <span data-ttu-id="33e1f-116">場合、`PollingId`接続 URI で指定されて、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]で指定された文字列を追加、 `PollingId` POLLINGSTMT 操作の既定のターゲット名前空間へのパラメーター: `http://microsoft.lobservices.oracledb/2007/03/POLLINGSTMT`。</span><span class="sxs-lookup"><span data-stu-id="33e1f-116">If a `PollingId` is specified in the connection URI, the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] appends the string specified in the `PollingId` parameter to the default target namespace for the POLLINGSTMT operation: `http://microsoft.lobservices.oracledb/2007/03/POLLINGSTMT`.</span></span> <span data-ttu-id="33e1f-117">POLLINGSTMT 操作のメッセージのアクションは変更されません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-117">The message action of the POLLINGSTMT operation is not modified.</span></span>  

 <span data-ttu-id="33e1f-118">たとえば、次の接続 URI が指定されている場合: `OracleDb://User=SCOTT;Password=TIGER@Adapter?PollingId=AcctActivity`、ターゲット名前空間になります`http:/microsoft.lobservices.oracledb/2007/03/POLLINGSTMTAcctActivity`します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-118">For example, if the following connection URI is specified: `OracleDb://User=SCOTT;Password=TIGER@Adapter?PollingId=AcctActivity`, the target namespace will be `http:/microsoft.lobservices.oracledb/2007/03/POLLINGSTMTAcctActivity`.</span></span>  

 <span data-ttu-id="33e1f-119">各 POLLINGSTMT 操作、一意の名前空間を提供し、アプリケーションで複数の Oracle のテーブルおよびビューのデータ変更メッセージを受信できます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-119">By providing a unique namespace for each POLLINGSTMT operation, you can receive data-changed messages for multiple Oracle tables and views in your application.</span></span>  

 <span data-ttu-id="33e1f-120">詳細については、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]接続 URI を参照してください[Oracle Database 接続 URI の作成](../../adapters-and-accelerators/adapter-oracle-database/create-the-oracle-database-connection-uri.md)です。</span><span class="sxs-lookup"><span data-stu-id="33e1f-120">For more information about the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] connection URI, see [Create the Oracle Database connection URI](../../adapters-and-accelerators/adapter-oracle-database/create-the-oracle-database-connection-uri.md).</span></span>  

## <a name="receive-data-changed-messages-using-binding-properties"></a><span data-ttu-id="33e1f-121">バインドのプロパティを使用して、データ変更メッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-121">Receive data-changed messages using binding properties</span></span>
 <span data-ttu-id="33e1f-122">構成する、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]バインドのプロパティの一部またはすべてを設定して、データ変更メッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-122">You configure the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] to receive data-changed messages by setting some or all of the following binding properties.</span></span>  


|         <span data-ttu-id="33e1f-123">プロパティのバインド</span><span class="sxs-lookup"><span data-stu-id="33e1f-123">Binding Property</span></span>         |                                                                                                                                                                                                                                                                                                                                                                   <span data-ttu-id="33e1f-124">値</span><span class="sxs-lookup"><span data-stu-id="33e1f-124">Value</span></span>                                                                                                                                                                                                                                                                                                                                                                    |      <span data-ttu-id="33e1f-125">既定</span><span class="sxs-lookup"><span data-stu-id="33e1f-125">Default</span></span>       |                                                                                  <span data-ttu-id="33e1f-126">必須/省略可</span><span class="sxs-lookup"><span data-stu-id="33e1f-126">Required/Optional</span></span>                                                                                  |
|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     <span data-ttu-id="33e1f-127">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="33e1f-127">**InboundOperationType**</span></span>     |                                                                                                                                                                                                                                                                                                                                              <span data-ttu-id="33e1f-128">値が設定されていることを確認**ポーリング**します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-128">Make sure that the value is set to **Polling**.</span></span>                                                                                                                                                                                                                                                                                                                                               |      <span data-ttu-id="33e1f-129">ポーリング</span><span class="sxs-lookup"><span data-stu-id="33e1f-129">Polling</span></span>       |                                                           <span data-ttu-id="33e1f-130">必須。</span><span class="sxs-lookup"><span data-stu-id="33e1f-130">Required.</span></span> <span data-ttu-id="33e1f-131">指定しない場合、明示的に設定、既定値に適用されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-131">If not explicitly set, the default value will apply.</span></span>                                                            |
| <span data-ttu-id="33e1f-132">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="33e1f-132">**PolledDataAvailableStatement**</span></span> | <span data-ttu-id="33e1f-133">すべてのデータが特定のテーブルのポーリングに使用できるかどうかを判断するために実行する SELECT ステートメントを指定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-133">Specify the SELECT statement executed to determine whether any data is available for polling for a specific table.</span></span> <span data-ttu-id="33e1f-134">指定したステートメントには、結果の行と列で構成されるセットを返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-134">The specified statement must return a result set consisting of rows and columns.</span></span> <span data-ttu-id="33e1f-135">結果セットの最初のセルの値は、アダプターが指定された値を実行するかどうかを示します、 **PollingStatement**プロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="33e1f-135">The value in the first cell of the result set indicates whether the adapter executes the value specified for the **PollingStatement** binding property.</span></span> <span data-ttu-id="33e1f-136">結果の最初のセルに正の値が含まれている場合、アダプターは、ポーリング ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-136">If the first cell of the result contains a positive value, the adapter executes the polling statement.</span></span> <span data-ttu-id="33e1f-137">たとえば、このバインドのプロパティの有効なステートメントになります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-137">For example, a valid statement for this binding property will be:</span></span><br /><br /> `Select * from <table_name>`<br /><br /> <span data-ttu-id="33e1f-138">**注:** このバインドのプロパティのストアド プロシージャを指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-138">**Note:** You must not specify stored procedures for this binding property.</span></span> <span data-ttu-id="33e1f-139">また、このステートメントは、基になる Oracle データベースを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-139">Also, this statement must not modify the underlying Oracle database.</span></span> | <span data-ttu-id="33e1f-140">デュアルから 1 を選択します</span><span class="sxs-lookup"><span data-stu-id="33e1f-140">SELECT 1 FROM DUAL</span></span> | <span data-ttu-id="33e1f-141">必須。</span><span class="sxs-lookup"><span data-stu-id="33e1f-141">Required.</span></span> <span data-ttu-id="33e1f-142">表示ない場合は、明示的に設定、既定値が適用される、アダプターがポーリングされるテーブルがかどうかにデータをどのようにがかどうかに関係なくポーリングを続行する必要がありますが含まれています。</span><span class="sxs-lookup"><span data-stu-id="33e1f-142">If not explicitly set, the default value will apply, which implies that the adapter must continue polling irrespective of whether the table being polled has data or not.</span></span> |
|        <span data-ttu-id="33e1f-143">**PollingAction**</span><span class="sxs-lookup"><span data-stu-id="33e1f-143">**PollingAction**</span></span>         |                                                                                                                                                                                                                                        <span data-ttu-id="33e1f-144">ポーリング操作のアクションを指定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-144">Specifies the action for the polling operation.</span></span> <span data-ttu-id="33e1f-145">特定の操作を使用して、操作を生成するメタデータからのポーリング アクションを決定することができます、[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-145">You can determine the polling action for a specific operation from the metadata you generate for the operation using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>                                                                                                                                                                                                                                         |        <span data-ttu-id="33e1f-146">null</span><span class="sxs-lookup"><span data-stu-id="33e1f-146">null</span></span>        |                                                   <span data-ttu-id="33e1f-147">テーブルとビューの SELECT ステートメントを使用してポーリング操作の省略可能。</span><span class="sxs-lookup"><span data-stu-id="33e1f-147">Optional for polling operations on tables and views using the SELECT statement.</span></span>                                                   |
|       <span data-ttu-id="33e1f-148">**PollingInterval**</span><span class="sxs-lookup"><span data-stu-id="33e1f-148">**PollingInterval**</span></span>        |                                                                                                                                         <span data-ttu-id="33e1f-149">アダプターは、Oracle データベースを照会する秒単位で間隔を設定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-149">Set to the interval, in seconds, at which you want the adapter to query the Oracle database.</span></span> <span data-ttu-id="33e1f-150">このプロパティは、ポーリング間隔とポーリング トランザクションのタイムアウトを指定します。値は、クエリおよび (指定されている場合)、Oracle データベースでのポーリング後ステートメントの実行にかかる時間の量とクライアントがクエリ データを処理し、ポーリング応答メッセージを返すのためにかかる時間より大きくする必要があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-150">This property specifies the polling interval and the polling transaction time out. The value should be greater than the amount of time it takes to execute the query and post-poll statement (if one is specified) on the Oracle database plus the amount of time it takes for the client to process the query data and return the polling response message.</span></span>                                                                                                                                          |        <span data-ttu-id="33e1f-151">500</span><span class="sxs-lookup"><span data-stu-id="33e1f-151">500</span></span>         |                                                           <span data-ttu-id="33e1f-152">必須。</span><span class="sxs-lookup"><span data-stu-id="33e1f-152">Required.</span></span> <span data-ttu-id="33e1f-153">指定しない場合、明示的に設定、既定値に適用されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-153">If not explicitly set, the default value will apply.</span></span>                                                            |
|       <span data-ttu-id="33e1f-154">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="33e1f-154">**PollingStatement**</span></span>       |                                                                                                                                       <span data-ttu-id="33e1f-155">次のいずれかを指定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-155">Specify either of the following:</span></span><br /><br /> <span data-ttu-id="33e1f-156">Oracle データベースに対して実行される SQL SELECT ステートメント。</span><span class="sxs-lookup"><span data-stu-id="33e1f-156">- SQL SELECT statement that should be executed against the Oracle database.</span></span> <span data-ttu-id="33e1f-157">このステートメントは、FOR UPDATE 句を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-157">This statement should include a FOR UPDATE clause.</span></span> <span data-ttu-id="33e1f-158">FOR UPDATE 句については、次を参照してください。[ポーリング ステートメントで FOR UPDATE 句を指定する](#ForUpdate)このトピックで後述します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-158">For information about the FOR UPDATE clause, see [Specifying a FOR UPDATE Clause in the Polling Statement](#ForUpdate) later in this topic.</span></span><br /><br /> <span data-ttu-id="33e1f-159">-ストアド プロシージャ、関数、またはプロシージャまたは関数をポーリングするパッケージ内のメッセージを要求します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-159">- Request message for a stored procedure, function, or procedure or function within a package that you want to be polled.</span></span>                                                                                                                                        |        <span data-ttu-id="33e1f-160">null</span><span class="sxs-lookup"><span data-stu-id="33e1f-160">null</span></span>        |                                                     <span data-ttu-id="33e1f-161">必須。</span><span class="sxs-lookup"><span data-stu-id="33e1f-161">Required.</span></span> <span data-ttu-id="33e1f-162">設定**PollingStatement** null 以外の値のポーリングで有効にします。</span><span class="sxs-lookup"><span data-stu-id="33e1f-162">Setting **PollingStatement** to a non-null value enables polling.</span></span>                                                     |
|      <span data-ttu-id="33e1f-163">**PollWhileDataFound**</span><span class="sxs-lookup"><span data-stu-id="33e1f-163">**PollWhileDataFound**</span></span>      |                                                                                                                                                                                             <span data-ttu-id="33e1f-164">指定するかどうか、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]ポーリング間隔を無視し、継続的にデータがポーリングされるテーブルで使用できる場合は、Oracle データベースをポーリングします。</span><span class="sxs-lookup"><span data-stu-id="33e1f-164">Specifies whether the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] ignores the polling interval and continuously polls the Oracle database, if data is available in the table being polled.</span></span> <span data-ttu-id="33e1f-165">指定されたポーリング間隔で SQL ステートメントを実行する、テーブルで使用できるデータがない場合は、アダプターを元に戻します</span><span class="sxs-lookup"><span data-stu-id="33e1f-165">If no data is available in the table, the adapter reverts to execute the SQL statement at the specified polling interval</span></span>                                                                                                                                                                                              |       <span data-ttu-id="33e1f-166">False</span><span class="sxs-lookup"><span data-stu-id="33e1f-166">False</span></span>        |                                                           <span data-ttu-id="33e1f-167">必須。</span><span class="sxs-lookup"><span data-stu-id="33e1f-167">Required.</span></span> <span data-ttu-id="33e1f-168">指定しない場合、明示的に設定、既定値に適用されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-168">If not explicitly set, the default value will apply.</span></span>                                                            |
|      <span data-ttu-id="33e1f-169">**PostPollStatement**</span><span class="sxs-lookup"><span data-stu-id="33e1f-169">**PostPollStatement**</span></span>       |                                                                                                                                                                                                                                                                                          <span data-ttu-id="33e1f-170">クエリを実行すると、クエリの前に、データがクライアントに返される後、アダプターによって実行される PL/SQL コード ブロックに設定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-170">Set to an optional PL/SQL code block that is executed by the adapter after the query is performed, but before the query data is returned to the client.</span></span>                                                                                                                                                                                                                                                                                           |        <span data-ttu-id="33e1f-171">null</span><span class="sxs-lookup"><span data-stu-id="33e1f-171">null</span></span>        |                                                     <span data-ttu-id="33e1f-172">任意。</span><span class="sxs-lookup"><span data-stu-id="33e1f-172">Optional.</span></span> <span data-ttu-id="33e1f-173">値が指定されていない場合は、ポーリング後ステートメントは実行されません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-173">If no value is specified, a post poll statement is not executed.</span></span>                                                      |

> [!NOTE]
>  <span data-ttu-id="33e1f-174">設定する必要がある、WCF サービス モデルまたは WCF チャネル モデルを使用している場合、 **AcceptCredentialsInUri**プロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="33e1f-174">If you are using the WCF service model or the WCF channel model, you must also set the **AcceptCredentialsInUri** binding property.</span></span>  

##  <a name="ForUpdate"></a> <span data-ttu-id="33e1f-175">ポーリング ステートメントでの更新プログラムを入力します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-175">Enter a FOR UPDATE in the polling statement</span></span>  
 <span data-ttu-id="33e1f-176">ポーリング ステートメントと SELECT ステートメントで指定された行に影響するポーリング後ステートメントを実行する SELECT ステートメントを使用する場合は、ポーリング ステートメントで FOR UPDATE 句を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-176">If you are using a SELECT statement as the polling statement and executing a post-poll statement that affects the rows specified in the SELECT statement, you must use the FOR UPDATE clause in the polling statement.</span></span> <span data-ttu-id="33e1f-177">FOR UPDATE 句を指定することにより、トランザクション中に、ポーリング ステートメントによって選択されたレコードがロックされていることと、ポーリング後ステートメントがそれらの任意の必要な更新プログラムを実行できます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-177">Specifying a FOR UPDATE clause ensures that the records selected by the polling statement are locked during the transaction and that the post-poll statement can perform any required updates on them.</span></span>  

> [!CAUTION]
>  <span data-ttu-id="33e1f-178">複数のレコードは、ポーリングとポーリング後ステートメント間の時間枠のどこのシナリオを設定することが、ポーリング後ステートメントの条件を満たすテーブルに追加されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-178">You can have scenarios where in the time window between the polling and post-poll statements, more records are added to the table that meet the condition of the post-poll statement.</span></span> <span data-ttu-id="33e1f-179">このような状況では、条件を満たすすべてのレコードとポーリング ステートメントの一部として選択されたレコードだけでなく、ポーリング後ステートメントを更新します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-179">In such situations, the post-poll statement would update all the records that satisfy the condition and not just the records selected as part of the polling statement.</span></span>  

 <span data-ttu-id="33e1f-180">ポーリング後ステートメントが指定されたポーリング ステートメントに FOR UPDATE 句が含まれていない場合、次の 2 つの条件のいずれかが発生します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-180">If a post-poll statement is specified and the polling statement does not contain a FOR UPDATE clause, you will experience one of the following two conditions:</span></span>  

- <span data-ttu-id="33e1f-181">場合**TransactionIsolationLevel**に設定されている**ReadCommitted**、後のポーリング クエリでは、選択した行は更新されません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-181">If **TransactionIsolationLevel** is set to **ReadCommitted**, the post-poll query will not update the selected rows.</span></span>  

- <span data-ttu-id="33e1f-182">場合**TransactionIsolationLevel**に設定されている**Serializable**、次の対象のシステム例外 (**Microsoft.ServiceModel.Channels.Common.TargetSystemException**) は、ポーリング後ステートメントが実行されるときに発生します。「Ora-08177 がこのトランザクションへのアクセスをシリアル」ことはできません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-182">If **TransactionIsolationLevel** is set to **Serializable**, the following target system exception (**Microsoft.ServiceModel.Channels.Common.TargetSystemException**) will occur when the post-poll statement is executed: "ORA-08177 can't serialize access for this transaction".</span></span> <span data-ttu-id="33e1f-183">このような場合は、設定する必要があります、 **PollingRetryCount**数を定義するプロパティのバインド アダプターは、同じトランザクションを再試行する回数。</span><span class="sxs-lookup"><span data-stu-id="33e1f-183">In such a case, you must set the **PollingRetryCount** binding property to define the number of times you want the adapter to retry the same transaction.</span></span>  

  <span data-ttu-id="33e1f-184">トランザクション分離レベルを設定する方法の詳細については、次を参照してください。 [Oracle データベースとトランザクション分離レベルとトランザクションのタイムアウトを構成する](../../adapters-and-accelerators/adapter-oracle-database/configure-transaction-isolation-level-and-transaction-timeout-with-oracle-db.md)します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-184">For instructions on how to set the transaction isolation level, see [Configure transaction isolation level and transaction timeout with Oracle Database](../../adapters-and-accelerators/adapter-oracle-database/configure-transaction-isolation-level-and-transaction-timeout-with-oracle-db.md).</span></span>  

  <span data-ttu-id="33e1f-185">トランザクションとの値を使用するアダプターのクライアントが構成されている場合、ポーリングとポーリング後ステートメントがトランザクションで実行される、 **UseAmbientTransaction**に設定されているプロパティのバインド**True**アダプター。</span><span class="sxs-lookup"><span data-stu-id="33e1f-185">The polling and post-poll statements are executed in a transaction if the adapter clients have configured to use transactions and the value of the **UseAmbientTransaction** binding property is set to **True** in the adapter.</span></span>  

  <span data-ttu-id="33e1f-186">FOR UPDATE オプションを使用して、ポーリング クエリの例を示します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-186">An example of a polling query with the FOR UPDATE option is:</span></span>  

```  
SELECT * from EMP WHERE FLAG = 'Y' FOR UPDATE  
```  

### <a name="enter-a-nowait-clause-in-the-polling-statement"></a><span data-ttu-id="33e1f-187">ポーリング ステートメントで NOWAIT 句を入力します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-187">Enter a NOWAIT clause in the polling statement</span></span>  
 <span data-ttu-id="33e1f-188">同時実行スレッドがポーリングされるテーブルへのアクセスのシナリオを必要に応じて、テーブルが多すぎるの競合をリードします。</span><span class="sxs-lookup"><span data-stu-id="33e1f-188">You may have scenarios where concurrent threads are accessing the table being polled, leading to too many contentions in the table.</span></span> <span data-ttu-id="33e1f-189">テーブルの行ロックを取得するブロックされるポーリング クエリがある可能性があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-189">This may cause the polling query to be blocked to get a lock on table rows.</span></span> <span data-ttu-id="33e1f-190">ポーリング ステートメントと SELECT ステートメントを使用する場合、SELECT ステートメントで FOR UPDATE キーワードと共に NOWAIT キーワードを指定することがあります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-190">If you are using a SELECT statement as the polling statement, you may want to specify a NOWAIT keyword along with the FOR UPDATE keyword in the SELECT statement.</span></span> <span data-ttu-id="33e1f-191">これにより、ポーリング クエリの実行を選択しようとして、ポーリング クエリの行にロックがあるかどうかにすぐに返すアダプター内で。</span><span class="sxs-lookup"><span data-stu-id="33e1f-191">This will cause the polling query execution within the adapter to return immediately if there are locks on rows which the polling query is trying to select.</span></span> <span data-ttu-id="33e1f-192">例外は通常このような条件下で Oracle によってスローされます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-192">An exception is usually thrown by Oracle under such conditions.</span></span> <span data-ttu-id="33e1f-193">アダプター クライアントを再び使用することがあります、 **PollingInterval**データをポーリングする時間間隔後アダプター クライアントが再試行する必要がありますを指定するプロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="33e1f-193">Again, adapter clients may use the **PollingInterval** binding property to specify the time interval after which the adapter clients must retry for polling the data.</span></span>  

 <span data-ttu-id="33e1f-194">NOWAIT オプションを使用して、ポーリング クエリの例を示します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-194">An example of a polling query with the NOWAIT option is:</span></span>  

```  
SELECT * from EMP WHERE FLAG = 'Y' FOR UPDATE NOWAIT  
```  

### <a name="enter-a-skip-locked-clause-in-the-polling-statement"></a><span data-ttu-id="33e1f-195">ポーリング ステートメントでロックされたスキップ句を入力します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-195">Enter a SKIP LOCKED clause in the polling statement</span></span>  
 <span data-ttu-id="33e1f-196">同時実行スレッドがポーリングされるテーブルにアクセスするためのポーリング クエリで指定した WHERE 句の結果セットでいくつかの行はロックされているシナリオがあります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-196">You may have scenarios where due to concurrent threads accessing the table being polled, some rows in the result set of the WHERE clause specified in the polling query are locked.</span></span> <span data-ttu-id="33e1f-197">たとえば、ポーリング クエリが; テーブルから 6 つの行を返しますこれら 6 つの行から 4 は既に、他のトランザクションのためロックされています。</span><span class="sxs-lookup"><span data-stu-id="33e1f-197">For example, your polling query returns 6 rows from a table; 4 out of these 6 rows are already locked because of some other transaction.</span></span> <span data-ttu-id="33e1f-198">ここで、WHERE 句で指定された行をロックして、既にロックされていることが判明しているすべての行をスキップしようとするように指示される FOR UPDATE キーワードと共に SKIP がロックされているキーワードを指定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-198">In this case, you might want to specify a SKIP LOCKED keyword along with the FOR UPDATE keyword that instructs the database to attempt to lock the rows specified by the WHERE clause, and to skip any rows that are found to be already locked.</span></span> <span data-ttu-id="33e1f-199">トランザクション中に、WHERE 句でロックされていない行がロックされているし、ポーリング後ステートメントは、これらの行が再度ポーリングしないようにに、それらでの任意の必要な更新プログラムを実行できます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-199">The unlocked rows in the WHERE clause are locked during the transaction and the post-poll statement can perform any required updates on them so that these rows are not polled again.</span></span> <span data-ttu-id="33e1f-200">これにより、WHERE 句ではロックされている指定したすべての行になるまでポーリング メッセージを受信するまで待機する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-200">This ensures that you do not have to wait to receive the polling messages until all the rows specified by the WHERE clause are unlocked.</span></span>  

 <span data-ttu-id="33e1f-201">ロックされたスキップ キーワードは、データベースで同じテーブルをポーリングしている複数のコンピューターでアダプター クライアントがあるシナリオに便利です。</span><span class="sxs-lookup"><span data-stu-id="33e1f-201">The SKIP LOCKED keyword is useful in a scenario where you have adapter clients on multiple computers that are polling the same table in a database.</span></span> <span data-ttu-id="33e1f-202">WHERE 句で指定された時間の時点でロックされている行のデータの変更のポーリング ベースのメッセージが表示されるように、ポーリング操作を構成することによってアダプター クライアントの間で負荷しことを確認する行を更新することができます。クライアントがアダプターによってポーリング ベースのデータ変更メッセージを受信する場合、その他のクライアントは取得しません、同じメッセージ。</span><span class="sxs-lookup"><span data-stu-id="33e1f-202">You can load balance among the adapter clients by configuring the polling operation in such a way that you receive polling-based data-change messages for the rows specified by the WHERE clause that are unlocked at that point of time, and then update the row to ensure that if a polling-based data-change message is received by an adapter client, the other clients do not get the same message.</span></span>  

 <span data-ttu-id="33e1f-203">ロックされたスキップ オプションを使用して、ポーリング クエリの例を示します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-203">An example of a polling query with the SKIP LOCKED option is:</span></span>  

```  
SELECT * from EMP WHERE FLAG = 'Y' FOR UPDATE SKIP LOCKED  
```  

## <a name="support-for-ordered-delivery-fifo"></a><span data-ttu-id="33e1f-204">順次配送 (FIFO) のサポート</span><span class="sxs-lookup"><span data-stu-id="33e1f-204">Support for ordered delivery (FIFO)</span></span>  
 <span data-ttu-id="33e1f-205">運用環境では、Oracle データベースのデータ変更を監視するポーリングを使用できます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-205">In a production environment, polling can be used to monitor the data changes in the Oracle database.</span></span> <span data-ttu-id="33e1f-206">使用してアダプター クライアントがこれらのデータ変更メッセージを受信、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-206">These data-changed messages are received by the adapter client using the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)].</span></span> <span data-ttu-id="33e1f-207">ビジネス シナリオに基づいて、データ変更メッセージが正しい順序でアダプター クライアントによって受信される重要ながなります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-207">Based on business scenarios, it can be critical that the data-changed messages are received by the adapter client in the right order.</span></span>  

 <span data-ttu-id="33e1f-208">[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]配信または最初先出しの順序付けをサポートしている Oracle データベースからメッセージが受信される順序を維持するには、(FIFO)。</span><span class="sxs-lookup"><span data-stu-id="33e1f-208">The [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] supports ordered delivery or first-in-first-out (FIFO) to maintain the order in which messages are received from the Oracle database.</span></span> <span data-ttu-id="33e1f-209">受信のシナリオでの FIFO のサポートに関連するいくつかの考慮事項をここでは、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-209">Here are a few considerations related to support for FIFO in inbound scenarios for the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)].</span></span>  

- <span data-ttu-id="33e1f-210">メッセージがオーケストレーションによって処理される場合、オーケストレーションが設定からの受信メッセージの順次配送をいる必要があります、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]受信ポート。</span><span class="sxs-lookup"><span data-stu-id="33e1f-210">If the message is being consumed by an orchestration, the orchestration must have the ordered delivery set for the messages coming from the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] receive port.</span></span>  

- <span data-ttu-id="33e1f-211">送信ポートにする必要があります設定からの受信メッセージの配信が注文されている場合は、メッセージは、送信ポート (ルーティングでは、コンテンツ ベース) のシナリオで使用されている、[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]受信ポート。</span><span class="sxs-lookup"><span data-stu-id="33e1f-211">If the message is being consumed by a send port (in a content-based routing) scenario, the send port must have ordered delivery set for the messages coming from the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] receive port.</span></span>  

  <span data-ttu-id="33e1f-212">Wcf-custom または Wcf-oracledb アダプター プロパティがある**エラー発生時に要求メッセージを保留**受信処理に失敗した要求メッセージを保留するかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-212">The WCF-Custom or WCF-OracleDB adapter has a property **Suspend request message on failure** that specifies whether to suspend the request message that fails inbound processing.</span></span> <span data-ttu-id="33e1f-213">このプロパティを設定することができます、**メッセージ**Wcf-custom または Wcf-oracledb のタブの下のポートの受信、**エラー処理**セクション。</span><span class="sxs-lookup"><span data-stu-id="33e1f-213">This property can be set on the **Messages** tab of the WCF-Custom or WCF-OracleDB receive port under the **Error handling** section.</span></span> <span data-ttu-id="33e1f-214">次の表では、このプロパティを設定するかどうかと、メッセージのサブスクライバー (オーケストレーションやポート) の状態に基づいて、受信メッセージの処理方法を説明するシナリオを示します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-214">The following table lists the scenarios describing how the incoming messages are processed based on whether this property is set and the state of the message subscriber (orchestration or port).</span></span>  

|<span data-ttu-id="33e1f-215">Port プロパティ</span><span class="sxs-lookup"><span data-stu-id="33e1f-215">Port property</span></span>|<span data-ttu-id="33e1f-216">参加解除状態のサブスクライバー</span><span class="sxs-lookup"><span data-stu-id="33e1f-216">Subscriber in Unenlisted state</span></span>|<span data-ttu-id="33e1f-217">停止状態が参加済みでサブスクライバー</span><span class="sxs-lookup"><span data-stu-id="33e1f-217">Subscriber in Enlisted but Stopped state</span></span>|  
|-------------------|------------------------------------|----------------------------------------------|  
|<span data-ttu-id="33e1f-218">**エラー発生時に要求メッセージを中断**プロパティ</span><span class="sxs-lookup"><span data-stu-id="33e1f-218">**Suspend request message on failure** property NOT set</span></span>|<span data-ttu-id="33e1f-219">、中断 (再開不可メッセージ) としてルーティング エラー報告が生成されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-219">- Routing Failure Report is generated as a suspended (non-resumable message)</span></span><br /><br /> <span data-ttu-id="33e1f-220">-実際のメッセージが中断されていません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-220">- Actual message is not suspended</span></span><br /><br /> <span data-ttu-id="33e1f-221">-投稿のトランザクションが中止された取得と、ポーリング クエリは実行されません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-221">- Post poll query is not executed as transaction gets aborted.</span></span> <span data-ttu-id="33e1f-222">そのためにポーリングが繰り返され、もう一度、行がフェッチされます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-222">Hence polling repeats and fetches the rows again.</span></span><br /><br /> <span data-ttu-id="33e1f-223">-エラーの内容を記述するログが発生したイベントを報告します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-223">- Errors reported in the event log to describe what has happened.</span></span>|<span data-ttu-id="33e1f-224">-「エラー」と見なされます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-224">- Not considered a “Failure”.</span></span> <span data-ttu-id="33e1f-225">イベント ログにエラー メッセージはありません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-225">There are no error messages in the event log.</span></span><br /><br /> <span data-ttu-id="33e1f-226">-実際のメッセージは、中断 (再開可能) キューに配置されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-226">- Actual message is put into the suspended (resumable) queue.</span></span><br /><br /> <span data-ttu-id="33e1f-227">-サブスクライブしているポートまたはオーケストレーションの開始時に、メッセージが自動的に再開します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-227">- When the subscribing port or orchestration starts, the messages are automatically resumed.</span></span> <span data-ttu-id="33e1f-228">順次配送がサブスクライバーに設定されている場合は、これが適用されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-228">If ordered delivery is set on the subscriber, it will be honored.</span></span><br /><br /> <span data-ttu-id="33e1f-229">-メッセージを手動で再開も可能性があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-229">- The messages may also be resumed manually.</span></span>|  
|<span data-ttu-id="33e1f-230">**エラー発生時に要求メッセージを中断**プロパティの設定</span><span class="sxs-lookup"><span data-stu-id="33e1f-230">**Suspend request message on failure** property IS set</span></span>|<span data-ttu-id="33e1f-231">、中断 (再開不可メッセージ) としてルーティング エラー報告が生成されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-231">- Routing Failure Report is generated as a suspended (non-resumable message)</span></span><br /><br /> <span data-ttu-id="33e1f-232">-実際のメッセージが中断されました。</span><span class="sxs-lookup"><span data-stu-id="33e1f-232">- Actual message is also suspended</span></span><br /><br /> <span data-ttu-id="33e1f-233">-投稿のトランザクションが中止された取得と、ポーリング クエリは実行されません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-233">- Post poll query is not executed as transaction gets aborted.</span></span> <span data-ttu-id="33e1f-234">そのためにポーリングが繰り返され、もう一度、行がフェッチされます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-234">Hence polling repeats and fetches the rows again.</span></span><br /><br /> <span data-ttu-id="33e1f-235">-エラーの内容を記述するログが発生したイベントを報告します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-235">- Errors reported in the event log to describe what has happened.</span></span>|<span data-ttu-id="33e1f-236">-「エラー」と見なされます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-236">- Not considered a “Failure”.</span></span> <span data-ttu-id="33e1f-237">イベント ログにエラー メッセージはありません。</span><span class="sxs-lookup"><span data-stu-id="33e1f-237">There are no error messages in the event log.</span></span><br /><br /> <span data-ttu-id="33e1f-238">-実際のメッセージは、中断 (再開可能) キューに配置されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-238">- Actual message is put into the suspended (resumable) queue.</span></span><br /><br /> <span data-ttu-id="33e1f-239">-サブスクライブしているポートまたはオーケストレーションの開始時に、メッセージが自動的に再開します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-239">- When the subscribing port or orchestration starts, the messages are automatically resumed.</span></span> <span data-ttu-id="33e1f-240">順次配送がサブスクライバーに設定されている場合は、これが適用されます。</span><span class="sxs-lookup"><span data-stu-id="33e1f-240">If ordered delivery is set on the subscriber, it will be honored.</span></span><br /><br /> <span data-ttu-id="33e1f-241">-メッセージを手動で再開も可能性があります。</span><span class="sxs-lookup"><span data-stu-id="33e1f-241">- The messages may also be resumed manually.</span></span>|  

## <a name="see-also"></a><span data-ttu-id="33e1f-242">参照</span><span class="sxs-lookup"><span data-stu-id="33e1f-242">See also</span></span>  
[<span data-ttu-id="33e1f-243">Oracle データベース アプリケーションの開発</span><span class="sxs-lookup"><span data-stu-id="33e1f-243">Develop your Oracle Database applications</span></span>](../../adapters-and-accelerators/adapter-oracle-database/develop-your-oracle-database-applications.md)  
 <span data-ttu-id="33e1f-244">[BizTalk Server を使用してポーリング Oracle データベース](../../adapters-and-accelerators/adapter-oracle-database/poll-oracle-database-using-biztalk-server.md) </span><span class="sxs-lookup"><span data-stu-id="33e1f-244">[Poll Oracle Database using BizTalk Server](../../adapters-and-accelerators/adapter-oracle-database/poll-oracle-database-using-biztalk-server.md) </span></span>  
 <span data-ttu-id="33e1f-245">[WCF サービス モデルを使用して Oracle データベースでのポーリングに基づいたデータ変更メッセージを受信します。](../../adapters-and-accelerators/adapter-oracle-database/receive-polling-based-data-changed-messages-in-oracle-db-using-a-wcf-service.md) </span><span class="sxs-lookup"><span data-stu-id="33e1f-245">[Receive Polling-based Data-changed Messages in Oracle Database using the WCF Service Model](../../adapters-and-accelerators/adapter-oracle-database/receive-polling-based-data-changed-messages-in-oracle-db-using-a-wcf-service.md) </span></span>  
 [<span data-ttu-id="33e1f-246">WCF チャネル モデルを使用して Oracle データベースでのポーリングに基づいたデータ変更メッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="33e1f-246">Receive Polling-based Data-changed Messages in Oracle Database using the WCF Channel Model</span></span>](../../adapters-and-accelerators/adapter-oracle-database/receive-polling-based-data-changed-messages-in-oracle-db-using-a-wcf-channel.md)