---
title: "SAP の tRFCs に対する操作 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- RFCs, invoking transactional RFCs in an SAP System
- TID database
- transactional RFCs
- tRFCs, receiving inbound iransactional RFC calls from an SAP system
- tRFCs
- GUID parameter
- RFCs, processing inbound
- RfcConfirmTransID
- transaction ID (TID)
- tRFC Operations
- IDOCS, receiving IDOCs as a tRFC server
- adapters, operations on tRFCs
- RFC, invoking an RFC
ms.assetid: d6a5c515-d6aa-4b70-9c23-32d1dd94d473
caps.latest.revision: "5"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6e60465716931161e9b9949e16c4630d85c2cfe2
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="operations-on-trfcs-in-sap"></a><span data-ttu-id="7fa0a-102">SAP の tRFCs に対する操作</span><span class="sxs-lookup"><span data-stu-id="7fa0a-102">Operations on tRFCs in SAP</span></span>
<span data-ttu-id="7fa0a-103">トランザクションの Rfc (tRFCs) は、Rfc 作業 (LUW) の論理単位の一部として呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-103">Transactional RFCs (tRFCs) are RFCs that are invoked as part of a logical unit of work (LUW).</span></span> <span data-ttu-id="7fa0a-104">SAP システムを LUW にすべてのビジネスやプログラミング タスクを完了するために必要な手順が含まれます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-104">On an SAP system, an LUW contains all of the steps necessary to complete a business or programming task.</span></span> <span data-ttu-id="7fa0a-105">TRFC が RFC; を呼び出す方法を表します一意の SAP アーティファクトではありません。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-105">A tRFC represents a way of invoking an RFC; it is not a unique SAP artifact.</span></span>  
  
 <span data-ttu-id="7fa0a-106">使用することができます、 [!INCLUDE[adaptersap](../../includes/adaptersap-md.md)] tRFC クライアントと tRFC サーバーの両方です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-106">You can use the [!INCLUDE[adaptersap](../../includes/adaptersap-md.md)] both as a tRFC client and as a tRFC server.</span></span>  
  
-   <span data-ttu-id="7fa0a-107">**TRFC クライアントとして**アダプターを SAP システムで、LUW で単一の RFC を呼び出すアプリケーションを有効にします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-107">**As a tRFC client**, the adapter enables your application to invoke a single RFC in an LUW on the SAP system.</span></span> <span data-ttu-id="7fa0a-108">これにより、RFC の 1 回限りののみ実行されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-108">This guarantees one-time only execution of the RFC.</span></span> <span data-ttu-id="7fa0a-109">トランザクションの動作は限りません。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-109">It does not imply transactional behavior.</span></span>  
  
-   <span data-ttu-id="7fa0a-110">**TRFC サーバーとして**アダプターでは、LUW 内の複数の Rfc を受信することができます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-110">**As a tRFC server**, the adapter enables you to receive multiple RFCs inside an LUW.</span></span> <span data-ttu-id="7fa0a-111">アダプターは、トランザクションのコンテキストで受信 tRFC の呼び出しをサポートしていますコミットであるし、ロールのバックの動作がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-111">The adapter supports inbound tRFC calls in a transactional context; that is commit and roll back behavior are supported.</span></span>  
  
## <a name="trfc-operations"></a><span data-ttu-id="7fa0a-112">tRFC 操作</span><span class="sxs-lookup"><span data-stu-id="7fa0a-112">tRFC Operations</span></span>  
 <span data-ttu-id="7fa0a-113">TRFC、RFC; を起動する方法を意味します。個別の SAP アーティファクトではありません。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-113">A tRFC implies a way of invoking an RFC; it is not a separate SAP artifact.</span></span> <span data-ttu-id="7fa0a-114">そのため、(対象のアダプター メタデータを取得できます)、SAP システム上のすべての RFC は、によって tRFC として提示されるも、[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-114">Therefore, every RFC on the SAP system (for which the adapter can retrieve metadata) is also surfaced as a tRFC by the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span> <span data-ttu-id="7fa0a-115">tRFCs は、RFC 名前によって TRFC メタデータ カテゴリ ノードの下での操作として表示されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-115">tRFCs are surfaced by RFC name as operations under the TRFC metadata category node.</span></span> <span data-ttu-id="7fa0a-116">(参照または tRFCs を検索することができます、 **TRFC**ノードを使用するときに、[!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)]または[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-116">(You can browse or search for tRFCs under the **TRFC** node when you use the [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] or the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].)</span></span>  
  
 <span data-ttu-id="7fa0a-117">[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] TRFCs で、次をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-117">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] supports the following on tRFCs:</span></span>  
  
-   <span data-ttu-id="7fa0a-118">インポートのパラメーター</span><span class="sxs-lookup"><span data-stu-id="7fa0a-118">IMPORT parameters</span></span>  
  
-   <span data-ttu-id="7fa0a-119">パラメーター (変化させるパラメーターの入力側のみがサポートされます) を変更します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-119">CHANGING parameters (only the input side of the CHANGING parameter is supported)</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7fa0a-120">tRFCs は、それらの出力値 (エクスポートまたは変更するパラメーター) が返されないように、非同期的に実行されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-120">tRFCs are executed asynchronously, so no output values (EXPORT or CHANGING parameters) are returned for them.</span></span>  
  
 <span data-ttu-id="7fa0a-121">GUID パラメーターは tRFC 操作のため、アダプターによって確認できます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-121">A GUID parameter is surfaced by the adapter for tRFC operations.</span></span> <span data-ttu-id="7fa0a-122">この GUID は、SAP トランザクション ID (TID)、tRFC に関連付けられているアダプターによってマップされます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-122">This GUID is mapped by the adapter to the SAP transaction ID (TID) that is associated with the tRFC.</span></span> <span data-ttu-id="7fa0a-123">この GUID パラメーターを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-123">You can use this GUID parameter to:</span></span>  
  
-   <span data-ttu-id="7fa0a-124">TRFC クライアント呼び出しで、SAP システムで tRFC を確認します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-124">Confirm the tRFC on the SAP system in tRFC client calls.</span></span> <span data-ttu-id="7fa0a-125">これを行う RfcConfirmTransId 操作を呼び出すことによってです。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-125">You do this by invoking the RfcConfirmTransId operation.</span></span> <span data-ttu-id="7fa0a-126">これは、SAP システムで TID を確認するアダプター側に表示される特別な操作です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-126">This is a special operation surfaced by the adapter to confirm a TID on the SAP system.</span></span>  
  
-   <span data-ttu-id="7fa0a-127">TRFC クライアントと tRFC のサーバーのシナリオの両方で、アダプターから tRFC に使用される実際の SAP TID を取得します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-127">Get the actual SAP TID used for a tRFC from the adapter in both tRFC client and tRFC server scenarios.</span></span> <span data-ttu-id="7fa0a-128">SAP ユーティリティ メソッドを呼び出し、ConvertGuidToTid これを行います。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-128">You do this by invoking the SAP utility method, ConvertGuidToTid.</span></span>  
  
 <span data-ttu-id="7fa0a-129">これらの操作の詳細については、次を参照してください。[特別な操作](../../adapters-and-accelerators/adapter-sap/special-operations.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-129">For more information about these operations, see [Special Operations](../../adapters-and-accelerators/adapter-sap/special-operations.md).</span></span> <span data-ttu-id="7fa0a-130">メッセージの構造体と tRFCs のアダプターによって使用される SOAP アクションの詳細については、次を参照してください。 [tRFC 操作のメッセージ スキーマを](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-130">For more information about the message structures and SOAP actions used for tRFCs by the adapter, see [Message Schemas for tRFC Operations](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span></span>  
  
## <a name="invoking-transactional-rfcs-in-an-sap-system"></a><span data-ttu-id="7fa0a-131">SAP システムでトランザクションの Rfc を呼び出す</span><span class="sxs-lookup"><span data-stu-id="7fa0a-131">Invoking Transactional RFCs in an SAP System</span></span>  
 <span data-ttu-id="7fa0a-132">通常、tRFCs を使用して実行単一 LUW; 内の 1 つまたは複数の RFC 呼び出しただし、SAP RFC SDK での制限により、 [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] LUW あたり 1 つの tRFC のみをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-132">Typically, tRFCs are used to execute one or more RFC calls inside a single LUW; however, due to limitations in the SAP RFC SDK, the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] supports only a single tRFC per LUW.</span></span> <span data-ttu-id="7fa0a-133">このため、アダプターは各 tRFC の LUW (SAP TID) を作成します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-133">For this reason, the adapter creates an LUW (SAP TID) for each tRFC.</span></span> <span data-ttu-id="7fa0a-134">このようなクライアントについて SAP RFC の「1 回限り」の実行を保証するためのメカニズムとして、LUW を定義し、コミットとロールバック ベース トランザクションとは限りません。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-134">For such clients, SAP defines an LUW as a mechanism to guarantee "one-time" execution of the RFC and does not imply commit and rollback-based transactions.</span></span>  
  
 <span data-ttu-id="7fa0a-135">次の手順は、RFC 呼び出しを使用してクライアントで実行されるタスクをまとめて、[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-135">The following steps summarize the tasks that are performed in an RFC client call using the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span> <span data-ttu-id="7fa0a-136">これらの手順の一部は、クライアントによって実行される、アダプター、およびいくつかは、アダプターによって実行されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-136">Some of these steps are performed by the adapter client, and some are performed by the adapter.</span></span>  
  
1.  <span data-ttu-id="7fa0a-137">TRFC 操作の要求メッセージをアダプターのクライアントに送信します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-137">The adapter client sends a request message for the tRFC operation.</span></span> <span data-ttu-id="7fa0a-138">アダプターのクライアントは、このメッセージの GUID をオプションで指定できます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-138">The adapter client can optionally supply a GUID in this message.</span></span>  
  
2.  <span data-ttu-id="7fa0a-139">[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]要求メッセージを受信し、RFC SDK を使用して、SAP システムからトランザクション ID (TID) を取得します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-139">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] receives the request message and uses the RFC SDK to get a transaction ID (TID) from the SAP system.</span></span> <span data-ttu-id="7fa0a-140">アダプターはこの GUID を SAP TID; にマップして、要求メッセージに GUID が含まれている場合それ以外の場合、アダプターは新しい GUID を作成し、SAP TID に割り当てる</span><span class="sxs-lookup"><span data-stu-id="7fa0a-140">If the request message contains a GUID, the adapter maps this GUID to the SAP TID; otherwise, the adapter creates a new GUID and maps it to the SAP TID</span></span>  
  
3.  <span data-ttu-id="7fa0a-141">アダプターでは、TID を使用して、SAP サーバーへの呼び出し tRFC を加えます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-141">The adapter uses the TID to make the tRFC call to the SAP server.</span></span> <span data-ttu-id="7fa0a-142">TID の状態マークが付いている**完了**SAP システムでします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-142">The status of the TID is marked as **FINISHED** on the SAP system.</span></span>  
  
4.  <span data-ttu-id="7fa0a-143">アダプターは、アダプターでクライアントに応答メッセージ (TID にマップ) される GUID を返します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-143">The adapter returns the GUID (that is mapped to the TID) to the adapter client in the response message.</span></span>  
  
5.  <span data-ttu-id="7fa0a-144">アダプターのクライアントは、前の手順で返される GUID を持つアダプターの RfcConfirmTransID 操作を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-144">The adapter client invokes the RfcConfirmTransID operation on the adapter with the GUID returned in the previous step.</span></span>  
  
6.  <span data-ttu-id="7fa0a-145">アダプターは、SAP TID を識別する RfcConfirmTransID 要求メッセージ内で、GUID を使用し、SAP システムで tRFC の呼び出しを確認します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-145">The adapter uses the GUID in the RfcConfirmTransID request message to identify the SAP TID and confirms the tRFC call on the SAP system.</span></span> <span data-ttu-id="7fa0a-146">これにより、SAP サーバーをそのデータベースから TID エントリを削除します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-146">This causes the SAP server to delete the TID entry from its database.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7fa0a-147">tRFC クライアント呼び出しでは、エクスポートまたは変更するパラメーターは返されません。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-147">tRFC client calls do not return EXPORT or CHANGING parameters.</span></span>  
  
 <span data-ttu-id="7fa0a-148">詳細については。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-148">For more information about:</span></span>  
  
-   <span data-ttu-id="7fa0a-149">BizTalk Server を使用して tRFC の呼び出しを参照してください[で BizTalk Server を使用して SAP tRFCs を呼び出す](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-biztalk-server.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-149">Invoking a tRFC using BizTalk Server, see [Invoke tRFCs in SAP using BizTalk Server](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="7fa0a-150">モデルを使用して、WCF サービス、tRFC の呼び出しを参照してください[で WCF サービス モデルを使用して SAP tRFCs を呼び出す](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-the-wcf-service-model.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-150">Invoking a tRFC using the WCF service model, see [Invoke tRFCs in SAP using the WCF Service Model](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-the-wcf-service-model.md).</span></span>  
  
-   <span data-ttu-id="7fa0a-151">メッセージの構造と、tRFC の呼び出しの SOAP アクションを参照してください[tRFC 操作のメッセージ スキーマを](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-151">Message structures and SOAP action for invoking a tRFC, see [Message Schemas for tRFC Operations](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span></span>  
  
## <a name="receiving-inbound-transactional-rfc-calls-from-an-sap-system"></a><span data-ttu-id="7fa0a-152">SAP システムからの受信側の受信トランザクションの RFC 呼び出し</span><span class="sxs-lookup"><span data-stu-id="7fa0a-152">Receiving Inbound Transactional RFC Calls from an SAP System</span></span>  
 <span data-ttu-id="7fa0a-153">TRFC サーバーとしてアダプターを使用すると、SAP から tRFCs を受信します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-153">You can use the adapter as a tRFC server to receive tRFCs from SAP.</span></span> <span data-ttu-id="7fa0a-154">TRFC サーバーとして、アダプターが、tRFC を受信すると、アプリケーションに対応する tRFC 操作を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-154">As a tRFC server, when the adapter receives a tRFC, it invokes the corresponding tRFC operation on your application.</span></span> <span data-ttu-id="7fa0a-155">TRFC サーバーとして動作する、アダプターは、次の機能をサポートします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-155">The adapter supports the following functionality when it acts as a tRFC server:</span></span>  
  
-   <span data-ttu-id="7fa0a-156">(SAP TID で識別される)、LUW では、複数 tRFCs (RFC 呼び出し) を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-156">An LUW (identified by a SAP TID) can contain multiple tRFCs (RFC calls).</span></span>  
  
-   <span data-ttu-id="7fa0a-157">アダプターは、各 SAP TID をコミットできるトランザクションを作成します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-157">The adapter creates a committable transaction for each SAP TID.</span></span> <span data-ttu-id="7fa0a-158">アプリケーション コードは、このトランザクションに参加できます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-158">Your application code can enlist in this transaction.</span></span>  
  
-   <span data-ttu-id="7fa0a-159">コミットとロールバックはサポートされています。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-159">Commit and roll back are supported.</span></span>  
  
 <span data-ttu-id="7fa0a-160">このセクションの残りの部分では、tRFC サーバーとして、アダプターの使用に関する全般情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-160">The rest of this section provides general information about using the adapter as a tRFC server.</span></span> <span data-ttu-id="7fa0a-161">詳細については。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-161">For more specific information about:</span></span>  
  
-   <span data-ttu-id="7fa0a-162">BizTalk Server を使用して呼び出しを参照してください受信 tRFC の受信[受信受信 tRFC BizTalk Server を使用して SAP からの呼び出し](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-from-sap-using-biztalk-server.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-162">Receiving a inbound tRFC calls using BizTalk Server, see [Receive Inbound tRFC Calls from SAP using BizTalk Server](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-from-sap-using-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="7fa0a-163">受信 tRFC を受信する WCF サービス モデルを使用して呼び出しを参照してください[WCF サービス モデルを使用して SAP で受信受信 tRFC の呼び出し](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-in-sap-using-the-wcf-service-model.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-163">Receiving a inbound tRFC calls using the WCF service model, see [Receive Inbound tRFC Calls in SAP using the WCF Service Model](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-in-sap-using-the-wcf-service-model.md).</span></span>  
  
### <a name="the-tid-database"></a><span data-ttu-id="7fa0a-164">TID データベース</span><span class="sxs-lookup"><span data-stu-id="7fa0a-164">The TID Database</span></span>  
 <span data-ttu-id="7fa0a-165">アダプターが SQL Server データベースを使用して tRFC サーバーの役割を果たして、— TID データベース — トランザクション SAP システムから受信した Id を管理します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-165">When it acts as a tRFC server, the adapter uses a SQL Server database—the TID database—to manage the transaction IDs that it receives from the SAP system.</span></span> <span data-ttu-id="7fa0a-166">たとえば、コミット、ロールバック、SAP システムからの呼び出しを管理し、TID を確認するために、TID データベースを使用します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-166">For example, it uses the TID database to help manage calls from the SAP system to commit, rollback, and confirm the TID.</span></span> <span data-ttu-id="7fa0a-167">アダプターでは、GUID を作成し、TID データベース内の各 SAP TID 関連付けますがも格納されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-167">The adapter also stores the GUID that it creates and associates with each SAP TID in the TID database.</span></span>  
  
### <a name="prerequisites"></a><span data-ttu-id="7fa0a-168">前提条件</span><span class="sxs-lookup"><span data-stu-id="7fa0a-168">Prerequisites</span></span>  
 <span data-ttu-id="7fa0a-169">TRFC サーバーとして実行するアダプターの場合、次の項目が該当することを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-169">For the adapter to perform as a tRFC server, you must ensure that the following are true:</span></span>  
  
-   <span data-ttu-id="7fa0a-170">RFC は、SAP システムで宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-170">The RFC must be declared on the SAP system.</span></span> <span data-ttu-id="7fa0a-171">これは、アダプターは、SAP システムの RFC を説明するメタデータを取得できるようにします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-171">This is so the adapter can retrieve metadata that describes the RFC from the SAP system.</span></span> <span data-ttu-id="7fa0a-172">RFC は、実際には、アプリケーションで実装されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-172">The RFC is actually implemented in your application.</span></span>  
  
-   <span data-ttu-id="7fa0a-173">アダプターは、SAP ゲートウェイで、RFC 変換先を登録する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-173">The adapter must register with an RFC destination on an SAP gateway.</span></span> <span data-ttu-id="7fa0a-174">登録は、プログラム ID と呼ばれる論理名をに基づいてください。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-174">The registration is based on a logical name called a program ID.</span></span> <span data-ttu-id="7fa0a-175">プログラム ID を指定する URI の接続でパラメーターを指定する SAP ゲートウェイ、およびこの登録の SAP サーバー。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-175">You supply parameters in the connection URI to specify the program ID, SAP gateway, and SAP server for this registration.</span></span>  
  
-   <span data-ttu-id="7fa0a-176">TID データベースは、SQL Server で作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-176">The TID database must be created in SQL Server.</span></span> <span data-ttu-id="7fa0a-177">これを行うには、セットアップでインストールされている SQL スクリプトを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-177">To do this, you must run a SQL script that is installed by the setup.</span></span> <span data-ttu-id="7fa0a-178">SQL スクリプトが通常にインストールされている\<インストール ドライブ >: \Program Files\Microsoft[!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-178">The SQL script is typically installed at \<installation drive>:\Program Files\Microsoft [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span></span> <span data-ttu-id="7fa0a-179">詳細については、「 [BizTalk Adapter Pack をインストールする](http://msdn.microsoft.com/library/2ae27db5-b11b-42c3-a568-e2331badf80e)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-179">For more information see, [Installing the BizTalk Adapter Pack](http://msdn.microsoft.com/library/2ae27db5-b11b-42c3-a568-e2331badf80e).</span></span>  
  
-   <span data-ttu-id="7fa0a-180">**TidDatabaseConnectionString** TID データベースの SQL データベース接続文字列に設定するプロパティをバインドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-180">The **TidDatabaseConnectionString** binding property must be set to the SQL database connection string for the TID database.</span></span> <span data-ttu-id="7fa0a-181">詳細については、 **TidDatabaseConnectionString**バインディング プロパティを参照してください[mySAP Business Suite のバインドのプロパティの BizTalk アダプターの説明を読む](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-181">For more information about the **TidDatabaseConnectionString** binding property, see [Read about BizTalk Adapter for mySAP Business Suite binding properties](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7fa0a-182">設定、 **TidDatabaseConnectionString** RFC サーバーではなく tRFC サーバーとして機能するアダプターを構成するプロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-182">Setting the **TidDatabaseConnectionString** binding property configures the adapter to act as a tRFC server rather than as an RFC server.</span></span> <span data-ttu-id="7fa0a-183">場合、 **TidDatabaseConnectionString** binding プロパティを設定し、接続 URI、RFC 変換先を指定する、アダプターが RFC 転送先からの着信呼び出しの tRFC サーバーとして機能します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-183">If the **TidDatabaseConnectionString** binding property is set and you specify an RFC destination in the connection URI, the adapter acts as a tRFC server for incoming calls from the RFC destination.</span></span> <span data-ttu-id="7fa0a-184">このバインドのプロパティが設定されていない場合、アダプターは、RFC サーバーとして機能します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-184">If this binding property is not set, the adapter acts as an RFC server.</span></span>  
  
### <a name="how-the-adapter-processes-inbound-trfcs"></a><span data-ttu-id="7fa0a-185">どのアダプター プロセス受信 tRFCs</span><span class="sxs-lookup"><span data-stu-id="7fa0a-185">How the Adapter Processes Inbound tRFCs</span></span>  
 <span data-ttu-id="7fa0a-186">次の手順は、RFC クライアント呼び出しを使用して実行されるタスクをまとめて、[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-186">The following steps summarize the tasks that are performed by the RFC client call using the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span> <span data-ttu-id="7fa0a-187">これらの手順の一部は、クライアントによって実行される、アダプター、およびいくつかは、アダプターによって実行されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-187">Some of these steps are performed by the adapter client, and some are performed by the adapter.</span></span>  
  
1.  <span data-ttu-id="7fa0a-188">アダプターに、TID かどうかを確認する、SAP システム コールは使用されています。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-188">The SAP system calls into the adapter to enquire whether a TID has already been used.</span></span> <span data-ttu-id="7fa0a-189">アダプターは、SAP システムに適切な応答を返します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-189">The adapter returns the appropriate response to the SAP system.</span></span> <span data-ttu-id="7fa0a-190">TID が新しい場合は、アダプターは、コミットできるトランザクションを作成します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-190">If the TID is new, the adapter creates a committable transaction.</span></span> <span data-ttu-id="7fa0a-191">このトランザクションは、SAP プログラムは、コミット (コミット動作) を実行するときに、トランザクション的な方法で TID データベースに TID を永続化に使用されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-191">This transaction is used to persist the TID to the TID database in a transactional manner when the SAP program performs a commit (COMMIT WORK).</span></span> <span data-ttu-id="7fa0a-192">受信 tRFCs を処理するアプリケーション コードに公開されるもします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-192">It is also exposed to application code that handles the inbound tRFCs.</span></span> <span data-ttu-id="7fa0a-193">さらに、アダプターでは、SAP TID に関連付ける GUID を作成します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-193">Additionally, the adapter creates a GUID that it associates with the SAP TID.</span></span>  
  
2.  <span data-ttu-id="7fa0a-194">SAP システムは、1 つまたは複数のトランザクションの Rfc をアダプターに送信します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-194">The SAP system sends one or more transactional RFCs to the adapter.</span></span> <span data-ttu-id="7fa0a-195">各 tRFC は、アダプターは、アプリケーションに適切な tRFC 操作を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-195">For each tRFC, the adapter invokes the appropriate tRFC operation on your application.</span></span> <span data-ttu-id="7fa0a-196">アダプターは、各操作用にアプリケーションを手順 1. で作成されたトランザクションをフローします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-196">The adapter flows the transaction created in step 1 to your application for each operation.</span></span> <span data-ttu-id="7fa0a-197">アダプターは、操作の要求メッセージで手順 1. で作成された GUID を渡します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-197">The adapter passes the GUID created in step 1 in the request message for the operation.</span></span>  
  
3.  <span data-ttu-id="7fa0a-198">SAP システムは、LUW (COMMIT WORK) をコミットします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-198">SAP system commits the LUW (COMMIT WORK).</span></span> <span data-ttu-id="7fa0a-199">アダプターは、SAP TID (手順 1. で作成された) に関連付けられているトランザクションをコミットしようとします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-199">The adapter tries to commit the transaction associated with the SAP TID (created in step 1).</span></span>  
  
    1.  <span data-ttu-id="7fa0a-200">手順 2. で呼び出しのいずれかの中に (アプリケーション) でトランザクションが中止されたアダプターがトランザクションをコミットしようとするときにエラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-200">If the transaction was aborted (by your application) during any of the calls in step 2, then an error occurs when the adapter tries to commit the transaction.</span></span> <span data-ttu-id="7fa0a-201">SAP に、エラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-201">The error is returned to SAP.</span></span> <span data-ttu-id="7fa0a-202">手順 4 に進みます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-202">Go to step 4.</span></span>  
  
    2.  <span data-ttu-id="7fa0a-203">コミットが成功した場合は、TID が TID データベースに接続してようになりました。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-203">If the commit is successful, the TID is now in the TID database.</span></span> <span data-ttu-id="7fa0a-204">手順 5 に進みます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-204">Go to step 5.</span></span>  
  
4.  <span data-ttu-id="7fa0a-205">エラーが発生した場合の手順 3、または SAP がロールバックそのコミットの代わりに LUW (RESTART_OF_BACKGROUNDTASK) 場合、アダプター トランザクションをロールバックします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-205">If an error occurred in step 3, or if SAP rolls back the LUW (RESTART_OF_BACKGROUNDTASK) instead of committing it, the adapter rolls back the transaction.</span></span> <span data-ttu-id="7fa0a-206">ここでは TID は TID データベースに保存されることです。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-206">In this case the TID is never persisted to the TID database.</span></span>  
  
5.  <span data-ttu-id="7fa0a-207">SAP システムは、TID を確認します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-207">The SAP system confirms the TID.</span></span> <span data-ttu-id="7fa0a-208">アダプター TID データベースから削除 TID (手順 3 が正常に完了し、TID が TID データベースに存在することを想定しています。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-208">The adapter removes the TID from the TID database (assuming that step 3 completed successfully and the TID exists in the TID database.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7fa0a-209">TRFC サーバー操作中に、TID データベースに接続しようとしてエラーが発生する場合はエラー コードのことを示す SAP からの着信呼び出しによって処理されませんでした、 [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] SAP に返されます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-209">If an error occurs attempting to connect to the TID Database during a tRFC server operation, an error code indicating that the incoming call from SAP was not processed by the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] is returned to SAP.</span></span>  
  
### <a name="receiving-idocs-as-a-trfc-server"></a><span data-ttu-id="7fa0a-210">TRFC サーバーとしての Idoc の受信</span><span class="sxs-lookup"><span data-stu-id="7fa0a-210">Receiving IDOCs as a tRFC server</span></span>  
 <span data-ttu-id="7fa0a-211">使用する、 [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] RFC サーバーまたは SAP システムから Idoc を受信する tRFC サーバーのいずれかとして。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-211">You use the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] as either an RFC server or a tRFC server to receive IDOCs from the SAP system.</span></span> <span data-ttu-id="7fa0a-212">どちらの場合に設定する必要があります、 **ReceiveIdocFormat**アダプターが、アプリケーションに IDOC データを出力する式を指定するプロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-212">In either case, you must set the **ReceiveIdocFormat** binding property to specify the format in which the adapter should emit the IDOC data to your application.</span></span> <span data-ttu-id="7fa0a-213">アダプターでの Idoc の受信の詳細については、次を参照してください。 [sap Idoc に対する操作](../../adapters-and-accelerators/adapter-sap/operations-on-idocs-in-sap.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-213">For more information about receiving IDOCs with the adapter, see [Operations on IDOCs in SAP](../../adapters-and-accelerators/adapter-sap/operations-on-idocs-in-sap.md).</span></span> <span data-ttu-id="7fa0a-214">詳細については、[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]バインドのプロパティを参照してください[mySAP Business Suite のバインドのプロパティの BizTalk アダプターの説明を読む](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-214">For more information about the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] binding properties, see [Read about BizTalk Adapter for mySAP Business Suite binding properties](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md).</span></span>  
  
## <a name="special-trfc-operations"></a><span data-ttu-id="7fa0a-215">特殊な tRFC 操作</span><span class="sxs-lookup"><span data-stu-id="7fa0a-215">Special tRFC Operations</span></span>  
 <span data-ttu-id="7fa0a-216">[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] SAP システムで特定の特別な tRFC 操作も実行できます。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-216">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] can also perform certain special tRFC operations on the SAP system.</span></span> <span data-ttu-id="7fa0a-217">このような 1 つの操作は、RfcConfirmTransID です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-217">One such operation is RfcConfirmTransID.</span></span>  
  
-   <span data-ttu-id="7fa0a-218">**RfcConfirmTransID です。**</span><span class="sxs-lookup"><span data-stu-id="7fa0a-218">**RfcConfirmTransID.**</span></span> <span data-ttu-id="7fa0a-219">この操作を呼び出し、[!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]を SAP サーバーに tRFC の呼び出しを確認します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-219">You invoke this operation on the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] to confirm tRFC calls made to the SAP server.</span></span> <span data-ttu-id="7fa0a-220">アダプターを使用して、tRFC として、SAP サーバーに Idoc を送信するシナリオでは、RfcConfirmTransID が必要です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-220">RfcConfirmTransID might be required in scenarios where the adapter is used to send IDOCs to the SAP server as a tRFC.</span></span> <span data-ttu-id="7fa0a-221">操作が 利用可能な**TRFC**ノードを使用する場合、[!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)]と[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-221">The operation is available under the **TRFC** node when using the [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] and [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>  
  
 <span data-ttu-id="7fa0a-222">メッセージの構造と RfcConfirmTransID 操作の SOAP アクションの詳細については、次を参照してください。 [tRFC 操作のメッセージ スキーマを](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-222">For more information about the message structure and SOAP action for the RfcConfirmTransID operation, see [Message Schemas for tRFC Operations](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7fa0a-223">参照</span><span class="sxs-lookup"><span data-stu-id="7fa0a-223">See Also</span></span>  
 [<span data-ttu-id="7fa0a-224">アダプターを使用して SAP システムへの接続します。</span><span class="sxs-lookup"><span data-stu-id="7fa0a-224">Connect to an SAP system using the adapter</span></span>](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)