---
title: SAP アダプターの SAPConnection クラス |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- SAPConnection, supported methods, classes, and constructors
ms.assetid: a700602d-8135-4f67-a38b-770357d4e28b
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 14fb1cf2b04fd16aedd8aa97f75f2fa57620e3f0
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65372953"
---
# <a name="sapconnection-class-in-the-sap-adapter"></a><span data-ttu-id="c69bf-102">SAP アダプターの SAPConnection クラス</span><span class="sxs-lookup"><span data-stu-id="c69bf-102">SAPConnection class in the SAP adapter</span></span>
<span data-ttu-id="c69bf-103">メソッドおよびプロパティを次のセクションの一覧、 **SAPConnection**クラス。</span><span class="sxs-lookup"><span data-stu-id="c69bf-103">The following section lists the methods and properties for the **SAPConnection** class.</span></span> <span data-ttu-id="c69bf-104">これは、SAP アプリケーション サーバーへの ADO.NET 接続を表します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-104">This represents an ADO.NET connection to the SAP application server.</span></span>  
  
 <span data-ttu-id="c69bf-105">これは、派生元**System.Data.Common.DbConnection**します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-105">This is derived from **System.Data.Common.DbConnection**.</span></span>  
  
## <a name="supported-properties"></a><span data-ttu-id="c69bf-106">サポートされているプロパティ</span><span class="sxs-lookup"><span data-stu-id="c69bf-106">Supported Properties</span></span>  
  
|<span data-ttu-id="c69bf-107">名前</span><span class="sxs-lookup"><span data-stu-id="c69bf-107">Name</span></span>|<span data-ttu-id="c69bf-108">Get/Set</span><span class="sxs-lookup"><span data-stu-id="c69bf-108">Get/Set</span></span>|<span data-ttu-id="c69bf-109">説明</span><span class="sxs-lookup"><span data-stu-id="c69bf-109">Description</span></span>|  
|----------|--------------|-----------------|  
|<span data-ttu-id="c69bf-110">**ConnectionString**</span><span class="sxs-lookup"><span data-stu-id="c69bf-110">**ConnectionString**</span></span>|<span data-ttu-id="c69bf-111">Get と Set</span><span class="sxs-lookup"><span data-stu-id="c69bf-111">Get and Set</span></span>|<span data-ttu-id="c69bf-112">参照してください[SAP 接続文字列のデータ プロバイダーの種類について](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md)します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-112">See [Read about Data Provider types for the SAP Connection String](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span></span>|  
|<span data-ttu-id="c69bf-113">**ConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="c69bf-113">**ConnectionTimeout**</span></span>|<span data-ttu-id="c69bf-114">取得</span><span class="sxs-lookup"><span data-stu-id="c69bf-114">Get</span></span>|<span data-ttu-id="c69bf-115">サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="c69bf-115">Not supported.</span></span> <span data-ttu-id="c69bf-116">0 を返します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-116">Returns 0.</span></span>|  
|<span data-ttu-id="c69bf-117">**[データベース]**</span><span class="sxs-lookup"><span data-stu-id="c69bf-117">**Database**</span></span>|<span data-ttu-id="c69bf-118">取得</span><span class="sxs-lookup"><span data-stu-id="c69bf-118">Get</span></span>|<span data-ttu-id="c69bf-119">SAP システム id。</span><span class="sxs-lookup"><span data-stu-id="c69bf-119">SAP System ID.</span></span>|  
|<span data-ttu-id="c69bf-120">**DataSource**</span><span class="sxs-lookup"><span data-stu-id="c69bf-120">**DataSource**</span></span>|<span data-ttu-id="c69bf-121">取得</span><span class="sxs-lookup"><span data-stu-id="c69bf-121">Get</span></span>|<span data-ttu-id="c69bf-122">これは、SAP アプリケーション サーバーのホストの名前を返します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-122">This returns the name of the SAP application server host.</span></span>|  
|<span data-ttu-id="c69bf-123">**ServerVersion**</span><span class="sxs-lookup"><span data-stu-id="c69bf-123">**ServerVersion**</span></span>|<span data-ttu-id="c69bf-124">取得</span><span class="sxs-lookup"><span data-stu-id="c69bf-124">Get</span></span>|<span data-ttu-id="c69bf-125">SAP インスタンスと SAP サーバー バージョンではなくリリース番号が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c69bf-125">This shows the release number for the SAP instance and not the SAP Server version.</span></span> <span data-ttu-id="c69bf-126">たとえば、ADO.NET クライアント インスタンスのリリース番号 620 で SAP サーバー バージョン 4.6 への接続は、このプロパティには 620 が表示されます。</span><span class="sxs-lookup"><span data-stu-id="c69bf-126">For example, if the ADO.NET client is connecting to SAP Server version 4.6 with the instance release number 620, this property will display 620.</span></span>|  
|<span data-ttu-id="c69bf-127">**State**</span><span class="sxs-lookup"><span data-stu-id="c69bf-127">**State**</span></span>|<span data-ttu-id="c69bf-128">取得</span><span class="sxs-lookup"><span data-stu-id="c69bf-128">Get</span></span>|<span data-ttu-id="c69bf-129">接続の状態。</span><span class="sxs-lookup"><span data-stu-id="c69bf-129">Connection state.</span></span> <span data-ttu-id="c69bf-130">サポートされている状態は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="c69bf-130">The supported states are:</span></span><br /><br /> <span data-ttu-id="c69bf-131">- [System.Data.ConnectionState]</span><span class="sxs-lookup"><span data-stu-id="c69bf-131">- [System.Data.ConnectionState]</span></span><br /><br /> <span data-ttu-id="c69bf-132">クローズ</span><span class="sxs-lookup"><span data-stu-id="c69bf-132">- Closed</span></span><br /><br /> <span data-ttu-id="c69bf-133">-</span><span class="sxs-lookup"><span data-stu-id="c69bf-133">- Open</span></span><br /><br /> <span data-ttu-id="c69bf-134">接続します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-134">- Connecting</span></span>|  
  
## <a name="supported-methods"></a><span data-ttu-id="c69bf-135">サポートされているメソッド</span><span class="sxs-lookup"><span data-stu-id="c69bf-135">Supported Methods</span></span>  
  
|<span data-ttu-id="c69bf-136">名前</span><span class="sxs-lookup"><span data-stu-id="c69bf-136">Name</span></span>|<span data-ttu-id="c69bf-137">説明</span><span class="sxs-lookup"><span data-stu-id="c69bf-137">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="c69bf-138">**ChangeDatabase(string)**</span><span class="sxs-lookup"><span data-stu-id="c69bf-138">**ChangeDatabase(string)**</span></span>|<span data-ttu-id="c69bf-139">サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="c69bf-139">Not supported.</span></span>|  
|<span data-ttu-id="c69bf-140">**Close()**</span><span class="sxs-lookup"><span data-stu-id="c69bf-140">**Close()**</span></span>|<span data-ttu-id="c69bf-141">SAP システムへの接続を閉じます。</span><span class="sxs-lookup"><span data-stu-id="c69bf-141">Closes the connection to the SAP system.</span></span>|  
|<span data-ttu-id="c69bf-142">**CreateCommand()**</span><span class="sxs-lookup"><span data-stu-id="c69bf-142">**CreateCommand()**</span></span>|<span data-ttu-id="c69bf-143">この接続に関連付けられた新しい SAPCommand を返します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-143">Returns a new SAPCommand associated with this connection.</span></span>|  
|<span data-ttu-id="c69bf-144">**GetSchema()**</span><span class="sxs-lookup"><span data-stu-id="c69bf-144">**GetSchema()**</span></span>|<span data-ttu-id="c69bf-145">検出された SAP テーブルの一覧を取得します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-145">Gets the list of discovered SAP tables.</span></span> <span data-ttu-id="c69bf-146">検出されたすべてのテーブルは、XML ファイル SAPDiscoveredObjects.xml に利用します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-146">All discovered tables are available in an XML file SAPDiscoveredObjects.xml.</span></span> <span data-ttu-id="c69bf-147">ファイルがある\<インストール ドライブ\>: \Program Files\Common \microsoft Shared\Adapters\SAP します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-147">The file is located at \<installation drive\>:\Program Files\Common Files\Microsoft Shared\Adapters\SAP.</span></span>|  
|<span data-ttu-id="c69bf-148">**GetSchema(string)**</span><span class="sxs-lookup"><span data-stu-id="c69bf-148">**GetSchema(string)**</span></span>|<span data-ttu-id="c69bf-149">コレクション名に基づくスキーマを取得します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-149">Gets schema based on collection name.</span></span> <span data-ttu-id="c69bf-150">コレクション名「テーブル」をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="c69bf-150">Supports the collection name “Tables”.</span></span>|  
  
|<span data-ttu-id="c69bf-151">名前</span><span class="sxs-lookup"><span data-stu-id="c69bf-151">Name</span></span>|<span data-ttu-id="c69bf-152">説明</span><span class="sxs-lookup"><span data-stu-id="c69bf-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="c69bf-153">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-153">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-154">コレクションの名前と制限事項に基づくスキーマを取得します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-154">Gets schema based on the collection name and restrictions.</span></span> <span data-ttu-id="c69bf-155">次の表は、コレクションの名前とサポートされている制限を表します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-155">The table below represents the collection names and restrictions supported:</span></span>|  
  
|<span data-ttu-id="c69bf-156">名前</span><span class="sxs-lookup"><span data-stu-id="c69bf-156">Name</span></span>|<span data-ttu-id="c69bf-157">コレクション名</span><span class="sxs-lookup"><span data-stu-id="c69bf-157">Collection Name</span></span>|<span data-ttu-id="c69bf-158">制限</span><span class="sxs-lookup"><span data-stu-id="c69bf-158">Restrictions</span></span>|<span data-ttu-id="c69bf-159">説明</span><span class="sxs-lookup"><span data-stu-id="c69bf-159">Description</span></span>|  
|----------|---------------------|------------------|-----------------|  
|<span data-ttu-id="c69bf-160">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-160">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-161">テーブル</span><span class="sxs-lookup"><span data-stu-id="c69bf-161">Tables</span></span>|-|<span data-ttu-id="c69bf-162">検出された SAP テーブルの一覧</span><span class="sxs-lookup"><span data-stu-id="c69bf-162">List of discovered SAP Tables</span></span>|  
|<span data-ttu-id="c69bf-163">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-163">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-164">手順</span><span class="sxs-lookup"><span data-stu-id="c69bf-164">Procedures</span></span>|-|<span data-ttu-id="c69bf-165">検出された Rfc の一覧</span><span class="sxs-lookup"><span data-stu-id="c69bf-165">List of discovered RFCs</span></span>|  
|<span data-ttu-id="c69bf-166">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-166">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-167">SearchRFCs</span><span class="sxs-lookup"><span data-stu-id="c69bf-167">SearchRFCs</span></span>|<span data-ttu-id="c69bf-168">arr [0]:検索式</span><span class="sxs-lookup"><span data-stu-id="c69bf-168">arr[0]: Search expr</span></span>|<span data-ttu-id="c69bf-169">Rfc の照合の一覧</span><span class="sxs-lookup"><span data-stu-id="c69bf-169">List of matching RFCs</span></span>|  
|<span data-ttu-id="c69bf-170">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-170">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-171">ImportParameters</span><span class="sxs-lookup"><span data-stu-id="c69bf-171">ImportParameters</span></span>|<span data-ttu-id="c69bf-172">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-172">arr[1]: RFC name</span></span>|<span data-ttu-id="c69bf-173">RFC のパラメーターをインポートします。</span><span class="sxs-lookup"><span data-stu-id="c69bf-173">Import parameters of RFC</span></span>|  
|<span data-ttu-id="c69bf-174">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-174">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-175">ImportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="c69bf-175">ImportParameterColumn</span></span>|<span data-ttu-id="c69bf-176">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-176">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="c69bf-177">arr [2]:パラメーター名</span><span class="sxs-lookup"><span data-stu-id="c69bf-177">arr[2]: Param name</span></span>|<span data-ttu-id="c69bf-178">パラメーターのスキーマのインポート</span><span class="sxs-lookup"><span data-stu-id="c69bf-178">Import parameter schema</span></span>|  
|<span data-ttu-id="c69bf-179">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-179">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-180">ExportParameters</span><span class="sxs-lookup"><span data-stu-id="c69bf-180">ExportParameters</span></span>|<span data-ttu-id="c69bf-181">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-181">arr[1]: RFC name</span></span>|<span data-ttu-id="c69bf-182">エクスポートの RFC パラメーター</span><span class="sxs-lookup"><span data-stu-id="c69bf-182">Export parameters of RFC</span></span>|  
|<span data-ttu-id="c69bf-183">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-183">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-184">ExportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="c69bf-184">ExportParameterColumn</span></span>|<span data-ttu-id="c69bf-185">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-185">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="c69bf-186">arr [2]:パラメーター名</span><span class="sxs-lookup"><span data-stu-id="c69bf-186">arr[2]: Param name</span></span>|<span data-ttu-id="c69bf-187">パラメーターのスキーマをエクスポートします。</span><span class="sxs-lookup"><span data-stu-id="c69bf-187">Export parameter schema</span></span>|  
|<span data-ttu-id="c69bf-188">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-188">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-189">TableParameters</span><span class="sxs-lookup"><span data-stu-id="c69bf-189">TableParameters</span></span>|<span data-ttu-id="c69bf-190">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-190">arr[1]: RFC name</span></span>|<span data-ttu-id="c69bf-191">RFC の表のパラメーター</span><span class="sxs-lookup"><span data-stu-id="c69bf-191">Table parameters of RFC</span></span>|  
|<span data-ttu-id="c69bf-192">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-192">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-193">TableParameterColumn</span><span class="sxs-lookup"><span data-stu-id="c69bf-193">TableParameterColumn</span></span>|<span data-ttu-id="c69bf-194">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-194">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="c69bf-195">arr [2]:パラメーター名</span><span class="sxs-lookup"><span data-stu-id="c69bf-195">arr[2]: Param name</span></span>|<span data-ttu-id="c69bf-196">パラメーターのテーブル スキーマ</span><span class="sxs-lookup"><span data-stu-id="c69bf-196">Table parameter schema</span></span>|  
|<span data-ttu-id="c69bf-197">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-197">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-198">ChangingParameters</span><span class="sxs-lookup"><span data-stu-id="c69bf-198">ChangingParameters</span></span>|<span data-ttu-id="c69bf-199">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-199">arr[1]: RFC name</span></span>|<span data-ttu-id="c69bf-200">RFC のパラメーターを変更します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-200">Changing parameters of RFC</span></span>|  
|<span data-ttu-id="c69bf-201">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-201">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-202">ChangingParameterColumn</span><span class="sxs-lookup"><span data-stu-id="c69bf-202">ChangingParameterColumn</span></span>|<span data-ttu-id="c69bf-203">arr [1]:RFC 名</span><span class="sxs-lookup"><span data-stu-id="c69bf-203">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="c69bf-204">arr [2]:パラメーター名</span><span class="sxs-lookup"><span data-stu-id="c69bf-204">arr[2]: Param name</span></span>|<span data-ttu-id="c69bf-205">パラメーターのスキーマを変更します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-205">Changing parameter schema</span></span>|  
|<span data-ttu-id="c69bf-206">**GetSchema(string, string[])**</span><span class="sxs-lookup"><span data-stu-id="c69bf-206">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="c69bf-207">列</span><span class="sxs-lookup"><span data-stu-id="c69bf-207">columns</span></span>|<span data-ttu-id="c69bf-208">arr [1]:テーブル名</span><span class="sxs-lookup"><span data-stu-id="c69bf-208">arr[1]: Table name</span></span>|<span data-ttu-id="c69bf-209">SAP テーブル列のスキーマ</span><span class="sxs-lookup"><span data-stu-id="c69bf-209">SAP Table column schema</span></span>|  
  
|<span data-ttu-id="c69bf-210">名前</span><span class="sxs-lookup"><span data-stu-id="c69bf-210">Name</span></span>|<span data-ttu-id="c69bf-211">説明</span><span class="sxs-lookup"><span data-stu-id="c69bf-211">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="c69bf-212">**Open()**</span><span class="sxs-lookup"><span data-stu-id="c69bf-212">**Open()**</span></span>|<span data-ttu-id="c69bf-213">接続文字列に基づいて、SAP 接続を開きます。</span><span class="sxs-lookup"><span data-stu-id="c69bf-213">Opens an SAP connection based on the connection string.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="c69bf-214">その他のすべてのコレクション エントリ、Table、Procedure、および SearchRFCs コレクション エントリを除く arr [0] のダミー値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c69bf-214">Except for Table, Procedure, and SearchRFCs collection entries, for all other collection entries you must specify a dummy value for arr[0].</span></span>  
  
## <a name="supported-constructors"></a><span data-ttu-id="c69bf-215">サポートされているコンス トラクター</span><span class="sxs-lookup"><span data-stu-id="c69bf-215">Supported Constructors</span></span>  
  
|<span data-ttu-id="c69bf-216">名前</span><span class="sxs-lookup"><span data-stu-id="c69bf-216">Name</span></span>|<span data-ttu-id="c69bf-217">説明</span><span class="sxs-lookup"><span data-stu-id="c69bf-217">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="c69bf-218">**SAPConnection()**</span><span class="sxs-lookup"><span data-stu-id="c69bf-218">**SAPConnection()**</span></span>|<span data-ttu-id="c69bf-219">SAPConnection オブジェクト インスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-219">Creates an SAPConnection object instance.</span></span>|  
|<span data-ttu-id="c69bf-220">**SAPConnection(string)**</span><span class="sxs-lookup"><span data-stu-id="c69bf-220">**SAPConnection(string)**</span></span>|<span data-ttu-id="c69bf-221">SAP の接続文字列を受け入れます。</span><span class="sxs-lookup"><span data-stu-id="c69bf-221">Accepts an SAP connection string.</span></span> <span data-ttu-id="c69bf-222">接続文字列が有効でない場合は、例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="c69bf-222">Throws an exception if the connection string is invalid.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c69bf-223">参照</span><span class="sxs-lookup"><span data-stu-id="c69bf-223">See Also</span></span>  
 [<span data-ttu-id="c69bf-224">SAP アダプターを使用した ADO.NET インターフェイスを拡張します。</span><span class="sxs-lookup"><span data-stu-id="c69bf-224">Extend ADO.NET Interfaces with the SAP adapter</span></span>](../../adapters-and-accelerators/adapter-sap/extend-ado-net-interfaces-with-the-sap-adapter.md)