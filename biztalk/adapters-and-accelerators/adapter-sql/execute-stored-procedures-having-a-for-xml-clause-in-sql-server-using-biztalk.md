---
title: "BizTalk Server を使用して SQL Server での FOR XML 句を持つストアド プロシージャを実行 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 1d8fe927-90bf-48fc-a418-63b920b409ed
caps.latest.revision: "13"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 2e47c269516ba73ab1e61664d200db207110e98e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="execute-stored-procedures-having-a-for-xml-clause-in-sql-server-using-biztalk-server"></a><span data-ttu-id="1fc72-102">BizTalk Server を使用して SQL Server での FOR XML 句を持つストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-102">Execute stored procedures having a FOR XML clause in SQL Server using BizTalk Server</span></span>
<span data-ttu-id="1fc72-103">SQL SELECT ステートメントでは、行セットではなく XML としてクエリ結果を返す FOR XML 句を持つことができます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-103">An SQL SELECT statement can have a FOR XML clause that returns the query result as XML instead of a rowset.</span></span> <span data-ttu-id="1fc72-104">また、ストアド プロシージャを FOR XML 句を伴う SELECT ステートメントを持つことができます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-104">You can also have a stored procedure that has a SELECT statement with a FOR XML clause.</span></span> <span data-ttu-id="1fc72-105">[FOR XML (SQL Server)](https://msdn.microsoft.com/library/ms178107.aspx)の詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="1fc72-105">[FOR XML (SQL Server)](https://msdn.microsoft.com/library/ms178107.aspx) has more information.</span></span>
  
 <span data-ttu-id="1fc72-106">WCF ベースを使用することができます[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]などを実行するストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="1fc72-106">You can use the WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to execute such stored procedures.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="1fc72-107">「ネイティブ」の SQL アダプターで使用可能な[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]FOR XML 句を SELECT ステートメントの一部として保持するストアド プロシージャが必要です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-107">The “native” SQL adapter available with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] requires stored procedures to have the FOR XML clause as part of the SELECT statement.</span></span> <span data-ttu-id="1fc72-108">このようなストアド プロシージャを使用するには、WCF ベースで[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]ストアド プロシージャの定義に変更を加えずにします。</span><span class="sxs-lookup"><span data-stu-id="1fc72-108">You can use such stored procedures with the WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] without making any changes to the stored procedure definition.</span></span>  
>   
>  <span data-ttu-id="1fc72-109">以前のバージョンに用意されている 'native' の SQL アダプターを使用して生成されたスキーマを常に使用することができます[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-109">You can always use the schemas generated using the ‘native’ SQL adapter provided with earlier versions of [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="1fc72-110">詳細については、次を参照してください。 [WCF-SQL アダプターを使用して FOR XML クエリ](http://go.microsoft.com/fwlink/?LinkId=223428)(http://go.microsoft.com/fwlink/?LinkId=223428)。</span><span class="sxs-lookup"><span data-stu-id="1fc72-110">For more information, see [Using FOR XML queries with the WCF-SQL Adapter](http://go.microsoft.com/fwlink/?LinkId=223428) (http://go.microsoft.com/fwlink/?LinkId=223428).</span></span>  
  
## <a name="how-to-invoke-stored-procedures-with-for-xml-clause"></a><span data-ttu-id="1fc72-111">FOR XML 句を使用してストアド プロシージャを呼び出す方法</span><span class="sxs-lookup"><span data-stu-id="1fc72-111">How to Invoke Stored Procedures with FOR XML Clause</span></span>  
 <span data-ttu-id="1fc72-112">SQL Server Management Studio または SQL アダプターで使用可能なを使用して FOR XML 句を使用してストアド プロシージャを呼び出した場合[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]出力は次の xml メッセージの形式でします。</span><span class="sxs-lookup"><span data-stu-id="1fc72-112">When you invoke a stored procedure with FOR XML clause in SQL Server Management Studio or using the SQL adapter available with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], the output is in the form of an xml message.</span></span> <span data-ttu-id="1fc72-113">WCF ベースでこれらの手順を使用する[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]、出力メッセージのスキーマをする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-113">To use these procedures with the WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)], you must have the schema for the output message.</span></span> <span data-ttu-id="1fc72-114">WCF ベース[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]FOR XML 句を使用してストアド プロシージャを実行した後、SQL Server からの応答メッセージを受信中にこのスキーマが必要です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-114">The WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] requires this schema while receiving the response message from SQL Server after executing a stored procedure with FOR XML clause.</span></span> <span data-ttu-id="1fc72-115">このストアド プロシージャを呼び出す要求メッセージがアダプター自体によって生成されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1fc72-115">Note that the request message to invoke this stored procedure will be generated by the adapter itself.</span></span>  
  
 <span data-ttu-id="1fc72-116">応答メッセージのスキーマとは別で、WCF ベースを使用して FOR XML 句を使用してストアド プロシージャを呼び出すための特定のタスクを実行する必要がありますも[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-116">Apart from having the schema for the response message, you must also perform certain tasks to invoke a stored procedure with FOR XML clause using the WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span>  
  
1.  <span data-ttu-id="1fc72-117">FOR XML 句を使用してストアド プロシージャの応答メッセージのスキーマを生成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-117">Generate the schema for the response message for the stored procedure with FOR XML clause.</span></span> <span data-ttu-id="1fc72-118">使用可能な「ネイティブ」の SQL アダプターによって生成される応答のスキーマがあれば[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]、この手順をスキップすることができます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-118">If you already have the response schema generated by the “native” SQL adapter available with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], you can skip this step.</span></span>  
  
2.  <span data-ttu-id="1fc72-119">BizTalk プロジェクトを作成し、生成されたスキーマをプロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-119">Create a BizTalk project and add the generated schema to the project.</span></span>  
  
3.  <span data-ttu-id="1fc72-120">WCF ベースを使用して FOR XML 句を使用して、ストアド プロシージャのスキーマを生成[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-120">Generate schema for the stored procedure with FOR XML clause using the WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="1fc72-121">これは、ストアド プロシージャを呼び出す SQL Server にアダプターを送信する要求メッセージのスキーマを提供します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-121">This provides the schema for the request message that the adapter sends to SQL Server to invoke the stored procedure.</span></span>  
  
4.  <span data-ttu-id="1fc72-122">SQL Server からメッセージを送受信する BizTalk プロジェクトでメッセージを作成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-122">Create messages in the BizTalk project to send and receive messages from SQL Server.</span></span> <span data-ttu-id="1fc72-123">要求メッセージは、アダプターによって生成された要求メッセージのスキーマに準拠している必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-123">The request message must conform to the schema of the request message generated by the adapter.</span></span> <span data-ttu-id="1fc72-124">応答メッセージは、または SQL Server Management Studio での FOR XML 句を使用してストアド プロシージャを実行することによって、「ネイティブ」の SQL アダプターを使用するか取得した応答メッセージのスキーマに準拠する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-124">The response message must conform to the schema of the response message obtained either using the “native” SQL adapter or by executing the stored procedure with FOR XML clause in SQL Server Management Studio.</span></span>  
  
5.  <span data-ttu-id="1fc72-125">SQL Server データベースにストアド プロシージャを呼び出すオーケストレーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-125">Create an orchestration to invoke the stored procedure in the SQL Server database.</span></span>  
  
6.  <span data-ttu-id="1fc72-126">構築し、BizTalk プロジェクトを展開します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-126">Build and deploy the BizTalk project.</span></span>  
  
7.  <span data-ttu-id="1fc72-127">BizTalk アプリケーションを作成する物理送信ポートと受信ポートを構成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-127">Configure the BizTalk application by creating physical send and receive ports.</span></span>  
  
8.  <span data-ttu-id="1fc72-128">BizTalk アプリケーションを起動します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-128">Start the BizTalk application.</span></span>  
  
##  <span data-ttu-id="1fc72-129"><a name="BKMK_RespSchema"></a>ストアド プロシージャの応答メッセージのスキーマを生成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-129"><a name="BKMK_RespSchema"></a> Generating Schema for the Response Message for Stored Procedure</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1fc72-130">使用可能な SQL アダプターによって生成される応答のスキーマがある場合は、この手順を実行する必要はありません[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-130">You do not need to perform this step if you have the response schema generated by the SQL adapter available with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
 <span data-ttu-id="1fc72-131">ストアド プロシージャで応答メッセージのスキーマを生成するには、ストアド プロシージャで SELECT ステートメントがある提供される、`xmlschema`句、`for xml`句。</span><span class="sxs-lookup"><span data-stu-id="1fc72-131">You can generate the schema for the response message for the stored procedure, provided the SELECT statement in the stored procedure has the `xmlschema` clause with the `for xml` clause.</span></span> <span data-ttu-id="1fc72-132">このトピックでは指定された従業員 ID の従業員の詳細情報を取得する GET_EMP_DETAILS_FOR_XML が格納されている手順に従いますお</span><span class="sxs-lookup"><span data-stu-id="1fc72-132">In this topic, we use the GET_EMP_DETAILS_FOR_XML stored procedure that retrieves the employee details for a given employee ID.</span></span> <span data-ttu-id="1fc72-133">ストアド プロシージャを実行することによって、スキーマを取得するには、SELECT ステートメントは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-133">To retrieve the schema by executing the stored procedure, the SELECT statement looks like the following:</span></span>  
  
```  
SELECT [Employee_ID] ,[Name] ,[DOJ] ,[Designation] ,[Job_Description] ,[Photo] ,cast([Rating] as varchar(100)) as Rating ,[Salary] ,[Last_Modified] ,[Status] ,[Address]   
FROM [Adapt_Doc].[dbo].[Employee] for xml auto, xmlschema  
```  
  
 <span data-ttu-id="1fc72-134">応答メッセージのスキーマを取得するこのストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-134">Execute this stored procedure to get the schema for the response message.</span></span> <span data-ttu-id="1fc72-135">ストアド プロシージャからの応答には、ストアド プロシージャの実行からのデータと同様に、スキーマが含まれていることを注意してください。</span><span class="sxs-lookup"><span data-stu-id="1fc72-135">Note that the response from the stored procedure contains the schema as well as the data from executing the stored procedure.</span></span> <span data-ttu-id="1fc72-136">応答からスキーマをコピーし、テキスト パッドに保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-136">You must copy the schema from the response and save it to a text pad.</span></span> <span data-ttu-id="1fc72-137">この例では、名前を指定できますと、このスキーマ**ResponseSchema.xsd**です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-137">For this example, you can name this schema as **ResponseSchema.xsd**.</span></span> <span data-ttu-id="1fc72-138">BizTalk プロジェクトを作成する必要が今すぐ[!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)]し、このスキーマをプロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-138">You must now create a BizTalk project in [!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)] and add this schema to the project.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="1fc72-139">削除するかどうかを確認、`xmlschema`句のスキーマを生成するストアド プロシージャを実行した後です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-139">Make sure you remove the `xmlschema` clause after you have executed the stored procedure to generate the schema.</span></span> <span data-ttu-id="1fc72-140">失敗した場合に、最後に、BizTalk によってストアド プロシージャを実行するときに、応答メッセージのスキーマを再生成されます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-140">If you fail to do this, when you finally execute the stored procedure through BizTalk, you will again generate the schema in the response message.</span></span> <span data-ttu-id="1fc72-141">削除する必要があります xml として応答メッセージを取得する、`xmlschema`句。</span><span class="sxs-lookup"><span data-stu-id="1fc72-141">So, to get the response message as xml you must remove the `xmlschema` clause.</span></span>  
  
#### <a name="to-add-the-schema-to-a-biztalk-project"></a><span data-ttu-id="1fc72-142">BizTalk プロジェクトにスキーマを追加するには</span><span class="sxs-lookup"><span data-stu-id="1fc72-142">To add the schema to a BizTalk project</span></span>  
  
1.  <span data-ttu-id="1fc72-143">BizTalk プロジェクトを作成[!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-143">Create a BizTalk project in [!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)].</span></span>  
  
2.  <span data-ttu-id="1fc72-144">BizTalk プロジェクトにストアド プロシージャの生成、応答スキーマを追加します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-144">Add the response schema you generated for the stored procedure to the BizTalk project.</span></span> <span data-ttu-id="1fc72-145">ソリューション エクスプ ローラーで BizTalk プロジェクトを右クリックし、**追加**、クリックして**既存項目の**します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-145">Right-click the BizTalk project in the Solution Explorer, point to **Add**, and then click **Existing Item**.</span></span> <span data-ttu-id="1fc72-146">[既存項目の追加] ダイアログ ボックスをクリックして、スキーマを保存した場所に移動**追加**です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-146">In the Add Existing Item dialog box, navigate to the location where you saved the schema and click **Add**.</span></span>  
  
3.  <span data-ttu-id="1fc72-147">内のスキーマを開く[!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)]次の変更を加えます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-147">Open the schema in [!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)] and make the following changes.</span></span>  
  
    1.  <span data-ttu-id="1fc72-148">スキーマにノードを追加し、新しく追加されたこのノードの下の既存のルート ノードを移動します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-148">Add a node to the schema and move the existing root node under this newly added node.</span></span> <span data-ttu-id="1fc72-149">ルート ノードに名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-149">Give a name to the root node.</span></span> <span data-ttu-id="1fc72-150">このトピックの名前を変更するルート ノード**ルート**です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-150">For this topic, rename the root node to **Root**.</span></span>  
  
    2.  <span data-ttu-id="1fc72-151">ストアド プロシージャの生成、応答スキーマは、sqltypes.xsd を参照します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-151">The response schema generated for the stored procedure references a sqltypes.xsd.</span></span> <span data-ttu-id="1fc72-152">Sqltypes.xsd スキーマから取得できます[http://go.microsoft.com/fwlink/?LinkId=131087](http://go.microsoft.com/fwlink/?LinkId=131087)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-152">You can get the sqltypes.xsd schema from [http://go.microsoft.com/fwlink/?LinkId=131087](http://go.microsoft.com/fwlink/?LinkId=131087).</span></span> <span data-ttu-id="1fc72-153">Sqltypes.xsd スキーマを BizTalk プロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-153">Add the sqltypes.xsd schema to the BizTalk project.</span></span>  
  
    3.  <span data-ttu-id="1fc72-154">ストアド プロシージャの生成、スキーマ内の値を変更する`import schemaLocation`以下にします。</span><span class="sxs-lookup"><span data-stu-id="1fc72-154">In the schema generated for the stored procedure, change the value of `import schemaLocation` to the following.</span></span>  
  
        ```  
        import schemaLocation=”sqltypes.xsd”  
        ```  
  
         <span data-ttu-id="1fc72-155">これを行う sqltypes.xsd スキーマは、BizTalk プロジェクトに既に追加されたためです。</span><span class="sxs-lookup"><span data-stu-id="1fc72-155">You do this because you have already added the sqltypes.xsd schema to your BizTalk project.</span></span>  
  
    4.  <span data-ttu-id="1fc72-156">スキーマのターゲット名前空間を指定します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-156">Provide a target namespace for the schema.</span></span> <span data-ttu-id="1fc72-157">クリックして、 **\<スキーマ >**ノード、プロパティ ウィンドウで、名前空間を指定し、 **Target Namespace**プロパティ。</span><span class="sxs-lookup"><span data-stu-id="1fc72-157">Click the **\<Schema>** node, and in the properties pane, specify a namespace in the **Target Namespace** property.</span></span> <span data-ttu-id="1fc72-158">このトピックの付与と名前空間`http://ForXmlStoredProcs/namespace`です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-158">For this topic, give the namespace as `http://ForXmlStoredProcs/namespace`.</span></span>  
  
## <a name="generating-schema-for-the-request-message-to-invoke-the-stored-procedure"></a><span data-ttu-id="1fc72-159">ストアド プロシージャを呼び出す要求メッセージのスキーマを生成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-159">Generating Schema for the Request Message to Invoke the Stored Procedure</span></span>  
 <span data-ttu-id="1fc72-160">使用することが要求メッセージのスキーマを生成する、[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]で BizTalk プロジェクトから[!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-160">To generate schema for the request message you can use the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] from a BizTalk project in [!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)].</span></span> <span data-ttu-id="1fc72-161">このトピックでは、GET_EMP_DETAILS_FOR_XML ストアド プロシージャのスキーマを生成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-161">For this topic, generate the schema for the GET_EMP_DETAILS_FOR_XML stored procedure.</span></span> <span data-ttu-id="1fc72-162">使用してスキーマを生成する方法の詳細についての[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]を参照してください[SQL アダプターを使用して Visual Studio での SQL Server 操作のメタデータを取得する](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-162">For more information about how to generate the schema using [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)], see [Retrieving Metadata for SQL Server Operations in Visual Studio using the SQL adapter](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="1fc72-163">プロシージャからのみを選択して、スキーマを生成する必要があります、**プロシージャ**内のノード[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-163">You must generate the schema by selecting the procedure only from the **Procedures** node in [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>  
  
## <a name="defining-messages-and-message-types"></a><span data-ttu-id="1fc72-164">メッセージとメッセージの種類を定義します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-164">Defining Messages and Message Types</span></span>  
 <span data-ttu-id="1fc72-165">先に生成したスキーマは、オーケストレーションのメッセージに求められる "型" を記述します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-165">The schema that you generated earlier describes the “types” required for the messages in the orchestration.</span></span> <span data-ttu-id="1fc72-166">メッセージは、通常、対象の型が、対応するスキーマで定義されている、変数です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-166">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="1fc72-167">今すぐ、オーケストレーションのメッセージを作成して、前の手順で生成したスキーマにリンクします。</span><span class="sxs-lookup"><span data-stu-id="1fc72-167">You must now create messages for the orchestration, and link them to schemas that you generated in the previous step.</span></span>  
  
#### <a name="to-create-messages-and-link-to-schema"></a><span data-ttu-id="1fc72-168">メッセージを作成し、スキーマにリンクするには</span><span class="sxs-lookup"><span data-stu-id="1fc72-168">To create messages and link to schema</span></span>  
  
1.  <span data-ttu-id="1fc72-169">オーケストレーションを BizTalk プロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-169">Add an orchestration to the BizTalk project.</span></span> <span data-ttu-id="1fc72-170">ソリューション エクスプ ローラーで、BizTalk プロジェクト名を右クリックし、**追加**、クリックして**新しい項目の**します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-170">From Solution Explorer, right-click the BizTalk project name, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="1fc72-171">BizTalk オーケストレーションの名前を入力し、クリックして**追加**です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-171">Type a name for the BizTalk orchestration, and then click **Add**.</span></span>  
  
2.  <span data-ttu-id="1fc72-172">まだ開いていない場合は、BizTalk プロジェクトのオーケストレーションの種類 ウィンドウを開きます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-172">Open the Orchestration View window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="1fc72-173">これを行うには、をクリックして**ビュー**、 をポイント**その他のウィンドウ**、順にクリック**オーケストレーション ビュー**です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-173">To do so, click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  
  
3.  <span data-ttu-id="1fc72-174">オーケストレーション ビューで右クリック**メッセージ**、クリックして**新しいメッセージ**です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-174">In Orchestration View, right-click **Messages**, and then click **New Message**.</span></span>  
  
4.  <span data-ttu-id="1fc72-175">新しく作成されたメッセージを右クリックし [**プロパティ] ウィンドウ**します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-175">Right-click the newly created message, and then select **Properties Window**.</span></span>  
  
5.  <span data-ttu-id="1fc72-176">**プロパティ**のウィンドウ、 **Message_1**を次の操作します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-176">In the **Properties** pane for the **Message_1**, do the following:</span></span>  
  
    |<span data-ttu-id="1fc72-177">プロパティ</span><span class="sxs-lookup"><span data-stu-id="1fc72-177">Use this</span></span>|<span data-ttu-id="1fc72-178">目的</span><span class="sxs-lookup"><span data-stu-id="1fc72-178">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="1fc72-179">[Identifier]</span><span class="sxs-lookup"><span data-stu-id="1fc72-179">Identifier</span></span>|<span data-ttu-id="1fc72-180">「`Request`」と入力します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-180">Type `Request`</span></span>|  
    |<span data-ttu-id="1fc72-181">メッセージの種類</span><span class="sxs-lookup"><span data-stu-id="1fc72-181">Message Type</span></span>|<span data-ttu-id="1fc72-182">ドロップダウン リストから、展開**スキーマ**、し、 *ForXMLProcedure.Procedure_dbo です。GET_EMP_DETAILS_FOR_XML*ForXMLProcedure は、BizTalk プロジェクトの名前。</span><span class="sxs-lookup"><span data-stu-id="1fc72-182">From the drop-down list, expand **Schemas**, and then select *ForXMLProcedure.Procedure_dbo.GET_EMP_DETAILS_FOR_XML*, where ForXMLProcedure is the name of your BizTalk project.</span></span> <span data-ttu-id="1fc72-183">Procedure_dbo は GET_EMP_DETAILS_FOR_XML プロシージャを呼び出すことの生成スキーマです。</span><span class="sxs-lookup"><span data-stu-id="1fc72-183">Procedure_dbo is the schema generated for invoking the GET_EMP_DETAILS_FOR_XML procedure.</span></span>|  
  
6.  <span data-ttu-id="1fc72-184">新しいメッセージを作成する 2 の手順を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-184">Repeat step 2 to create a new message.</span></span> <span data-ttu-id="1fc72-185">**プロパティ**新しいメッセージ ウィンドウ、次の操作します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-185">In the **Properties** pane for the new message, do the following:</span></span>  
  
    |<span data-ttu-id="1fc72-186">プロパティ</span><span class="sxs-lookup"><span data-stu-id="1fc72-186">Use this</span></span>|<span data-ttu-id="1fc72-187">目的</span><span class="sxs-lookup"><span data-stu-id="1fc72-187">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="1fc72-188">[Identifier]</span><span class="sxs-lookup"><span data-stu-id="1fc72-188">Identifier</span></span>|<span data-ttu-id="1fc72-189">「`Response`」と入力します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-189">Type `Response`</span></span>|  
    |<span data-ttu-id="1fc72-190">メッセージの種類</span><span class="sxs-lookup"><span data-stu-id="1fc72-190">Message Type</span></span>|<span data-ttu-id="1fc72-191">ドロップダウン リストから、展開**スキーマ**、し、 *ForXMLProcedure.ResponseSchema*ResponseSchema としてストアド プロシージャを実行することによって生成される応答スキーマの名前下に説明[ストアド プロシージャ用の応答メッセージのスキーマを生成する](#BKMK_RespSchema)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-191">From the drop-down list, expand **Schemas**, and then select *ForXMLProcedure.ResponseSchema*, where ResponseSchema is the name of the response schema generated by executing the stored procedure as described under [Generating Schema for the Response Message for Stored Procedure](#BKMK_RespSchema).</span></span>|  
  
## <a name="setting-up-the-orchestration"></a><span data-ttu-id="1fc72-192">オーケストレーションを設定します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-192">Setting up the Orchestration</span></span>  
 <span data-ttu-id="1fc72-193">使用する BizTalk オーケストレーションを作成する必要があります[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]の SQL Server のストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-193">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for executing a stored procedure in SQL Server.</span></span> <span data-ttu-id="1fc72-194">このオーケストレーションでの要求メッセージを削除する受信場所が、定義されています。</span><span class="sxs-lookup"><span data-stu-id="1fc72-194">In this orchestration, you drop a request message at a defined receive location.</span></span> <span data-ttu-id="1fc72-195">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]このメッセージを消費し、SQL Server に渡します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-195">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] consumes this message and passes it on to SQL Server.</span></span> <span data-ttu-id="1fc72-196">SQL Server からの応答は、別の場所に保存されます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-196">The response from SQL Server is saved to another location.</span></span> <span data-ttu-id="1fc72-197">送信を含めるし、受信図形を SQL Server にメッセージを送信し、それぞれ、応答を受信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-197">You must include Send and Receive shapes to send messages to SQL Server and receive responses, respectively.</span></span> <span data-ttu-id="1fc72-198">プロシージャを呼び出すためのサンプル オーケストレーションには、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-198">A sample orchestration for invoking a procedure resembles the following:</span></span>  
  
 <span data-ttu-id="1fc72-199">![ストアド プロシージャを呼び出すオーケストレーション](../../adapters-and-accelerators/adapter-sql/media/eac6e8b6-f0f4-44af-8218-03ca3864b267.gif "eac6e8b6-f0f4-44af-8218-03ca3864b267")</span><span class="sxs-lookup"><span data-stu-id="1fc72-199">![Orchestration to invoke stored procedures](../../adapters-and-accelerators/adapter-sql/media/eac6e8b6-f0f4-44af-8218-03ca3864b267.gif "eac6e8b6-f0f4-44af-8218-03ca3864b267")</span></span>  
  
### <a name="adding-message-shapes"></a><span data-ttu-id="1fc72-200">メッセージの構築図形を追加します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-200">Adding Message Shapes</span></span>  
 <span data-ttu-id="1fc72-201">メッセージの構築図形のごとに、次のプロパティを指定することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="1fc72-201">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="1fc72-202">図形 列に表示名は、単に記載されているオーケストレーションに表示されるメッセージの構築図形の名前です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-202">The names listed in the Shape column are the names of the message shapes as displayed in the just-mentioned orchestration.</span></span>  
  
|<span data-ttu-id="1fc72-203">図形</span><span class="sxs-lookup"><span data-stu-id="1fc72-203">Shape</span></span>|<span data-ttu-id="1fc72-204">図形の種類</span><span class="sxs-lookup"><span data-stu-id="1fc72-204">Shape Type</span></span>|<span data-ttu-id="1fc72-205">[プロパティ]</span><span class="sxs-lookup"><span data-stu-id="1fc72-205">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="1fc72-206">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="1fc72-206">ReceiveMessage</span></span>|<span data-ttu-id="1fc72-207">Receive</span><span class="sxs-lookup"><span data-stu-id="1fc72-207">Receive</span></span>|<span data-ttu-id="1fc72-208">-設定**名前**に*ReceiveMessage*</span><span class="sxs-lookup"><span data-stu-id="1fc72-208">-   Set **Name** to *ReceiveMessage*</span></span><br /><span data-ttu-id="1fc72-209">-設定**アクティブ**に*は True。*</span><span class="sxs-lookup"><span data-stu-id="1fc72-209">-   Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="1fc72-210">SendMessage</span><span class="sxs-lookup"><span data-stu-id="1fc72-210">SendMessage</span></span>|<span data-ttu-id="1fc72-211">Send</span><span class="sxs-lookup"><span data-stu-id="1fc72-211">Send</span></span>|<span data-ttu-id="1fc72-212">-設定**名前**に*SendMessage*</span><span class="sxs-lookup"><span data-stu-id="1fc72-212">-   Set **Name** to *SendMessage*</span></span>|  
|<span data-ttu-id="1fc72-213">ReceiveResponse</span><span class="sxs-lookup"><span data-stu-id="1fc72-213">ReceiveResponse</span></span>|<span data-ttu-id="1fc72-214">Receive</span><span class="sxs-lookup"><span data-stu-id="1fc72-214">Receive</span></span>|<span data-ttu-id="1fc72-215">-設定**名前**に*ReceiveResponse*</span><span class="sxs-lookup"><span data-stu-id="1fc72-215">-   Set **Name** to *ReceiveResponse*</span></span><br /><span data-ttu-id="1fc72-216">-設定**アクティブ**に*False*</span><span class="sxs-lookup"><span data-stu-id="1fc72-216">-   Set **Activate** to *False*</span></span>|  
|<span data-ttu-id="1fc72-217">SendResponse</span><span class="sxs-lookup"><span data-stu-id="1fc72-217">SendResponse</span></span>|<span data-ttu-id="1fc72-218">Send</span><span class="sxs-lookup"><span data-stu-id="1fc72-218">Send</span></span>|<span data-ttu-id="1fc72-219">-設定**名前**に*SendResponse*</span><span class="sxs-lookup"><span data-stu-id="1fc72-219">-   Set **Name** to *SendResponse*</span></span>|  
  
### <a name="adding-ports"></a><span data-ttu-id="1fc72-220">ポートの追加</span><span class="sxs-lookup"><span data-stu-id="1fc72-220">Adding Ports</span></span>  
 <span data-ttu-id="1fc72-221">論理ポートごとに、次のプロパティを指定することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="1fc72-221">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="1fc72-222">ポート列に表示される名前は、オーケストレーションで表示されているポートの名前です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-222">The names listed in the Port column are the names of the ports as displayed in the orchestration.</span></span>  
  
|<span data-ttu-id="1fc72-223">ポート</span><span class="sxs-lookup"><span data-stu-id="1fc72-223">Port</span></span>|<span data-ttu-id="1fc72-224">[プロパティ]</span><span class="sxs-lookup"><span data-stu-id="1fc72-224">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="1fc72-225">MessageIn</span><span class="sxs-lookup"><span data-stu-id="1fc72-225">MessageIn</span></span>|<span data-ttu-id="1fc72-226">-設定**識別子**に*MessageIn*</span><span class="sxs-lookup"><span data-stu-id="1fc72-226">-   Set **Identifier** to *MessageIn*</span></span><br /><span data-ttu-id="1fc72-227">-設定**型**に*MessageInType*</span><span class="sxs-lookup"><span data-stu-id="1fc72-227">-   Set **Type** to *MessageInType*</span></span><br /><span data-ttu-id="1fc72-228">-設定**通信パターン**に*一方向*</span><span class="sxs-lookup"><span data-stu-id="1fc72-228">-   Set **Communication Pattern** to *One-Way*</span></span><br /><span data-ttu-id="1fc72-229">-設定**通信方向**に*受信*</span><span class="sxs-lookup"><span data-stu-id="1fc72-229">-   Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="1fc72-230">LOBPort</span><span class="sxs-lookup"><span data-stu-id="1fc72-230">LOBPort</span></span>|<span data-ttu-id="1fc72-231">-設定**識別子**に*LOBPort*</span><span class="sxs-lookup"><span data-stu-id="1fc72-231">-   Set **Identifier** to *LOBPort*</span></span><br /><span data-ttu-id="1fc72-232">-設定**型**に*LOBPortType*</span><span class="sxs-lookup"><span data-stu-id="1fc72-232">-   Set **Type** to *LOBPortType*</span></span><br /><span data-ttu-id="1fc72-233">-設定**通信パターン**に*要求-応答*</span><span class="sxs-lookup"><span data-stu-id="1fc72-233">-   Set **Communication Pattern** to *Request-Response*</span></span><br /><span data-ttu-id="1fc72-234">-設定**通信方向**に*送受信*</span><span class="sxs-lookup"><span data-stu-id="1fc72-234">-   Set **Communication Direction** to *Send-Receive*</span></span>|  
|<span data-ttu-id="1fc72-235">ResponseOut</span><span class="sxs-lookup"><span data-stu-id="1fc72-235">ResponseOut</span></span>|<span data-ttu-id="1fc72-236">-設定**識別子**に*ResponseOut*</span><span class="sxs-lookup"><span data-stu-id="1fc72-236">-   Set **Identifier** to *ResponseOut*</span></span><br /><span data-ttu-id="1fc72-237">-設定**型**に*ResponseOutType*</span><span class="sxs-lookup"><span data-stu-id="1fc72-237">-   Set **Type** to *ResponseOutType*</span></span><br /><span data-ttu-id="1fc72-238">-設定**通信パターン**に*一方向*</span><span class="sxs-lookup"><span data-stu-id="1fc72-238">-   Set **Communication Pattern** to *One-Way*</span></span><br /><span data-ttu-id="1fc72-239">-設定**通信方向**に*送信*</span><span class="sxs-lookup"><span data-stu-id="1fc72-239">-   Set **Communication Direction** to *Send*</span></span>|  
  
### <a name="specify-messages-for-action-shapes-and-connect-them-to-ports"></a><span data-ttu-id="1fc72-240">アクション図形のメッセージを指定して、ポートへの接続</span><span class="sxs-lookup"><span data-stu-id="1fc72-240">Specify Messages for Action Shapes, and Connect Them to Ports</span></span>  
 <span data-ttu-id="1fc72-241">次の表は、プロパティとアクション図形のメッセージを指定して、メッセージ、ポートにリンクを設定する必要があります、値を指定します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-241">The following table specifies the properties and their values that you should set to specify messages for action shapes and to link the messages to the ports.</span></span> <span data-ttu-id="1fc72-242">図形 列に表示名は、既に説明したオーケストレーションに表示されるメッセージの構築図形の名前です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-242">The names listed in the Shape column are the names of the message shapes as displayed in the orchestration mentioned earlier.</span></span>  
  
|<span data-ttu-id="1fc72-243">図形</span><span class="sxs-lookup"><span data-stu-id="1fc72-243">Shape</span></span>|<span data-ttu-id="1fc72-244">[プロパティ]</span><span class="sxs-lookup"><span data-stu-id="1fc72-244">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="1fc72-245">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="1fc72-245">ReceiveMessage</span></span>|<span data-ttu-id="1fc72-246">-設定**メッセージ**に*要求*</span><span class="sxs-lookup"><span data-stu-id="1fc72-246">-   Set **Message** to *Request*</span></span><br /><span data-ttu-id="1fc72-247">-設定**操作**に*MessageIn.FOR_XML です。要求*</span><span class="sxs-lookup"><span data-stu-id="1fc72-247">-   Set **Operation** to *MessageIn.FOR_XML.Request*</span></span>|  
|<span data-ttu-id="1fc72-248">SendMessage</span><span class="sxs-lookup"><span data-stu-id="1fc72-248">SendMessage</span></span>|<span data-ttu-id="1fc72-249">-設定**メッセージ**に*要求*</span><span class="sxs-lookup"><span data-stu-id="1fc72-249">-   Set **Message** to *Request*</span></span><br /><span data-ttu-id="1fc72-250">-設定**操作**に*LOBPort.FOR_XML です。要求*</span><span class="sxs-lookup"><span data-stu-id="1fc72-250">-   Set **Operation** to *LOBPort.FOR_XML.Request*</span></span>|  
|<span data-ttu-id="1fc72-251">ReceiveResponse</span><span class="sxs-lookup"><span data-stu-id="1fc72-251">ReceiveResponse</span></span>|<span data-ttu-id="1fc72-252">-設定**メッセージ**に*応答*</span><span class="sxs-lookup"><span data-stu-id="1fc72-252">-   Set **Message** to *Response*</span></span><br /><span data-ttu-id="1fc72-253">-設定**操作**に*LOBPort.FOR_XML です。応答*</span><span class="sxs-lookup"><span data-stu-id="1fc72-253">-   Set **Operation** to *LOBPort.FOR_XML.Response*</span></span>|  
|<span data-ttu-id="1fc72-254">SendResponse</span><span class="sxs-lookup"><span data-stu-id="1fc72-254">SendResponse</span></span>|<span data-ttu-id="1fc72-255">-設定**メッセージ**に*応答*</span><span class="sxs-lookup"><span data-stu-id="1fc72-255">-   Set **Message** to *Response*</span></span><br /><span data-ttu-id="1fc72-256">-設定**操作**に*ResponseOut.FOR_XML です。要求*</span><span class="sxs-lookup"><span data-stu-id="1fc72-256">-   Set **Operation** to *ResponseOut.FOR_XML.Request*</span></span>|  
  
 <span data-ttu-id="1fc72-257">これらのプロパティを指定した後、メッセージの構築図形とポートが接続されているし、オーケストレーションが完了します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-257">After you have specified these properties, the message shapes and ports are connected and your orchestration is complete.</span></span>  
  
 <span data-ttu-id="1fc72-258">今すぐ BizTalk ソリューションをビルドしに配置する必要があります、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-258">You must now build the BizTalk solution and deploy it to a [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="1fc72-259">詳細については、次を参照してください。[のビルドおよび実行されているオーケストレーション](../../core/building-and-running-orchestrations.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-259">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md).</span></span>
  
## <a name="configuring-the-biztalk-application"></a><span data-ttu-id="1fc72-260">BizTalk アプリケーションを構成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-260">Configuring the BizTalk Application</span></span>  
 <span data-ttu-id="1fc72-261">[オーケストレーション] ペインで以前に作成したオーケストレーションが表示されている BizTalk プロジェクトを配置した後、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理コンソールです。</span><span class="sxs-lookup"><span data-stu-id="1fc72-261">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the Orchestrations pane in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="1fc72-262">使用する必要があります、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理コンソール アプリケーションを構成します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-262">You must use the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console to configure the application.</span></span> <span data-ttu-id="1fc72-263">チュートリアルについては、次を参照してください。[チュートリアル: 基本的な BizTalk アプリケーションの展開](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-263">For a walkthrough, see [Walkthrough: Deploying a Basic BizTalk Application](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span></span>
  
 <span data-ttu-id="1fc72-264">アプリケーションの構成が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-264">Configuring an application involves:</span></span>  
  
-   <span data-ttu-id="1fc72-265">アプリケーションのホストを選択します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-265">Selecting a host for the application.</span></span>  
  
-   <span data-ttu-id="1fc72-266">物理ポートにオーケストレーションで作成したポートのマッピング、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理コンソールです。</span><span class="sxs-lookup"><span data-stu-id="1fc72-266">Mapping the ports that you created in your orchestration to physical ports in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="1fc72-267">このオーケストレーションの次の操作を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-267">For this orchestration you must:</span></span>  
  
    -   <span data-ttu-id="1fc72-268">ハード ディスクと、要求メッセージをドロップする場所、対応するファイル ポート上の場所を定義します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-268">Define a location on the hard disk and a corresponding file port where you will drop a request message.</span></span> <span data-ttu-id="1fc72-269">BizTalk オーケストレーションは、要求メッセージを消費し、SQL Server データベースに送信します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-269">The BizTalk orchestration will consume the request message and send it to SQL Server database.</span></span>  
  
    -   <span data-ttu-id="1fc72-270">ハード ディスクと、対応する file ポートを BizTalk オーケストレーションが SQL Server データベースからの応答を含む応答メッセージをドロップする場所に場所を定義します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-270">Define a location on the hard disk and a corresponding file port where the BizTalk orchestration will drop the response message containing the response from SQL Server database.</span></span>  
  
    -   <span data-ttu-id="1fc72-271">SQL Server データベースにメッセージを送信する物理 Wcf-custom または WCF-SQL 送信ポートを定義します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-271">Define a physical WCF-Custom or WCF-SQL send port to send messages to SQL Server database.</span></span> <span data-ttu-id="1fc72-272">送信ポートを作成する方法については、次を参照してください。 [SQL アダプターを物理ポートのバインドを手動で構成](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-272">For instructions on how to create a send port, see [Manually configure a physical port binding to the SQL adapter](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md).</span></span>
  
         <span data-ttu-id="1fc72-273">送信ポートでアクションを指定することもあります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-273">You must also specify the action in the send port.</span></span> <span data-ttu-id="1fc72-274">FOR XML 句を含む手順では、次の形式でアクションを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-274">For procedures that contain the FOR XML clause, you must set the action in the following format.</span></span>  
  
        ```  
        XmlProcedure/<schema_name>/<procedure_name>  
        ```  
  
         <span data-ttu-id="1fc72-275">そのため、GET_EMP_DETAILS_FOR_XML プロシージャを実行して、このトピックのアクションになります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-275">So, for this topic where we are executing the GET_EMP_DETAILS_FOR_XML procedure, the action will be:</span></span>  
  
        ```  
        XmlProcedure/dbo/GET_EMP_DETAILS_FOR_XML  
        ```  
  
         <span data-ttu-id="1fc72-276">設定アクションの詳細については、次を参照してください。 [SQL アダプタの SOAP アクションを構成する](../../adapters-and-accelerators/adapter-sql/configure-the-soap-action-for-the-sql-adapter.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-276">For more information about setting action, see [Configure the SOAP action for the SQL adapter ](../../adapters-and-accelerators/adapter-sql/configure-the-soap-action-for-the-sql-adapter.md).</span></span>
  
         <span data-ttu-id="1fc72-277">FOR XML 句を使用してストアド プロシージャを実行するときに、次のバインド プロパティを設定することもあります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-277">You must also set the following binding properties when executing a stored procedure with the FOR XML clause.</span></span>  
  
        |<span data-ttu-id="1fc72-278">バインディングのプロパティ名</span><span class="sxs-lookup"><span data-stu-id="1fc72-278">Binding property name</span></span>|<span data-ttu-id="1fc72-279">これを設定します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-279">Set this to</span></span>|  
        |---------------------------|-----------------|  
        |<span data-ttu-id="1fc72-280">XmlStoredProcedureRootNodeName</span><span class="sxs-lookup"><span data-stu-id="1fc72-280">XmlStoredProcedureRootNodeName</span></span>|<span data-ttu-id="1fc72-281">下の説明に従って、ストアド プロシージャの生成、応答スキーマに追加したルート ノードの名前を指定[ストアド プロシージャ用の応答メッセージのスキーマを生成する](#BKMK_RespSchema)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-281">Specify the name of the root node that you added to the response schema you generated for the stored procedure, as described under [Generating Schema for the Response Message for Stored Procedure](#BKMK_RespSchema).</span></span> <span data-ttu-id="1fc72-282">このトピックのこれを設定**ルート**です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-282">For this topic, set this to **Root**.</span></span>|  
        |<span data-ttu-id="1fc72-283">XmlStoredProcedureRootNodeNamespace</span><span class="sxs-lookup"><span data-stu-id="1fc72-283">XmlStoredProcedureRootNodeNamespace</span></span>|<span data-ttu-id="1fc72-284">下の説明に従って、ストアド プロシージャの生成、応答スキーマのターゲット名前空間を指定[ストアド プロシージャ用の応答メッセージのスキーマを生成する](#BKMK_RespSchema)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-284">Specify the target namespace for the response schema you generated for the stored procedure, as described under [Generating Schema for the Response Message for Stored Procedure](#BKMK_RespSchema).</span></span> <span data-ttu-id="1fc72-285">このトピックのこれを設定`http://ForXmlStoredProcs/namespace`です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-285">For this topic, set this to `http://ForXmlStoredProcs/namespace`.</span></span>|  
  
         <span data-ttu-id="1fc72-286">バインドのプロパティの値を指定する方法の詳細については、次を参照してください。 [SQL アダプターのバインドのプロパティを構成する](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-286">For more information about specifying values for binding properties, see [Configure the binding properties for the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md).</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="1fc72-287">使用してスキーマを生成する、[!INCLUDE[consumeadapterservlong](../../includes/consumeadapterservlong-md.md)]ポートとそれらのポートに設定するアクションに関する情報を含むバインド ファイルも作成されます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-287">Generating the schema using the [!INCLUDE[consumeadapterservlong](../../includes/consumeadapterservlong-md.md)] also creates a binding file that contains information about the ports and the actions to be set for those ports.</span></span> <span data-ttu-id="1fc72-288">このバインド ファイルをインポートすることができます、 [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] (着信) の受信ポートを (発信) の送信ポートを作成または管理コンソールです。</span><span class="sxs-lookup"><span data-stu-id="1fc72-288">You can import this binding file from the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console to create send ports (for outbound calls) or receive ports (for inbound calls).</span></span> <span data-ttu-id="1fc72-289">詳細については、次を参照してください。 [SQL アダプターを使用するポートのバインド ファイルを使用する物理ポートのバインドを構成する](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-289">For more information, see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>
  
## <a name="starting-the-application"></a><span data-ttu-id="1fc72-290">アプリケーションの起動</span><span class="sxs-lookup"><span data-stu-id="1fc72-290">Starting the Application</span></span>  
 <span data-ttu-id="1fc72-291">SQL Server データベースでプロシージャを呼び出す BizTalk アプリケーションを開始する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1fc72-291">You must start the BizTalk application for invoking procedures in SQL Server database.</span></span> <span data-ttu-id="1fc72-292">BizTalk アプリケーションの起動方法の詳細については、次を参照してください。[オーケストレーションを開始する方法](../../core/how-to-start-an-orchestration.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-292">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md).</span></span>
  
 <span data-ttu-id="1fc72-293">この段階で確認します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-293">At this stage, make sure:</span></span>  
  
-   <span data-ttu-id="1fc72-294">ファイルは、オーケストレーションが実行中の要求メッセージを受信するポートを受信します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-294">The FILE receive port to receive request messages for the orchestration is running.</span></span>  
  
-   <span data-ttu-id="1fc72-295">オーケストレーションから応答メッセージを受信する FILE 送信ポートが実行されています。</span><span class="sxs-lookup"><span data-stu-id="1fc72-295">The FILE send port to receive the response messages from the orchestration is running.</span></span>  
  
-   <span data-ttu-id="1fc72-296">SQL Server データベースにメッセージを送信する Wcf-custom または WCF-SQL 送信ポートが実行されています。</span><span class="sxs-lookup"><span data-stu-id="1fc72-296">The WCF-Custom or WCF-SQL send port to send messages to SQL Server database is running.</span></span>  
  
-   <span data-ttu-id="1fc72-297">操作の BizTalk オーケストレーションが実行されています。</span><span class="sxs-lookup"><span data-stu-id="1fc72-297">The BizTalk orchestration for the operation is running.</span></span>  
  
## <a name="executing-the-operation"></a><span data-ttu-id="1fc72-298">操作の実行</span><span class="sxs-lookup"><span data-stu-id="1fc72-298">Executing the Operation</span></span>  
 <span data-ttu-id="1fc72-299">アプリケーションを実行した後、ファイルに要求メッセージをドロップする必要がありますの受信場所。</span><span class="sxs-lookup"><span data-stu-id="1fc72-299">After you run the application, you must drop a request message to the FILE receive location.</span></span> <span data-ttu-id="1fc72-300">要求メッセージのスキーマを使用して生成する手順については、要求スキーマに従う必要があります、[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-300">The schema for the request message must conform to the request schema for the procedure you generated using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="1fc72-301">たとえばを呼び出す GET_EMP_DETAILS_FOR XML 要求メッセージには。</span><span class="sxs-lookup"><span data-stu-id="1fc72-301">For example, the request message to invoke the GET_EMP_DETAILS_FOR XML is:</span></span>  
  
```  
<GET_EMP_DETAILS_FOR_XML xmlns="http://schemas.microsoft.com/Sql/2008/05/Procedures/dbo">  
  <emp_id>10765</emp_id>  
</GET_EMP_DETAILS_FOR_XML>  
```  
  
 <span data-ttu-id="1fc72-302">参照してください[プロシージャと関数のメッセージ スキーマを](../../adapters-and-accelerators/adapter-sql/message-schemas-for-procedures-and-functions.md)を使用して、データベースの SQL Server でプロシージャを呼び出すための要求メッセージ スキーマの詳細については、[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-302">See [Message Schemas for Procedures and Functions](../../adapters-and-accelerators/adapter-sql/message-schemas-for-procedures-and-functions.md) for more information about the request message schema for invoking procedures in SQL Server database using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span>  
  
 <span data-ttu-id="1fc72-303">オーケストレーションはメッセージを使用して、SQL Server データベースに送信します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-303">The orchestration consumes the message and sends it to SQL Server database.</span></span> <span data-ttu-id="1fc72-304">SQL Server データベースからの応答は、オーケストレーションの一部として定義されているその他のファイルの場所に保存されます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-304">The response from SQL Server database is saved at the other FILE location defined as part of the orchestration.</span></span> <span data-ttu-id="1fc72-305">たとえば、上記の要求メッセージ用の SQL Server データベースからの応答には。</span><span class="sxs-lookup"><span data-stu-id="1fc72-305">For example, the response from SQL Server database for the preceding request message is:</span></span>  
  
```  
\<?xml version="1.0" encoding="utf-8"?>  
<Root xmlns="http://ForXmlStoredProcs/namespace">  
  \<Adapt_Doc.dbo.Employee Employee_ID="10765" Name="John" Designation="asdfaf" Salary="3434.00" Last_Modified="AAAAAAAANso=" Status="0" xmlns="" />  
</Root>  
```  
  
 <span data-ttu-id="1fc72-306">ストアド プロシージャを実行することによって生成されたものと、同じスキーマで、応答を受信したことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1fc72-306">Notice that the response is received in the same schema as generated by executing the stored procedure.</span></span> <span data-ttu-id="1fc72-307">ルート ノードと名前空間は、の値として指定したものと同じであるにも注意してください**XmlStoredProcedureRootNodeName**と**XmlStoredProcedureRootNodeNamespace**それぞれのプロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="1fc72-307">Also note that the root node and the namespace is the same you specified as values for **XmlStoredProcedureRootNodeName** and **XmlStoredProcedureRootNodeNamespace** binding properties respectively.</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="1fc72-308">ベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="1fc72-308">Best Practices</span></span>  
 <span data-ttu-id="1fc72-309">展開して、BizTalk プロジェクトを構成することが後、は、バインド ファイルと呼ばれる XML ファイルに構成設定をエクスポートできます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-309">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the binding file.</span></span> <span data-ttu-id="1fc72-310">バインド ファイルを生成したできるように、送信ポートなどの項目を作成し、同じオーケストレーション用のポートを受信する必要はありません、ファイルから構成設定をインポートすることができます。</span><span class="sxs-lookup"><span data-stu-id="1fc72-310">Once you generate a binding file, you can import the configuration settings from the file, so that you do not need to create items such as send ports and receive ports for the same orchestration.</span></span> <span data-ttu-id="1fc72-311">バインド ファイルの詳細については、次を参照してください。[アダプターのバインドを再利用](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md)です。</span><span class="sxs-lookup"><span data-stu-id="1fc72-311">For more information about binding files, see [Reuse adapter bindings](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1fc72-312">参照</span><span class="sxs-lookup"><span data-stu-id="1fc72-312">See Also</span></span>  
[<span data-ttu-id="1fc72-313">SQL アダプターを使用して BizTalk アプリケーションを開発します。</span><span class="sxs-lookup"><span data-stu-id="1fc72-313">Develop BizTalk applications using the SQL adapter</span></span>](../../adapters-and-accelerators/adapter-sql/develop-biztalk-applications-using-the-sql-adapter.md)