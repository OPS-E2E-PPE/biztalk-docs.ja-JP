---
title: SQL アダプターを使用して SQL Server でストアド プロシージャを実行 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 245626a7-f546-4aca-90df-c0579139a872
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 65a475d8de1fc30df2e06923ad14bcba0897159e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22224058"
---
# <a name="execute-stored-procedures-in-sql-server-using-the-sql-adapter"></a><span data-ttu-id="7c78e-102">SQL アダプターを使用して SQL Server でのストアド プロシージャの実行します。</span><span class="sxs-lookup"><span data-stu-id="7c78e-102">Execute Stored Procedures in SQL Server using the SQL adapter</span></span>
<span data-ttu-id="7c78e-103">Transact SQL と CLR ストアド プロシージャの SQL Server での操作として表示された[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]下にある、**プロシージャ**ノードを使用しているときに、[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]または[!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-103">The Transact-SQL and CLR stored procedures in SQL Server are surfaced as operations in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)] under the **Procedures** node while using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] or [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)].</span></span> <span data-ttu-id="7c78e-104">によって公開される操作名、 [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] SQL Server のストアド プロシージャの名前と同じです。</span><span class="sxs-lookup"><span data-stu-id="7c78e-104">The operation names exposed by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] are the same as the name of the stored procedure in SQL Server.</span></span> <span data-ttu-id="7c78e-105">ストアド プロシージャ内のすべてのパラメーターは、対応する操作で公開されます。</span><span class="sxs-lookup"><span data-stu-id="7c78e-105">All the parameters in the stored procedure are exposed in the corresponding operation.</span></span> <span data-ttu-id="7c78e-106">OUT パラメーターには、ストアド プロシージャの戻り値が含まれています。</span><span class="sxs-lookup"><span data-stu-id="7c78e-106">The OUT parameter contains the return value of the stored procedure.</span></span> <span data-ttu-id="7c78e-107">ストアド プロシージャの結果セットは、データセットの配列です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-107">The result set of the stored procedure is an array of DataSet.</span></span> <span data-ttu-id="7c78e-108">データセットの詳細については、次を参照してください。 [http://go.microsoft.com/fwlink/?LinkId=196853](http://go.microsoft.com/fwlink/?LinkId=196853)です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-108">For more information about DataSet, see [http://go.microsoft.com/fwlink/?LinkId=196853](http://go.microsoft.com/fwlink/?LinkId=196853).</span></span> <span data-ttu-id="7c78e-109">ターゲット オブジェクトのスキーマ情報は、実行時に、応答メッセージの一部として取得されます。</span><span class="sxs-lookup"><span data-stu-id="7c78e-109">The schema information of the target object is obtained as part of the response message at run time.</span></span>  
  
 <span data-ttu-id="7c78e-110">ただし、デザイン時にターゲット オブジェクトのスキーマ情報を取得する場合は、プロシージャのスキーマを生成する必要があります、 **Strongly-Typed プロシージャ**内のノード、[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]または[!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-110">However, if you want to obtain the schema information of the target object at design time, you must generate schemas for the procedures under the **Strongly-Typed Procedures** node in the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] or [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)].</span></span> <span data-ttu-id="7c78e-111">同じストアド プロシージャが下に表示されたに注意してください、**プロシージャ**と**Strongly-Typed プロシージャ**ノード。</span><span class="sxs-lookup"><span data-stu-id="7c78e-111">Note that the same stored procedures are surfaced under the **Procedures** and the **Strongly-Typed Procedures** node.</span></span> <span data-ttu-id="7c78e-112">ストアド プロシージャの戻り値は厳密に型指定とだけでなくデータセットの配列。</span><span class="sxs-lookup"><span data-stu-id="7c78e-112">The return value of the stored procedure is strongly typed, and not just an array of DataSet.</span></span> <span data-ttu-id="7c78e-113">デザイン時に、スキーマ情報が利用できるようには、ストアド プロシージャのスキーマを別の操作を別のスキーマにマップを使用できます。</span><span class="sxs-lookup"><span data-stu-id="7c78e-113">As the schema information is available at the design time, you can use it to map the schema of the stored procedure to another schema for a different operation.</span></span> <span data-ttu-id="7c78e-114">たとえば、データベース テーブルに対する挿入操作の生成スキーマを厳密に型指定されたプロシージャの生成スキーマをマップできます。</span><span class="sxs-lookup"><span data-stu-id="7c78e-114">For example, you can map the schema generated for a strongly-typed procedure to the schema generated for the Insert operation on a database table.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7c78e-115">場合、厳密に型指定されたストアド プロシージャのデザイン時にスキーマ情報を表示することはできません。</span><span class="sxs-lookup"><span data-stu-id="7c78e-115">You will not be able to view the schema information at design time for a strongly-typed stored procedure if:</span></span>  
>   
>  -   <span data-ttu-id="7c78e-116">厳密に型指定されたストアド プロシージャの入力パラメーターとして別のストアド プロシージャの戻り値であるカーソルを使用しています。</span><span class="sxs-lookup"><span data-stu-id="7c78e-116">You are using a cursor, which is a return value of another stored procedure, as the input parameter for the strongly-typed stored procedure.</span></span>  
> -   <span data-ttu-id="7c78e-117">CLR ストアド プロシージャ、テーブルに対して何らかの操作を実行することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="7c78e-117">It is a CLR stored procedure that performs some operations on a table.</span></span>  
  
## <a name="support-for-stored-procedures-with-for-xml-clause"></a><span data-ttu-id="7c78e-118">FOR XML 句を含むストアド プロシージャのサポート</span><span class="sxs-lookup"><span data-stu-id="7c78e-118">Support for Stored Procedures with FOR XML Clause</span></span>  
 <span data-ttu-id="7c78e-119">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]を FOR XML 句を伴う SELECT ステートメントを持つストアド プロシージャを実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="7c78e-119">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] also enables you to execute stored procedures that have a SELECT statement with a FOR XML clause.</span></span> <span data-ttu-id="7c78e-120">行セットではなく XML として結果を返す SELECT ステートメントで FOR XML 句を使用するとします。</span><span class="sxs-lookup"><span data-stu-id="7c78e-120">A FOR XML clause is used in a SELECT statement to return the results as XML instead of a rowset.</span></span> <span data-ttu-id="7c78e-121">FOR XML 句の詳細については、次を参照してください。 [http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402)です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-121">For more information about the FOR XML clause, see [http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7c78e-122">「ネイティブ」[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]で利用可能な[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]サポート XML を返すプロシージャが格納されているもののみつまり、ある FOR XML 句、SELECT ステートメントでします。</span><span class="sxs-lookup"><span data-stu-id="7c78e-122">The “native” [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] available with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] supports only those stored procedures that return XML, that is, have the FOR XML clause in the SELECT statement.</span></span> <span data-ttu-id="7c78e-123">FOR XML 句を使用してストアド プロシージャのサポート、WCF ベースを使用してこれらのストアド プロシージャを実行できる[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]ストアド プロシージャの定義に変更を加えずにします。</span><span class="sxs-lookup"><span data-stu-id="7c78e-123">With the support for stored procedures with FOR XML clause, you can execute these stored procedures using the WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] without making any changes to the stored procedure definition.</span></span>  
  
## <a name="support-for-stored-procedures-with-temporary-tables"></a><span data-ttu-id="7c78e-124">一時テーブルを持つストアド プロシージャのサポート</span><span class="sxs-lookup"><span data-stu-id="7c78e-124">Support for Stored Procedures with Temporary Tables</span></span>  
 <span data-ttu-id="7c78e-125">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]をその定義内の一時テーブルを含むストアド プロシージャのメタデータを生成することができます。</span><span class="sxs-lookup"><span data-stu-id="7c78e-125">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] enables you to generate metadata for stored procedures that contain temporary tables in their definitions.</span></span> <span data-ttu-id="7c78e-126">ただし、このようなストアド プロシージャの必要がありますを生成するメタデータをストアド プロシージャからのみを選択すると、**プロシージャ**を使用しているときに、ノード、[!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)]または[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-126">However, for such stored procedures you must generate metadata by selecting the stored procedures only from the **Procedures** node, while using the [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] or [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="7c78e-127">アダプターがこのようなストアド プロシージャからのメタデータの生成をサポートしていません、 **Strongly-Typed プロシージャ**ノード。</span><span class="sxs-lookup"><span data-stu-id="7c78e-127">The adapter does not support generating metadata for such stored procedures from under the **Strongly-Typed Procedures** node.</span></span>  
  
## <a name="support-for-result-sets-containing-columns-without-names-or-with-same-names"></a><span data-ttu-id="7c78e-128">名前のない、または同じ名前を持つ列を含む結果セットのサポート</span><span class="sxs-lookup"><span data-stu-id="7c78e-128">Support for Result Sets Containing Columns Without Names or With Same Names</span></span>  
 <span data-ttu-id="7c78e-129">次の表にリスト方法、[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]名とストアド プロシージャと厳密に型指定されたストアド プロシージャの結果セット内の同じ名前のない列を処理します。</span><span class="sxs-lookup"><span data-stu-id="7c78e-129">The following table lists how the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] handles columns without names and same names in the result sets for stored procedures and strongly-typed stored procedures.</span></span>  
  
|<span data-ttu-id="7c78e-130">結果セットが含まれています.</span><span class="sxs-lookup"><span data-stu-id="7c78e-130">Result set contains…</span></span>|<span data-ttu-id="7c78e-131">ストアド プロシージャ</span><span class="sxs-lookup"><span data-stu-id="7c78e-131">Stored Procedure</span></span>|<span data-ttu-id="7c78e-132">厳密に型指定されたストアド プロシージャ</span><span class="sxs-lookup"><span data-stu-id="7c78e-132">Strongly-Typed Stored Procedure</span></span>|  
|--------------------------|----------------------|--------------------------------------|  
|<span data-ttu-id="7c78e-133">**名前のない列**</span><span class="sxs-lookup"><span data-stu-id="7c78e-133">**Columns without names**</span></span>|<span data-ttu-id="7c78e-134">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]次のように、列の名前が生成されます: せず、列の一意の ID (GUID) が生成される"-"(ハイフン)、その GUID 文字列がプレフィックス付きの"C"によって生成された GUID が数字で開始可能性がありますが、XML タグ名ができないためです。</span><span class="sxs-lookup"><span data-stu-id="7c78e-134">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] generates a name for the column in the following way: a unique ID (GUID) is generated for the column without "-" (hyphen), and then the GUID string is prefixed by "C" because the generated GUID might start with a digit but an XML tag name cannot.</span></span>|<span data-ttu-id="7c78e-135">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]列の次の名前が生成されます:"[column_index] UnNamedColumn"、column_index が '0' からを開始します。</span><span class="sxs-lookup"><span data-stu-id="7c78e-135">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] generates the following name for the column: “UnNamedColumn[column_index]”,  where column_index starts from ‘0’.</span></span>|  
|<span data-ttu-id="7c78e-136">**同じ名前の列**</span><span class="sxs-lookup"><span data-stu-id="7c78e-136">**Columns with same names**</span></span>|<span data-ttu-id="7c78e-137">1 つ目以外の列の名前は「_」(アンダー スコア) なしのランダムな GUID で後に追加されます"-"(ハイフン)。</span><span class="sxs-lookup"><span data-stu-id="7c78e-137">The names of the columns other than the first one are appended with “_” (underscore) followed by a random GUID without "-" (hyphen).</span></span> <span data-ttu-id="7c78e-138">例:"\_[GUID]"です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-138">For example: “\_[GUID]”.</span></span>|<span data-ttu-id="7c78e-139">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]結果セットに同じ名前の列をサポートしておらず、例外をスローします。</span><span class="sxs-lookup"><span data-stu-id="7c78e-139">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] does not support columns with same names in the result sets, and throws an exception.</span></span> <span data-ttu-id="7c78e-140">**重要:** 結果セット内の列名は、一意の名前であることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7c78e-140">**Important:**  You must ensure that the column names in a result set have unique names.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="7c78e-141">一般に、ストアド プロシージャの結果内のすべての列の設定し、ストアド プロシージャの厳密に型指定された名前する必要がありますで一意の名前を持っていることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="7c78e-141">In general, it is recommended that all the columns in a result set for stored procedures and strongly-typed stored procedures must be named, and have unique names.</span></span>  
  
 <span data-ttu-id="7c78e-142">詳細については。</span><span class="sxs-lookup"><span data-stu-id="7c78e-142">For more information about:</span></span>  
  
-   <span data-ttu-id="7c78e-143">ストアド プロシージャを実行する方法[BizTalk Server を使用して SQL Server でストアド プロシージャを実行](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-in-sql-server-using-biztalk-server.md)です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-143">How to execute stored procedures, see [Execute stored procedures in SQL Server using BizTalk Server](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-in-sql-server-using-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="7c78e-144">FOR XML 句を持つストアド プロシージャを実行する方法[BizTalk Server を使用して SQL Server での FOR XML 句を持つストアド プロシージャを実行](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-having-a-for-xml-clause-in-sql-server-using-biztalk.md)です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-144">How to execute stored procedures having a FOR XML clause, see [Execute stored procedures having a FOR XML clause in SQL Server using BizTalk Server](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-having-a-for-xml-clause-in-sql-server-using-biztalk.md).</span></span>  
  
-   <span data-ttu-id="7c78e-145">メッセージのストアド プロシージャのスキーマを参照してください[プロシージャと関数のメッセージ スキーマを](../../adapters-and-accelerators/adapter-sql/message-schemas-for-procedures-and-functions.md)です。</span><span class="sxs-lookup"><span data-stu-id="7c78e-145">Message schemas for the stored procedures, see [Message Schemas for Procedures and Functions](../../adapters-and-accelerators/adapter-sql/message-schemas-for-procedures-and-functions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c78e-146">参照</span><span class="sxs-lookup"><span data-stu-id="7c78e-146">See Also</span></span>  
 [<span data-ttu-id="7c78e-147">アダプターを使用して SAP システムへの接続します。</span><span class="sxs-lookup"><span data-stu-id="7c78e-147">Connect to an SAP system using the adapter</span></span>](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)