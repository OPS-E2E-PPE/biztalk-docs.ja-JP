---
title: SQL アダプターを使用して SQL Server でのポーリング |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c31b3cda-c05e-46db-827b-6c47a53d1a3a
caps.latest.revision: 19
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 73bb47bfd631576fe992ef072eee8ff3ff5ba5bf
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36967131"
---
# <a name="polling-in-sql-server-using-the-sql-adapter"></a><span data-ttu-id="3d998-102">SQL アダプターを使用して SQL Server でのポーリング</span><span class="sxs-lookup"><span data-stu-id="3d998-102">Polling in SQL Server using the SQL adapter</span></span>
[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]<span data-ttu-id="3d998-103"> SQL Server データベースからデータ変更メッセージを受信アダプターのクライアントを有効にします。</span><span class="sxs-lookup"><span data-stu-id="3d998-103"> enables adapter clients to receive data-change messages from the SQL Server database.</span></span> <span data-ttu-id="3d998-104">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] 「ポーリング ベース」のメッセージの受信をサポート、アダプターが (SELECT ステートメントまたはストアド プロシージャ) は、指定された SQL ステートメントを実行する場合を取得または、データを更新し、一定の間隔でアダプター クライアントに結果を提供します。時間です。</span><span class="sxs-lookup"><span data-stu-id="3d998-104">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports receiving "polling-based" messages wherein the adapter executes a specified SQL statement (SELECT statement or stored procedure), retrieves or updates the data, and provides the result to the adapter client at regular intervals of time.</span></span>  
  
 <span data-ttu-id="3d998-105">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]ポーリングの次の操作を公開します。</span><span class="sxs-lookup"><span data-stu-id="3d998-105">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] exposes the following operations for polling:</span></span>  
  
- <span data-ttu-id="3d998-106">**ポーリング**: SQL Server テーブルまたはビューの定期的なデータ変更メッセージを受信することができます。</span><span class="sxs-lookup"><span data-stu-id="3d998-106">**Polling**: Enables you to receive periodic data-change messages for SQL Server tables or views.</span></span> <span data-ttu-id="3d998-107">メッセージがない厳密に型指定します。</span><span class="sxs-lookup"><span data-stu-id="3d998-107">The messages are not strongly-typed.</span></span>  
  
- <span data-ttu-id="3d998-108">**TypedPolling**: SQL Server データベースから厳密に型指定されたメッセージを受信することができます。</span><span class="sxs-lookup"><span data-stu-id="3d998-108">**TypedPolling**: Enables you to receive strongly-typed messages from the SQL Server database.</span></span> <span data-ttu-id="3d998-109">ポーリング メッセージ内の要素を他の任意のスキーマにマップする場合は、この操作を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3d998-109">You must use this operation if you intend to map the elements in the polling message to any other schema.</span></span>  
  
- <span data-ttu-id="3d998-110">**XmlPolling**します。</span><span class="sxs-lookup"><span data-stu-id="3d998-110">**XmlPolling**.</span></span> <span data-ttu-id="3d998-111">SELECT ステートメントまたはストアド プロシージャを FOR XML 句を使用して、XML メッセージとしてデータを返すを使用できます。</span><span class="sxs-lookup"><span data-stu-id="3d998-111">Enables you to use SELECT statements or stored procedures that use a FOR XML clause and return data as XML messages.</span></span> <span data-ttu-id="3d998-112">この操作は、XML メッセージとしてポーリング メッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="3d998-112">This operation returns the polling message as an XML message.</span></span>  
  
   <span data-ttu-id="3d998-113">FOR XML 句の詳細については、次を参照してください。 [ http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402)します。</span><span class="sxs-lookup"><span data-stu-id="3d998-113">For more information about FOR XML clause, see [http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402).</span></span>  
  
  <span data-ttu-id="3d998-114">ポーリングの詳細については、[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]を参照してください[を使用して BizTalk Server によって SQL Server からのデータ変更メッセージの受信のポーリングに基づいた](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md)します。</span><span class="sxs-lookup"><span data-stu-id="3d998-114">For more information about polling in the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)], see [Receive Polling-based Data-changed Messages from SQL Server by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md).</span></span>  
  
## <a name="polling"></a><span data-ttu-id="3d998-115">ポーリング</span><span class="sxs-lookup"><span data-stu-id="3d998-115">Polling</span></span>  
 <span data-ttu-id="3d998-116">使用して一般的なポーリング操作、[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]次が含まれます。</span><span class="sxs-lookup"><span data-stu-id="3d998-116">A typical polling operation using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] involves the following:</span></span>  
  
1. <span data-ttu-id="3d998-117">アダプターのクライアントを指定する必要があります`Polling`の受信の操作として、 **InboundOperationType**プロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="3d998-117">The adapter clients must specify `Polling` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="3d998-118">このバインドのプロパティの既定値は`Polling`します。</span><span class="sxs-lookup"><span data-stu-id="3d998-118">The default value for this binding property is `Polling`.</span></span>  
  
2. <span data-ttu-id="3d998-119">アダプター クライアントの SQL ステートメントを指定する必要があります、 **PolledDataAvailableStatement**ポーリングに使用できるデータがあるかどうかを決定するプロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="3d998-119">The adapter clients must specify a SQL statement for the **PolledDataAvailableStatement** binding property that determines whether there is data available for polling.</span></span> <span data-ttu-id="3d998-120">このステートメントを実行で返される最初の結果の最初の行の最初の列には、整数値が含まれています。</span><span class="sxs-lookup"><span data-stu-id="3d998-120">The first column of the first row of the first result set returned on executing this statement contains an integer value.</span></span> <span data-ttu-id="3d998-121">ポーリングに使用できるデータがない、戻り値は 0 (ゼロ) です。</span><span class="sxs-lookup"><span data-stu-id="3d998-121">If there is no data available for polling, the return value is 0 (zero).</span></span> <span data-ttu-id="3d998-122">データが使用可能な場合、戻り値は 0 より大きいです。</span><span class="sxs-lookup"><span data-stu-id="3d998-122">If there is data available, the return value is greater than zero.</span></span>  
  
3. <span data-ttu-id="3d998-123">アダプター クライアントのポーリング間隔を指定する必要があります、 **PollingIntervalInSeconds**間隔を定義するプロパティのバインド内のステートメント、 **PolledDataAvailableStatement**バインドプロパティが実行されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-123">The adapter clients must specify a polling interval for the **PollingIntervalInSeconds** binding property to define the interval at which the statement in the **PolledDataAvailableStatement** binding property is executed.</span></span> <span data-ttu-id="3d998-124">ポーリング間隔の最後に、ポーリング済みデータの使用可能なステートメントを実行して、結果セットが返されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-124">At the end of every polling interval, the polled data available statement is executed, and the result set is returned.</span></span>  
  
4. <span data-ttu-id="3d998-125">アダプター クライアントのポーリング SQL ステートメント (SELECT ステートメントまたはストアド プロシージャ) を指定する必要があります、 **PollingStatement**プロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="3d998-125">The adapter clients must specify a polling SQL statement (SELECT statement or stored procedure) for the **PollingStatement** binding property.</span></span> <span data-ttu-id="3d998-126">ポーリングに使用できるデータがある場合 (によって決定されます、 **PolledDataAvailableStatement**プロパティのバインド)、アダプターを取得し、(該当する場合) を更新するポーリング ステートメントを実行する SQL Server データベース内のデータ。</span><span class="sxs-lookup"><span data-stu-id="3d998-126">If there is data available for polling (determined by the **PolledDataAvailableStatement** binding property), the adapter executes the polling statement to obtain and update (if applicable) the data in the SQL Server database.</span></span> <span data-ttu-id="3d998-127">ときに、[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]併用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]、メッセージを送信する、同じトランザクションを使用しても[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="3d998-127">When the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] is used with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], the same transaction is also used to submit the message to [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
5. <span data-ttu-id="3d998-128">アダプターのクライアントが使用できる、 **PollWhileDataFound**ポーリング間隔を無視し、継続的に使用可能な場合と、データをポーリングするプロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="3d998-128">The adapter clients can use the **PollWhileDataFound** binding property to ignore the polling interval, and continuously poll data, as and when available.</span></span>  
  
6. <span data-ttu-id="3d998-129">ポーリング ステートメントを実行した結果として返される結果セットは、受信メッセージとしてアダプター クライアントに送信されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-129">The result sets that are returned as a result of executing the polling statement are sent to the adapter client as the inbound message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3d998-130">XmlPolling 操作には、ポーリング操作と同じ手順が含まれます。</span><span class="sxs-lookup"><span data-stu-id="3d998-130">An XmlPolling operation involves the same steps as the Polling operation.</span></span>  
  
## <a name="strongly-typed-polling"></a><span data-ttu-id="3d998-131">厳密に型指定されたポーリング</span><span class="sxs-lookup"><span data-stu-id="3d998-131">Strongly-Typed Polling</span></span>  
 <span data-ttu-id="3d998-132">使用して厳密に型指定されたポーリングの一般的な操作、[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]次が含まれます。</span><span class="sxs-lookup"><span data-stu-id="3d998-132">A typical strongly-typed polling operation using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] involves the following:</span></span>  
  
1. <span data-ttu-id="3d998-133">アダプターのクライアントを指定する必要があります`TypedPolling`の受信の操作として、 **InboundOperationType**プロパティをバインドします。</span><span class="sxs-lookup"><span data-stu-id="3d998-133">The adapter clients must specify `TypedPolling` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="3d998-134">このバインドのプロパティの既定値は`Polling`します。</span><span class="sxs-lookup"><span data-stu-id="3d998-134">The default value for this binding property is `Polling`.</span></span>  
  
2. <span data-ttu-id="3d998-135">アダプターのクライアントは、接続 URI の一部として受信 ID を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3d998-135">The adapter clients must specify an inbound ID as part of the connection URI.</span></span> <span data-ttu-id="3d998-136">受信 ID では、任意の文字列を使用することし、名前空間の競合を防ぐために、TypedPolling 操作の標準名前空間に追加されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-136">The inbound ID could be any string and is appended to the standard namespace of the TypedPolling operation to prevent namespace collisions.</span></span>  
  
3. <span data-ttu-id="3d998-137">残りの手順では、2 ~ 6 の前のセクションで説明されているポーリング操作に記載の手順と同じです。</span><span class="sxs-lookup"><span data-stu-id="3d998-137">The rest of the steps are same as steps 2–6 listed in the Polling operation described in the preceding section.</span></span>  
  
   <span data-ttu-id="3d998-138">ポーリングと厳密に型指定されたポーリングに関連するバインドのプロパティの詳細については、次を参照してください。 [for SQL Server のアダプターのバインド プロパティの BizTalk アダプターについて](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)します。</span><span class="sxs-lookup"><span data-stu-id="3d998-138">For detailed information about the binding properties related to polling and strongly-typed polling, see [Read about BizTalk Adapter for SQL Server adapter  Binding Properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3d998-139">複数の結果セットは、ポーリング ステートメントを実行した結果として返されることができます。</span><span class="sxs-lookup"><span data-stu-id="3d998-139">Multiple result sets can be returned as a result of executing the polling statement.</span></span> <span data-ttu-id="3d998-140">結果セットに行が含まれない場合は、アダプターのクライアントにメッセージが送信されません。</span><span class="sxs-lookup"><span data-stu-id="3d998-140">If the result sets do not contain any rows, no messages are sent to the adapter client.</span></span>  
  
 <span data-ttu-id="3d998-141">次の図でポーリング ワークフローに関する情報を提供する[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="3d998-141">The illustration below provides information about the polling workflow in [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="3d998-142">ポーリング ワークフローの 2 つのシナリオを示します。</span><span class="sxs-lookup"><span data-stu-id="3d998-142">Two scenarios for the polling workflow are illustrated:</span></span>  
  
1. <span data-ttu-id="3d998-143">ときの値、 **PollWhileDataFound**が"False"(既定の設定) に設定します。</span><span class="sxs-lookup"><span data-stu-id="3d998-143">When the value of the **PollWhileDataFound** is set to “False” (default setting).</span></span>  
  
2. <span data-ttu-id="3d998-144">ときの値、 **PollWhileDataFound** "は True"に設定されている。</span><span class="sxs-lookup"><span data-stu-id="3d998-144">When the value of the **PollWhileDataFound** is set to “True.”</span></span>  
  
   <span data-ttu-id="3d998-145">![ポーリング ワークフロー &#40;PollWhileDataFound &#61; False&#41;](../../adapters-and-accelerators/adapter-sql/media/15598c14-3a62-4b8d-90bf-84e004a386db.gif "15598c14-3a62-4b8d-90bf-84e004a386db") ![ポーリング ワークフロー &#40;PollWhileDataFound &#61; &#41; ] (../../adapters-and-accelerators/adapter-sql/media/c20535be-ea45-4456-8b62-4d4585cb1d8c.gif "c20535be-ea45-4456-8b62-4d4585cb1d8c")</span><span class="sxs-lookup"><span data-stu-id="3d998-145">![Polling Workflow &#40;PollWhileDataFound &#61; False&#41;](../../adapters-and-accelerators/adapter-sql/media/15598c14-3a62-4b8d-90bf-84e004a386db.gif "15598c14-3a62-4b8d-90bf-84e004a386db") ![Polling Workflow &#40;PollWhileDataFound &#61; True&#41;](../../adapters-and-accelerators/adapter-sql/media/c20535be-ea45-4456-8b62-4d4585cb1d8c.gif "c20535be-ea45-4456-8b62-4d4585cb1d8c")</span></span>  
  
## <a name="differences-between-polling-and-query-notification"></a><span data-ttu-id="3d998-146">ポーリングとクエリ通知の違い</span><span class="sxs-lookup"><span data-stu-id="3d998-146">Differences between Polling and Query Notification</span></span>  
 <span data-ttu-id="3d998-147">ポーリングとクエリ通知は、両方の受信操作で、SQL Server データベースのデータの変更について、アダプターをクライアントに通知、ただし、次の表は、いくつか 2 つの違いを示します。</span><span class="sxs-lookup"><span data-stu-id="3d998-147">Though polling and query notification are both inbound operations, and inform the adapter clients about the data changes in the SQL Server database, the following table lists some differences between the two.</span></span> <span data-ttu-id="3d998-148">次の相違点を使用すると、要件に応じて、操作を決定できます。</span><span class="sxs-lookup"><span data-stu-id="3d998-148">The following differences will help you decide on an operation depending on your requirements:</span></span>  
  
|<span data-ttu-id="3d998-149">ポーリング</span><span class="sxs-lookup"><span data-stu-id="3d998-149">Polling</span></span>|<span data-ttu-id="3d998-150">クエリ通知</span><span class="sxs-lookup"><span data-stu-id="3d998-150">Query Notification</span></span>|  
|-------------|------------------------|  
|<span data-ttu-id="3d998-151">ポーリングは、アダプターによって開始されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-151">Polling is initiated by the adapter.</span></span> <span data-ttu-id="3d998-152">アダプターは、データのポーリングに使用できるとポーリングの一部のデータがある場合は、ポーリング ステートメントを実行してポーリングを開始するかどうかを検証するステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="3d998-152">The adapter executes a statement to validate whether data is available for polling, and then initiates polling by executing the polling statement if some data is available for polling.</span></span>|<span data-ttu-id="3d998-153">クエリ通知は、SQL Server によって開始されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-153">Query notification is initiated by SQL Server.</span></span> <span data-ttu-id="3d998-154">だけ、アダプターによって発行された通知のステートメントでは、データベース ステートメントの結果セット内の変更がある場合は、通知を開始するように指示します。</span><span class="sxs-lookup"><span data-stu-id="3d998-154">The notification statement issued by the adapter just instructs the database to initiate notification in case there is a change in the result set of the statement.</span></span>|  
|<span data-ttu-id="3d998-155">ポーリング ステートメントを使用して、読み取りまたは SQL Server データベース テーブル内のデータを更新することができます。</span><span class="sxs-lookup"><span data-stu-id="3d998-155">You can use the polling statement to read or update data in a SQL Server database table.</span></span>|<span data-ttu-id="3d998-156">クエリ通知のステートメントを使用すると、SQL Server データベース テーブルにデータを読み取るだけです。</span><span class="sxs-lookup"><span data-stu-id="3d998-156">You can use the query notification statement to only read data in a SQL Server database table.</span></span>|  
|<span data-ttu-id="3d998-157">ポーリングには、実際のデータが変更されたことについて通知されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-157">Polling informs you about the actual data that has changed.</span></span>|<span data-ttu-id="3d998-158">クエリ通知は、Insert などのデータの変更の種類についてのみ通知は、更新、および削除します。</span><span class="sxs-lookup"><span data-stu-id="3d998-158">Query notification only informs about the type of change in the data such as Insert, Update, and Delete.</span></span>|  
|<span data-ttu-id="3d998-159">データの変更通知が、ポーリング間隔に依存し、アダプター クライアントは、ポーリング間隔の最後に、データの変更について通知されます。</span><span class="sxs-lookup"><span data-stu-id="3d998-159">The data-change notification depends on the polling interval, and the adapter clients are informed about the data changes at the end of every polling interval.</span></span> <span data-ttu-id="3d998-160">**ヒント:** ポーリングが継続的に、データの変更が発生したありと設定されるタイミングとしては、各変更の通知しないシナリオでスループットを向上を提供します。</span><span class="sxs-lookup"><span data-stu-id="3d998-160">**Tip:**  Polling can give you better throughput in scenarios where the data changes are happening continuously, and you do not want to be notified of each change as and when it happens.</span></span> <span data-ttu-id="3d998-161">代わりに後の最後のデータの変更の通知以降に発生したすべての変更を通知するポーリング間隔を指定します。</span><span class="sxs-lookup"><span data-stu-id="3d998-161">Instead, you specify a polling interval after which you want to be notified of all the changes that have happened since the last data-change notification.</span></span>|<span data-ttu-id="3d998-162">データの変更通知は瞬時です。</span><span class="sxs-lookup"><span data-stu-id="3d998-162">The data-change notification is instantaneous.</span></span>|  
  
 <span data-ttu-id="3d998-163">クエリ通知の詳細については[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]を参照してください[を使用して BizTalk Server によって SQL クエリ通知の受信](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)します。</span><span class="sxs-lookup"><span data-stu-id="3d998-163">For more information about query notification in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)], see [Receive SQL Query Notifications by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3d998-164">参照</span><span class="sxs-lookup"><span data-stu-id="3d998-164">See Also</span></span>  
 <span data-ttu-id="3d998-165">[どのような操作は、アダプターを使用して実行しますか?](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span><span class="sxs-lookup"><span data-stu-id="3d998-165">[What Operations Can be Performed Using the Adapter?](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span></span>