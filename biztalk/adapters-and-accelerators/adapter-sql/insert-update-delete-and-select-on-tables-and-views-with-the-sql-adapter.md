---
title: Insert、Update、Delete、およびテーブルとビューを SQL アダプターでの操作の選択 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d0cc39d5-16f2-454a-8e1d-c031592439ae
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cae4dfff287414c4f9b1081face9a33bbf9da545
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22225386"
---
# <a name="insert-update-delete-and-select-operations-on-tables-and-views-with-the-sql-adapter"></a><span data-ttu-id="6f3ad-102">Insert、Update、Delete、およびテーブルとビューを SQL アダプターでの操作の選択</span><span class="sxs-lookup"><span data-stu-id="6f3ad-102">Insert, Update, Delete, and Select Operations on Tables and Views with the SQL adapter</span></span>
<span data-ttu-id="6f3ad-103">[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]テーブルと、SQL Server データベースのビューごとに、標準的な操作のセットを表示します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-103">The [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]surfaces a set of standard operations on each table and view in the SQL Server database.</span></span> <span data-ttu-id="6f3ad-104">これらの操作を使用すると、対象のテーブルまたはビューの WHERE 句で修飾された単純な INSERT、UPDATE、SELECT、および DELETE ステートメントを実行できます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-104">By using these operations, you can execute simple INSERT, UPDATE, SELECT, and DELETE statements qualified by a WHERE clause on the target table or view.</span></span> <span data-ttu-id="6f3ad-105">これらの操作は、データ操作言語 (DML) 操作とも呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-105">These operations are also called data manipulation language (DML) operations.</span></span>  
  
 <span data-ttu-id="6f3ad-106">次の表は、DML 操作を[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-106">The following table shows the DML operations that the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports:</span></span>  
  
|<span data-ttu-id="6f3ad-107">操作</span><span class="sxs-lookup"><span data-stu-id="6f3ad-107">Operation</span></span>|<span data-ttu-id="6f3ad-108">Description</span><span class="sxs-lookup"><span data-stu-id="6f3ad-108">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="6f3ad-109">Insert</span><span class="sxs-lookup"><span data-stu-id="6f3ad-109">Insert</span></span>|<span data-ttu-id="6f3ad-110">対象のテーブルまたはビューに対する Insert 操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-110">Performs an Insert operation on the target table or view.</span></span><br /><br /> <span data-ttu-id="6f3ad-111">-Insert 操作は、入力としてレコードの配列を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-111">-   The Insert operation takes an array of records as input.</span></span> <span data-ttu-id="6f3ad-112">各レコードはターゲット テーブルとテーブル内に挿入される行にマップには厳密に型指定します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-112">Each record is strongly typed to the target table, and maps to the row being inserted in the table.</span></span><br /><span data-ttu-id="6f3ad-113">値を指定された id 列に値を挿入-、 **AllowIdentityInsert** binding プロパティが TRUE に設定します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-113">-   You can insert values in identity columns provided the value of the **AllowIdentityInsert** binding property is set to TRUE.</span></span> <span data-ttu-id="6f3ad-114">詳細については、 **AllowIdentityInsert**バインディング プロパティを参照してください[SQL Server のアダプターのバインド プロパティの BizTalk アダプターの説明を読む](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)です。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-114">For more information about the **AllowIdentityInsert** binding property, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span><br /><span data-ttu-id="6f3ad-115">-Insert 操作の戻り値は、長い形式のデータ型の配列です。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-115">-   The return value of the Insert operation is an array of Long data type.</span></span> <span data-ttu-id="6f3ad-116">この配列は、存在する場合に、挿入された行の id 値を格納します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-116">This array stores the identity values of the inserted rows, if any.</span></span> <span data-ttu-id="6f3ad-117">テーブル内に id 列がない場合、戻り値は NULL です。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-117">If there is no identity column in a table, the return value is NULL.</span></span><br /><br /> <span data-ttu-id="6f3ad-118">挿入操作のメッセージの一部の値は、次のように扱われます、 [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="6f3ad-118">Some values in the Insert operation message are treated in the following manner by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span></span><br /><br /> <span data-ttu-id="6f3ad-119">の計算列とタイムスタンプ列の指定値は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-119">-   Values specified for computed columns and timestamp columns are ignored.</span></span><br /><span data-ttu-id="6f3ad-120">-ノードの id 列が null の場合は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-120">-   If the node for an identity column is null, it is ignored.</span></span><br /><br /> <span data-ttu-id="6f3ad-121">挿入操作のメッセージでその他のすべての値。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-121">For all other values in the Insert operation message:</span></span><br /><br /> <span data-ttu-id="6f3ad-122">場合は、列の値を指定すると、その値は、INSERT ステートメントで使用されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-122">-   If a value is specified for a column, that value is used in the INSERT statement.</span></span><br /><span data-ttu-id="6f3ad-123">-特定の列のノードが null の場合は NULL は、INSERT ステートメントで使用されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-123">-   If the node for a particular column is null, NULL is used in the INSERT statement.</span></span> <span data-ttu-id="6f3ad-124">**注:** 特定のレコードの INSERT ステートメントで使用できる値がない場合 (つまり、任意の列に値が指定されていませんまたはすべての列値が無視されます)、アダプターは、次の SQL ステートメントを実行します。`insert into <table_name> default values`</span><span class="sxs-lookup"><span data-stu-id="6f3ad-124">**Note:**  If for a particular record, there are no values that can be used in the INSERT statement (that is, either no values were specified for any column or all the column values were ignored), the adapter executes the following SQL statement: `insert into <table_name> default values`</span></span>|  
|<span data-ttu-id="6f3ad-125">Select</span><span class="sxs-lookup"><span data-stu-id="6f3ad-125">Select</span></span>|<span data-ttu-id="6f3ad-126">対象のテーブルまたはビューのレコード (列) の配列と WHERE 句を指定するクエリ文字列に基づいてに対する SELECT ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-126">Performs a SELECT statement on the target table or view based on an array of records (columns) and a query string that specifies a WHERE clause.</span></span><br /><br /> <span data-ttu-id="6f3ad-127">、SELECT ステートメント内の列の一覧については値を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-127">-   A value must be specified for the list of the columns in the SELECT statement.</span></span> <span data-ttu-id="6f3ad-128">すべての列をテーブルまたはビュー内で取得する必要がある場合 \*、SELECT ステートメントで指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-128">If all columns have to be retrieved in a table or view, \* must be specified in the SELECT statement.</span></span> <span data-ttu-id="6f3ad-129">特定の列を取得する場合、列の名前をコンマで区切らしてテーブルまたはビューで定義されているように同じ順序で指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-129">If specific columns have to be retrieved, the column names must be separated by comma, and specified in the same order as they are defined in the table or view.</span></span><br /><span data-ttu-id="6f3ad-130">-SELECT ステートメントでは、、WHERE 句を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-130">-   The WHERE clause must be included in the SELECT statement.</span></span> <span data-ttu-id="6f3ad-131">ただし、WHERE 句の値を指定しない場合か、削除できます、`Query`要素または空のままにします。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-131">However, if you do not want to specify a value in the WHERE clause, you can either delete the `Query` element or leave it empty.</span></span><br /><span data-ttu-id="6f3ad-132">-選択操作では、更新操作を実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-132">-   The Select operation also allows you to perform an Update operation.</span></span> <span data-ttu-id="6f3ad-133">この場合、UPDATE ステートメントは内部に格納、 `Query` SELECT ステートメントの要素。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-133">In this case, the UPDATE statement is placed inside the `Query` element of the SELECT statement.</span></span><br /><br /> <span data-ttu-id="6f3ad-134">Select 操作の戻り値は、指定された列と対象のテーブルまたはビューから行を含む厳密に型指定された結果セットです。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-134">The return value of the Select operation is a strongly-typed result set that contains the specified columns and rows from the target table or view.</span></span>|  
|<span data-ttu-id="6f3ad-135">Update</span><span class="sxs-lookup"><span data-stu-id="6f3ad-135">Update</span></span>|<span data-ttu-id="6f3ad-136">対象のテーブルまたはビューの更新操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-136">Performs an Update operation on the target table or view.</span></span><br /><br /> <span data-ttu-id="6f3ad-137">-更新操作は、入力としてレコードのペアの配列を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-137">- The Update operation takes an array of record pairs as input.</span></span> <span data-ttu-id="6f3ad-138">各レコードのペアが 2 つのレコードのコレクションと、各レコードは、厳密に型指定された対象のテーブルにします。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-138">Each record pair is a collection of two records, and each record is strongly-typed to the target table.</span></span><br /><br /> <span data-ttu-id="6f3ad-139">-最初のレコードを更新する必要のある新しい値に対応しています、つまり、UPDATE ステートメントの SET 句に対応します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-139">- The first record corresponds to new values that need to be updated, that is, it corresponds to the SET clause of the UPDATE statement.</span></span> <br /><span data-ttu-id="6f3ad-140">-2 番目のレコードの行の古い値、つまり、UPDATE ステートメントの WHERE 句に対応します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-140">- The second record corresponds to the old values of the rows, that is, it corresponds to the WHERE clause of the UPDATE statement.</span></span> <span data-ttu-id="6f3ad-141">**注:** そのレコードのペアの更新ステートメントが実行されていない場合、特定のレコードのペアでは、SET 句で使用できる値はありません、します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-141">**Note:**      If, for a particular record pair, there are no values that can be used in the SET clause, no UPDATE statement is executed for that record pair.</span></span> <br /><span data-ttu-id="6f3ad-142">-の値を指定された id 列の値を更新できる、 **AllowIdentityInsert** binding プロパティが TRUE に設定します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-142">- You can update values in identity columns provided the value of the **AllowIdentityInsert** binding property is set to TRUE.</span></span> <span data-ttu-id="6f3ad-143">詳細については、 **AllowIdentityInsert**バインディング プロパティを参照してください[SQL Server のアダプターのバインド プロパティの BizTalk アダプターの説明を読む](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)です。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-143">For more information about the **AllowIdentityInsert** binding property, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span> <br /><span data-ttu-id="6f3ad-144">-更新操作の戻り値は、Int32 データ型では、更新された行の数を表します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-144">- The return value of the Update operation is of Int32 data type, and denotes the number of rows updated.</span></span><br /> <span data-ttu-id="6f3ad-145">更新操作のメッセージの一部の値は、次のように扱われます、 [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="6f3ad-145">Some values in the Update operation message are treated in the following manner by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span></span><br /><br /> <span data-ttu-id="6f3ad-146">の計算列と、メッセージの SET 句内のタイムスタンプ列の指定値は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-146">-   Values specified for computed columns and timestamp columns in the SET clause of the message are ignored.</span></span><br /><span data-ttu-id="6f3ad-147">ユーザー定義型 (UDT) がバイトの順序付け、UDT 列に指定された値ではない場合、WHERE 句を無視します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-147">-   If a User Defined Type (UDT) is not byte ordered, the value specified for the UDT column in the WHERE clause is ignored.</span></span><br /><span data-ttu-id="6f3ad-148">Id 列のノードがメッセージの SET 句で null の場合は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-148">-   If the node for an identity column is null in the SET clause of the message, it is ignored.</span></span><br /><span data-ttu-id="6f3ad-149">-Id またはタイムスタンプ列のノードが、メッセージの WHERE 句で null の場合は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-149">-   If the node for an identity or timestamp column is null in the WHERE clause of the message, it is ignored.</span></span><br /><span data-ttu-id="6f3ad-150">-イメージ、XML、Text または Ntext 列のノードが null の場合、メッセージの WHERE 句で、これらの値を比較できないために指定された値は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-150">-   If the node for an image, XML, Text or Ntext column is not null in the WHERE clause of the message, the values specified for them are ignored because these values cannot be compared.</span></span><br /><br /> <span data-ttu-id="6f3ad-151">Update 操作のメッセージ内の他のすべての値。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-151">For all other values in the Update operation message:</span></span><br /><br /> <span data-ttu-id="6f3ad-152">値がステートメントの SET 句で使用される場合は、UPDATE ステートメントの SET 句で列の値を指定すると、(`set <column_name> = <value>`)。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-152">-   If a value is specified for a column in the SET clause of the UPDATE statement, the value is used in the SET clause of the statement (`set <column_name> = <value>`).</span></span><br /><span data-ttu-id="6f3ad-153">-UPDATE ステートメントで NULL が使用される特定の列のノードが SET 句で null の場合 (`set <column_name> = null`)。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-153">-   If the node for a particular column is null in the SET clause, NULL is used in the UPDATE statement (`set <column_name> = null`).</span></span><br /><span data-ttu-id="6f3ad-154">-UPDATE ステートメントの WHERE 句で、値は、ステートメントの WHERE 句で使用列の値が指定した場合 (`where <column_name> = <value>`)。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-154">-   If a value is specified for a column in the WHERE clause of the UPDATE statement, the value is used in the WHERE clause of the statement (`where <column_name> = <value>`).</span></span><br /><span data-ttu-id="6f3ad-155">-UPDATE ステートメントで NULL が使用される特定の列のノードが、UPDATE ステートメントの WHERE 句で null の場合 (`where <column_name> is null`)。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-155">-   If the node for a particular column is null in the WHERE clause of the UPDATE statement, NULL is used in the UPDATE statement (`where <column_name> is null`).</span></span>|  
|<span data-ttu-id="6f3ad-156">DELETE</span><span class="sxs-lookup"><span data-stu-id="6f3ad-156">Delete</span></span>|<span data-ttu-id="6f3ad-157">対象のテーブルまたは対象のテーブルと、WHERE 句を指定するフィルター文字列のレコード (列名の一覧) の厳密に型指定された配列に基づいたビューに対して Delete 操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-157">Performs a Delete operation on the target table or view based on a strongly-typed array of records (list of column names) of the target table and a filter string that specifies a WHERE clause.</span></span><br /><br /> <span data-ttu-id="6f3ad-158">削除操作の戻り値は、Int32 データ型では、削除された行の数を表します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-158">The return value of the Delete operation is of Int32 data type, and denotes the number of rows deleted.</span></span><br /><br /> <span data-ttu-id="6f3ad-159">削除操作のメッセージの一部の値は、次のように扱われます、 [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="6f3ad-159">Some values in the Delete operation message are treated in the following manner by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span></span><br /><br /> <span data-ttu-id="6f3ad-160">-イメージ、XML、Text または Ntext 列のノードが null の場合、メッセージの WHERE 句で、これらの値を比較できないために指定された値は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-160">-   If the node for an image, XML, Text or Ntext column is not null in the WHERE clause of the message, the values specified for them are ignored because these values cannot be compared.</span></span><br /><span data-ttu-id="6f3ad-161">-Id またはタイムスタンプ列のノードが null の場合は無視されます。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-161">-   If the node for an identity or timestamp column is null, it is ignored.</span></span><br /><span data-ttu-id="6f3ad-162">-UDT がバイトの順序付け、UDT 列に指定された値ではない場合、WHERE 句を無視します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-162">-   If a UDT is not byte ordered, the value specified for the UDT column in the WHERE clause is ignored.</span></span><br /><br /> <span data-ttu-id="6f3ad-163">削除操作のメッセージでその他のすべての値。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-163">For all other values in the Delete operation message:</span></span><br /><br /> <span data-ttu-id="6f3ad-164">値が DELETE ステートメントの WHERE 句で使用される場合は、列の値を指定すると、(`where <column_name> = <value>`)。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-164">-   If a value is specified for a column, the value is used in the WHERE clause of the DELETE statement (`where <column_name> = <value>`).</span></span><br /><span data-ttu-id="6f3ad-165">-DELETE ステートメントで NULL が使用される特定の列のノードが null の場合 (`where <column_name> is null`)。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-165">-   If the node for a particular column is null, NULL is used in the DELETE statement (`where <column_name> is null`).</span></span> <span data-ttu-id="6f3ad-166">**注:** 場合、特定のレコード (つまり、任意の列に値が指定されていませんか存在すべての列値が無視されたかどうか)、DELETE ステートメント内で使用できる値はありません、アダプターが、DELETE ステートメントを実行できません。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-166">**Note:**  If, for a particular record, there are no values that can be used in the DELETE statement (that is, either no values were specified for any column or if all the column values present were ignored), the adapter does not execute any DELETE statement.</span></span>|  
  
 <span data-ttu-id="6f3ad-167">詳細については。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-167">For more information about:</span></span>  
  
-   <span data-ttu-id="6f3ad-168">使用してこれらの操作を実行する[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]を参照してください[Insert、update、delete、または BizTalk Server アダプターを使用して、SQL select 操作](../../adapters-and-accelerators/adapter-sql/insert-update-delete-or-select-using-the-sql-adapter-in-biztalk-server.md)です。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-168">Performing these operations using [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], see [Insert, update, delete, or select operations using BizTalk Server with the SQL adapter](../../adapters-and-accelerators/adapter-sql/insert-update-delete-or-select-using-the-sql-adapter-in-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="6f3ad-169">メッセージの構造と DML 操作を実行するための SOAP アクションを参照してください[Insert、Update、Delete、およびテーブルおよびビューに対する選択操作のメッセージ スキーマを](../../adapters-and-accelerators/adapter-sql/message-schemas-for-insert-update-delete-and-select-on-tables-and-views.md)です。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-169">Message structures and SOAP action for performing DML operations, see [Message Schemas for Insert, Update, Delete, and Select Operations on Tables and Views](../../adapters-and-accelerators/adapter-sql/message-schemas-for-insert-update-delete-and-select-on-tables-and-views.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6f3ad-170">参照</span><span class="sxs-lookup"><span data-stu-id="6f3ad-170">See Also</span></span>  
 [<span data-ttu-id="6f3ad-171">アダプターを使用して SAP システムへの接続します。</span><span class="sxs-lookup"><span data-stu-id="6f3ad-171">Connect to an SAP system using the adapter</span></span>](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)