---
title: メッセージの修復処理 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- repairing messages
- errors, messages
- messages, errors
- validating, messages
- messages, validating
ms.assetid: 87b97cec-5796-4684-bcf0-53285aca7ee2
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 442e49c347b4adf84dd7e6ee86c3b3595452cb34
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22211194"
---
# <a name="message-repair-process"></a><span data-ttu-id="85f92-102">メッセージの修復処理</span><span class="sxs-lookup"><span data-stu-id="85f92-102">Message Repair Process</span></span>
<span data-ttu-id="85f92-103">既定では、[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックス データベースの保留キューに失敗したメッセージを中断します。</span><span class="sxs-lookup"><span data-stu-id="85f92-103">By default, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] suspends failed messages in the suspended queue of the MessageBox database.</span></span> <span data-ttu-id="85f92-104">このプロセスは、成功したメッセージから個別に失敗したメッセージを処理します。</span><span class="sxs-lookup"><span data-stu-id="85f92-104">This process handles failed messages separately from successful messages.</span></span> <span data-ttu-id="85f92-105">この既定のメカニズムを使用して、ただし、ある失敗したメッセージを取得し、それらを修復する機能が制限されます。</span><span class="sxs-lookup"><span data-stu-id="85f92-105">Using this default mechanism, however, you have a limited ability to retrieve failed messages and repair them.</span></span> <span data-ttu-id="85f92-106">メッセージ修復 and New Submission 機能[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]により、[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]ユーザー メッセージを修復して再送信します。</span><span class="sxs-lookup"><span data-stu-id="85f92-106">The Message Repair and New Submission feature of [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] enables an [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] user to repair a message and resubmit it.</span></span> <span data-ttu-id="85f92-107">別[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]ユーザーは、修復を確認し、3 つ目は、修復を承認できます。</span><span class="sxs-lookup"><span data-stu-id="85f92-107">Another [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] user can then verify the repairs, and a third can approve the repairs.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="85f92-108">このコンテキストで、[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]ユーザーは、部門別の修復ワークフロー内でロールを実行するユーザー。</span><span class="sxs-lookup"><span data-stu-id="85f92-108">In this context, an [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] user is a user that performs a role in a departmental repair workflow.</span></span> <span data-ttu-id="85f92-109">この A4SWIFT ユーザーが定義されているし、プロファイル Web クライアントのユーザー リンク内の証明書に関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="85f92-109">This A4SWIFT user is defined, and associated with a certificate, in the Users link of the Profile Web Client.</span></span> <span data-ttu-id="85f92-110">これは、[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]ユーザーと同じではありません、[!INCLUDE[btsWinNoVersion](../../includes/btswinnoversion-md.md)]で定義されているユーザー アカウント、[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]でユーザーをグループ化、[!INCLUDE[btsWinNoVersion](../../includes/btswinnoversion-md.md)]コンピューター管理ユーティリティです。</span><span class="sxs-lookup"><span data-stu-id="85f92-110">This [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] user is not the same as a [!INCLUDE[btsWinNoVersion](../../includes/btswinnoversion-md.md)] user account, as defined in the [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] Users group in the [!INCLUDE[btsWinNoVersion](../../includes/btswinnoversion-md.md)] Computer Management utility.</span></span> <span data-ttu-id="85f92-111">として機能している人、[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]ユーザーがいる必要があります、[!INCLUDE[btsWinNoVersion](../../includes/btswinnoversion-md.md)]ユーザー アカウントのメッセージを送信するときに、そのアカウントの証明書が使用できるようにします。</span><span class="sxs-lookup"><span data-stu-id="85f92-111">The person functioning as an [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] user must have a [!INCLUDE[btsWinNoVersion](../../includes/btswinnoversion-md.md)] user account so that they can use that account's certificates when submitting a message.</span></span> <span data-ttu-id="85f92-112">ただし、そのユーザーとしても使用できますの[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]ユーザー: 修理会社、検証、承認者、または作成者。</span><span class="sxs-lookup"><span data-stu-id="85f92-112">However, that person can also serve as other [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] users: repairer, verifier, approver, or creator.</span></span> <span data-ttu-id="85f92-113">詳細については、次を参照してください。 [Message Repair and New Submission のロールの作成の部門と](../../adapters-and-accelerators/accelerator-swift/creating-departments-and-roles-for-message-repair-and-new-submission.md)です。</span><span class="sxs-lookup"><span data-stu-id="85f92-113">For more information, see [Creating Departments and Roles for Message Repair and New Submission](../../adapters-and-accelerators/accelerator-swift/creating-departments-and-roles-for-message-repair-and-new-submission.md).</span></span>  
  
 <span data-ttu-id="85f92-114">この修復ワークフローで[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]失敗したメッセージを一時停止しません。</span><span class="sxs-lookup"><span data-stu-id="85f92-114">With this repair workflow, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] does not suspend a failed message.</span></span> <span data-ttu-id="85f92-115">失敗したメッセージの追加の処理を実行し、成功のメッセージの場合と同様に、メッセージ ボックスに、メッセージをドロップします。</span><span class="sxs-lookup"><span data-stu-id="85f92-115">It performs additional processing on the failed message, and then drops the message into the MessageBox, just as it would a successful message.</span></span> <span data-ttu-id="85f92-116">修復オーケストレーションにメッセージをドロップする、 [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] MRSR サイト、ユーザーがのそれらの機能を実行できる[!INCLUDE[btsInpathNoVersion](../../includes/btsinpathnoversion-md.md)]フォーム。</span><span class="sxs-lookup"><span data-stu-id="85f92-116">The repair orchestration drops the message into the [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] MRSR site, where users can perform their functions in [!INCLUDE[btsInpathNoVersion](../../includes/btsinpathnoversion-md.md)] forms.</span></span>  
  
## <a name="message-validation"></a><span data-ttu-id="85f92-117">メッセージの検証</span><span class="sxs-lookup"><span data-stu-id="85f92-117">Message Validation</span></span>  
 <span data-ttu-id="85f92-118">Message Repair and New Submission MRSR サイト修復のために、次の検証が失敗しているすべてのメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="85f92-118">Message Repair and New Submission sends any message failing the following validation to MRSR site for repair:</span></span>  
  
-   <span data-ttu-id="85f92-119">フラット ファイル パーサー (未解析メッセージ) によって実行される構造の検証</span><span class="sxs-lookup"><span data-stu-id="85f92-119">Structural validation performed by the flat file parser (unparsed messages)</span></span>  
  
-   <span data-ttu-id="85f92-120">リーダーを検証する XML によって実行されるデータ検証</span><span class="sxs-lookup"><span data-stu-id="85f92-120">Data validation performed by the XML validating reader</span></span>  
  
-   <span data-ttu-id="85f92-121">ルールの検証ビジネス ルール エンジン (BRE) での実行に SWIFT ネットワークとの使用</span><span class="sxs-lookup"><span data-stu-id="85f92-121">SWIFT network and usage rule validation performed by the Business Rule Engine (BRE)</span></span>  
  
 [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]<span data-ttu-id="85f92-122">SWIFT メッセージの転送されたエラーのコレクション オブジェクト内の検証中に発生したエラーを収集します。</span><span class="sxs-lookup"><span data-stu-id="85f92-122"> collects any errors encountered during validation in an error collection object that travels with the SWIFT message.</span></span> <span data-ttu-id="85f92-123">修復プロセスには、XML と、エラーの一部としてメッセージに添付にシリアル化のエラー情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="85f92-123">The repair process includes serializing error information into XML and attaching it to the message as an error part.</span></span> <span data-ttu-id="85f92-124">またこの処理には、プロパティを昇格したメッセージの検証が失敗したことを示すメッセージをマークすることが含まれます ([!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]_Failed = = True)、およびエラーを報告するもう 1 つの昇格させたプロパティが検証ステージごとにカウントします。</span><span class="sxs-lookup"><span data-stu-id="85f92-124">This processing also includes marking the message with a promoted property that indicates that the message has failed validation ([!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]_Failed==True), and another promoted property that reports the error counts for each validation stage.</span></span> <span data-ttu-id="85f92-125">次の結果として得られるマルチパート メッセージで構成されます。</span><span class="sxs-lookup"><span data-stu-id="85f92-125">The resulting multipart message consists of the following:</span></span>  
  
-   <span data-ttu-id="85f92-126">失敗したメッセージを含むボディ部</span><span class="sxs-lookup"><span data-stu-id="85f92-126">A body part containing the failed message</span></span>  
  
-   <span data-ttu-id="85f92-127">エラー コレクション XML を含むエラー部分</span><span class="sxs-lookup"><span data-stu-id="85f92-127">An error part containing the error-collection XML</span></span>  
  
-   <span data-ttu-id="85f92-128">障害の状態を示すプロパティの昇格</span><span class="sxs-lookup"><span data-stu-id="85f92-128">Promoted properties indicating the failure state</span></span>  
  
## <a name="message-repair"></a><span data-ttu-id="85f92-129">Message Repair</span><span class="sxs-lookup"><span data-stu-id="85f92-129">Message Repair</span></span>  
 <span data-ttu-id="85f92-130">MRSRDepartmentPolicy 内 MRSRDepartmentRule ビジネス ルールでは、部門は、失敗したメッセージを処理を決定します。</span><span class="sxs-lookup"><span data-stu-id="85f92-130">The MRSRDepartmentRule business rule within the MRSRDepartmentPolicy determines which department will handle the failed message.</span></span> <span data-ttu-id="85f92-131">メッセージの修復オーケストレーションは、部門の修復のロールに関連付けられている受信トレイにメッセージをルーティングして修復ワークフローを開始します。</span><span class="sxs-lookup"><span data-stu-id="85f92-131">The message repair orchestration starts the repair workflow by routing the message to an inbox associated with the repair role in the department.</span></span> <span data-ttu-id="85f92-132">[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]修復ロールを実行するユーザーにメッセージを開く、[!INCLUDE[btsInpathNoVersion](../../includes/btsinpathnoversion-md.md)]フォームで、メッセージを修復し署名および送信します。</span><span class="sxs-lookup"><span data-stu-id="85f92-132">The [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] user performing the repair role opens the message in the [!INCLUDE[btsInpathNoVersion](../../includes/btsinpathnoversion-md.md)] form, repairs the message, and then signs and submits it.</span></span> <span data-ttu-id="85f92-133">オーケストレーションは、修復、キーの再検証、または承認のロールのそれぞれに修復されたメッセージをルーティングし、ワークフローが正常に完了したら、メッセージを送信ポートにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="85f92-133">The orchestration routes the repaired message to each of the repair, rekey verification, or approval roles, and after the workflow has successfully completed, routes the message to the send port.</span></span>  
  
 <span data-ttu-id="85f92-134">検証、に加えて[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]次を確認するメッセージの署名をチェックします。</span><span class="sxs-lookup"><span data-stu-id="85f92-134">In addition to validation, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] checks the signatures on the message to determine the following:</span></span>  
  
-   <span data-ttu-id="85f92-135">修復ワークフロー内のユーザーが同じ部門に属しています。</span><span class="sxs-lookup"><span data-stu-id="85f92-135">The users in the repair workflow belong to the same department</span></span>  
  
-   <span data-ttu-id="85f92-136">各ユーザーが 1 回だけサインインします。</span><span class="sxs-lookup"><span data-stu-id="85f92-136">Each user has signed just once</span></span>  
  
-   <span data-ttu-id="85f92-137">一連のユーザーに対応する役割がその部門に定義されたワークフローの組み合わせに一致します。</span><span class="sxs-lookup"><span data-stu-id="85f92-137">The sequence of roles corresponding to the users matches the sequence in the workflow defined for that department</span></span>  
  
 <span data-ttu-id="85f92-138">部門の詳細については、次を参照してください。 [Message Repair and New Submission のロールの作成の部門と](../../adapters-and-accelerators/accelerator-swift/creating-departments-and-roles-for-message-repair-and-new-submission.md)です。</span><span class="sxs-lookup"><span data-stu-id="85f92-138">For more information about departments, see [Creating Departments and Roles for Message Repair and New Submission](../../adapters-and-accelerators/accelerator-swift/creating-departments-and-roles-for-message-repair-and-new-submission.md).</span></span>  
  
 [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]<span data-ttu-id="85f92-139">未解析のメッセージを修復することもできます。</span><span class="sxs-lookup"><span data-stu-id="85f92-139"> also enables you to repair unparsed messages.</span></span> <span data-ttu-id="85f92-140">ただし、[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]修復未解析のメッセージのさまざまな処理を実行します。</span><span class="sxs-lookup"><span data-stu-id="85f92-140">However, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] performs different processing on a repaired unparsed message.</span></span> <span data-ttu-id="85f92-141">詳細については、次を参照してください。[未解析のメッセージの修復](../../adapters-and-accelerators/accelerator-swift/repairing-unparsed-messages.md)です。</span><span class="sxs-lookup"><span data-stu-id="85f92-141">For more information, see [Repairing Unparsed Messages](../../adapters-and-accelerators/accelerator-swift/repairing-unparsed-messages.md).</span></span>