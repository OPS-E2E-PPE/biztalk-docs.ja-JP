---
title: オペレーティング システムの最適化 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: af2e77d0-d69b-4ae4-b689-96831fc4deed
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 15ef1c8d5860b6e9bd3683551096c947de8c7a42
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2017
ms.locfileid: "25976696"
---
# <a name="operating-system-optimizations"></a>オペレーティング システムの最適化
このトピックのパフォーマンスを最適化するための推奨事項を提供する、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 、実稼働環境で使用されるコンピューター[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。 これらの最適化が後に適用されます[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]をインストールして構成します。  
  
## <a name="general-guidelines-for-improving-operating-system-performance"></a>オペレーティング システムのパフォーマンスを向上させるための一般的なガイドライン  
 オペレーティング システムのパフォーマンスを向上させるのには、次の推奨事項を使用できます。  
  
### <a name="install-the-latest-bios-storage-area-network-san-drivers-network-adapter-firmware-and-network-adapter-drivers"></a>最新の BIOS、記憶域エリア ネットワーク (SAN) ドライバー、ネットワーク アダプターのファームウェアおよびネットワーク アダプター ドライバーをインストールします。  
 ハードウェアの製造元によっては、BIOS、ファームウェア、およびドライバーの更新対応するハードウェアのパフォーマンスと可用性を向上させることができますを定期的に解放します。 ダウンロードして、BizTalk Server 環境内の各コンピューターで、次のハードウェア コンポーネントの更新プログラムを適用するハードウェアの製造元の Web サイトを参照してください。  
  
1.  BIOS の更新プログラム  
  
2.  SAN ドライバー (場合は、SAN の使用)  
  
3.  ファームウェアの NIC  
  
4.  NIC ドライバー  
  
### <a name="assign-the-msdtc-log-file-directory-to-a-separate-dedicated-drive"></a>MSDTC ログ ファイルのディレクトリを別の専用のドライブに割り当てる  
 別の SQL Server コンピューターに複数のメッセージ ボックス データベースを使用する BizTalk Server 環境では、Microsoft 分散トランザクション コーディネーター (MSDTC) に関連付けられている追加のオーバーヘッドが発生します。 既定では、MSDTC ログ ファイルは、%systemdrive%\windows\system32\msdtc のディレクトリにあります、DTC サービスを実行しているコンピューター。 DTC ログがパフォーマンスのボトルネックになる可能性があります可能性を軽減するのには、MSDTC ログ ファイルのディレクトリを高速なディスク ドライブに移動を検討してください。 MSDTC ログ ファイルのディレクトリを変更には、これらの手順に従います。  
  
1.  をクリックして**開始**、 をクリックして**実行**、および種類**dcomcnfg**を起動する、**コンポーネント サービス**管理コンソールです。  
  
2.  展開**コンポーネント サービス**、展開**コンピューター**を右クリックして**マイ コンピューター**、順にクリック**プロパティ**です。  
  
3.  **マイ コンピューター プロパティ**ダイアログ ボックスで、をクリックして、 **MSDTC**タブです。  
  
4.  **場所**編集ボックスの **ログ情報**、(たとえば、G:\Logs\DTCLog) を作成する新しいログが必要なパスを入力します。  
  
5.  をクリックして**リセット ログ**、およびサービスの再起動を求められます。 をクリックして **[ok]** DTC サービスを再起動し、をクリックする**OK** MSDTC サービスが再起動されていることを確認します。  
  
### <a name="configure-antivirus-software-to-avoid-real-time-scanning-of-biztalk-server-executables-and-file-drops"></a>BizTalk Server 実行可能ファイルのリアルタイム スキャンしないようにするウイルス対策ソフトウェアを構成し、ファイルの削除  
 ウイルス対策ソフトウェアの BizTalk Server 実行可能ファイルおよびフォルダーやファイルのリアルタイム スキャンの受信場所を BizTalk Server によって監視される共有 BizTalk Server のパフォーマンスに悪影響を与えることができます。 ウイルス対策ソフトウェアが BizTalk Server コンピューターにインストールされている場合の BizTalk Server によって参照される非実行可能ファイルの種類のリアルタイム スキャンを無効にする受信場所 (通常はします。XML、.csv、.txt などこともできます)。BizTalk Server 実行可能ファイルのスキャンを除外するウイルス対策ソフトウェアと構成  
  
### <a name="disable-intrusion-detection-network-scanning-between-computers-in-the-biztalk-server-environment"></a>侵入検出のネットワークが、BizTalk Server 環境内のコンピューター間でスキャンを無効にします。  
 侵入検知ソフトウェアでは、速度が低下したり、でもネットワーク経由で有効な通信を防止することができます。 侵入検知ソフトウェアがインストールされている場合は、ネットワークまたは (メッセージ キュー、WebSphere MQSeries など) にサービス コンピューターのメッセージングの BizTalk Server コンピューターと外部データ リポジトリ (SQL Server) コンピューターでスキャンを無効にします。  
  
### <a name="defragment-all-disks-in-the-biztalk-server-environment-on-a-regular-basis"></a>定期的に BizTalk Server 環境のすべてのディスクの断片化を解消します。  
 BizTalk Server 環境に過剰なディスクの断片化は、パフォーマンスが低下します。 BizTalk Server 環境のディスクの断片化を解消するこれらの手順に従います。  
  
1.  すべてのディスクの断片化を解消 (ローカルと SAN/NAS) 営業時間外のディスクの最適化をスケジュールすることによって定期的にします。  
  
2.  Windows ページファイルの断片化を解消し、システム全体のパフォーマンスを向上させるため、BizTalk Server 環境内の各ディスクのマスター ファイル テーブルを事前に割り当てできます。  
  
    > [!NOTE]  
    >  使用可能な PageDefrag ユーティリティを使用して[http://go.microsoft.com/fwlink/?LinkId=108976](http://go.microsoft.com/fwlink/?LinkId=108976) Windows ページファイルの断片化を解消し、マスター ファイル テーブルを事前に割り当てできます。  
  
### <a name="if-antivirus-software-is-installed-on-the-sql-server-computers-disable-real-time-scanning-of-data-and-transaction-files"></a>ウイルス対策ソフトウェアが、SQL Server コンピューターでインストールされている場合は、データ ファイルとトランザクションのファイルのリアルタイム スキャンを無効にします。  
 SQL Server データ ファイルとトランザクション ファイル (.mdf、.ndf、.ldf、.mdb ファイル) のリアルタイム スキャン、ディスク I/O の競合が増えるし、SQL Server のパフォーマンスが低下することができます。 SQL Server データ ファイルとトランザクションのファイルの名前は、BizTalk Server 環境間で異なる場合がありますに注意してください。 既定の BizTalk Server 構成で作成されたデータとトランザクションのファイルの詳細については、次を参照してください。[のデータベースのファイル グループを最適化する](http://msdn.microsoft.com/library/ee377060\(v=bts.70\).aspx)です。  
  
### <a name="configure-msdtc-for-biztalk-server"></a>BizTalk サーバーの MSDTC を構成します。  
 BizTalk サーバーの MSDTC を構成するのには、次の情報を確認します。  
  
-   BizTalk Server で MSDTC を構成、「を有効にする DTC のローカル ホスト サーバーで」セクションの BizTalk Server 2010 インストール ガイドを参照してください。 [http://go.microsoft.com/fwlink/?LinkID=191321](http://go.microsoft.com/fwlink/?LinkID=191321)です。  
  
-   「MSDTC の問題のトラブルシューティング」 [http://go.microsoft.com/fwlink/?LinkID=202142](http://go.microsoft.com/fwlink/?LinkID=202142)です。  
  
### <a name="configure-firewalls-for-biztalk-server"></a>BizTalk server 上を構成します。  
  
> [!NOTE]  
>  のみ、この手順は必要なかどうかは 1 つまたは複数のファイアウォール BizTalk Server 環境内で発生します。  
  
 BizTalk server 上の構成を次の情報を確認します。  
  
-   「で必要なポートの BizTalk Server」 [http://go.microsoft.com/fwlink/?LinkId=101607](http://go.microsoft.com/fwlink/?LinkId=101607)です。  
  
-   「を使用する RPC 動的ポート割り当てを構成する方法ファイアウォール」 [http://go.microsoft.com/fwlink/?LinkID=76145](http://go.microsoft.com/fwlink/?LinkID=76145)です。  
  
### <a name="use-the-ntfs-file-system-on-all-volumes"></a>すべてのボリューム上に NTFS ファイル システムの使用  
 [!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]NTFS、FAT を含むドライブおよび FAT32 を書式設定するための複数のファイル システムの種類を提供します。 NTFS では、サーバーの任意のファイル システムを常にある必要があります。[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]  
  
 NTFS では、FAT および FAT32 ファイル システムよりも大きなパフォーマンス上の利点を提供し、Windows サーバーでのみ使用する必要があります。 さらに、NTFS では、FAT および FAT32 経由で多くのセキュリティ、スケーラビリティ、安定性と復旧の利点を備えています。  
  
 以前のバージョンの Windows では、FAT および FAT32 多くの場合、実装された小さいボリュームの (たとえば < 500 MB) が多くの場合、このような状況で高速なためです。 比較的安価な現在のディスク記憶域とオペレーティング システム ドライブの容量を最大にプッシュするアプリケーションと、このような小さいボリュームが使用される可能性はありません。 FAT32 では、FAT より大きなボリュームにスケールを設定が、まだに適切なファイル システムの Windows サーバーにありません。  
  
 FAT および FAT32 多くの場合に実装されている過去ようそれらがより簡単に回復可能なボリュームに問題が発生した場合のネイティブの DOS ツールを使用して管理しやすいとして。 今日では、NTFS 回復性のさまざまなツール ビルド両方のオペレーティング システムをネイティブに使用可能なサード パーティのユーティリティと使用可能なありますがあり、不要になったファイル システムを NTFS を使用していないに対して有効な引数。  
  
### <a name="do-not-use-ntfs-file-compression"></a>NTFS ファイル圧縮を使用しないでください。  
 ボリューム上の領域を削減する簡単な方法は、NTFS ファイル システム圧縮を使用してではない enterprise ファイル サーバーの適切です。 圧縮の実装のすべてのディスク操作、CPU 上余分なオーバーヘッドを配置し、避けることが最善です。 追加のディスクを追加するためのオプションについて検討、行の近くの記憶域またはファイル システム圧縮を真剣に検討する前にデータをアーカイブすることもできます。  
  
### <a name="review-disk-controller-stripe-size-and-volume-allocation-units"></a>レビュー ディスク コント ローラー ストライプ サイズおよびボリューム アロケーション ユニット  
 構成のドライブ アレイとハードウェア ドライブ コント ローラー内の論理ドライブを確認してください。 ボリュームのフォーマットに使用した、アロケーション ユニット サイズでコント ローラー ストライプ サイズが反映されます。 これはディスクの読み取りを確認してください読み書きパフォーマンスが最適をサーバーの全体的なパフォーマンスの向上を提供します。  
  
 アロケーション ユニット (クラスターまたはブロック) サイズを大きくの構成によって、小さく効率的に使用するディスク領域はもディスク I/O パフォーマンスを向上させるように各読み取り操作中に別のデータ ディスク ヘッドが読み取ることができます。  
  
 コント ローラーを構成およびでディスクをフォーマットする最適な設定を調べるには、平均ディスク転送サイズでは、ファイル システムのような特性を持つサーバーのディスク サブシステムを確認します。 使用して、[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]平均の論理ディスク オブジェクトのカウンターを監視するパフォーマンス モニター ツールディスク読み取りバイト数/と avg.ディスク バイト数/書き込みの通常のアクティビティの期間にわたって使用する最適な値を特定するため。  
  
 アロケーション ユニット サイズが小さい場合があるが保証されているかどうか、システムは多くの小さなファイルまたはレコードにアクセスにが 64 kb アロケーション ユニット サイズは、サウンドのパフォーマンスとほとんどの状況下で I/O のスループットを実現します。 チューニングされたアロケーション ユニット サイズではパフォーマンスの向上は、ディスク負荷が増えたときに特に注意することができます。  
  
> [!NOTE]  
>  ボリュームをフォーマットするときに 4096 バイト (4 KB) を超えるアロケーション ユニット サイズを指定するには、形式のコマンド ライン ツールまたはディスクの管理ツールのいずれかが必要です。 Windows エクスプ ローラーは、このしきい値まで書式がのみです。 (各アロケーション ユニットでは、バイト列として表示)、必要な情報が表示される前に、ボリューム全体をスキャンする必要があるボリュームの現在のアロケーション ユニット サイズを確認する CHKDSK コマンドを使用できます。  
  
### <a name="monitor-drive-space-utilization"></a>ドライブの領域使用率を監視します。  
 ディスクの低いデータは高速には動作します。 これも最適化済みのドライブにデータが記述されているためできるだけのディスクの外側のエッジに近いため、これは、ディスクが高速では回転して、最適なパフォーマンスが得られます。  
  
 ディスクのシーク時間よりも通常かなり長い読み取りまたは書き込み操作です。 前述のように、データが最初に、ディスクの外側の端に書き込まれます。 ように、ディスク ストレージが増加し、空き領域の要求が減少、ディスクの中央にデータが近い書き込まれます。 ディスクのシーク、読み取りに時間がかかります、時間が、端から離れた場所ヘッドの移動するとき、データを検索するが増加し、検出されたときにディスク I/O パフォーマンスを低下させてです。  
  
 これはディスク領域使用率の監視が、重要なだけでなく容量上の理由から、パフォーマンスもします。  
  
 原則として、ディスクの空き領域の間で 20 ~ 25% の合計ディスク領域を保持するための目標達成に向けた作業します。 かどうかはディスクの空き容量を下回るこのしきい値をディスク I/O パフォーマンスが低下します。  
  
### <a name="implement-a-strategy-to-avoid-disk-fragmentation"></a>ディスクの断片化を回避するための戦略を実装します。  
 パフォーマンスの低下を防ぐために、ルート ドライブを含む、ディスク上、デフラグ ユーティリティを定期的に実行します。 この毎週ビジー状態のディスク上の操作を行います。 ディスク デフラグ ツールは、Windows server がインストールされ、指定した間隔でスケジュールされたタスクから実行することができます。  
  
### <a name="optimize-windows-server-performance-for-background-services"></a>バック グラウンド サービスの Windows Server のパフォーマンスを最適化します。  
 BizTalk Server プロセス (BTSNTSVC.exe) は、バック グラウンド サービスとして実行されます。 既定では、[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]とバック グラウンド サービスではなくアプリケーション プログラムの最適なパフォーマンスを調整するように構成します。  
  
 [!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]preemptive マルチタスクを使用して、cpu に出席はプロセスのスレッドの優先順位を設定します。 それにより、プロセスの実行は停止され、別のプロセスが開始されているオペレーティング システムの判断での手法は、preemptive マルチタスクです。 このスキームでは、1 つのスレッドが CPU を占有していることを防止します。  
  
 次の 1 つのプロセスの実行から、CPU の切り替えは、コンテキストの切り替えと呼ばれます。 Windows オペレーティング システムには、コンテキストの切り替えが発生し、次のスレッドが処理される前に、CPU 上で実行する個別のスレッドを許可する時間を決定する設定が含まれています。 この時間数が、クォンタムと呼ばれます。 この設定では、プロセッサのクォンタムをフォア グラウンド プログラムとバック グラウンド サービスの間で共有する方法を選択できます。 通常、サーバーのバック グラウンド サービスよりも割り当てられているより多くの CPU 時間をフォア グラウンド プログラムを許可することが望ましいはありません。 つまり、CPU 時間を等しく考慮の対象がすべてのアプリケーションや、サーバーで実行されているプロセスから指定してください。  
  
 BizTalk ホスト インスタンスのようなバック グラウンド サービスのパフォーマンスを向上させるには、次の手順に従います。  
  
1.  をクリックして**開始**、] をクリックして**コントロール パネルの [**、順にクリック**システム**です。  
  
2.  をクリックして、**詳細**] タブをクリックして**設定**[**パフォーマンス**です。  
  
3.  をクリックして、 **詳細設定**  タブで、をクリックして**バック グラウンド サービス**、順にクリック**ok** 2 回クリックします。  
  
### <a name="manually-load-microsoft-certificate-revocation-lists"></a>Microsoft 証明書失効リストを手動で読み込む  
 .NET アプリケーションを開始するときに、.NET Framework は、署名されたアセンブリ用の証明書失効リスト (CRL) をダウンロードしようとします。 場合は、システムは、インターネットに直接アクセスがないか、Microsoft.com ドメインへのアクセス制限は、BizTalk Server の起動を遅らせるこの可能性があります。 アプリケーションの起動時にこの遅延を避けるためには、手動でダウンロードして、コード署名のシステムに証明書失効リストをインストールする次の手順を使用することができます。  
  
1.  最新の CRL の更新プログラムをダウンロード[http://crl.microsoft.com/pki/crl/products/CodeSignPCA.crl](http://go.microsoft.com/fwlink/?LinkID=117794)と[http://crl.microsoft.com/pki/crl/products/CodeSignPCA2.crl](http://go.microsoft.com/fwlink/?LinkId=117795)です。  
  
2.  CodeSignPCA.crl と CodeSignPCA2.crl ファイルを分離されたシステムに移動します。  
  
3.  コマンド プロンプトで、certutil ユーティリティを使用して、手順 1. でダウンロードした CRL のローカル証明書ストアを更新する次のコマンドを入力します。  
  
     certutil – addstore CA c:\CodeSignPCA.crl  
  
 CRL ファイルは、ダウンロードの繰り返し実行タスクを設定する必要があり、更新の CRL をインストールするように、定期的に更新されます。 表示する、次回の更新プログラムで .crl ファイルをダブルクリックし、値を表示、 **[次へ] を更新**フィールドです。  
  
### <a name="synchronize-time-on-all-servers"></a>すべてのサーバー上の時刻と同期します。  
 チケットに関連するさまざまな操作、配信確認メッセージやログ記録は、正確なされているローカル システム クロックに依存します。 これは、システム間の誤差の時間によるログの同期をまたは期限切れとして別に拒否される 1 つのシステムによって発行されたチケット、分散環境で特にまたはまだ有効ではありません。  
  
 時間を自動的に同期するためにサーバーを構成する方法については、次を参照してください。 [http://go.microsoft.com/fwlink/?LinkId=99420](http://go.microsoft.com/fwlink/?LinkId=99420)です。  
  
### <a name="configure-the-windows-pagefile-for-optimal-performance"></a>パフォーマンスを最適に Windows ページファイルを構成します。  
 最適なパフォーマンスを Windows ページファイル (ページング ファイル) を構成する次のガイドラインに従います。  
  
1.  **ディスクの競合を削減し、ディスクのパフォーマンスを向上させるオペレーティング システムがインストールされている物理ドライブから別の物理ボリュームに、ページング ファイルを移動**移動に関連するパフォーマンスの向上の BizTalk Server コンピューターで、ページング ファイルは、ドキュメントの処理負荷によって異なります。 SQL Server コンピューターで、別のボリュームに、ページング ファイルの移動が、SQL Server のディスクの処理を要する性質により、すべてのシナリオではベスト プラクティスと見なされます。  
  
2.  **1 つまたは複数専用物理ドライブには、RAID 0 (ストライプ) または raid-1 (ミラー) 配列のいずれかとして、または RAID でない 1 つのディスク上に構成されているページング ファイルの分離**専用のディスクまたはドライブ アレイを使用して、ページファイルです。SYS が唯一のファイル ボリューム全体で、ページング ファイルが断片化するパフォーマンスが向上します。 ほとんどのディスク配列とは、配列内の物理ディスクの数が増加するにつれて、配列のパフォーマンスが向上します。 ページング ファイルは、ディスク アレイ内の複数の物理ドライブ上の複数のボリュームの間で分散している場合、ページング ファイルのサイズは、配列内の各ドライブ上の同じサイズをする必要があります。 ディスク アレイを構成する場合にもお勧め能力と速度が同じである物理ドライブを使用します。 冗長性がページング ファイルの通常必要ないことに注意してください。  
  
3.  **RAID 5 アレイ上のページング ファイルを構成しない**-ページング ファイルの活動の能力と raid-5 アレイがより適して読み取りパフォーマンス書き込みのパフォーマンスよりも書き込みでは、raid-5 アレイ上のページング ファイルの構成は推奨されません。  
  
4.  **オペレーティング システムがインストールされている場合を除いて、ページング ファイルを物理的なボリュームに移動するためのリソースがあるない場合は、オペレーティング システムと同じ論理ボリューム上に存在するページング ファイルを構成する**-上に存在するページング ファイルの構成にはオペレーティング システムがディスクを増やして、同じ物理ディスク上にある別の論理ボリューム シーク時間およびディスク プラッター ヘッドが継続的に、ページ ファイルにアクセスする代わりに、ボリューム間で移動すると、システムのパフォーマンスを低下オペレーティング システム ファイル、アプリケーション ファイル、およびデータ ファイル。 また、オペレーティング システムは通常、これは通常、最も近い物理ディスクの外側の物理ディスクの最初のパーティションにインストールし、ディスク速度がここでは、関連するパフォーマンスは最適では、ディスクのです。  
  
    > [!IMPORTANT]  
    >  削除した場合は、ページング ファイルがブート パーティションから、作成できません、クラッシュ ダンプ ファイル (メモリです。DMP) すると、カーネル モードを停止した場合にデバッグ情報の書き込みでエラーが発生します。 クラッシュ ダンプ ファイルが必要なかどうかは、少なくとものページング ファイルのままにする、オプションはありません、ブート パーティションには、物理メモリ + 1 MB のサイズ。  
  
5.  **ページング ファイルのサイズを手動で設定**– 手動でによりサーバーが自動的にサイズを変更または持たないページング ファイルによりも優れたパフォーマンスは、通常、ページング ファイルのサイズを設定します。 チューニングのベスト プラクティスは、同じ値に初期 (最小) と、ページング ファイルの最大サイズ設定を設定します。 これにより、処理リソースがかかることができる、ページング ファイルの動的なサイズ変更に失われないこと。 これは、このサイズのアクティビティは、通常、システムでメモリ リソースが既に制限になるときに発生する考えるに特に当てはまります。 同一の最小と最大のページ ファイル サイズの値の設定もによりディスク上のページングの領域が 1 つの単一の連続した領域、ディスクを向上させる時刻をシークします。