---
title: "手順 3: 複数の単体テストを同時に実行するロード テストの作成 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: b5dd7e31-7188-4edf-9513-ea2725950b47
caps.latest.revision: "19"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f8c9a99c0efaacac233c339d9279c837744892fb
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="step-3-create-a-load-test-to-perform-multiple-unit-tests-simultaneously"></a>手順 3: 複数の単体テストを同時に実行するロード テストを作成します。
ロード テストの実行のいずれかの複数のインスタンスまたは複数の単体テストをアプリケーションのパフォーマンスと負荷を処理する能力を測定するようにします。 Visual Studio 2010 のロード テストの主要なコンポーネントは次のとおりです。  
  
-   **シナリオ**– セクションで、ロード テストのテストのロード パターン、テスト ミックス モデル、テスト ミックス、ネットワーク ミックス、および Web ブラウザー ミックスを構成します。 シナリオでは、複雑な実世界の作業負荷のプロファイルのシミュレーションの複雑さに対応します。 すべての包括的な一覧についてはロード テスト シナリオのプロパティを参照してください[ロード テスト シナリオ プロパティ](http://go.microsoft.com/fwlink/?LinkId=208327)(http://go.microsoft.com/fwlink/?LinkId=208327)。  
  
-   **カウンター セット**– セクションで、ロード テストの特定グループまたはロード テストの実行中に収集するパフォーマンス カウンターの「設定」を作成します。 既定ではいくつかの定義済みのカウンター セットが提供され、カスタム カウンター セットを追加することができます。 たとえばネットワークを評価するためにパフォーマンス カスタム カウンターを作成することができますを設定、関連するネットワークのパフォーマンス カウンターを追加および使用可能なカウンター セットの一覧に保存します。 作成して、ロード テストのカウンター セットの保存の詳細については、次を参照してください。[ロード テストでのコンピューターのカウンター セットを指定する](http://go.microsoft.com/fwlink/?LinkId=208328)(http://go.microsoft.com/fwlink/?LinkId=208328)。  
  
-   **実行設定**– 実行設定は、ロード テストのさまざまな側面を定義、テスト期間、ロード テスト中にさまざまなコンピューターに関連付けられているカウンター セットを含むさまざまなテストの検証オプション、およびテスト結果のストレージ オプションです。 作成、それぞれのロード テストに複数の実行設定を保存し、およびテストを実行するときに使用する特定の設定を選択できます。 初期の実行設定は、新しいロード テスト ウィザードでロード テストを作成するときに、ロード テストに追加されます。 実行設定プロパティをすべてのロード テストの包括的な一覧については、次を参照してください。[ロード テスト実行設定プロパティ](http://go.microsoft.com/fwlink/?LinkId=208329)(http://go.microsoft.com/fwlink/?LinkId=208329)。  
  
 ロード テストを作成するには、ウィザードを使用して、新しいロード テスト、ロード テスト エディターで編集してロード テスト アナライザーで分析されます。 Microsoft Visual Studio Ultimate edition では、これらすべてのツールが含まれています。 作成して、Visual Studio 2010 Ultimate エディションでのロード テストの編集の詳細については、次を参照してください。[ロード テストの編集と作成](http://go.microsoft.com/fwlink/?LinkId=208308)(http://go.microsoft.com/fwlink/?LinkId=208308)。  
  
 」に記載のテスト プロジェクトにテストにロードを追加するのには、以下のセクションで手順に従って[手順 1: BizTalk Server に送信ドキュメントに単体テストを作成](../technical-guides/step-1-create-a-unit-test-to-submit-documents-to-biztalk-server.md)です。 次の手順では、構成する方法についても説明、**シナリオ**、**カウンター セット**、および**実行設定**ロード テスト用です。  
  
##  <a name="BKMK_StepLoadTest"></a>ロード テストを追加し、ロード テスト シナリオを構成する、カウンター セット、および実行設定  
 このトピックを使用する方法について説明、**新しいロード テスト ウィザード**テスト プロジェクトにテストし、負荷を構成する方法で特定のニーズに合わせてテストをロードを追加します。  
  
### <a name="use-the-new-load-test-wizard-to-add-a-load-test-to-the-test-project"></a>新しいロード テスト ウィザードを使用して、テスト プロジェクトにロード テストを追加するには  
 新しいロード テスト ウィザードを使用して、テスト プロジェクトにロード テストを追加する手順に従います。  
  
1.  開く、**ロード テスト**がまだ開いていない場合、Visual Studio 2010 のソリューションです。  
  
2.  BTSLoad プロジェクトにフォルダーを追加します。このフォルダーは、このプロジェクトの一部として作成されるすべてのロード テストに格納されます。 ソリューション エクスプ ローラーでプロジェクトを右クリックして、BTSLoad をポイントし、**追加**、 をクリック**新しいフォルダー**です。 フォルダー アイコンを強調表示されたテキストを**NewFolder1** BTSLoad プロジェクトの種類の下に表示されます**LoadTests**を強調表示されたテキストを変更して C:\ フォルダーの作成の完了に Enter キーを押しますProjects\LoadTest\BTSLoad\LoadTests です。  
  
3.  ソリューション エクスプ ローラーを右クリックし、 **BTSLoad**プロジェクトをポイントし、**追加**、クリックして**ロード テスト**を開始する、**新しいロード テスト ウィザード**.  
  
4.  **[次へ]**をクリックします。  
  
5.  **ロード テスト シナリオの設定の編集**ページで、**ロード テスト シナリオの名前を入力:**型**BTS_Messaging_Step**です。 [**待ち時間のプロファイル**選択**待ち時間を使用しないでください**] をクリックし、 **[次へ]**です。  
  
6.  **ロード パターン設定の編集、負荷テスト シナリオ**選択のページ**ステップ ロード**、以下の値を入力し、をクリックして**[次へ]**です。  
  
    -   **ユーザー カウントの開始:** 30 ユーザー  
  
    -   **ステップ実行間隔:** 60 秒  
  
    -   **ユーザー カウントのステップ:** 10 人のユーザー  
  
    -   **最大ユーザー カウント**の 80 人  
  
    > [!NOTE]  
    >  ステップ ロード パターンの設定を適用するときに、すべてのステップ インクリメントを完了するのに必要な時間を計算する必要があります。 たとえば、ロード テストの上に指定されたロード パターン設定を使用しては必要がありますすべて 60 秒間の完了まで 5 分ずつ場合ステップの 80 人に 30 を増やしします。 うちの 1 つは、最後のページで、新しいロード テスト ウィザードでロード テストの長さを指定するオプションが表示されます、**ロード テストの継続時間**です。 すべてのステップ単位があります (ここでは 5 分) の値を入力する簡単なタスクを完了するのに必要な時間を計算が既に場合**ロード テストの継続**です。  
  
7.  **、ロード テストのテスト ミックス モデルを選択**ページの選択**仮想ユーザー数に基づく** をクリックし、 **次へ**です。  
  
8.  **ロード テスト シナリオにテストを追加し、テスト ミックスを編集**ページをクリックして、**追加**ボタンをクリックします。  
  
9. **使用可能なテスト**ダブルクリック**BTSMessaging**と**BTSMessaging2**のリストにこれらの単体テストを追加する**選択したテストの**します。 をクリックして**OK**  をクリックし、 **次へ**です。  
  
10. **ロード テスト シナリオにネットワークの種類を追加し、ネットワーク ミックスを編集**ページを確認する**ネットワークの種類**に設定されている**LAN**で、**配布**の**100%**  をクリックし、**次**です。  
  
11. **ロード テストの実行中にカウンター セットで監視するコンピューターを指定する**ページをクリック**次**です。  
  
    > [!NOTE]  
    >  この時点で、ロード テストには、コンピューターを追加しないでください。 新しいロード テスト ウィザードはできるだけにコンピューターを定義済みのカウンター セットに関連付けるし、このロード テストの定義済みの両方を必要とし、*カスタム*カウンター セット。 カスタム カウンター セットを追加し、定義済みの両方を使用してコンピューターを監視するロード テストを構成するには、ロード テストを編集するには、ウィザードが完了して、ロード テストを保存した後*と*カスタム カウンター セット。  
  
     **実行ロード テストの設定の確認と編集**ページには、次の値を入力してください。  
  
    1.  選択**ロード テストの継続**です。  
  
    2.  **ウォーム アップ継続時間 (hh mm ss)** 30 秒  
  
    3.  **実行の継続時間 (hh mm ss)** 5 分  
  
        > [!NOTE]  
        >  割り当てられた時間**実行の継続時間**すべてのステップに、上記の手順 5. またはこの例の 5 分間での説明に従って完了インクリメントに必要な時間を等しく必要があります。  
  
    4.  **サンプリング レート**5 秒  
  
    5.  **説明**(省略可能)、ここで、ロード テストの説明を入力します。  
  
    6.  **テスト失敗時にログを保存**は True。  
  
    7.  **検証レベル**低 – は、低に指定された検証規則を実行します。  
  
12. をクリックして**完了**を新しいロード テスト ウィザードを閉じます。  
  
13. をクリックして、**ファイル**メニュー**保存\<ロード テストの名前 > として .loadtest**です。  
  
    > [!NOTE]  
    >  この例では<Load Test Name>ファイルの名前が既に手動で変更されていない限り、Visual Studio 2010、通常の loadtestx.loadtest により、ロード テストのファイルに割り当てられた名前になります。  
  
14. 先ほど作成した C:\Projects\LoadTest\BTSLoad\LoadTests ディレクトリにファイルを保存します。 シナリオで使用する名前を持つファイルを保存することができますこの例では、シナリオの名前は BTS_Messaging_Step C:\Projects\LoadTest\BTSLoad\LoadTests\BTS_Messaging_Step.loadtest として loadtest ファイルが保存されます。  
  
###  <a name="BKMK_BTSCounters"></a>BizTalk Server 主要業績評価指標 (KPI) を測定する設定、カスタムのカウンターを追加します。  
 カウンター セットを決定する最大持続可能なスループット (MST)、BizTalk Server アプリケーションのために必要な BizTalk Server KPI を測定するパフォーマンス カウンターを追加する手順に従います。  
  
1.  ソリューション エクスプ ローラー をダブルクリックでは、負荷は、ロード テスト エディターでロード テストを表示するのには、前のセクションで作成したことをテストします。  
  
2.  ロード テスト エディターをクリックして展開**カウンター セット**です。 BizTalk Server の定義済みのカウンターが設定されていない、したがって"BizTalk Server"カウンター セットは、カウンターの一覧に追加する必要があります、カスタム設定のことに注意してください。  
  
3.  右クリック**カウンター セット**選択**カスタム カウンター セットの追加**です。 既定でこの操作は、カスタム カウンター セットの名前を持つを作成**Custom1**です。  
  
4.  右クリックし、 **Custom1**カウンターに設定し、**プロパティ**にフォーカスを設定、**プロパティ**Custom1 カウンター セットのダイアログ ボックス。  
  
5.  名前をダブルクリックして**Custom1**で、**プロパティ**ダイアログで、「 **BizTalk**し、ENTER キーを押しますカスタムのカウンター セットの名前を変更する**BizTalk**.  
  
6.  ロード テスト エディターを右クリックし、 **BizTalk**カウンターに設定し、**カウンターの追加**です。  
  
7.  **コンピューター**、BizTalk Server パフォーマンス カウンターが含まれているパフォーマンス モニター カテゴリを表示する BizTalk Server グループに BizTalk Server コンピューターの 1 つの名前を入力します。  
  
    > [!IMPORTANT]  
    >  すべての BizTalk Server パフォーマンス カテゴリとパフォーマンス カウンターを表示しをグループ内の BizTalk Server の完全修飾ドメイン名 (または IP アドレス) を入力する必要がありますで、次のホストのインスタンスを開始する必要がありますも、BizTalk Server コンピューター。  
    >   
    >  -   ロード テスト中に実行するオーケストレーションにバインドされている BizTalk ホストのインスタンス。  
    > -   送信または受信するロード テスト中に実行されるアダプターのハンドラーとして構成されている BizTalk ホストのインスタンス。  
  
8.  BizTalk Server では、非常に広範囲にわたるパフォーマンス カウンターを提供します。 のみを次の BizTalk Server のパフォーマンスを追加する必要があるアプリケーションがカウンターを BizTalk Server の最大持続可能なパフォーマンス (MST) を確認する目的で、 **BizTalk**カスタム カウンター セット。  
  
    |パフォーマンス カテゴリ|パフォーマンス カウンター|  
    |--------------------------|-------------------------|  
    |プロセッサ|_Total カウンター インスタンスのプロセッサ時間 (%)|  
    |Biztalk: メッセージ ボックス: 一般的なカウンター|スプールのサイズ、  *\<BizTalk メッセージ ボックス データベース名 >*:*\<SQL Server インスタンス名 >*カウンター インスタンス。 **注:***\<BizTalk メッセージ ボックス データベース名 >*と *\<SQL Server インスタンス名 >* BizTalk の実際の名前の単なるプレース ホルダーメッセージ ボックス データベースと BizTalk メッセージ ボックス データベースを格納する SQL Server インスタンス。   これらのプレース ホルダーは、BizTalk メッセージ ボックス データベースと関連付けられている SQL Server インスタンスの実際の名前に置き換える必要があります。|  
    |BizTalk:メッセージング|受信ホスト カウンター インスタンスの受信/秒を説明します。<br /><br /> ドキュメント処理数/秒の送信ホスト カウンター インスタンス。|  
    |BizTalk:Message Agent|ドキュメントのメッセージ配信の受信速度では、ホストが表示されます。|  
    |BizTalk:Message Agent|メッセージは、ドキュメントの送信ホストの送信速度を公開します。|  
    |XLANG/s Orchestrations|オーケストレーション完了した 1 秒あたりのオーケストレーションの処理ホスト。|  
  
### <a name="modify-run-settings-to-map-counter-sets-to-appropriate-computers"></a>カウンター セットを適切なコンピューターにマップする実行設定を変更します。  
 ロード テストの適切なコンピューターに適切なカウンター セットをマップするこれらの手順に従います。  
  
1.  **ロード テスト エディター**を右クリックして**実行設定**選択**カウンター セットの管理**です。  
  
2.  をクリックして**コンピューターの追加**一覧に新しいコンピューターを追加します。 強調表示されたテキストとアイコン**新しいコンピューター**下に表示されます**を監視するコンピューターおよびカウンター セット**です。 一覧に追加するには、コンピューターの名前を入力して、強調表示されたテキストを置き換えます。  
  
3.  コンピューターを一覧に追加すると、使用可能なカウンター セットの一覧を展開し、利用可能なカウンターの 1 つ以上選択する をクリックをカウンター セットを関連付けるコンピューターを設定します。  
  
4.  カウンター セットをするにはパフォーマンス データを収集するすべてのコンピューターに関連付けるまで、手順 2. および 3. を繰り返します。  
  
###  <a name="BKMK_TestSettings"></a>テストを実行し、リモート データを収集するソリューションにテスト設定ファイルを追加します。  
 作成したテスト コント ローラーおよびテスト エージェント コンピューターを使用してロード テストを構成する[手順 2: ロード テスト コント ローラーの構成とエージェント コンピュータ](../technical-guides/step-2-configure-load-test-controller-and-agent-computers.md)、手順に従います[リモート実行のテストの設定を追加または、ソリューションにデータ コレクション](http://go.microsoft.com/fwlink/?LinkId=209182)(http://go.microsoft.com/fwlink/?LinkId=209182) 次のようにします。  
  
1.  手順 3 の名前を入力してください**BizTalkLoadTest。**  
  
2.  既に手順 3 で名前を入力したため、手順 6. を無視します。  
  
3.  手順 7 では、入力「これらリモート テストの実行のテスト設定を既定値は、」**説明**です。  
  
4.  手順 8 では、既定の名前付けスキームを選択します。  
  
5.  手順 9、下の**テストの実行メソッド**選択**リモート実行**[**コント ローラー**テスト コント ローラーのコンピューターを選択し、その他のプロパティのままにします**ロール**を既定の設定] ページ。  
  
6.  手順 24、オプションを選択します**既定のホストで実行する**、select、**型ホスト**の**既定**、し、 **32 ビットまたは 64 ビット プロセスでテストを実行**、。オプションを選択して**64 ビット コンピューターで 64 ビット プロセスでテストを実行**です。  
  
7.  ステップ 25 選択**、個々 のテストを実行時間を超えた場合の失敗としてマーク**し選択 30 分の既定値のままにします。  
  
8.  27b、ステップのチェック ボックスをオンに**テスト ディレクトリ内のアセンブリに対して読み込みコンテキストを使用して**、クリックして**名前を付けて保存**です。  
  
9. **名前を付けて保存** ダイアログ ボックスであることを確認名前**BizTalkLoadTest**が横に入力された**ファイル名**、 をクリック**保存**です。 ソリューションにテスト設定ファイルが追加されました。