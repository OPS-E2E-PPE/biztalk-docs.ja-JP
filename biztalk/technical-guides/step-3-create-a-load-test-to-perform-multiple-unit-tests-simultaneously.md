---
title: 手順 3:同時に複数の単体テストを実行するロード テストの作成 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: b5dd7e31-7188-4edf-9513-ea2725950b47
caps.latest.revision: 19
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cb1f4949f8acb0e422888abc511b6323c57817c0
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65313279"
---
# <a name="step-3-create-a-load-test-to-perform-multiple-unit-tests-simultaneously"></a>手順 3:同時に複数の単体テストを実行するロード テストを作成します。
アプリケーションのパフォーマンスと負荷を処理する能力を測定するための複数の単体テストまたはロード テストが 1 つの複数のインスタンスを実行します。 Visual Studio 2010 のロード テストの主要コンポーネントは次のとおりです。  
  
- **シナリオ**– セクションで、ロード テストのテストのロード パターン、テスト ミックス モデル、テスト ミックス、ネットワーク ミックス、および Web ブラウザー ミックスを構成します。 シナリオでは、現実世界の複雑な作業のロード プロファイルをシミュレートする複雑さに対応します。 すべての包括的な一覧についてはロード テスト シナリオのプロパティを参照してください[ロード テスト シナリオ プロパティ](http://go.microsoft.com/fwlink/?LinkId=208327)(http://go.microsoft.com/fwlink/?LinkId=208327)します。  
  
- **カウンター セット**– 特定グループまたはロード テストの実行中に収集するパフォーマンス カウンターの「セット」を作成するロード テストのセクション。 いくつかの定義済みのカウンター セットは既定で提供され、カスタム カウンター セットを追加することができます。 ネットワークを評価する例についてはパフォーマンス カスタム カウンターを作成する設定、関連するネットワークのパフォーマンス カウンターを追加および使用可能なカウンター セットの一覧に保存します。 作成して、ロード テストのカウンター セットの保存の詳細については、次を参照してください。[ロード テストでコンピューターのカウンター セットを指定する](http://go.microsoft.com/fwlink/?LinkId=208328)(http://go.microsoft.com/fwlink/?LinkId=208328)します。  
  
- **実行設定**– 実行設定は、ロード テストのさまざまな側面を定義、テスト期間、ロード テスト中にさまざまなコンピューターに関連付けられているカウンター セットを含むさまざまなテストの検証オプション、およびテスト結果のストレージ オプション。 作成、ロード テストごとに複数の実行設定を保存し、テストを実行するときに使用する特定の設定を選択します。 初期の実行設定は、新しいロード テスト ウィザードでロード テストを作成するときに、ロード テストに追加されます。 すべてのロード テスト実行設定プロパティの包括的な一覧については、次を参照してください。[ロード テストの実行設定プロパティ](http://go.microsoft.com/fwlink/?LinkId=208329)(http://go.microsoft.com/fwlink/?LinkId=208329)します。  
  
  ロード テストは、新しいロード テスト ウィザードでロード テスト エディターで編集し、ロード テスト アナライザーで分析を使用して作成されます。 Microsoft Visual Studio Ultimate edition では、これらすべてのツールが含まれます。 作成して、Visual Studio 2010 Ultimate edition でのロード テストの編集の詳細については、次を参照してください。[の作成とロード テストの編集](http://go.microsoft.com/fwlink/?LinkId=208308)(http://go.microsoft.com/fwlink/?LinkId=208308)します。  
  
  説明されているテスト プロジェクトにテスト負荷を追加する次のセクションの手順に従います[手順 1。BizTalk Server にドキュメントを送信する単体テスト作成](../technical-guides/step-1-create-a-unit-test-to-submit-documents-to-biztalk-server.md)です。 構成する方法も説明しています。、**シナリオ**、**カウンター セット**、および**実行設定**ロード テスト用です。  
  
##  <a name="BKMK_StepLoadTest"></a> ロード テストの追加しロード テスト シナリオの構成、カウンター セット、および実行設定  
 このトピックでは、使用する方法を説明します、**新しいロード テスト ウィザード**テスト プロジェクトにテストし、負荷を構成する方法を特定のニーズに合わせてテスト負荷を追加します。  
  
### <a name="use-the-new-load-test-wizard-to-add-a-load-test-to-the-test-project"></a>新しいロード テスト ウィザードを使用して、テスト プロジェクトにロード テストを追加するには  
 新しいロード テスト ウィザードを使用してテスト プロジェクトにロード テストを追加するこれらの手順に従います。  
  
1.  開く、**ロード テスト**がまだ開いていない場合、Visual Studio 2010 でのソリューションです。  
  
2.  BTSLoad プロジェクトにフォルダーを追加します。このフォルダーには、このプロジェクトの一部として作成されるすべてのロード テストが含まれます。 ソリューション エクスプ ローラーで BTSLoad プロジェクトを右クリックして**追加**、 をクリック**新しいフォルダー**します。 強調表示されたテキストでフォルダー アイコン**NewFolder1** BTSLoad プロジェクトの種類の下に表示されます**LoadTests**を強調表示されたテキストを変更し、C:\ フォルダーの作成を完了 Enter キーを押しますProjects\LoadTest\BTSLoad\LoadTests します。  
  
3.  ソリューション エクスプ ローラーを右クリックし、 **BTSLoad**プロジェクトをポイントして、**追加**、 をクリックし、**ロード テスト**を開始する、**新しいロード テスト ウィザード**.  
  
4.  **[次へ]** をクリックします。  
  
5.  **ロード テスト シナリオの設定の編集**ページ**ロード テスト シナリオの名前を入力します:** 型**BTS_Messaging_Step**します。 **待ち時間のプロファイル**選択**待ち時間を使用しないでください**順にクリックします**次**します。  
  
6.  **編集ロード パターン設定をロード テスト シナリオ**選択ページ**ステップ ロード**、以下の値を入力し、クリックして**次**。  
  
    -   **ユーザー カウントを開始します。** 30 ユーザー  
  
    -   **ステップ実行間隔:** 60 秒  
  
    -   **ユーザー カウントのステップ:** 10 人のユーザー  
  
    -   **最大ユーザー カウント**の 80 人  
  
    > [!NOTE]  
    >  ステップ ロード パターンの設定を適用するときに、すべてのステップ インクリメントを完了するために必要な時間を計算する必要があります。 たとえば、ロード テスト上で指定した設定の読み込みパターンを使用してでは必要があります 5 分、60 秒間のすべてを完了する手順インクリメント 30 から 80 人を調査するときに。 あるうちの 1 つは、最後のページで、新しいロード テスト ウィザードでロード テストの長さを指定するためのオプションが表示されます、**ロード テストの実行時間**します。 すべてのステップ単位があります (このケースでは 5 分間) の値を入力する簡単なタスクを完了するのに必要な時間を既に計算がある場合**ロード テストの継続時間**します。  
  
7.  **ロード テストのテスト ミックス モデルを選択します。** 選択ページ**仮想ユーザー数に基づく**順にクリックします **[次へ]**。  
  
8.  **ロード テスト シナリオにテストを追加し、テスト ミックスの編集**ページをクリックして、**追加**ボタン。  
  
9. **使用可能なテスト**ダブルクリック**BTSMessaging**と**BTSMessaging2**のリストにこれらの単体テストを追加する**選択したテストの**。 をクリックして**OK**順にクリックします**次**します。  
  
10. **をロード テスト シナリオにネットワークの種類を追加し、ネットワーク ミックスの編集**ページを確認する**ネットワークの種類**に設定されている**LAN**で、**配布**の**100%** し**次**します。  
  
11. **ロード テストの実行中にカウンター セットを監視するコンピューターを指定する**ページ クリック **[次へ]** します。  
  
    > [!NOTE]  
    >  この時点でのロード テストには、コンピューターを追加しないでください。 新しいロード テスト ウィザードでのみ許可にコンピューターを定義済みのカウンター セットに関連付けることは、このロード テストは、定義済みの両方の使用を要求し、*カスタム*カウンター セット。 カスタム カウンター セットを追加して、定義済みの両方を使用してコンピューターを監視するロード テストを構成するロード テストを編集するには、ウィザードが完了して、ロード テストを保存した後*と*カスタム カウンター セット。  
  
     **実行ロード テストの設定の確認と編集**ページは、次の値を入力します。  
  
    1.  選択**ロード テストの継続時間**します。  
  
    2.  **ウォーム アップ継続時間 (hh mm ss)** 30 秒  
  
    3.  **実行の継続時間 (hh mm ss)** 5 分  
  
        > [!NOTE]  
        >  割り当てられた時間**実行の継続時間**のために必要なすべてのステップ ステップ 5、またはこの例では 5 分で説明されているように完了した単位の時間を等しく必要があります。  
  
    4.  **サンプリング レート**5 秒  
  
    5.  **説明**(省略可能)、ここで、ロード テストの説明を入力します。  
  
    6.  **テスト失敗時にログを保存**は True。  
  
    7.  **検証レベル**低-低に指定された検証規則を実行  
  
12. クリックして**完了**を新しいロード テスト ウィザードを閉じます。  
  
13. をクリックして、**ファイル**メニュー選択し、**保存\<ロード テスト名\>として .loadtest**します。  
  
    > [!NOTE]  
    >  この例で<Load Test Name>ファイルの名前が既に手動で変更していない限り、Visual Studio 2010、通常の loadtestx.loadtest により、ロード テスト ファイルに割り当てられた名前になります。  
  
14. 先ほど作成した C:\Projects\LoadTest\BTSLoad\LoadTests ディレクトリに保存します。 シナリオで使用する名前のファイルを保存することができますこの例では、シナリオの名前は BTS_Messaging_Step C:\Projects\LoadTest\BTSLoad\LoadTests\BTS_Messaging_Step.loadtest として loadtest ファイルが保存されます。  
  
###  <a name="BKMK_BTSCounters"></a> BizTalk Server の主要業績評価指標 (KPI) を測定する設定、カスタム カウンターを追加します。  
 カウンター セットの最大持続可能なスループット (MST) の BizTalk Server アプリケーションを決定するために必要な BizTalk Server の KPI を測定するパフォーマンス カウンターを追加するこれらの手順に従います。  
  
1. ソリューション エクスプ ローラー をダブルクリックで、ロード テストのロード テスト エディターでロード テストを表示するのには、前のセクションで作成しました。  
  
2. ロード テスト エディターで、クリックして展開**カウンター セット**します。 BizTalk Server の定義済みのカウンター セットがないことは、そのため、カスタム カウンター セットは"BizTalk Server"は、カウンターの一覧に追加する必要がありますが設定に注意してください。  
  
3. 右クリック**カウンター セット**選択**カスタム カウンター セットの追加**します。 既定でこの操作は、カスタム カウンター セットと名を作成**Custom1**します。  
  
4. 右クリックし、 **Custom1**カウンター セットおよび選択**プロパティ**にフォーカスを設定、**プロパティ**Custom1 カウンター セットのダイアログ。  
  
5. 名前をダブルクリックして**Custom1**で、**プロパティ**ダイアログ ボックスで、型**BizTalk**とカスタムのカウンター セットの名前を変更するのには ENTER キーを押します**BizTalk**.  
  
6. ロード テスト エディターを右クリックし、 **BizTalk**カウンター セットおよび選択**カウンターの追加**します。  
  
7. **コンピューター**、BizTalk Server パフォーマンス カウンターが含まれているパフォーマンス モニター カテゴリを表示する BizTalk Server グループに BizTalk Server コンピューターの 1 つの名前を入力します。  
  
   > [!IMPORTANT]
   >  十分にすべての BizTalk Server パフォーマンス カテゴリとパフォーマンス カウンターが一覧表示しをグループ内の BizTalk Server の完全修飾ドメイン名 (または IP アドレス) を入力する必要がありますで次のホストのインスタンスを開始する必要がありますも、BizTalk Server コンピューター。  
   > 
   > - ロード テスト中に実行するオーケストレーションにバインドされている BizTalk ホストのインスタンス。  
   >   -   送信または受信ロード テスト中に実行されるアダプターのハンドラーとして構成されている BizTalk ホストのインスタンス。  
  
8. BizTalk Server では、非常に広範囲にわたるパフォーマンス カウンターを提供します。 BizTalk Server の最大持続可能なパフォーマンス (MST) を決定するためのアプリケーションが次の BizTalk Server のパフォーマンスを追加するだけで済みますがするカウンター、 **BizTalk**カスタム カウンター セット。  
  
   |パフォーマンス カテゴリ|パフォーマンス カウンター|  
   |--------------------------|-------------------------|  
   |プロセッサ|% プロセッサ時間 _Total カウンターのインスタンス。|  
   |BizTalk:Message ボックス:一般的なカウンター|スプールのサイズ、  *\<BizTalk メッセージ ボックス データベース名\>*:*\<SQL Server インスタンス名\>* カウンターのインスタンス。 **注:***\<BizTalk メッセージ ボックス データベース名\>* と *\<SQL Server インスタンス名\>* database と SQL Server、BizTalk メッセージ ボックスの実際の名前の単なるプレース ホルダーをBizTalk メッセージ ボックス データベースを格納するインスタンス。 これらのプレース ホルダーは、BizTalk メッセージ ボックス データベースと関連付けられている SQL Server インスタンスの実際の名前に置き換える必要があります。|  
   |BizTalk:メッセージング|受信ホスト カウンター インスタンスの受信/秒を説明します。<br /><br /> 送信ホストのカウンター インスタンスの処理/秒を説明します。|  
   |BizTalk:Message Agent|ドキュメントのメッセージ配信の受信レートには、ホストが表示されます。|  
   |BizTalk:Message Agent|メッセージは、ドキュメントの送信ホストの送信速度を公開します。|  
   |XLANG/s Orchestrations|オーケストレーション完了した 1 秒あたりのオーケストレーション処理ホスト。|  
  
### <a name="modify-run-settings-to-map-counter-sets-to-appropriate-computers"></a>カウンター セットを適切なコンピューターにマップする実行設定を変更します。  
 ロード テスト用の適切なコンピューターに適切なカウンター セットをマップするこれらの手順に従います。  
  
1.  **ロード テスト エディター**、右クリック**実行設定**選択と**カウンター セットの管理**します。  
  
2.  クリックして**コンピューターの追加**リストに新しいコンピューターを追加します。 強調表示されたテキストとアイコン**新しいコンピューター**下に表示されます**を監視するコンピューターおよびカウンター セット**します。 一覧に追加するには、コンピューターの名前を入力して、強調表示されたテキストを置き換えます。  
  
3.  コンピューターを一覧に追加すると、使用可能なカウンター セットの一覧を展開し、順にクリックして、使用可能なカウンターの 1 つ以上選択をカウンター セットを関連付けるコンピューターを設定します。  
  
4.  手順 2. および 3. を繰り返して、パフォーマンス データを収集するようには対象のすべてのコンピューターとカウンター セットに関連付けられました。  
  
###  <a name="BKMK_TestSettings"></a> テストを実行し、データの収集をリモートでソリューションをテスト設定ファイルを追加します。  
 作成した Test Controller および Test Agent のコンピューターを使用してロード テストを構成する[手順 2。ロード テスト コント ローラーとエージェント コンピュータを構成する](../technical-guides/step-2-configure-load-test-controller-and-agent-computers.md)、手順に従います[リモートの実行またはデータ コレクションのテストの設定をソリューションに追加](http://go.microsoft.com/fwlink/?LinkId=209182)(http://go.microsoft.com/fwlink/?LinkId=209182)以下に示すよう。  
  
1.  手順 3 では、名前を入力します**BizTalkLoadTest。**  
  
2.  手順 3 での名前を入力済みであるために、手順 6 を無視します。  
  
3.  手順 7 では、入力「リモート テストの実行のテスト設定を既定値は」**説明**します。  
  
4.  手順 8 では、既定の名前付けスキームを選択します。  
  
5.  手順 9 では、下の**テストの実行メソッド**選択**リモート実行**下で、**コント ローラー**テスト コント ローラー コンピューターを選択しで、残りのプロパティのままにします**ロール**を既定の設定 ページ。  
  
6.  手順 24 のオプションを選択します**既定のホストで実行する**を選択、**ホストの種類**の**既定**、し、 **32 ビットまたは 64 ビット プロセスでテストを実行**、。オプションを選択して**64 ビット コンピューター上で 64 ビット プロセスでテストを実行**します。  
  
7.  手順 25 では、選択**個々 のテストを実行時間を超えた場合の失敗としてマーク**し選択 30 分の既定値のままにします。  
  
8.  27b の手順では、チェック ボックスを選択します。**テスト ディレクトリ内のアセンブリに対して読み込みコンテキストを使用して**、 をクリックし、**名前を付けて保存**。  
  
9. **名前を付けて保存** ダイアログ ボックスで、ことを確認します名前**BizTalkLoadTest**が横に入力**ファイル名**、 をクリック**保存**します。 ソリューションにテスト設定ファイルが追加されました。