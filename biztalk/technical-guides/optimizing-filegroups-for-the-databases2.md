---
title: データベース ファイル グループの最適化 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8d7fa4c9-e504-4f43-a308-517a4a574c26
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 2f82c9a6607a4f7d58459f721b8a3354b49702af
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65291384"
---
# <a name="optimizing-filegroups-for-the-databases"></a><span data-ttu-id="5c3d2-102">データベースのファイルグループの最適化</span><span class="sxs-lookup"><span data-stu-id="5c3d2-102">Optimizing Filegroups for the Databases</span></span>
<span data-ttu-id="5c3d2-103">ファイルは、入出力 (I/O) の競合が制限要因、または運用環境の BizTalk Server 環境で、ボトルネックが頻繁にです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-103">File input/output (I/O) contention is frequently a limiting factor, or bottleneck, in a production BizTalk Server environment.</span></span> <span data-ttu-id="5c3d2-104">BizTalk Server が非常にデータベースの処理を要するアプリケーションと、さらに、BizTalk Server によって使用される SQL Server データベースは、非常にファイル I/O を集中的に使用します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-104">BizTalk Server is a very database intensive application and in turn, the SQL Server database used by BizTalk Server is very file I/O intensive.</span></span> <span data-ttu-id="5c3d2-105">このトピックでは、ファイルおよびファイル I/O の競合の発生を最小限に抑えるし、BizTalk Server ソリューションの全体的なパフォーマンスを向上する SQL Server のファイル グループの機能の使用を最適化する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-105">This topic describes how to make optimal use of the files and filegroups feature of SQL Server to minimize the occurrence of file I/O contention and improve the overall performance of a BizTalk Server solution.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="5c3d2-106">概要</span><span class="sxs-lookup"><span data-stu-id="5c3d2-106">Overview</span></span>  
 <span data-ttu-id="5c3d2-107">すべての BizTalk Server ソリューションでは、スループットが増加するにつれて、ファイル I/O の競合が最終的に発生します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-107">Every BizTalk Server solution will eventually encounter file I/O contention as throughput is increased.</span></span> <span data-ttu-id="5c3d2-108">I/O サブシステムまたはストレージ エンジンは、任意のリレーショナル データベースのキー コンポーネントです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-108">The I/O subsystem, or storage engine, is a key component of any relational database.</span></span> <span data-ttu-id="5c3d2-109">通常、データベースの実装を成功させるには、プロジェクトの初期段階で慎重に計画を立てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-109">A successful database implementation typically requires careful planning at the early stages of a project.</span></span> <span data-ttu-id="5c3d2-110">計画では、次の問題について検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-110">This planning should include consideration of the following issues:</span></span>  
  
- <span data-ttu-id="5c3d2-111">RAID (Redundant Array of Independent Disks) デバイスなど、使用するディスク ハードウェアの種類。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-111">What type of disk hardware to use, such as RAID (redundant array of independent disks) devices.</span></span> 
  
- <span data-ttu-id="5c3d2-112">ファイルおよびファイル グループを使用してディスク上のデータを分配する方法。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-112">How to apportion data on the disks using files and filegroups.</span></span> <span data-ttu-id="5c3d2-113">SQL Server でのファイルおよびファイル グループの使用に関する詳細については、次を参照してください。 [Database Files and Filegroups](https://docs.microsoft.com/sql/relational-databases/databases/database-files-and-filegroups)します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-113">For more information about using files and filegroups in SQL Server, see [Database Files and Filegroups](https://docs.microsoft.com/sql/relational-databases/databases/database-files-and-filegroups).</span></span>
  
- <span data-ttu-id="5c3d2-114">データにアクセスする場合は、パフォーマンスを向上させるための最適なインデックスの設計を実装します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-114">Implementing the optimal index design for improving performance when accessing data.</span></span> <span data-ttu-id="5c3d2-115">インデックスのデザインの詳細については、次を参照してください。[インデックスの設計](https://docs.microsoft.com/sql/relational-databases/sql-server-index-design-guide)します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-115">For more information about designing indexes, see [Designing Indexes](https://docs.microsoft.com/sql/relational-databases/sql-server-index-design-guide).</span></span>
  
- <span data-ttu-id="5c3d2-116">最適なパフォーマンスを SQL Server の構成パラメーターを設定する方法。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-116">How to set SQL Server configuration parameters for optimal performance.</span></span> <span data-ttu-id="5c3d2-117">SQL Server の最適な構成パラメーターの設定の詳細については、次を参照してください。[サーバー構成オプションの](https://docs.microsoft.com/sql/database-engine/configure-windows/server-configuration-options-sql-server)します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-117">For more information about setting optimal configuration parameters for SQL Server, see [Server Configuration Options](https://docs.microsoft.com/sql/database-engine/configure-windows/server-configuration-options-sql-server).</span></span>
  
  <span data-ttu-id="5c3d2-118">BizTalk Server の主な設計目標の 1 つは、メッセージがあることを確認する**決して**失われます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-118">One of the primary design goals of BizTalk Server is to ensure that a message is **never** lost.</span></span> <span data-ttu-id="5c3d2-119">メッセージの損失の可能性を軽減するためには、メッセージが処理されるメッセージをメッセージ ボックス データベースに書き込まれます頻繁に。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-119">In order to mitigate the possibility of message loss, messages are frequently written to the MessageBox database as the message is processed.</span></span> <span data-ttu-id="5c3d2-120">オーケストレーションによって処理されるは、メッセージ、メッセージがオーケストレーション内のすべての永続化ポイントにあるメッセージ ボックス データベースに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-120">When messages are processed by an orchestration, the message is written to the MessageBox database at every persistence point in the orchestration.</span></span> <span data-ttu-id="5c3d2-121">これらの永続性ポイントには、メッセージ ボックスに、物理ディスクへのメッセージと関連する状態の書き込みが発生します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-121">These persistence points cause the MessageBox to write the message and related state to physical disk.</span></span> <span data-ttu-id="5c3d2-122">高いスループットをでは、この永続化は、かなりのディスクの競合が生じるし、ボトルネックになる可能性があることができます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-122">At higher throughputs, this persistence can result in considerable disk contention and can potentially become a bottleneck.</span></span>  
  
  <span data-ttu-id="5c3d2-123">ファイルを使用する最適なとを効果的にファイル IO のボトルネックを解決し、BizTalk Server ソリューションの全体的なパフォーマンスを向上させる SQL Server でのファイル グループの機能も示されています。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-123">Making optimal use of the files and filegroups feature in SQL Server has been shown to effectively address File IO bottlenecks and improve overall performance in BizTalk Server solutions.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5c3d2-124">この最適化は、経験豊富な SQL Server データベース管理者と後のすべての BizTalk Server データベースを正しくバックアップされているだけでのみ実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-124">This optimization should only be done by an experienced SQL Server database administrator and only after all BizTalk Server databases have been properly backed up.</span></span> <span data-ttu-id="5c3d2-125">この最適化は、BizTalk Server 環境ですべての SQL Server コンピューターで実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-125">This optimization should be performed on all SQL Server computers in the BizTalk Server environment.</span></span>  
  
 <span data-ttu-id="5c3d2-126">SQL Server のファイルおよびファイル グループは、この機能により、データベースを複数のディスク コント ローラーに複数のディスクにまたがって作成するためにデータベースのパフォーマンスを向上させるために使用できるまたは RAID (独立したディスクの冗長アレイ) システムです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-126">SQL Server files and filegroups can be used to improve database performance because this functionality allows a database to be created across multiple disks, multiple disk controllers, or RAID (redundant array of independent disks) systems.</span></span> <span data-ttu-id="5c3d2-127">たとえば、コンピューターにディスクが 4 個ある場合は、データ ファイル 3 つとログ ファイル 1 つから構成されるデータベースを、各ディスクにファイルを 1 つずつ配置して作成できます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-127">For example, if your computer has four disks, you can create a database that is made up of three data files and one log file, with one file on each disk.</span></span> <span data-ttu-id="5c3d2-128">データへのアクセスが行われると、4 つの読み取り/書き込みヘッドは並行してデータを同時にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-128">As data is accessed, four read/write heads can concurrently access the data in parallel.</span></span> <span data-ttu-id="5c3d2-129">これにより速度が、データベース操作が大幅にします。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-129">This speeds up database operations significantly.</span></span> <span data-ttu-id="5c3d2-130">SQL Server のディスクのハードウェア ソリューションの実装の詳細については、次を参照してください。[データベース パフォーマンス](http://go.microsoft.com/fwlink/?LinkID=71419)(http://go.microsoft.com/fwlink/?LinkID=71419) 、SQL Server Books Online にします。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-130">For more information about implementing hardware solutions for SQL Server disks, see [Database Performance](http://go.microsoft.com/fwlink/?LinkID=71419) (http://go.microsoft.com/fwlink/?LinkID=71419) in the SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="5c3d2-131">さらに、ファイルおよびファイル グループを有効にする、データの配置で特定のファイル グループにテーブルを作成できるためです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-131">Additionally, files and filegroups enable data placement, because tables can be created in specific filegroups.</span></span> <span data-ttu-id="5c3d2-132">これにより、指定されたテーブルのすべてのファイル I/O は、特定のディスクに向けることがあるために、パフォーマンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-132">This improves performance, because all file I/O for a given table can be directed at a specific disk.</span></span> <span data-ttu-id="5c3d2-133">たとえば、使用頻度の高いテーブルは、1 つのディスク上にあるファイル グループ内のファイルを配置でき、データベース内の他の頻度が低いテーブルを 2 番目のディスク上にある別のファイル グループ内の異なるファイルに配置することができます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-133">For example, a heavily used table can be placed on a file in a filegroup, located on one disk, and the other less heavily accessed tables in the database can be located on different files in another filegroup, located on a second disk.</span></span>  
  
 <span data-ttu-id="5c3d2-134">ファイル I/O のボトルネックがでかなり詳しく説明されている[データベース層のボトルネック](../technical-guides/bottlenecks-in-the-database-tier.md)します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-134">File I/O bottlenecks are discussed in considerable detail in [Bottlenecks in the Database Tier](../technical-guides/bottlenecks-in-the-database-tier.md).</span></span> <span data-ttu-id="5c3d2-135">ファイル I/O (ディスク I/O) がボトルネックである最も一般的なインジケーターでは、「物理ディスク: 平均ディスク キューの長さ」カウンターの値です。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-135">The most common indicator that file I/O (disk I/O) is a bottleneck is the value of the “Physical Disk:Average Disk Queue Length” counter.</span></span> <span data-ttu-id="5c3d2-136">「物理ディスク: 平均ディスク キューの長さ」カウンターの値が SQL Server を実行しているコンピューター上の特定のディスクの約 3 より大きい場合、ファイル I/O と思われますボトルネックになっています。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-136">When the value of the “Physical Disk:Average Disk Queue Length” counter is greater than about 3 for any given disk on any of the computers running SQL Server, then file I/O is likely a bottleneck.</span></span>  
  
 <span data-ttu-id="5c3d2-137">ファイルまたはファイル グループの最適化を適用することも、ファイル I/O のボトルネックの問題が解決しない場合は、追加の物理または SAN ドライブを追加することで、ディスク サブシステムのスループットを向上させるために必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-137">If applying file or filegroup optimization doesn't resolve a file I/O bottleneck problem, it may be necessary to increase the throughput of the disk subsystem by adding additional physical or SAN drives.</span></span>  
  
 <span data-ttu-id="5c3d2-138">このトピックでは、手動でファイルとファイル グループの最適化を適用する方法を説明しますが、これらの最適化をスクリプト化もできます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-138">This topic describes how to manually apply file and filegroup optimizations, but these optimizations can also be scripted.</span></span> <span data-ttu-id="5c3d2-139">サンプル SQL スクリプトに含まれる[BizTalk Server メッセージ ボックス データベースのファイル グループの SQL スクリプト](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md)します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-139">A sample SQL script is provided in [BizTalk Server MessageBox Database Filegroups SQL Script](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5c3d2-140">このスクリプトはファイル、ファイル グループ、および任意の BizTalk Server ソリューションの SQL Server データベースによって使用されるディスク構成に合わせて変更する必要があることに注意してください。 重要です。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-140">It is important to note that this script would need to be modified to accommodate the file, filegroup, and disk configuration used by the SQL Server databases for any given BizTalk Server solution.</span></span>  
> 
> [!NOTE]
>  <span data-ttu-id="5c3d2-141">このトピックでは、複数のファイルと、BizTalk メッセージ ボックス データベースのファイル グループを作成する方法も説明します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-141">This topic also describes how to create multiple files and filegroups for the BizTalk MessageBox database.</span></span> <span data-ttu-id="5c3d2-142">推奨されるファイルと、BizTalk Server データベースのすべてのファイル グループをすべて網羅、用の「付録 B」を参照してください。、 [BizTalk Server データベースの最適化](http://go.microsoft.com/fwlink/?LinkID=101578)ホワイト ペーパー (http://go.microsoft.com/fwlink/?LinkID=101578)します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-142">For an exhaustive list of recommended files and filegroups for all of the BizTalk Server databases, see “Appendix B” of the [BizTalk Server Database Optimization](http://go.microsoft.com/fwlink/?LinkID=101578) white paper (http://go.microsoft.com/fwlink/?LinkID=101578).</span></span>  
> 
> [!NOTE]
>  <span data-ttu-id="5c3d2-143">場合でも、 [BizTalk Server データベースの最適化](http://go.microsoft.com/fwlink/?LinkID=101578)ホワイト ペーパー (<http://go.microsoft.com/fwlink/?LinkID=101578>) で書き込まれた[!INCLUDE[btsbiztalkserver2006r2](../includes/btsbiztalkserver2006r2-md.md)]に注意してください、同じ原則が BizTalk Server に適用します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-143">Even though the [BizTalk Server Database Optimization](http://go.microsoft.com/fwlink/?LinkID=101578) white paper (<http://go.microsoft.com/fwlink/?LinkID=101578>) was written with [!INCLUDE[btsbiztalkserver2006r2](../includes/btsbiztalkserver2006r2-md.md)] in mind, the same principles apply to BizTalk Server.</span></span>  
  
## <a name="databases-created-with-a-default-biztalk-server-configuration"></a><span data-ttu-id="5c3d2-144">既定の BizTalk Server の構成で作成されたデータベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-144">Databases created with a default BizTalk Server configuration</span></span>  
 <span data-ttu-id="5c3d2-145">に応じて最大 13 の異なるデータベース、BizTalk Server の構成は SQL Server で作成でき、これらすべてのデータベースが既定のファイル グループの作成時に、機能が有効にします。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-145">Depending on which features are enabled when configuring BizTalk Server, up to 13 different databases may be created in SQL Server and all of these databases are created in the default filegroup.</span></span> <span data-ttu-id="5c3d2-146">SQL Server の既定のファイル グループは、ALTER DATABASE コマンドを使用して既定のファイル グループが変更されない限り、プライマリ ファイル グループです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-146">The default filegroup for SQL Server is the PRIMARY filegroup unless the default filegroup is changed by using the ALTER DATABASE command.</span></span> <span data-ttu-id="5c3d2-147">次の表は、BizTalk Server を構成するときに、すべての機能が有効な場合は、SQL Server で作成されたデータベースを一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-147">The following table lists the databases that are created in SQL Server if all features are enabled when configuring BizTalk Server.</span></span>  
  
### <a name="biztalk-server-databases"></a><span data-ttu-id="5c3d2-148">BizTalk Server データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-148">BizTalk Server Databases</span></span>  
  
||||  
|-|-|-|  
|<span data-ttu-id="5c3d2-149">**[データベース]**</span><span class="sxs-lookup"><span data-stu-id="5c3d2-149">**Database**</span></span>|<span data-ttu-id="5c3d2-150">**既定のデータベース名**</span><span class="sxs-lookup"><span data-stu-id="5c3d2-150">**Default Database Name**</span></span>|<span data-ttu-id="5c3d2-151">**[説明]**</span><span class="sxs-lookup"><span data-stu-id="5c3d2-151">**Description**</span></span>|  
|<span data-ttu-id="5c3d2-152">構成データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-152">Configuration database</span></span>|<span data-ttu-id="5c3d2-153">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="5c3d2-153">BizTalkMgmtDb</span></span>|<span data-ttu-id="5c3d2-154">中央メタ情報は、BizTalk Server グループ内の BizTalk Server のすべてのインスタンスを格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-154">The central meta-information store for all instances of BizTalk Server in the BizTalk Server group.</span></span>|  
|<span data-ttu-id="5c3d2-155">BizTalk メッセージ ボックス データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-155">BizTalk MessageBox database</span></span>|<span data-ttu-id="5c3d2-156">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="5c3d2-156">BizTalkMsgBoxDb</span></span>|<span data-ttu-id="5c3d2-157">サブスクリプションの述語を格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-157">Stores subscriptions predicates.</span></span> <span data-ttu-id="5c3d2-158">ホスト プラットフォームし、各 BizTalk Server ホストのキューおよび状態テーブルを保持します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-158">It is a host platform, and keeps queues and state tables for each BizTalk Server host.</span></span> <span data-ttu-id="5c3d2-159">また、メッセージ ボックス データベースには、メッセージおよびメッセージ プロパティが格納されます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-159">The MessageBox database also stores the messages and message properties.</span></span>|  
|<span data-ttu-id="5c3d2-160">BizTalk 追跡データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-160">BizTalk Tracking database</span></span>|<span data-ttu-id="5c3d2-161">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="5c3d2-161">BizTalkDTADb</span></span>|<span data-ttu-id="5c3d2-162">ビジネスおよび稼動状態の監視、BizTalk Server 追跡エンジンで追跡データを格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-162">Stores business and health monitoring data tracked by the BizTalk Server tracking engine.</span></span>|  
|<span data-ttu-id="5c3d2-163">BAM 分析データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-163">BAM Analysis database</span></span>|<span data-ttu-id="5c3d2-164">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="5c3d2-164">BAMAnalysis</span></span>|<span data-ttu-id="5c3d2-165">ビジネス アクティビティの集計済み履歴データを保持する SQL Server Analysis Services データベースです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-165">SQL Server Analysis Services database that keeps the aggregated historical data for Business Activities.</span></span>|  
|<span data-ttu-id="5c3d2-166">BAM スター スキーマ データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-166">BAM Star Schema database</span></span>|<span data-ttu-id="5c3d2-167">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="5c3d2-167">BAMStarSchema</span></span>|<span data-ttu-id="5c3d2-168">OLAP 処理するために、ビジネス アクティビティの監視から収集されたデータを変換します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-168">Transforms the data collected from Business Activity Monitoring for OLAP Processing.</span></span> <span data-ttu-id="5c3d2-169">BAM 分析データベースを使用する場合、このデータベースが必要です。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-169">This database is required when using the BAM Analysis database.</span></span>|  
|<span data-ttu-id="5c3d2-170">BAM プライマリ インポート データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-170">BAM Primary Import database</span></span>|<span data-ttu-id="5c3d2-171">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="5c3d2-171">BAMPrimaryImport</span></span>|<span data-ttu-id="5c3d2-172">アクティビティ インスタンスの後に、ビジネス アクティビティの進行状況とデータのクエリからイベントを格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-172">Stores the events from Business Activities and then queries for the progress and data after activity instances.</span></span> <span data-ttu-id="5c3d2-173">このデータベースには、リアルタイム集計も実行します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-173">This database also performs real-time aggregations.</span></span>|  
|<span data-ttu-id="5c3d2-174">BAM アーカイブ データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-174">BAM Archive database</span></span>|<span data-ttu-id="5c3d2-175">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="5c3d2-175">BAMArchive</span></span>|<span data-ttu-id="5c3d2-176">サブスクリプションの述語を格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-176">Stores subscription predicates.</span></span> <span data-ttu-id="5c3d2-177">BAM アーカイブ データベースには、BAM プライマリ インポート データベース内のビジネス アクティビティ データの蓄積が最小限に抑えます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-177">The BAM Archive database minimizes the accumulation of Business Activity data in the BAM Primary Import database.</span></span>|  
|<span data-ttu-id="5c3d2-178">SSO データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-178">SSO database</span></span>|<span data-ttu-id="5c3d2-179">SSODB</span><span class="sxs-lookup"><span data-stu-id="5c3d2-179">SSODB</span></span>|<span data-ttu-id="5c3d2-180">構成を安全に格納の情報の受信場所。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-180">Securely stores the configuration information for receive locations.</span></span> <span data-ttu-id="5c3d2-181">Sso の情報を格納は、すべての関連アプリケーションに暗号化されたユーザー資格情報だけでなく、アプリケーションに関連します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-181">Stores information for SSO affiliate applications, as well as the encrypted user credentials to all the affiliate applications.</span></span>|  
|<span data-ttu-id="5c3d2-182">ルール エンジン データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-182">Rule Engine database</span></span>|<span data-ttu-id="5c3d2-183">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="5c3d2-183">BizTalkRuleEngineDb</span></span>|<span data-ttu-id="5c3d2-184">リポジトリ:</span><span class="sxs-lookup"><span data-stu-id="5c3d2-184">Repository for:</span></span><br /><br /> <span data-ttu-id="5c3d2-185">-ポリシー、関連するルールのセットであります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-185">-   Policies, which are sets of related rules.</span></span><br /><span data-ttu-id="5c3d2-186">-ボキャブラリをルール内でデータの参照をドメイン固有のわかりやすい名前のコレクション。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-186">-   Vocabularies, which are collections of user-friendly, domain-specific names for data references in rules.</span></span>|  
|<span data-ttu-id="5c3d2-187">BizTalk ベース EDI データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-187">BizTalk Base EDI database</span></span>|<span data-ttu-id="5c3d2-188">BizTalkEDIDb</span><span class="sxs-lookup"><span data-stu-id="5c3d2-188">BizTalkEDIDb</span></span>|<span data-ttu-id="5c3d2-189">EDI ドキュメントの追跡および処理されたデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-189">Stores EDI document tracking and processing data.</span></span>|  
|<span data-ttu-id="5c3d2-190">ヒューマン ワークフロー サービス管理データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-190">Human Workflow Services Administration database</span></span>|<span data-ttu-id="5c3d2-191">BizTalkHwsDb</span><span class="sxs-lookup"><span data-stu-id="5c3d2-191">BizTalkHwsDb</span></span>|<span data-ttu-id="5c3d2-192">BizTalk ヒューマン ワークフロー サービスで必要な管理情報を格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-192">Stores administrative information required by the BizTalk Human Workflow Services.</span></span>|  
|<span data-ttu-id="5c3d2-193">取引先管理データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-193">Trading Partner Management database</span></span>|<span data-ttu-id="5c3d2-194">TPM</span><span class="sxs-lookup"><span data-stu-id="5c3d2-194">TPM</span></span>|<span data-ttu-id="5c3d2-195">ビジネス アクティビティ サービス (BAS) のパートナーのデータを取引先を保存します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-195">Stores trading partner data for Business Activity Services (BAS).</span></span>|  
|<span data-ttu-id="5c3d2-196">追跡分析サーバーの管理データベース</span><span class="sxs-lookup"><span data-stu-id="5c3d2-196">Tracking Analysis Server Administration database</span></span>|<span data-ttu-id="5c3d2-197">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="5c3d2-197">BizTalkAnalysisDb</span></span>|<span data-ttu-id="5c3d2-198">ビジネスおよび稼動状況監視 OLAP キューブの両方を格納します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-198">Stores both business and health monitoring OLAP cubes.</span></span>|  
  
## <a name="separation-of-data-files-and-log-files"></a><span data-ttu-id="5c3d2-199">データ ファイルとログ ファイルの分離</span><span class="sxs-lookup"><span data-stu-id="5c3d2-199">Separation of data files and log files</span></span>  
 <span data-ttu-id="5c3d2-200">前述のように、既定の BizTalk Server の構成は、既定のファイル グループ内の 1 つのファイルにメッセージ ボックス データベースを配置します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-200">As noted earlier, a default BizTalk Server configuration places the MessageBox Database into a single file in the default filegroup.</span></span> <span data-ttu-id="5c3d2-201">既定では、メッセージ ボックス データベースのデータとトランザクション ログが同じドライブおよびパスに配置されます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-201">By default, the data and transaction logs for the MessageBox database are placed on the same drive and path.</span></span> <span data-ttu-id="5c3d2-202">これは、1 つのディスクを使用したシステムに対応するためです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-202">This is done to accommodate systems with a single disk.</span></span> <span data-ttu-id="5c3d2-203">1 つのファイルまたはファイル グループ/ディスク構成が**最適ではない**運用環境でします。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-203">A single file/filegroup/disk configuration is **not optimal** in a production environment.</span></span> <span data-ttu-id="5c3d2-204">最適なパフォーマンス、データ ファイルとログ ファイルを別個のディスクに配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-204">For optimal performance, the data files and log files should be placed on separate disks.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5c3d2-205">ログ ファイルは、ファイル グループの一部ではできません。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-205">Log files are never part of a filegroup.</span></span> <span data-ttu-id="5c3d2-206">ログ領域はデータ領域とは別に管理されます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-206">Log space is managed separately from data space.</span></span>  
  
## <a name="the-8020-rule-of-distributing-biztalk-server-databases"></a><span data-ttu-id="5c3d2-207">BizTalk Server データベースを配布する 80/20 ルール</span><span class="sxs-lookup"><span data-stu-id="5c3d2-207">The 80/20 rule of distributing BizTalk Server databases</span></span>  
 <span data-ttu-id="5c3d2-208">ディスク I/O の競合またはデータベースの競合のため、ほとんどの BizTalk Server ソリューションでの競合の主なソースは、BizTalk Server メッセージ ボックス データベースです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-208">The main source of contention in most BizTalk Server solutions, either because of disk I/O contention or database contention, is the BizTalk Server MessageBox database.</span></span> <span data-ttu-id="5c3d2-209">これは、単一およびマルチ メッセージ ボックスの両方のシナリオに当てはまります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-209">This is true in both single and multi-MessageBox scenarios.</span></span> <span data-ttu-id="5c3d2-210">BizTalk データベースを配布する値の 80% をメッセージ ボックス データ ファイルとログ ファイルを最適化することから導き出されますことがあると考えることになります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-210">It is reasonable to assume that as much as 80% of the value of distributing BizTalk databases will be derived from optimizing the MessageBox data files and log file.</span></span> <span data-ttu-id="5c3d2-211">シナリオの詳細を以下の例はメッセージ ボックス データベースのデータ ファイルの最適化に重点を置いています。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-211">The sample scenario detailed below is focused on optimizing the data files for a MessageBox database.</span></span> <span data-ttu-id="5c3d2-212">必要に応じて、次の手順を他のデータベースの後にし、できます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-212">These steps can then be followed for other databases as needed.</span></span> <span data-ttu-id="5c3d2-213">たとえば、ソリューションは、広範な追跡を必要とする場合、追跡データベースを最適化もできます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-213">For example, if the solution requires extensive tracking, the Tracking database can also be optimized.</span></span>  
  
## <a name="manually-adding-files-to-the-messagebox-database-step-by-step"></a><span data-ttu-id="5c3d2-214">ステップ バイ ステップに、メッセージ ボックス データベースにファイルを手動で追加します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-214">Manually adding files to the MessageBox database, step-by-step</span></span>  
 <span data-ttu-id="5c3d2-215">このセクションのトピックでは、メッセージ ボックス データベースにファイルを手動で追加する手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-215">This section of the topic describes the steps that can be followed to manually add files to the MessageBox database.</span></span> <span data-ttu-id="5c3d2-216">この例では、次の 3 つのファイル グループが追加され、メッセージ ボックス データベースの複数のディスク ファイルを配布する各ファイル グループにファイルを追加します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-216">In this example three filegroups are added and then a file is added to each filegroup to distribute the files for the MessageBox across multiple disks.</span></span>
  
### <a name="manually-adding-files-to-the-messagebox-database-on-sql-server"></a><span data-ttu-id="5c3d2-217">SQL Server のメッセージ ボックス データベースにファイルを手動で追加します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-217">Manually adding files to the MessageBox database on SQL Server</span></span>
   
1.  <span data-ttu-id="5c3d2-218">開いている**SQL Server Management Studio**を表示する、**サーバーへの接続** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-218">Open **SQL Server Management Studio** to display the **Connect to Server** dialog box.</span></span>  
  
     <span data-ttu-id="5c3d2-219">![SQL Server ログイン画面](../technical-guides/media/sqlserver2008r2-loginscreen.gif "SQLServer2008R2 Loginscreen")</span><span class="sxs-lookup"><span data-stu-id="5c3d2-219">![SQL Server Login screen](../technical-guides/media/sqlserver2008r2-loginscreen.gif "SQLServer2008R2-Loginscreen")</span></span>  
  
2.  <span data-ttu-id="5c3d2-220">**サーバー名**のボックスの編集、**サーバーへの接続** ダイアログ ボックスで、BizTalk Server メッセージ ボックス データベースを格納する SQL Server インスタンスの名前を入力し、をクリックして**の接続**を SQL Server Management Studio を表示します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-220">In the **Server name** edit box of the **Connect to Server** dialog box, enter the name of the SQL Server instance that houses the BizTalk Server MessageBox databases and click **Connect** to display SQL Server Management Studio.</span></span> <span data-ttu-id="5c3d2-221">**オブジェクト エクスプ ローラー** SQL Server Management Studio でのウィンドウが展開**データベース**を SQL Server のこのインスタンスのデータベースを表示します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-221">In the **Object Explorer** pane of SQL Server Management Studio, expand **Databases** to view the databases for this instance of SQL Server.</span></span>  
  
     <span data-ttu-id="5c3d2-222">![SQL Server 2005 Management Studio、オブジェクト エクスプ ローラー](../technical-guides/media/81f13912-fedc-48c3-9669-c18863e637b1.gif "81f13912-fedc-48c3-9669-c18863e637b1")</span><span class="sxs-lookup"><span data-stu-id="5c3d2-222">![SQL Server 2005 Management Studio, Object Explorer](../technical-guides/media/81f13912-fedc-48c3-9669-c18863e637b1.gif "81f13912-fedc-48c3-9669-c18863e637b1")</span></span>  
  
3.  <span data-ttu-id="5c3d2-223">クリックして、ファイルを追加するデータベースを右クリックして**プロパティ**を表示する、**データベース プロパティ**データベース用のダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-223">Right-click the database to which to add the files, and then click **Properties** to display the **Database Properties** dialog box for the database.</span></span>  
  
     <span data-ttu-id="5c3d2-224">![SQL Server 2005 データベースのプロパティ ダイアログ ボックス](../technical-guides/media/82ae7c11-5b3a-4312-876c-70876abdd65c.gif "82ae7c11-5b3a-4312-876c-70876abdd65c")</span><span class="sxs-lookup"><span data-stu-id="5c3d2-224">![SQL Server 2005 Database Properties dialog box](../technical-guides/media/82ae7c11-5b3a-4312-876c-70876abdd65c.gif "82ae7c11-5b3a-4312-876c-70876abdd65c")</span></span>  
  
4.  <span data-ttu-id="5c3d2-225">**データベース プロパティ**ダイアログ ボックスで、**ファイル グループ**ページ。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-225">In the **Database Properties** dialog box, select the **Filegroups** page.</span></span> <span data-ttu-id="5c3d2-226">BizTalkMsgBoxDb データベースの追加のファイル グループを作成する をクリックして**追加**します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-226">To create additional filegroups for the BizTalkMsgBoxDb databases, click **Add** .</span></span> <span data-ttu-id="5c3d2-227">次の例では、次の 3 つの追加のファイル グループが追加されます。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-227">In the following example, three additional filegroups are added.</span></span>  
  
     <span data-ttu-id="5c3d2-228">![SQL Server 2005、データベース ファイル グループに追加する](../technical-guides/media/6be47c0e-06c3-45d9-bce2-a42453da7d19.gif "6be47c0e-06c3-45d9-bce2-a42453da7d19")</span><span class="sxs-lookup"><span data-stu-id="5c3d2-228">![SQL Server 2005, adding filegroups to a database](../technical-guides/media/6be47c0e-06c3-45d9-bce2-a42453da7d19.gif "6be47c0e-06c3-45d9-bce2-a42453da7d19")</span></span>  
  
5.  <span data-ttu-id="5c3d2-229">**[データベースのプロパティ]** ダイアログ ボックスで、 **[ファイル]** ページをクリックします。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-229">In the **Database Properties** dialog box, select the **Files** page.</span></span>  
  
     <span data-ttu-id="5c3d2-230">ファイル グループに追加するファイルを作成する をクリックして**追加**、 をクリックし、 **OK**。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-230">To create additional files to add to the filegroups, click **Add** , and then click **OK**.</span></span> <span data-ttu-id="5c3d2-231">メッセージ ボックス データベースがパフォーマンスに大きな利点は、1 つのディスク構成を提供する複数のディスクで配布ようになりました。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-231">The MessageBox database is now distributed across multiple disks, which will provide a significant performance advantage over a single disk configuration.</span></span>  
  
     <span data-ttu-id="5c3d2-232">次の例では、以前に作成されたファイル グループの各ファイルが作成し、各ファイルが別のディスク上に配置します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-232">In the following example, a file is created for each of the filegroups that were created earlier and each file is placed on a separate disk.</span></span>  
  
     <span data-ttu-id="5c3d2-233">![SQL Server 2005、ファイルをファイル グループに追加する](../technical-guides/media/d5d5c5df-d483-4f01-8128-f98228de51b9.gif "d5d5c5df-d483-4f01-8128-f98228de51b9")</span><span class="sxs-lookup"><span data-stu-id="5c3d2-233">![SQL Server 2005, adding files to a filegroup](../technical-guides/media/d5d5c5df-d483-4f01-8128-f98228de51b9.gif "d5d5c5df-d483-4f01-8128-f98228de51b9")</span></span>  
  
## <a name="sample-sql-script-for-adding-filegroups-and-files-to-the-biztalk-messagebox-database"></a><span data-ttu-id="5c3d2-234">BizTalk メッセージ ボックス データベースにファイル グループとファイルを追加するためのサンプル SQL スクリプト</span><span class="sxs-lookup"><span data-stu-id="5c3d2-234">Sample SQL script for adding filegroups and files to the BizTalk MessageBox database</span></span>  
 <span data-ttu-id="5c3d2-235">このガイドには、BizTalk Server メッセージ ボックス データベースにファイル グループとファイルの追加の SQL スクリプトが含まれています。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-235">This guide includes an SQL script for adding filegroups and files to the BizTalk Server MessageBox database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5c3d2-236">SQL Server のログ ファイルに書き込むと順番に、ために、SQL Server データベースの複数のログ ファイルを作成することに気付きましたパフォーマンス上の利点はありません。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-236">Because SQL Server writes to its log files sequentially, there is no performance advantage realized by creating multiple log files for a SQL Server database.</span></span>  
  
 <span data-ttu-id="5c3d2-237">このスクリプトを実行するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-237">To run this script, follow these steps:</span></span>  
  
1. <span data-ttu-id="5c3d2-238">開いている**SQL Server Management Studio**を表示する、**サーバーへの接続** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-238">Open **SQL Server Management Studio** to display the **Connect to Server** dialog box.</span></span>  
  
2. <span data-ttu-id="5c3d2-239">**サーバー名**のボックスの編集、**サーバーへの接続** ダイアログ ボックスで、BizTalk Server メッセージ ボックス データベースを格納する SQL Server インスタンスの名前を入力し、をクリックして**の接続** SQL Server Management Studio のダイアログ ボックスを表示します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-239">In the **Server name** edit box of the **Connect to Server** dialog box, enter the name of the SQL Server instance that houses the BizTalk Server MessageBox databases and click **Connect** to display the SQL Server Management Studio dialog box.</span></span>  
  
3. <span data-ttu-id="5c3d2-240">SQL Server Management studio でをクリックして、**ファイル**メニューで、**新規**、順にクリックします**現在の接続を使用したクエリ**SQL クエリ エディターを起動します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-240">In SQL Server Management Studio, click the **File** menu, point to **New**, and then click **Query with Current Connection** to start the SQL Query Editor.</span></span>  
  
4. <span data-ttu-id="5c3d2-241">サンプル スクリプトをコピー [BizTalk Server メッセージ ボックス データベースのファイル グループの SQL スクリプト](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md)をクエリ エディターにします。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-241">Copy the sample script from [BizTalk Server MessageBox Database Filegroups SQL Script](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md) into the Query Editor.</span></span>  
  
5. <span data-ttu-id="5c3d2-242">、BizTalk Server 環境に合わせてスクリプト内のパラメーターを編集し、スクリプトを実行します。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-242">Edit the parameters in the script to match your BizTalk Server environment, and execute the script.</span></span>  
  
   <span data-ttu-id="5c3d2-243">スクリプトの利点は、スクリプトに複数のタスクをすばやく実行することができますし、正確に再現することができ、人的ミスの可能性を減らすことです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-243">The advantage to scripting is that scripts can perform multiple tasks quickly, can be reproduced precisely, and reduce the possibility of human error.</span></span> <span data-ttu-id="5c3d2-244">スクリプトの欠点は、スクリプトが正しく記述の実行が最初から再度構成する BizTalk Server データベースが必要になる重大な問題になることができます可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-244">The disadvantage of scripting is that the execution of an incorrectly written script can potentially cause serious problems that could require the BizTalk Server databases to be re-configured from scratch.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="5c3d2-245">最も重要なの SQL スクリプトなど、このガイドのサンプル スクリプトは、運用環境で実行する前に徹底的にテストのことです。</span><span class="sxs-lookup"><span data-stu-id="5c3d2-245">It is of utmost importance that SQL scripts such as the sample script in this guide are thoroughly tested before being executed in a production environment.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5c3d2-246">参照</span><span class="sxs-lookup"><span data-stu-id="5c3d2-246">See Also</span></span>  
 [<span data-ttu-id="5c3d2-247">データベース パフォーマンスの最適化</span><span class="sxs-lookup"><span data-stu-id="5c3d2-247">Optimizing Database Performance</span></span>](../technical-guides/optimizing-database-performance.md)