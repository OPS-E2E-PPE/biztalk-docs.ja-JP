---
title: "インストールして、BizTalk Server で使用する HYPER-V 仮想マシンの構成 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 86add392-3cde-432d-95d6-c81d68716537
caps.latest.revision: "18"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 62e612ed35a20646f686bd178fad01771dbd2cce
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="installing-and-configuring-a-hyper-v-virtual-machine-for-use-with-biztalk-server"></a><span data-ttu-id="6c906-102">インストールして、BizTalk Server で使用する HYPER-V 仮想マシンの構成</span><span class="sxs-lookup"><span data-stu-id="6c906-102">Installing and Configuring a Hyper-V Virtual Machine for use with BizTalk Server</span></span>
<span data-ttu-id="6c906-103">このトピックの内容をインストールして、HYPER-V 仮想マシンのインストールと構成に関する推奨事項を BizTalk Server をインストールするための推奨事項など、HYPER-V 環境で BizTalk Server の構成に関する推奨事項を提供する、HYPER-V バーチャル マシンです。</span><span class="sxs-lookup"><span data-stu-id="6c906-103">This topic provides recommendations for installing and configuring BizTalk Server in a Hyper-V environment, including recommendations for installation and configuration of the Hyper-V virtual machine and recommendations for installing BizTalk Server on a Hyper-V virtual machine.</span></span>  
  
## <a name="installing-and-configuring-hyper-v"></a><span data-ttu-id="6c906-104">インストールして、HYPER-V を構成します。</span><span class="sxs-lookup"><span data-stu-id="6c906-104">Installing and Configuring Hyper-V</span></span>  
 <span data-ttu-id="6c906-105">HYPER-V をインストールする前に、次を参照してください。 [Windows Server 2008 R2 で Hyper-v の新](http://go.microsoft.com/fwlink/?LinkID=202427)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-105">Before installing Hyper-V, see [What's New in Hyper-V in Windows Server 2008 R2](http://go.microsoft.com/fwlink/?LinkID=202427).</span></span> <span data-ttu-id="6c906-106">"Microsoft HYPER-V Server 2008 R2 Getting Started"を説明し、インストールして構成する方法の詳細について[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]HYPER-V です。</span><span class="sxs-lookup"><span data-stu-id="6c906-106">The “Microsoft Hyper-V Server 2008 R2 Getting Started” guide provides details about how to install and configure [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] Hyper-V.</span></span> <span data-ttu-id="6c906-107">このガイドでは[http://go.microsoft.com/fwlink/?LinkID=202431](http://go.microsoft.com/fwlink/?LinkID=202431)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-107">The guide is available at [http://go.microsoft.com/fwlink/?LinkID=202431](http://go.microsoft.com/fwlink/?LinkID=202431).</span></span>  
  
 <span data-ttu-id="6c906-108">「Windows Server 2008 R2 のパフォーマンス チューニング ガイドライン」のドキュメントは、チューニングに関する詳細を提供[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]Hyper-v 重点セクションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="6c906-108">“The Performance Tuning Guidelines for Windows Server 2008 R2” document provides details on tuning [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] and includes a section specifically focused on Hyper-V.</span></span> <span data-ttu-id="6c906-109">このドキュメントでは[http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-109">The document is available at [http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087).</span></span>  
  
### <a name="hyper-v-platform-prerequisites"></a><span data-ttu-id="6c906-110">HYPER-V プラットフォームの前提条件</span><span class="sxs-lookup"><span data-stu-id="6c906-110">Hyper-V Platform Prerequisites</span></span>  
 <span data-ttu-id="6c906-111">HYPER-V は 64 ビットおよびすべてのエディションの使用可能なサーバーの役割[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]は 64 ビットのみです。</span><span class="sxs-lookup"><span data-stu-id="6c906-111">Hyper-V is a server role available for 64-bit and all editions of  [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] are 64-bit only.</span></span> <span data-ttu-id="6c906-112">また、物理ハードウェアがハードウェア支援による仮想化をサポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-112">Additionally, the physical hardware must support hardware assisted virtualization.</span></span> <span data-ttu-id="6c906-113">つまり、プロセッサは、Intel バーチャライゼーション テクノロジ (Intel VT) または AMD Virtualization (AMD-V) テクノロジと互換性のあるである必要があります、システム BIOS でデータ実行防止 (DEP) をサポートする必要があります、DEP を有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-113">This means the processor must be compatible with Intel Virtualization Technology (Intel VT) or AMD Virtualization (AMD-V) technology, the system BIOS must support Data Execution Prevention (DEP), and DEP must be enabled.</span></span> <span data-ttu-id="6c906-114">具体的には、Intel XD ビットを有効にする必要があります (execute disable bit) または AMD NX ビット (no execute bit)。</span><span class="sxs-lookup"><span data-stu-id="6c906-114">Specifically, you must enable the Intel XD bit (execute disable bit) or AMD NX bit (no execute bit).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6c906-115">システム BIOS でこれらのオプションを有効にした後に、完全にコンピューターをオフにしてこれらの設定が適用されていることを確認するコンピューターを再起動します。</span><span class="sxs-lookup"><span data-stu-id="6c906-115">After enabling these options in the system BIOS, turn off the computer completely and then restart the computer to ensure that these settings are applied.</span></span>  
  
#### <a name="determining-hardware-requirements"></a><span data-ttu-id="6c906-116">ハードウェア要件の決定</span><span class="sxs-lookup"><span data-stu-id="6c906-116">Determining Hardware Requirements</span></span>  
 <span data-ttu-id="6c906-117">によりサーバーの統合の確認要求は、HYPER-V サーバーでは、複数の CPU やメモリを消費する傾向があり、比較可能なコンピューティングの読み込みを伴う物理サーバーよりも大きい値のディスク I/O 帯域幅を必要とします。</span><span class="sxs-lookup"><span data-stu-id="6c906-117">Due to the demands of server consolidation, Hyper-V servers tend to consume more CPU and memory, and require greater disk I/O bandwidth than physical servers with comparable computing loads.</span></span> <span data-ttu-id="6c906-118">条件を満たしている環境をデプロイするのには、サーバーの正確なハードウェア要件を決定するのには、以下の要因を検討してください。</span><span class="sxs-lookup"><span data-stu-id="6c906-118">In order to deploy an environment that will meet expectations, consider the factors below to determine the exact hardware requirements of your server.</span></span>  
  
##### <a name="storage-configuration-options"></a><span data-ttu-id="6c906-119">記憶域構成オプション</span><span class="sxs-lookup"><span data-stu-id="6c906-119">Storage Configuration Options</span></span>  
 <span data-ttu-id="6c906-120">十分な I/O 帯域幅と記憶域容量をホストする予定の仮想マシンの現在および将来のニーズを満たすために記憶域のハードウェアを提供します。</span><span class="sxs-lookup"><span data-stu-id="6c906-120">The storage hardware should provide sufficient I/O bandwidth and storage capacity to meet the current and future needs of the virtual machines that you plan to host.</span></span> <span data-ttu-id="6c906-121">トレードオフがある容量の使用状況とを提供するパフォーマンスの HYPER-V の記憶域の構成を選択するときにします。</span><span class="sxs-lookup"><span data-stu-id="6c906-121">There is a trade-off when choosing the storage configuration for Hyper-V between capacity usage and the performance it can provide.</span></span>  
  
 <span data-ttu-id="6c906-122">記憶域の構成を計画するときは、プロビジョニングする環境の要件を検討してください。</span><span class="sxs-lookup"><span data-stu-id="6c906-122">When planning storage configuration, consider the requirements of the environment you are provisioning.</span></span> <span data-ttu-id="6c906-123">実稼働環境、実稼働前、および開発環境の要件が大きく異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-123">The requirements for production, pre-production, and development environments may differ considerably.</span></span>  
  
 <span data-ttu-id="6c906-124">実稼働を展開する場合は[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]HYPER-V、パフォーマンス上の環境の重要な要件になります。</span><span class="sxs-lookup"><span data-stu-id="6c906-124">If you are deploying a production [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] environment on Hyper-V, performance will be a key requirement.</span></span> <span data-ttu-id="6c906-125">ディスク使用中の実稼働システムで I/O の競合を避けるためには、ホストとゲストの両方のオペレーティング システムに統合サービスをインストールし、合成の SCSI コント ローラーとデータ ボリュームのディスクを構成します。</span><span class="sxs-lookup"><span data-stu-id="6c906-125">To avoid disk I/O contention on busy production systems, install integration services on both the host and guest operating system and configure disks for data volumes with the synthetic SCSI controller.</span></span> <span data-ttu-id="6c906-126">高負荷の高いストレージの I/O ワークロードの複数のデータ ドライブに配置されている場合に、全体的なパフォーマンスを向上させるため代理個別の SCSI コント ローラーに各 VHD をアタッチする必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-126">For highly intensive storage I/O workloads that span multiple data drives, each VHD should be attached to a separate synthetic SCSI controller for better overall performance.</span></span> <span data-ttu-id="6c906-127">さらに、各 VHD は、個別の物理ディスクに保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-127">In addition, each VHD should be stored on separate physical disks.</span></span> <span data-ttu-id="6c906-128">データ ディスクの構成の詳細については、合成の SCSI コント ローラーでボリュームを参照してください「ディスクのパフォーマンスを最適化する」トピックの[チェックリスト: HYPER-V でのパフォーマンスの最適化](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-128">For more information about configuring disks for data volumes with the synthetic SCSI controller see the “Optimize Disk Performance” section of the topic [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span>  
  
 <span data-ttu-id="6c906-129">通常、リソース使用率を最大化するメインの優先度傾向がありますので、開発環境には厳しいパフォーマンス要件はありません。</span><span class="sxs-lookup"><span data-stu-id="6c906-129">Typically, development environments do not have stringent performance requirements since maximizing resource utilization tends to be the main priority.</span></span> <span data-ttu-id="6c906-130">開発環境の 1 つの物理ドライブ上の複数の VHD ファイルをホストしているときに指定パフォーマンスは、通常は許容されます。</span><span class="sxs-lookup"><span data-stu-id="6c906-130">For development environments the performance provided when hosting multiple VHD files on a single physical drive is generally acceptable.</span></span>  
  
 <span data-ttu-id="6c906-131">HYPER-V では、さまざまな種類の記憶域ディスク オプションをサポートします。</span><span class="sxs-lookup"><span data-stu-id="6c906-131">Hyper-V supports several different types of storage disk options.</span></span> <span data-ttu-id="6c906-132">各ストレージ オプションは、コンピューターに、IDE または SCSI コント ローラーを使用して接続できます。</span><span class="sxs-lookup"><span data-stu-id="6c906-132">Each of the storage options can be attached via an IDE or SCSI controller to the machine.</span></span> <span data-ttu-id="6c906-133">SCSI コント ローラーを使用して、IDE コント ローラー上の潜在的な利点は、ことのみが正しく機能するオペレーティング システムの統合コンポーネントの正しいバージョンは、ゲスト仮想マシンにインストールされている場合です。</span><span class="sxs-lookup"><span data-stu-id="6c906-133">A potential benefit of using the SCSI controller over the IDE controller is that it will only work correctly if the correct versions of the operating system integration components have been installed on the guest virtual machine.</span></span> <span data-ttu-id="6c906-134">これは、ゲスト オペレーティング システムに正しいオペレーティング システムの統合コンポーネントがインストールされていることを確認する簡単な方法です。</span><span class="sxs-lookup"><span data-stu-id="6c906-134">This is a straightforward method for ensuring that correct operating system integration components are installed on the guest operating system.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6c906-135">以前のバージョンの Microsoft 仮想化テクノロジとは異なり、仮想 IDE コント ローラーまたは仮想 SCSI コント ローラーを使用してバーチャル ハード_ディスクにアクセスするときのパフォーマンスの違いはありません。</span><span class="sxs-lookup"><span data-stu-id="6c906-135">Unlike previous versions of Microsoft virtualization technology, there is no performance difference between using a virtual IDE controller or a virtual SCSI controller when accessing virtual hard disks.</span></span>  
  
 <span data-ttu-id="6c906-136">読み取り/書き込みアクティビティの処理を要する場合などをホストしている[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]固定バーチャル ハード ドライブ (VHD) ディスクのパフォーマンスの利点データベース、パススルー ディスク オプションを提供します。</span><span class="sxs-lookup"><span data-stu-id="6c906-136">For intensive read-write activities, such as hosting [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] databases, the passthrough disk option provides incremental performance advantages over fixed virtual hard drive (VHD) disks.</span></span> <span data-ttu-id="6c906-137">パススルー オプションにより、物理ディスクに直接アクセスする仮想マシンと、ルート パーティション内の NTFS ファイル システムをバイパスするが、仮想ディスクを仮想マシンのスナップショットとクラスタ リングなどの特定の機能をサポートしていませんサポートしてください。</span><span class="sxs-lookup"><span data-stu-id="6c906-137">The passthrough option permits the virtual machine to have direct access to the physical disk and bypasses the NTFS file system in the root partition but does not support certain functionality of virtual disks, such as Virtual machine snapshots and clustering support.</span></span> <span data-ttu-id="6c906-138">したがってマージナル パフォーマンス上の利点は、複数の不足している機能のオフセットために、BizTalk または SQL Server 環境でパススルー ディスクの機能の使用は推奨されません。</span><span class="sxs-lookup"><span data-stu-id="6c906-138">Therefore use of the passthrough disk feature is not recommended in a BizTalk or SQL Server environment because the marginal performance benefits are more than offset by the missing functionality.</span></span>  
  
 <span data-ttu-id="6c906-139">次の表では、長所と短所の使用可能な HYPER-V の記憶域オプションをまとめたものです。 します。</span><span class="sxs-lookup"><span data-stu-id="6c906-139">The following table summarizes the advantages and disadvantages of available Hyper-V storage options:.</span></span>  
  
|<span data-ttu-id="6c906-140">**HYPER-V の記憶域の種類**</span><span class="sxs-lookup"><span data-stu-id="6c906-140">**Hyper-V Storage Type**</span></span>|<span data-ttu-id="6c906-141">**担当者**</span><span class="sxs-lookup"><span data-stu-id="6c906-141">**Pros**</span></span>|<span data-ttu-id="6c906-142">**短所**</span><span class="sxs-lookup"><span data-stu-id="6c906-142">**Cons**</span></span>|<span data-ttu-id="6c906-143">**BizTalk Server に関する考慮事項**</span><span class="sxs-lookup"><span data-stu-id="6c906-143">**Considerations for BizTalk Server**</span></span>|  
|-------------------------------|--------------|--------------|-------------------------------------------|  
|<span data-ttu-id="6c906-144">**容量固定のディスク**</span><span class="sxs-lookup"><span data-stu-id="6c906-144">**Fixed size disks**</span></span>|<span data-ttu-id="6c906-145">物理ハード ドライブに作成されたときに、VHD ファイルはその最大サイズに初期化されるためより容量可変の VHD を実行します。</span><span class="sxs-lookup"><span data-stu-id="6c906-145">Performs better than a dynamic VHD because the VHD file is initialized at its maximum possible size when it is created on the physical hard drive.</span></span><br /><br /> <span data-ttu-id="6c906-146">これにより断片化小さい可能性があり、したがって、1 つの I/O が複数の I/o を分割のシナリオを軽減できます。</span><span class="sxs-lookup"><span data-stu-id="6c906-146">This makes fragmentation less likely and, therefore, mitigates scenarios where a single I/O is split into multiple I/Os.</span></span> <span data-ttu-id="6c906-147">これは、読み取りと書き込みが、ブロックのマッピングを検索する必要はないために、VHD の種類の最小の CPU のオーバーヘッドです。</span><span class="sxs-lookup"><span data-stu-id="6c906-147">This has the lowest CPU overhead of the VHD types because reads and writes do not need to look up the mapping of the block.</span></span>|<span data-ttu-id="6c906-148">最初に必要なディスク領域の全容量の割り当てが必要です。</span><span class="sxs-lookup"><span data-stu-id="6c906-148">Requires allocation of the full amount of disk space up-front.</span></span>|<span data-ttu-id="6c906-149">オペレーティング システムのボリュームを使用で[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]と[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-149">Use for operating system volumes on [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span> <span data-ttu-id="6c906-150">**重要:** HYPER-V ゲストのパーティションの起動ディスクは、IDE コント ローラーに接続する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-150">**Important:**  The startup disk of a Hyper-V guest partition must be attached to an IDE contoller.</span></span>|  
|<span data-ttu-id="6c906-151">**容量可変の拡張ディスク**</span><span class="sxs-lookup"><span data-stu-id="6c906-151">**Dynamically expanding disks**</span></span>|<span data-ttu-id="6c906-152">VHD ファイルのサイズより多くのデータが、仮想マシン自体に格納されている、ディスクを作成するときに、指定したサイズに増加します。</span><span class="sxs-lookup"><span data-stu-id="6c906-152">The size of the VHD file increases to the size specified when creating the disk, as more data is stored on the virtual machine itself.</span></span> <span data-ttu-id="6c906-153">これには、最も効率的に使用可能記憶域の使用が対応しています。</span><span class="sxs-lookup"><span data-stu-id="6c906-153">This accommodates the most efficient use of available storage.</span></span>|<span data-ttu-id="6c906-154">固定サイズの VHD およびは実行されません。</span><span class="sxs-lookup"><span data-stu-id="6c906-154">Does not perform as well as a fixed size VHD.</span></span> <span data-ttu-id="6c906-155">これは、ディスク内のブロックがゼロのブロックとして開始、VHD ファイル内の実際の領域でバックアップされていないためです。</span><span class="sxs-lookup"><span data-stu-id="6c906-155">This is because the blocks in the disk start as zeroed blocks but are not backed by any actual space in the VHD file.</span></span> <span data-ttu-id="6c906-156">このようなブロックの戻り値から、ゼロのブロックを読み取ります。</span><span class="sxs-lookup"><span data-stu-id="6c906-156">Reads from such blocks return a block of zeros.</span></span> <span data-ttu-id="6c906-157">ブロックが最初に書き込まれ、仮想化スタック必要がありますブロックに VHD ファイル内の領域を割り当てる、対応するメタデータを更新します。</span><span class="sxs-lookup"><span data-stu-id="6c906-157">When a block is first written to, the virtualization stack must allocate space within the VHD file for the block and then update the corresponding metadata.</span></span> <span data-ttu-id="6c906-158">これだけでなく既存のブロックが参照されるたびにブロック マッピングする必要がありますで検索することメタデータ。</span><span class="sxs-lookup"><span data-stu-id="6c906-158">In addition to this every time an existing block is referenced the block mapping must be looked up in the metadata.</span></span> <span data-ttu-id="6c906-159">読み取りの数が増加し、これにより、さらに書き込み活動は、CPU 使用率を向上します。</span><span class="sxs-lookup"><span data-stu-id="6c906-159">This increases the number of read and write activities which in turn causes increased CPU utilization.</span></span><br /><br /> <span data-ttu-id="6c906-160">動的な増加には、サーバーの管理者が記憶域の要件の増大として十分なディスクの記憶域があることを確認するディスク容量を監視することも必要です。</span><span class="sxs-lookup"><span data-stu-id="6c906-160">The dynamic growth also requires that the server administrator monitor disk capacity to ensure that there is sufficient disk storage as the storage requirements increase.</span></span>|<span data-ttu-id="6c906-161">固定サイズの VHD およびは実行されません。</span><span class="sxs-lookup"><span data-stu-id="6c906-161">Does not perform as well as a fixed size VHD.</span></span><br /><br /> <span data-ttu-id="6c906-162">パフォーマンス問題がない場合は、インスタンスの開発環境でこれがありますにオペレーティング システムのハード ドライブの最適なオプション。</span><span class="sxs-lookup"><span data-stu-id="6c906-162">If performance is not a concern, for instance in a development environment, this may be a suitable option for the operating system hard drives.</span></span><br /><br /> <span data-ttu-id="6c906-163">ブロック マッピング参照により追加の CPU オーバーヘッドが発生します。</span><span class="sxs-lookup"><span data-stu-id="6c906-163">Causes additional CPU overhead due to block mapping lookup.</span></span>|  
|<span data-ttu-id="6c906-164">**差分ディスク**</span><span class="sxs-lookup"><span data-stu-id="6c906-164">**Differencing disks**</span></span>|<span data-ttu-id="6c906-165">これは、差分ディスクが、ベース VHD とベース VHD に関連のすべての変更を保存する場所、親子構成は静的です。</span><span class="sxs-lookup"><span data-stu-id="6c906-165">This a parent-child configuration where the differencing disk stores all changes relative to a base VHD and the base VHD remains static.</span></span> <span data-ttu-id="6c906-166">したがっては親と異なるブロックだけでは、差分 VHD の子に格納する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-166">Therefore only the blocks which are different from the parent need to be stored in the child differencing VHD.</span></span>|<span data-ttu-id="6c906-167">読み取り/書き込みは、固定/動的親 VHD と差分ディスクにアクセスする必要があるために、パフォーマンスが低下することができます。</span><span class="sxs-lookup"><span data-stu-id="6c906-167">Performance can degrade because read/writes need to access the fixed/dynamic parent VHD as well as the differencing disk.</span></span> <span data-ttu-id="6c906-168">これは、CPU 使用率とディスク I/O のオーバーヘッドが増加します。</span><span class="sxs-lookup"><span data-stu-id="6c906-168">This increases CPU utilization and disk I/O overhead.</span></span>|<span data-ttu-id="6c906-169">大量のコンピューターの特定の構成が必要[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]のインストールと子の VHD ファイルのサイズが増加大幅にこのディスク構成を使用する利点を最小限に抑えるはします。</span><span class="sxs-lookup"><span data-stu-id="6c906-169">A large amount of machine specific configuration is required for [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] installations and child VHD files may grow substantially which would minimize the benefits of using this disk configuration.</span></span> <span data-ttu-id="6c906-170">このシナリオでの複数の VHD からの読み取りは、追加の CPU とディスク I/O のオーバーヘッドが生じます。</span><span class="sxs-lookup"><span data-stu-id="6c906-170">Reading from multiple VHD’s in this scenario incurs additional CPU and disk I/O overhead.</span></span>|  
|<span data-ttu-id="6c906-171">**パススルー ディスク**</span><span class="sxs-lookup"><span data-stu-id="6c906-171">**Passthrough disks**</span></span>|<span data-ttu-id="6c906-172">これらは、物理ディスクに設定されている*オフライン*ルート パーティションと読み取り/書き込みを排他的に物理ディスクにアクセスするには、有効にする HYPER-V にします。</span><span class="sxs-lookup"><span data-stu-id="6c906-172">These are physical disks which are set to *offline* in the root partition and enable Hyper-V to have exclusive read-write access to the physical disk.</span></span>|<span data-ttu-id="6c906-173">仮想マシンに割り当てられるために、完全に専用のディスクまたは LUN が必要です。</span><span class="sxs-lookup"><span data-stu-id="6c906-173">Requires a fully dedicated disk or LUN in order for it to be allocated to a virtual machine.</span></span><br /><br /> <span data-ttu-id="6c906-174">物理ディスクは、VHD ファイルよりもコンピューター間で移動することは困難です。</span><span class="sxs-lookup"><span data-stu-id="6c906-174">A physical disk is more difficult to move between machines than VHD files.</span></span>|<span data-ttu-id="6c906-175">場合、[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]インスタンスが、HYPER-V で実行されているの固定容量仮想ハード_ディスク (VHD) を使用するパススルー ディスクを使用して増分パフォーマンスの向上を取得する可能性があります、[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]データ ボリューム。</span><span class="sxs-lookup"><span data-stu-id="6c906-175">If your [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance is running on a Hyper-V, you may obtain incremental performance improvements by using passthrough disks over using fixed virtual hard disks (VHD) for the [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] data volumes.</span></span><br /><br /> <span data-ttu-id="6c906-176">ローカル ホストしている場合、ファイル受信場所で[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]を処理中にディスク サイズの大きいメッセージをストリーミングするには、固定容量仮想ハード_ディスク (VHD) を使用するパススルー ディスクを使用して増分パフォーマンスの向上を取得することがありますか。</span><span class="sxs-lookup"><span data-stu-id="6c906-176">If you are hosting local file receive locations on [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] or streaming large messages to disk during processing, you may obtain incremental performance improvements using passthrough disks over using fixed virtual hard disks (VHD).</span></span>|  
  
 <span data-ttu-id="6c906-177">ディスクと hyper-v の記憶域の実装の詳細については、次を参照してください。[を実装するディスクおよび記憶域](http://go.microsoft.com/fwlink/?LinkID=142362)(http://go.microsoft.com/fwlink/?LinkID=142362)。</span><span class="sxs-lookup"><span data-stu-id="6c906-177">For more information about implementing disks and storage with Hyper-V see [Implementing Disks and Storage](http://go.microsoft.com/fwlink/?LinkID=142362) (http://go.microsoft.com/fwlink/?LinkID=142362).</span></span>  
  
##### <a name="networking"></a><span data-ttu-id="6c906-178">ネットワーク</span><span class="sxs-lookup"><span data-stu-id="6c906-178">Networking</span></span>  
 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]<span data-ttu-id="6c906-179">使用率が高いネットワークが発生する傾向があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-179"> tends to exhibit high network utilization.</span></span> <span data-ttu-id="6c906-180">したがって、ネットワークのパフォーマンスに問題がある場合は、仮想マシンごとに別個の物理ネットワーク カードを割り当てることを検討します。</span><span class="sxs-lookup"><span data-stu-id="6c906-180">Therefore, when network performance is an issue, consider allocating a separate physical network card for each virtual machine.</span></span>  
  
 <span data-ttu-id="6c906-181">仮想マシンを構成する場合は、レガシ ネットワーク アダプターではなく、ネットワーク アダプターを使用することを確認します。</span><span class="sxs-lookup"><span data-stu-id="6c906-181">When configuring a virtual machine, ensure that you use the Network Adapter instead of the Legacy Network Adapter.</span></span> <span data-ttu-id="6c906-182">レガシ ネットワーク アダプターは、統合コンポーネントをサポートしないオペレーティング システム向けです。</span><span class="sxs-lookup"><span data-stu-id="6c906-182">The legacy network adapter is intended for operating systems that do not support integration components.</span></span>  
  
 <span data-ttu-id="6c906-183">ネットワーク パフォーマンスの使用状況を測定する、 **"\Network インターフェイス \Bytes total/sec"**と**\Network インターフェイス (\*) \Output Queue Length**ホスト オペレーティングにパフォーマンス モニター カウンターネットワーク カードの全体的なパフォーマンスを測定するシステムです。</span><span class="sxs-lookup"><span data-stu-id="6c906-183">To measure network performance use the **“\Network Interface \Bytes Total/sec”** and the **\Network Interface(\*)\Output Queue Length** performance monitor counters on the host operating system to measure overall performance of the network card.</span></span> <span data-ttu-id="6c906-184">物理ネットワークが使用中として識別される場合を使用して、 **"\Hyper-V 仮想ネットワーク アダプター (\*) \Bytes/sec"**どのバーチャル マシン ネットワーク アダプターを識別する、ホスト オペレーティング システムのカウンターは、高負荷を生成しています。</span><span class="sxs-lookup"><span data-stu-id="6c906-184">If a physical network has been identified as being busy, use the **“\Hyper-V Virtual Network Adapter (\*)\Bytes/sec”** counter on the host operating system to identify which virtual machine network adapter(s) is/are generating high load.</span></span>  
  
 <span data-ttu-id="6c906-185">HYPER-V 環境でネットワーク パフォーマンスの評価の詳細については、次を参照してください。、**ネットワーク パフォーマンスの測定**のセクション[チェックリスト: Hyper-v でのパフォーマンスの測定](../technical-guides/checklist-measuring-performance-on-hyper-v.md)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-185">For more information about evaluating network performance on a Hyper-V environment see the **Measuring Network Performance** section of [Checklist: Measuring Performance on Hyper-V](../technical-guides/checklist-measuring-performance-on-hyper-v.md).</span></span>  
  
##### <a name="cpu"></a><span data-ttu-id="6c906-186">CPU</span><span class="sxs-lookup"><span data-stu-id="6c906-186">CPU</span></span>  
 <span data-ttu-id="6c906-187">HYPER-V は、さまざまなゲスト オペレーティング システムの仮想プロセッサの数が異なるをサポートしています次の表にまとめるとおりです。</span><span class="sxs-lookup"><span data-stu-id="6c906-187">Hyper-V supports different numbers of virtual processors for different guest operating systems; as summarized in the table below.</span></span> <span data-ttu-id="6c906-188">最大 CPU リソースに割り当てる[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]にインストール、[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]ゲスト オペレーティング システムは、仮想マシンあたり 4 つの仮想プロセッサをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="6c906-188">To allocate the maximum CPU resources for [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)], install it on a [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] guest operating system,  which supports four virtual processors per virtual machine.</span></span>  
  
 <span data-ttu-id="6c906-189">コンテキストの過度の切り替えを防ぐためにホスト オペレーティング システムが利用できる論理プロセッサにゲスト オペレーティング システムで仮想プロセッサの 1 対 1 の割り当てを構成します。</span><span class="sxs-lookup"><span data-stu-id="6c906-189">Configure a 1-1 allocation of virtual processors in the guest operating system(s) to logical processors available to the host operating system to prevent excessive context switching.</span></span> <span data-ttu-id="6c906-190">コンテキストの過度のプロセッサ間の切り替えがパフォーマンスの低下が発生します。</span><span class="sxs-lookup"><span data-stu-id="6c906-190">Excessive context switching between processors will result in performance degradation.</span></span> <span data-ttu-id="6c906-191">仮想プロセッサと論理プロセッサの割り当てに関する詳細については、トピックの「プロセッサのパフォーマンスを最適化する」セクションを参照して[チェックリスト: HYPER-V でパフォーマンスの最適化](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-191">For more information about allocating virtual processors to logical processors, see the “Optimize Processor Performance” section of the topic [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span>  
  
 <span data-ttu-id="6c906-192">"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行時間"のパフォーマンス モニター カウンターはすべてのゲスト マシンと HYPER-V ホスト上のハイパーバイザーの全体的なリソース使用率を測定します。</span><span class="sxs-lookup"><span data-stu-id="6c906-192">The “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” Performance Monitor counter measures the overall resource utilization of all guest machines and the hypervisor on the Hyper-V host.</span></span> <span data-ttu-id="6c906-193">最大容量です。 サーバーが実行されている場合、この値は、90% 以上が、このシナリオで仮想マシンに割り当ての追加仮想プロセッサでは、システム全体のパフォーマンスが低下することができ、避ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-193">If this value is above 90%, the server is running at maximum capacity; allocating additional virtual processors to virtual machines in this scenario can degrade overall system performance and should be avoided.</span></span> <span data-ttu-id="6c906-194">HyperV のパフォーマンス カウンターの使用の詳細については、次を参照してください。、 [Hyper-v 上の BizTalk サーバー パフォーマンスの評価](../technical-guides/evaluating-biztalk-server-performance-on-hyper-v.md)このガイドの「します。</span><span class="sxs-lookup"><span data-stu-id="6c906-194">For further details on using the HyperV performance counters, see the [Evaluating BizTalk Server Performance on Hyper-V](../technical-guides/evaluating-biztalk-server-performance-on-hyper-v.md) section of this guide.</span></span>  
  
|<span data-ttu-id="6c906-195">オペレーティング システム</span><span class="sxs-lookup"><span data-stu-id="6c906-195">Operating system</span></span>|<span data-ttu-id="6c906-196">仮想プロセッサ数の上限</span><span class="sxs-lookup"><span data-stu-id="6c906-196">Virtual processor limit</span></span>|  
|----------------------|-----------------------------|  
|[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]<span data-ttu-id="6c906-197">」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="6c906-197">.</span></span> <span data-ttu-id="6c906-198">すべてのエディション[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]は 64 ビットのみです。</span><span class="sxs-lookup"><span data-stu-id="6c906-198">All editions of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] are 64-bit only.</span></span>|<span data-ttu-id="6c906-199">4</span><span class="sxs-lookup"><span data-stu-id="6c906-199">4</span></span>|  
|[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]<span data-ttu-id="6c906-200">64 ビット</span><span class="sxs-lookup"><span data-stu-id="6c906-200"> 64-bit</span></span>|<span data-ttu-id="6c906-201">4</span><span class="sxs-lookup"><span data-stu-id="6c906-201">4</span></span>|  
|[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]<span data-ttu-id="6c906-202">32 ビット</span><span class="sxs-lookup"><span data-stu-id="6c906-202"> 32-bit</span></span>|<span data-ttu-id="6c906-203">4</span><span class="sxs-lookup"><span data-stu-id="6c906-203">4</span></span>|  
|<span data-ttu-id="6c906-204">Windows 7 64 ビット</span><span class="sxs-lookup"><span data-stu-id="6c906-204">Windows 7 64-bit</span></span>|<span data-ttu-id="6c906-205">4</span><span class="sxs-lookup"><span data-stu-id="6c906-205">4</span></span>|  
|<span data-ttu-id="6c906-206">Windows 7 32 ビット</span><span class="sxs-lookup"><span data-stu-id="6c906-206">Windows 7 32-bit</span></span>|<span data-ttu-id="6c906-207">4</span><span class="sxs-lookup"><span data-stu-id="6c906-207">4</span></span>|  
|<span data-ttu-id="6c906-208">Windows Vista 64 ビット</span><span class="sxs-lookup"><span data-stu-id="6c906-208">Windows Vista 64-bit</span></span>|<span data-ttu-id="6c906-209">2</span><span class="sxs-lookup"><span data-stu-id="6c906-209">2</span></span>|  
|<span data-ttu-id="6c906-210">Windows Vista 32 ビット</span><span class="sxs-lookup"><span data-stu-id="6c906-210">Windows Vista  32-bit</span></span>|<span data-ttu-id="6c906-211">2</span><span class="sxs-lookup"><span data-stu-id="6c906-211">2</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="6c906-212">HYPER-V でサポートされているゲスト オペレーティング システムの詳細については、次を参照してください。 [http://go.microsoft.com/fwlink/?LinkID=118347](http://go.microsoft.com/fwlink/?LinkID=118347)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-212">For more information about the guest operating systems that are supported on Hyper-V, see [http://go.microsoft.com/fwlink/?LinkID=118347](http://go.microsoft.com/fwlink/?LinkID=118347).</span></span>  
  
##### <a name="memory"></a><span data-ttu-id="6c906-213">[メモリ]</span><span class="sxs-lookup"><span data-stu-id="6c906-213">Memory</span></span>  
 <span data-ttu-id="6c906-214">物理サーバーでは、ルート パーティションと、サーバーで実行されているすべてのバーチャル マシンのための十分なメモリが必要です。</span><span class="sxs-lookup"><span data-stu-id="6c906-214">The physical server requires enough memory for the root partition and any virtual machines running on the server.</span></span> <span data-ttu-id="6c906-215">テスト中に、2 GB のメモリの最小値は、ルート パーティションに割り当てられた、**メモリ/利用可能領域のメガバイト数**パフォーマンス モニター カウンターを監視したメモリ不足が発生しましたないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="6c906-215">During testing, a minimum of 2GB of memory was allocated to the root partition and the **Memory/Available Mbytes** performance monitor counter was monitored to ensure no memory pressure was experienced.</span></span>  
  
 <span data-ttu-id="6c906-216">場合は、各仮想マシンに割り当てる必要があるメモリの量、[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]環境は、ワークロードによって異なりますされ、処理の種類が実行されます。</span><span class="sxs-lookup"><span data-stu-id="6c906-216">The amount of memory that should be allocated to each virtual machine in a [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] environment depends on the workload and type of processing that will be performed.</span></span> <span data-ttu-id="6c906-217">多くの要因に影響を与えるのメモリ要件がある[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]など。</span><span class="sxs-lookup"><span data-stu-id="6c906-217">There are many factors that affect memory requirements of  [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] including:</span></span>  
  
-   <span data-ttu-id="6c906-218">処理されるメッセージのサイズ</span><span class="sxs-lookup"><span data-stu-id="6c906-218">Size of messages processed</span></span>  
  
-   <span data-ttu-id="6c906-219">メッセージのスループット</span><span class="sxs-lookup"><span data-stu-id="6c906-219">Throughput of messages</span></span>  
  
-   <span data-ttu-id="6c906-220">オーケストレーションのデザイン</span><span class="sxs-lookup"><span data-stu-id="6c906-220">Orchestration design</span></span>  
  
-   <span data-ttu-id="6c906-221">パイプライン処理</span><span class="sxs-lookup"><span data-stu-id="6c906-221">Pipeline processing</span></span>  
  
-   <span data-ttu-id="6c906-222">仮想マシン内で実行しようとする BizTalk ホストの数</span><span class="sxs-lookup"><span data-stu-id="6c906-222">Number of BizTalk hosts that you plan to run within the virtual machine</span></span>  
  
 <span data-ttu-id="6c906-223">メモリに影響する要因の包括的な一覧で BizTalk Server のパフォーマンス最適化ガイド 』 の「パフォーマンスの要因」セクションを参照してください。 [http://go.microsoft.com/fwlink/?LinkId=122587](http://go.microsoft.com/fwlink/?LinkId=122587)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-223">For a comprehensive list of factors that affect memory, see “The Performance Factors” section of the BizTalk Server Performance Optimizations Guide at [http://go.microsoft.com/fwlink/?LinkId=122587](http://go.microsoft.com/fwlink/?LinkId=122587).</span></span>  
  
 <span data-ttu-id="6c906-224">事前対応的に監視、**メモリ/利用可能領域のメガバイト数**各仮想マシンと、ルート パーティション自体内からカウンターです。</span><span class="sxs-lookup"><span data-stu-id="6c906-224">Proactively monitor the **Memory/Available Mbytes** counter from within each virtual machine and the root partition itself.</span></span> <span data-ttu-id="6c906-225">次のガイドライン[チェックリスト: HYPER-V でのパフォーマンスの測定](../technical-guides/checklist-measuring-performance-on-hyper-v.md)に十分な物理メモリ、仮想マシンと、ルート パーティションがあるかどうかを判断するために使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-225">The following guidelines from [Checklist: Measuring Performance on Hyper-V](../technical-guides/checklist-measuring-performance-on-hyper-v.md) should be used to determine whether there is enough available physical memory for the virtual machine and for the root partition:</span></span>  
  
-   <span data-ttu-id="6c906-226">使用可能な空きメモリの 50% より = 正常または</span><span class="sxs-lookup"><span data-stu-id="6c906-226">50% of free memory available or more = Healthy</span></span>  
  
-   <span data-ttu-id="6c906-227">使用可能な空きメモリの 25% = モニター</span><span class="sxs-lookup"><span data-stu-id="6c906-227">25% of free memory available = Monitor</span></span>  
  
-   <span data-ttu-id="6c906-228">使用可能な空きメモリの 10% = 警告</span><span class="sxs-lookup"><span data-stu-id="6c906-228">10% of free memory available = Warning</span></span>  
  
-   <span data-ttu-id="6c906-229">使用可能な空きメモリの 5% 未満 ="重大"、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="6c906-229">Less than 5% of free memory available = Critical, performance will be adversely affected</span></span>  
  
#### <a name="choosing-root-operating-system-version"></a><span data-ttu-id="6c906-230">ルートのオペレーティング システムのバージョンを選択します。</span><span class="sxs-lookup"><span data-stu-id="6c906-230">Choosing Root Operating System Version</span></span>  
 <span data-ttu-id="6c906-231">Server Core とフル インストールに HYPER-V がサポートされている[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-231">Hyper-V is supported on a Server Core as well as a full installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="6c906-232">ルート パーティションのオーバーヘッドを最小限に抑えるには、Server Core インストールに HYPER-V をインストール[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-232">To minimize the overhead of the root partition, install Hyper-V on a Server Core installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="6c906-233">HYPER-V の役割は、別のシステムで HYPER-V マネージャーからリモートで管理できます。</span><span class="sxs-lookup"><span data-stu-id="6c906-233">The Hyper-V role can be managed remotely from the Hyper-V Manager on a different system.</span></span> <span data-ttu-id="6c906-234">Server Core では、仮想マシンで使用できる多くのリソースを残して、小さいディスクとメモリ プロファイル、したがってを提供します。</span><span class="sxs-lookup"><span data-stu-id="6c906-234">Server Core provides a smaller disk and memory profile, therefore, leaving more resources available for virtual machines.</span></span> <span data-ttu-id="6c906-235">詳細については、Server Core インストール オプションの使用可能な[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]を参照してください[http://go.microsoft.com/fwlink/?LinkID=202439](http://go.microsoft.com/fwlink/?LinkID=202439)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-235">For more information about the Server Core installation option available for [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)], see [http://go.microsoft.com/fwlink/?LinkID=202439](http://go.microsoft.com/fwlink/?LinkID=202439).</span></span>  
  
 <span data-ttu-id="6c906-236">完全インストールを使用する場合[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]、HYPER-V サーバー ロールにのみ、ルート パーティションは専用のことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="6c906-236">If you choose to use a full installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)], ensure that the root partition is dedicated only to the Hyper-V server role.</span></span> <span data-ttu-id="6c906-237">追加のサーバー役割を実行しているメモリ、ディスク、プロセッサ、およびネットワーク リソースを消費し、パフォーマンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="6c906-237">Running additional server roles will consume memory, disk, processor, and network resources and will degrade performance.</span></span>  
  
#### <a name="creating-your-virtual-machines"></a><span data-ttu-id="6c906-238">仮想マシンを作成します。</span><span class="sxs-lookup"><span data-stu-id="6c906-238">Creating Your Virtual Machines</span></span>  
 <span data-ttu-id="6c906-239">インストールし、HYPER-V サーバーの役割を構成したが後、は、仮想マシンを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6c906-239">After you have installed and configured the Hyper-V server role, you need to create the virtual machines.</span></span> <span data-ttu-id="6c906-240">これを行う前に、次の質問に答える便利です。</span><span class="sxs-lookup"><span data-stu-id="6c906-240">Before doing this, it is useful to answer the following questions:</span></span>  
  
-   <span data-ttu-id="6c906-241">どのような記憶域の構成が使用されますか。</span><span class="sxs-lookup"><span data-stu-id="6c906-241">What storage configuration will I use?</span></span>  
  
-   <span data-ttu-id="6c906-242">ゲスト オペレーティング システムは仮想プロセッサの数をサポートしますか。</span><span class="sxs-lookup"><span data-stu-id="6c906-242">How many virtual processors does the guest operating system support?</span></span>  
  
-   <span data-ttu-id="6c906-243">メモリの量は、仮想マシンに割り当てられるか。</span><span class="sxs-lookup"><span data-stu-id="6c906-243">How much memory will be allocated to the virtual machine?</span></span>  
  
-   <span data-ttu-id="6c906-244">仮想マシンの数、HYPER-V サーバーで実行できますか</span><span class="sxs-lookup"><span data-stu-id="6c906-244">How many virtual machines can I run on my Hyper-V Server?</span></span>  
  
-   <span data-ttu-id="6c906-245">コンピューターにオペレーティング システムをインストールする方法は?</span><span class="sxs-lookup"><span data-stu-id="6c906-245">How will I install the operating system onto the machine?</span></span>  
  
 <span data-ttu-id="6c906-246">作成して、仮想マシンを構成する方法の詳細については、次を参照してください。[仮想マシンを作成](http://go.microsoft.com/fwlink/?LinkID=202440)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-246">For more information about how to create and configure virtual machines, see [Create Virtual Machines](http://go.microsoft.com/fwlink/?LinkID=202440).</span></span>  
  
##### <a name="installing-the-base-operating-system"></a><span data-ttu-id="6c906-247">ベースのオペレーティング システムをインストールします。</span><span class="sxs-lookup"><span data-stu-id="6c906-247">Installing the Base Operating System</span></span>  
 <span data-ttu-id="6c906-248">物理サーバー インストールで使用できるすべてのオプションは、HYPER-V で使用できます。</span><span class="sxs-lookup"><span data-stu-id="6c906-248">All the options available for a physical server installation are available in Hyper-V.</span></span> <span data-ttu-id="6c906-249">手動インストールを実行するのには、起動可能な CD または DVD-ROM メディアまたは ISO イメージを使用できます。</span><span class="sxs-lookup"><span data-stu-id="6c906-249">A bootable CD/DVD-ROM media or an ISO image can be used to perform a manual installation.</span></span> <span data-ttu-id="6c906-250">仮想マシンは、ISO イメージをホストするサーバーと同じネットワークに接続されたネットワーク アダプターで構成されている場合、ネットワークのインストールを実行できます。</span><span class="sxs-lookup"><span data-stu-id="6c906-250">A network installation can be performed if the virtual machine has been configured with a network adapter connected to the same network as a server that hosts the ISO images.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="6c906-251">HYPER-V で実行されている各仮想マシンのオペレーティング システムの統合コンポーネントをインストールする重要なパフォーマンス向上のため、どちらのインストール方法が選択されます。</span><span class="sxs-lookup"><span data-stu-id="6c906-251">Whichever installation method is chosen, for performance reasons it is critical the operating system integration components be installed for each virtual machine running under Hyper-V.</span></span> <span data-ttu-id="6c906-252">統合コンポーネントは、一連のドライバーと統合デバイスを使用して実行するゲスト マシンを有効にするサービスを提供します。</span><span class="sxs-lookup"><span data-stu-id="6c906-252">The integration components provide a set of drivers and services that enable the guest machine to perform by using synthetic devices.</span></span> <span data-ttu-id="6c906-253">統合デバイスは、エミュレートされたデバイスは、統合コンポーネントをサポートしないオペレーティング システムで使用する必要を避けるようにします。</span><span class="sxs-lookup"><span data-stu-id="6c906-253">Synthetic devices avoid the need for emulated devices, which are used on operating systems that do not support integration components.</span></span> <span data-ttu-id="6c906-254">エミュレートされたデバイスでは、統合デバイスと比較して大きくのシステム オーバーヘッドが発生します。</span><span class="sxs-lookup"><span data-stu-id="6c906-254">Emulated devices incur greater system overhead compared to synthetic devices.</span></span>  
  
 <span data-ttu-id="6c906-255">インストールして、このラボで使用するコンピューターの構成、初期の基本イメージは、固定サイズの VHD に作成されました。</span><span class="sxs-lookup"><span data-stu-id="6c906-255">To install and configure the machines used in this lab, an initial base image was created on a fixed size VHD.</span></span> <span data-ttu-id="6c906-256">手動インストールが関係しているこの[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-256">This involved a manual installation of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="6c906-257">すべての適切な更新プログラムがインストールされていたと基本の仮想マシン イメージを作成した %WINDIR%\system32\sysprep ディレクトリに、Windows Server 2008 と共にインストールされる sysprep ユーティリティを使用します。</span><span class="sxs-lookup"><span data-stu-id="6c906-257">Once all appropriate updates had been installed the base virtual machine was imaged using sysprep utility that is installed with Windows Server 2008, in the %WINDIR%\system32\sysprep directory.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6c906-258">後に Sysprep を実行している[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]をインストールしてに構成されているサーバーは、Sysprep 応答ファイルを使用して実現でき、スクリプトが付属[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-258">Running Sysprep after [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] has been installed and configured on the server can be accomplished through the use of a Sysprep answer file and scripts provided with [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)].</span></span> <span data-ttu-id="6c906-259">これらのサンプル スクリプトがで使用するために設計された[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]にインストールされている[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-259">These sample scripts are designed for use with [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] installed on [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)].</span></span> <span data-ttu-id="6c906-260">詳細については、次を参照してください。、[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]オンライン ドキュメントを参照します。</span><span class="sxs-lookup"><span data-stu-id="6c906-260">For more information see the [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] online documentation.</span></span>  
  
## <a name="installing-and-configuring-biztalk-server"></a><span data-ttu-id="6c906-261">BizTalk Server のインストールと構成</span><span class="sxs-lookup"><span data-stu-id="6c906-261">Installing and Configuring BizTalk Server</span></span>  
  
-   <span data-ttu-id="6c906-262">仮想マシンをインストールに必要な時間を最小限に抑えるには、ゲスト オペレーティング システムとソフトウェアの前提条件のみで構成される基本イメージを作成します。</span><span class="sxs-lookup"><span data-stu-id="6c906-262">To minimize the time required to install virtual machines, create a base image consisting only of the guest operating system and software prerequisites.</span></span> <span data-ttu-id="6c906-263">SysPrep を使用して、再利用するため、VHD イメージを準備し、基にしてこの VHD にすべての仮想マシン (Vm)。</span><span class="sxs-lookup"><span data-stu-id="6c906-263">Use SysPrep to prepare the VHD image for reuse, and then base all your virtual machines (VMs) on this VHD.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6c906-264">[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]、基本イメージに対して Sysprep を実行することは*後*[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]をインストールして、サーバーで構成します。</span><span class="sxs-lookup"><span data-stu-id="6c906-264">With [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)], it is possible to run Sysprep against a base image *after*[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] has been installed and configured on the server.</span></span> <span data-ttu-id="6c906-265">これには、Sysprep 応答ファイルを使用してで提供されるスクリプト[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-265">This can be accomplished through the use of a Sysprep answer file and scripts provided with [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)].</span></span> <span data-ttu-id="6c906-266">これらのサンプル スクリプトがで使用するために設計された[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]にインストールされている[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="6c906-266">These sample scripts are designed for use with [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] installed on   [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] .</span></span> <span data-ttu-id="6c906-267">詳細については、次を参照してください。、[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]オンライン ドキュメントを参照します。</span><span class="sxs-lookup"><span data-stu-id="6c906-267">For more information see the [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] online documentation.</span></span>  
    >   
    >  <span data-ttu-id="6c906-268">Windows の無人セットアップ リファレンスについては、「 [http://go.microsoft.com/fwlink/?LinkId=142364](http://go.microsoft.com/fwlink/?LinkId=142364)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-268">The Unattended Windows Setup Reference is available at [http://go.microsoft.com/fwlink/?LinkId=142364](http://go.microsoft.com/fwlink/?LinkId=142364).</span></span>  
  
-   <span data-ttu-id="6c906-269">次の推奨事項、「ときにインストールしを構成する BizTalk Server…」に</span><span class="sxs-lookup"><span data-stu-id="6c906-269">Follow the recommendations in the “When Installing and Configuring BizTalk Server…”</span></span> <span data-ttu-id="6c906-270">」の「[チェックリスト: インストールと Hyper-v での BizTalk Server 構成のベスト プラクティス](../technical-guides/checklist-best-practices-to-install-and-configure-biztalk-server-on-hyper-v.md)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-270">section of the topic [Checklist: Best Practices for Installing and Configuring BizTalk Server on Hyper-V](../technical-guides/checklist-best-practices-to-install-and-configure-biztalk-server-on-hyper-v.md).</span></span>  
  
-   <span data-ttu-id="6c906-271">サポート状況について[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]と[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]HYPER-V 環境で、次を参照してください。[付録 c: BizTalk Server と SQL Server の Hyper-v でサポート性](../technical-guides/appendix-c-biztalk-server-and-sql-server-hyper-v-supportability.md)です。</span><span class="sxs-lookup"><span data-stu-id="6c906-271">For information on the supportability of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] in a Hyper-V environment, see [Appendix C: BizTalk Server and SQL Server Hyper-V Supportability](../technical-guides/appendix-c-biztalk-server-and-sql-server-hyper-v-supportability.md).</span></span>