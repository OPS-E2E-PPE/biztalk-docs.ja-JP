---
title: マスター シークレット サーバーの高可用性 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 9b99cb04-61a5-41cc-a409-35897c17b789
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f366eb2827859f8d720c74e670808aebfb0665b2
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/01/2017
ms.locfileid: "26008843"
---
# <a name="high-availability-for-the-master-secret-server"></a><span data-ttu-id="4962b-102">マスター シークレット サーバーの高可用性</span><span class="sxs-lookup"><span data-stu-id="4962b-102">High Availability for the Master Secret Server</span></span>
<span data-ttu-id="4962b-103">SSO は、ため、全体的な Microsoft BizTalk Server インフラストラクチャの重要な一部のマッピングの資格情報やシングル サインオン エンタープライズ シングル サインオン (SSO) 機能を使用しない場合でも[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]SSO を使用してセキュリティで保護されたポートの情報構成します。</span><span class="sxs-lookup"><span data-stu-id="4962b-103">Even if you do not use the Enterprise Single Sign-On (SSO) functionality for mapping credentials and single sign-on, SSO is a critical part of the overall Microsoft BizTalk Server infrastructure, because [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses SSO to help secure information for port configuration.</span></span> <span data-ttu-id="4962b-104">ポートの構成データを暗号化して、SSO データベースに格納します。</span><span class="sxs-lookup"><span data-stu-id="4962b-104">The port configuration data is encrypted and stored in the SSO database.</span></span> <span data-ttu-id="4962b-105">各 BizTalk サーバーでは、ポートの構成データを暗号化および暗号化に使用する SSO サービス (ENTSSO.exe) があります。</span><span class="sxs-lookup"><span data-stu-id="4962b-105">Each BizTalk server has an SSO service (ENTSSO.exe) that is used for encrypting and decrypting the port configuration data.</span></span>  
  
 <span data-ttu-id="4962b-106">SSO サービスが起動時に、マスター シークレット サーバーから暗号化キーを取得します。</span><span class="sxs-lookup"><span data-stu-id="4962b-106">When an SSO service starts up, it retrieves the encryption key from the master secret server.</span></span> <span data-ttu-id="4962b-107">この暗号化キーには、マスター シークレットが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="4962b-107">This encryption key is called the master secret.</span></span> <span data-ttu-id="4962b-108">マスター シークレット サーバーは、他の SSO サービスを維持し、マスター シークレットを配布する追加のサブサービスを持つです。</span><span class="sxs-lookup"><span data-stu-id="4962b-108">The master secret server is another SSO service that has an additional subservice that maintains and distributes the master secret.</span></span> <span data-ttu-id="4962b-109">マスター シークレットが取得された後は、SSO サービスはキャッシュします。</span><span class="sxs-lookup"><span data-stu-id="4962b-109">After a master secret is retrieved, the SSO service caches it.</span></span> <span data-ttu-id="4962b-110">60 秒ごとに、SSO サービスは、マスター シークレット サーバーとマスター シークレットを同期します。</span><span class="sxs-lookup"><span data-stu-id="4962b-110">Every 60 seconds, the SSO service synchronizes the master secret with the master secret server.</span></span>  
  
 <span data-ttu-id="4962b-111">マスター シークレット サーバーが失敗し、SSO サービスは、その更新間隔のいずれかで障害を検出、SSO サービスおよびすべてのランタイム操作に失敗しました。 を含む、サーバーの資格情報の復号化する前に実行されていた正常に続行します。</span><span class="sxs-lookup"><span data-stu-id="4962b-111">If the master secret server fails, and the SSO service detects the failure in one of its refresh intervals, the SSO service and all run-time operations that were running before the server failed, including decryption of credentials, continue successfully.</span></span> <span data-ttu-id="4962b-112">ただし、新しい資格情報またはポートの構成データを暗号化することはできません。</span><span class="sxs-lookup"><span data-stu-id="4962b-112">However, you cannot encrypt new credentials or port configuration data.</span></span> <span data-ttu-id="4962b-113">したがって、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境、マスタ シークレット サーバーの可用性に依存しています。</span><span class="sxs-lookup"><span data-stu-id="4962b-113">Therefore, the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment has a dependency on the availability of the master secret server.</span></span>  
  
## <a name="making-the-master-secret-server-available"></a><span data-ttu-id="4962b-114">マスター シークレット サーバーの可用性を確保する方法</span><span class="sxs-lookup"><span data-stu-id="4962b-114">Making the Master Secret Server Available</span></span>  
 <span data-ttu-id="4962b-115">SSO システムの可用性のための[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境では、生成されるとすぐには、マスター シークレットをバックアップすることが重要です。</span><span class="sxs-lookup"><span data-stu-id="4962b-115">For availability of the SSO system, and therefore of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment, it is critical that you back up the master secret as soon as it is generated.</span></span> <span data-ttu-id="4962b-116">マスター シークレットを失うことは、SSO システムがそのマスター シークレットを使って暗号化したデータを失うことを意味します。</span><span class="sxs-lookup"><span data-stu-id="4962b-116">If you lose it, you lose the data that the SSO system encrypted by using that master secret.</span></span> <span data-ttu-id="4962b-117">マスター シークレットのバックアップの詳細については、次を参照してください。[バックアップ マスター シークレットをする方法](http://go.microsoft.com/fwlink/?LinkID=151934)(http://go.microsoft.com/fwlink/?LinkID=151934)、BizTalk Server のヘルプ。</span><span class="sxs-lookup"><span data-stu-id="4962b-117">For more information about backing up the master secret, see [How to Back Up the Master Secret](http://go.microsoft.com/fwlink/?LinkID=151934) (http://go.microsoft.com/fwlink/?LinkID=151934) in BizTalk Server Help.</span></span>  
  
 <span data-ttu-id="4962b-118">マスター シークレット サーバーの可用性は、次の 2 とおりの方法で確保することができます。</span><span class="sxs-lookup"><span data-stu-id="4962b-118">You can make the master secret server available in two ways:</span></span>  
  
-   <span data-ttu-id="4962b-119">**使用できないが、高可用性ではない**です。</span><span class="sxs-lookup"><span data-stu-id="4962b-119">**Available, but not highly available**.</span></span> <span data-ttu-id="4962b-120">マスター シークレット サーバーが、使用できなくなったとマスター シークレット サーバーと、このサーバーでマスター シークレットを復元するもう 1 つの SSO サーバーを昇格することができますし、手動で通知するように Microsoft System Center Operations Manager イベントを作成することができます。</span><span class="sxs-lookup"><span data-stu-id="4962b-120">You can create a Microsoft System Center Operations Manager event to notify you when the master secret server becomes unavailable, and you can then manually promote another SSO server to master secret server and restore the master secret on this server.</span></span>  
  
     <span data-ttu-id="4962b-121">この構成では、高可用性、ほとんどのシナリオだけで十分ができますをスケール アウト、受信、送信、および処理ホストと一致します。</span><span class="sxs-lookup"><span data-stu-id="4962b-121">Although this configuration is not highly available, it can be satisfactory for most scenarios and it is consistent with scaling out the receiving, sending, and processing hosts.</span></span>  
  
-   <span data-ttu-id="4962b-122">**高可用性**です。</span><span class="sxs-lookup"><span data-stu-id="4962b-122">**Highly available**.</span></span> <span data-ttu-id="4962b-123">マスター シークレット サーバーの冗長性を確保するには、Windows クラスタリングを使用して別にマスター シークレット サーバーをクラスター化するか、マスター シークレット サーバーを既存のデータベース クラスター上に構成します。</span><span class="sxs-lookup"><span data-stu-id="4962b-123">To provide redundancy for the master secret server, use Windows Clustering on a separate master secret server cluster, or configure the master secret server on an existing database cluster.</span></span> <span data-ttu-id="4962b-124">マスター シークレット サーバーによって提供されるサービスは、それほど多くのリソースを消費しません。データベース クラスターにインストールしたとしても、データベースの機能やパフォーマンスに影響を与えることはありません。</span><span class="sxs-lookup"><span data-stu-id="4962b-124">The services provided by the master secret server do not consume many resources, and typically do not affect database functionality or performance when installed on a database cluster.</span></span> <span data-ttu-id="4962b-125">次の図は、マスター シークレット サーバーに高水準の可用性を確保する方法を示したものです。</span><span class="sxs-lookup"><span data-stu-id="4962b-125">The following figure shows how you can make the master secret server highly available.</span></span>  
  
     <span data-ttu-id="4962b-126">![高可用性のマスター シークレット サーバー](../core/media/tdi-highava-msscluster.gif "TDI_HighAva_MSSCluster")</span><span class="sxs-lookup"><span data-stu-id="4962b-126">![Highly Available Master Secret Server](../core/media/tdi-highava-msscluster.gif "TDI_HighAva_MSSCluster")</span></span>  
  
     <span data-ttu-id="4962b-127">この構成では高い可用性が実現される反面、追加のハードウェア リソースが必要になります。</span><span class="sxs-lookup"><span data-stu-id="4962b-127">While this configuration is highly available, it requires additional hardware resources.</span></span> <span data-ttu-id="4962b-128">SSO の高可用性インストール オプションの詳細については、次を参照してください。[高可用性 SSO インストール オプション](http://go.microsoft.com/fwlink/?LinkId=156838)(http://go.microsoft.com/fwlink/?LinkId=156838)、BizTalk Server のヘルプ。</span><span class="sxs-lookup"><span data-stu-id="4962b-128">For more information about high-availability installation options for SSO, see [High-Availability SSO Installation Options](http://go.microsoft.com/fwlink/?LinkId=156838) (http://go.microsoft.com/fwlink/?LinkId=156838) in BizTalk Server Help.</span></span>  
  
     <span data-ttu-id="4962b-129">このセクションには、上の高可用性クラスター リソースとして、SSO マスター シークレット サーバーを構成する方法の詳細情報が含まれています、[!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)]クラスター。</span><span class="sxs-lookup"><span data-stu-id="4962b-129">This section includes detailed information about configuring the SSO master secret server as a highly available cluster resource on a [!INCLUDE[btsWinSvrNoVersion](../includes/btswinsvrnoversion-md.md)] cluster.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4962b-130">高可用性ソリューションのハードウェア リソースを減らすためには、クラスター リソースとして、マスター シークレット サーバーを追加することができます、[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]クラスター。</span><span class="sxs-lookup"><span data-stu-id="4962b-130">To reduce the hardware resources for a highly available solution, you can add the master secret server as a cluster resource in your [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] cluster.</span></span> <span data-ttu-id="4962b-131">注意する必要はありませんを購入する追加[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]SSO をインストールするライセンス サービス、SQL Server を実行しているコンピューターにします。</span><span class="sxs-lookup"><span data-stu-id="4962b-131">Note that you do not need to purchase additional [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] licenses to install the SSO service on the computer running the SQL Server.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="4962b-132">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="4962b-132">In This Section</span></span>  
  
-   [<span data-ttu-id="4962b-133">マスター シークレット サーバーのクラスタリング</span><span class="sxs-lookup"><span data-stu-id="4962b-133">Clustering the Master Secret Server</span></span>](../technical-guides/clustering-the-master-secret-server.md)  
  
-   [<span data-ttu-id="4962b-134">新しいマスター シークレット サーバーを手動で指定する</span><span class="sxs-lookup"><span data-stu-id="4962b-134">Designating a New Master Secret Server Manually</span></span>](../technical-guides/designating-a-new-master-secret-server-manually.md)  
  
## <a name="see-also"></a><span data-ttu-id="4962b-135">参照</span><span class="sxs-lookup"><span data-stu-id="4962b-135">See Also</span></span>  
 <span data-ttu-id="4962b-136">[高 Availability2 の計画](../technical-guides/planning-for-high-availability2.md) </span><span class="sxs-lookup"><span data-stu-id="4962b-136">[Planning for High Availability2](../technical-guides/planning-for-high-availability2.md) </span></span>  
 <span data-ttu-id="4962b-137">[BizTalk ホストの高可用性](../technical-guides/high-availability-for-biztalk-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="4962b-137">[High Availability for BizTalk Hosts](../technical-guides/high-availability-for-biztalk-hosts.md) </span></span>  
 [<span data-ttu-id="4962b-138">データベースの高可用性</span><span class="sxs-lookup"><span data-stu-id="4962b-138">High Availability for Databases</span></span>](../technical-guides/high-availability-for-databases.md)