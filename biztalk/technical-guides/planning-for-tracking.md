---
title: 追跡の計画 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8ffc8573-1b4a-47c7-96ab-0471f43facf5
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c9853fccde9c5fa6e8c223106c8386f19298d0b9
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22302082"
---
# <a name="planning-for-tracking"></a><span data-ttu-id="b5a26-102">追跡の計画</span><span class="sxs-lookup"><span data-stu-id="b5a26-102">Planning for Tracking</span></span>
<span data-ttu-id="b5a26-103">メッセージの追跡は、格納するためのメッセージ本文、メッセージ プロパティ、メタデータなどのメッセージ インスタンスの部分は、データベースでは、通常アーカイブのためのプロセスです。</span><span class="sxs-lookup"><span data-stu-id="b5a26-103">Message tracking is the process by which parts of a message instance, such as the message body, message properties, and metadata are stored in a database, typically for archival purposes.</span></span> <span data-ttu-id="b5a26-104">追跡されているメッセージ インスタンス部分見なすことができます、その後で [グループ ハブ] ページからクエリを実行して、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールです。</span><span class="sxs-lookup"><span data-stu-id="b5a26-104">Message instance parts that are tracked can subsequently be viewed by running queries from the Group Hub page in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="b5a26-105">アーカイブ済みのデータにアクセスするだけでなく、便利なツールを識別して、開発中の問題の修正またはステージング環境の可能性があるライブ データを表示することもできます。</span><span class="sxs-lookup"><span data-stu-id="b5a26-105">In addition to accessing archived data, you can also view live data, which can be a helpful tool for identifying and fixing problems in a development or staging environment.</span></span>  
  
 <span data-ttu-id="b5a26-106">メッセージの追跡プロセスには、リソースを使用する可能性があります、ため、計画を作成する前に、このトピックの内容を確認してください。</span><span class="sxs-lookup"><span data-stu-id="b5a26-106">Since the process of message tracking can be very resource intensive, you should review this topic before creating your plan.</span></span>  
  
 <span data-ttu-id="b5a26-107">追跡の詳細については、次を参照してください。[状態と動作状況の追跡](http://go.microsoft.com/fwlink/?LinkId=154187)(http://go.microsoft.com/fwlink/?LinkId=154187)。</span><span class="sxs-lookup"><span data-stu-id="b5a26-107">For more information about tracking, see [Health and Activity Tracking](http://go.microsoft.com/fwlink/?LinkId=154187) (http://go.microsoft.com/fwlink/?LinkId=154187).</span></span>  
  
## <a name="configuring-and-enabling-the-dta-purge-and-archive-sql-agent-job"></a><span data-ttu-id="b5a26-108">構成し有効化、DTA Purge and Archive SQL エージェント ジョブ</span><span class="sxs-lookup"><span data-stu-id="b5a26-108">Configuring and Enabling the DTA Purge and Archive SQL Agent Job</span></span>  
 <span data-ttu-id="b5a26-109">このジョブをアーカイブしてがあまり大きくならないように、BizTalk 追跡データベースから古いデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-109">This job archives and purges old data from the BizTalk Tracking database, thus keeping it from becoming too large.</span></span> <span data-ttu-id="b5a26-110">これは、正常なために不可欠な[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]システムです。</span><span class="sxs-lookup"><span data-stu-id="b5a26-110">This is essential for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] system.</span></span> <span data-ttu-id="b5a26-111">追跡データベースを照会する追跡ホストおよびその他のすべてのプロセスのパフォーマンスに影響を与える大きな追跡データベースが開始されます。</span><span class="sxs-lookup"><span data-stu-id="b5a26-111">A large tracking database will begin to affect the performance of the tracking host and any other processes that query the tracking database.</span></span>  
  
-   <span data-ttu-id="b5a26-112">**DTA Purge and Archive SQL エージェント ジョブが適切に構成された、有効であり、正常に完了することを確認します。**</span><span class="sxs-lookup"><span data-stu-id="b5a26-112">**Ensure that the DTA Purge and Archive SQL Agent job is properly configured, enabled, and successfully completing.**</span></span> <span data-ttu-id="b5a26-113">アーカイブ ファイルの書き込み先ディレクトリを含めるようにを構成する必要がありますまずために、このジョブは既定で有効にできません。</span><span class="sxs-lookup"><span data-stu-id="b5a26-113">This job is not enabled by default because you must first configure it to include a directory where the archive files can be written.</span></span>  
  
-   <span data-ttu-id="b5a26-114">**ジョブが、受信追跡データが生成された高速の追跡データが削除できることを確認します。**</span><span class="sxs-lookup"><span data-stu-id="b5a26-114">**Ensure that the job is able to purge the tracking data as fast as the incoming tracking data is generated.**</span></span> <span data-ttu-id="b5a26-115">ピーク負荷時の背後に取得するジョブもかまわないが遅れを取り戻すことが常になります。</span><span class="sxs-lookup"><span data-stu-id="b5a26-115">It is acceptable for the job to get behind during peak load times, but it should always be able to catch up.</span></span> <span data-ttu-id="b5a26-116">Purge ジョブでは、背後にあるを取得し、遅延を解消することはありません場合に増加し、BizTalk 追跡データベースは引き続き、パフォーマンスが悪影響を受ける最終的には</span><span class="sxs-lookup"><span data-stu-id="b5a26-116">If the purge job gets behind and is never able to catch up, the BizTalk Tracking database will continue to grow, and performance will eventually be adversely affected.</span></span>  
  
-   <span data-ttu-id="b5a26-117">**論理削除を確認し、物理削除パラメーターを確認するには、なりすぎないように、十分な時間の長いデータを維持しています。**</span><span class="sxs-lookup"><span data-stu-id="b5a26-117">**Review the soft purge and hard purge parameters to ensure you are keeping data long enough but not too long.**</span></span> <span data-ttu-id="b5a26-118">これらのパラメーターの詳細については、次を参照してください。[アーカイブ化および BizTalk 追跡データベースを削除](http://go.microsoft.com/fwlink/?LinkID=153816)(http://go.microsoft.com/fwlink/?LinkID=153816)。</span><span class="sxs-lookup"><span data-stu-id="b5a26-118">For more information about these parameters see [Archiving and Purging the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816).</span></span>  
  
-   <span data-ttu-id="b5a26-119">**だけ古いデータを削除しないようにする必要がある場合必要があります、最初に、アーカイブし、SQL を変更するエージェント ジョブの"dtasp_PurgeTrackingDatabase"ストアド プロシージャを呼び出します。**</span><span class="sxs-lookup"><span data-stu-id="b5a26-119">**If you only need to purge the old data and do not need to archive it first, then change the SQL Agent job to call the stored procedure “dtasp_PurgeTrackingDatabase”.**</span></span> <span data-ttu-id="b5a26-120">これは、アーカイブ手順をスキップし、実行するだけで、パージします。</span><span class="sxs-lookup"><span data-stu-id="b5a26-120">This skips the archive step, and just does the purge.</span></span> <span data-ttu-id="b5a26-121">詳細については、このストアド プロシージャと、使用する SQL エージェント ジョブを変更するを参照してください[BizTalk 追跡データベースからデータを消去する方法](http://go.microsoft.com/fwlink/?LinkID=153817)(http://go.microsoft.com/fwlink/?LinkID=153817)。</span><span class="sxs-lookup"><span data-stu-id="b5a26-121">For more information about this stored procedure and changing the SQL Agent job to use it, see [How to Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817).</span></span>  
  
-   <span data-ttu-id="b5a26-122">**BizTalk 追跡データベースのアーカイブ ファイルを保持する必要がある場合は、正常に復元し、それらを使用するプロセスがあることを確認します。**</span><span class="sxs-lookup"><span data-stu-id="b5a26-122">**If you need to keep the BizTalk Tracking database archive files, ensure that you have a process in place to successfully restore and use them.**</span></span>  
  
-   <span data-ttu-id="b5a26-123">**場合は、BizTalk 追跡データベースを消去して一時的に対処するパフォーマンスの問題があると、不要になった追跡情報を収集する BizTalk を構成する場合、グローバル追跡を無効にすることを検討する可能性があります。**</span><span class="sxs-lookup"><span data-stu-id="b5a26-123">**If you are having performance issues that are momentarily addressed by purging the BizTalk tracking database, and you want to configure BizTalk to no longer collect tracking information, you may want to consider turning off global tracking.**</span></span> <span data-ttu-id="b5a26-124">グローバル追跡をオフにする方法については、トピックを参照してください。[グローバル追跡を無効にする方法](http://go.microsoft.com/fwlink/?LinkID=154193)(http://go.microsoft.com/fwlink/?LinkID=154193)。</span><span class="sxs-lookup"><span data-stu-id="b5a26-124">For information about how to turn off global tracking, see the topic [How to Turn Off Global Tracking](http://go.microsoft.com/fwlink/?LinkID=154193) (http://go.microsoft.com/fwlink/?LinkID=154193).</span></span>  
  
## <a name="creating-a-dedicated-tracking-host"></a><span data-ttu-id="b5a26-125">専用の追跡ホストを作成します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-125">Creating a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="b5a26-126">ときにオプション**ホストの追跡を許可する**は BizTalk Server 管理コンソールで、そのホストのインスタンスのホストに、Tracking Data Decode Service (TDDS) から追跡したデータの移動には実行に対して有効で、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックスBizTalk 追跡データベースへのデータベースです。</span><span class="sxs-lookup"><span data-stu-id="b5a26-126">When the option to **Allow Host Tracking** is enabled for a host in the BizTalk Server Administration console, instances of that host will run the Tracking Data Decode Service (TDDS) to move tracked data from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database to the BizTalk Tracking database.</span></span> <span data-ttu-id="b5a26-127">TDDS は、リソースが多用される可能性があります、ためには、対象の「専用」の追跡ホストを作成することを検討してください、**ホストの追跡を許可する**オプションが有効になっており、これが実行されないその他の[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]プロセス (たとえば、アダプターまたはオーケストレーション)。</span><span class="sxs-lookup"><span data-stu-id="b5a26-127">Since TDDS may be resource intensive, consider creating a "dedicated" tracking host for which the **Allow Host Tracking** option is enabled and which does not run any other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processes (such as adapters or orchestrations).</span></span> <span data-ttu-id="b5a26-128">BizTalk グループに 1 つ以上の BizTalk server が含まれている場合も TDDS の高可用性を実現する、グループ内の各サーバーでこのホストのインスタンスを作成するベスト プラクティスと見なされます。</span><span class="sxs-lookup"><span data-stu-id="b5a26-128">If your BizTalk group contains more than one BizTalk server, it is also considered a best practice to create an instance of this host on each server in the group to provide high availability for TDDS.</span></span>  
  
## <a name="testing-to-measure-maximum-sustainable-tracking-throughput"></a><span data-ttu-id="b5a26-129">維持可能な最大の追跡スループットを測定するテスト</span><span class="sxs-lookup"><span data-stu-id="b5a26-129">Testing to Measure Maximum Sustainable Tracking Throughput</span></span>  
 <span data-ttu-id="b5a26-130">広範なメッセージの追跡は、多くのリソースを集中的なアクティビティと適切に管理しない場合のパフォーマンスが極端に悪影響を与えることができます、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。</span><span class="sxs-lookup"><span data-stu-id="b5a26-130">Extensive message tracking is a very resource intensive activity and if not properly managed can have an extremely adverse effect on the performance of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="b5a26-131">そのための維持可能な最大の追跡スループットを測定する必要があります、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境システムが維持可能な特定のメッセージ フロー レートで無期限に実行されます。</span><span class="sxs-lookup"><span data-stu-id="b5a26-131">Therefore, you should measure maximum sustainable tracking throughput for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment to ensure that the system is sustainable and will run indefinitely at a given message flow rate.</span></span> <span data-ttu-id="b5a26-132">維持可能な最大の追跡スループットの測定の詳細については、次を参照してください。[維持可能な最大の追跡スループットの測定](http://go.microsoft.com/fwlink/?LinkID=153815)(http://go.microsoft.com/fwlink/?LinkID=153815)。</span><span class="sxs-lookup"><span data-stu-id="b5a26-132">For more information about measuring maximum sustainable tracking throughput, see [Measuring Maximum Sustainable Tracking Throughput](http://go.microsoft.com/fwlink/?LinkID=153815) (http://go.microsoft.com/fwlink/?LinkID=153815).</span></span>  
  
##  <a name="BKMK_TrackingBP"></a><span data-ttu-id="b5a26-133">追跡のベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="b5a26-133">Best Practices for Tracking</span></span>  
  
-   <span data-ttu-id="b5a26-134">**計画時に追跡するために必要な情報を決定する**: 追跡、プロジェクトを配置した後は、追跡オプションを設定および履歴データの量を制限できるようにするために必要な情報がステージングの計画時に決定する必要があります必要な情報のみを付与します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-134">**Determine the information you need to track during planning** : You should decide during the planning stages which information you need to track, so that after you deploy the project you can set the tracking options and limit the amount of tracked data to give you only the information you need.</span></span>  
  
-   <span data-ttu-id="b5a26-135">**すべてのメッセージを追跡しない**: ことをお勧めできませんのすべてのメッセージを追跡するたびに、メッセージがブラウザーであるため[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]別のコピーを作成します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-135">**Do not track all messages**: We recommend that you not track all messages, because each time a message is touched, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] makes another copy.</span></span> <span data-ttu-id="b5a26-136">特定のポートのみを追跡すると、代わりにスコープを絞ることができます。</span><span class="sxs-lookup"><span data-stu-id="b5a26-136">You can instead narrow the scope by tracking only a specific port.</span></span> <span data-ttu-id="b5a26-137">これにより、システムのパフォーマンスを最大限にし、データベースをきちんと整頓します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-137">This helps to maximize the performance of your system and to keep the databases uncluttered.</span></span>  
  
-   <span data-ttu-id="b5a26-138">**送信ポートの追跡を設定し、受信パイプラインでの代わりにポート**: パイプラインに追跡オプションを設定する場合、パイプラインを使用するすべてのポートに対してグローバルに追跡オプションは設定もできます。</span><span class="sxs-lookup"><span data-stu-id="b5a26-138">**Set tracking on send ports and receive ports instead of on a pipeline**: If you set tracking options on pipelines, you will also set the tracking options globally for every port that uses the pipeline.</span></span> <span data-ttu-id="b5a26-139">これは、順番が原因でより多くのデータが意図したものと追跡されているシステムのパフォーマンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-139">This in turn may result in far more data being tracked than you intend, which will slow system performance.</span></span> <span data-ttu-id="b5a26-140">代わりに、ポートの送信に追跡オプションを設定し、ポートを受信できます。</span><span class="sxs-lookup"><span data-stu-id="b5a26-140">Instead, you can set tracking options on send ports and receive ports.</span></span>  
  
-   <span data-ttu-id="b5a26-141">**BizTalk 追跡データベースのサイズを変更するとき、さまざまな要因を考慮**:</span><span class="sxs-lookup"><span data-stu-id="b5a26-141">**Take into account various factors when you size the BizTalk Tracking database**:</span></span>  
  
    -   <span data-ttu-id="b5a26-142">BizTalk 追跡データベースのサイズ変更、コンティンジェンシー乗数を計算の結果に追加することで、インデックス サイズなど、SQL Server の要因を考慮してください。</span><span class="sxs-lookup"><span data-stu-id="b5a26-142">When sizing the BizTalk Tracking database, account for SQL Server factors, such as index size, by adding a contingency multiplier to your calculations.</span></span>  
  
    -   <span data-ttu-id="b5a26-143">BizTalk 追跡データベース内のメッセージのサイズを決定するとき、メッセージ コンテキストの平均サイズを追加メッセージのサイズこれは重要な場合メッセージ サイズと比較します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-143">When determining the size of messages in the BizTalk Tracking database, add the average size of the message context to the message size if it is significant compared to the message size.</span></span>  
  
    -   <span data-ttu-id="b5a26-144">BizTalk 追跡データベース内のメッセージのサイズを制限するためには、昇格したプロパティの数を制限します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-144">To limit the size of messages in the BizTalk Tracking database, limit the number of properties that you promote.</span></span> <span data-ttu-id="b5a26-145">ルーティングを行うのために必要がある場合、プロパティだけに上位変換を使用する必要があります、それ以外の場合 識別フィールドを使用します。</span><span class="sxs-lookup"><span data-stu-id="b5a26-145">You should only use promoted properties if you need them for routing purposes, otherwise use distinguished fields.</span></span>  
  
    -   <span data-ttu-id="b5a26-146">場合、オーケストレーション**図形の開始と終了**オプションが有効になっている、各オーケストレーション インスタンス内の各図形の開始および停止イベントは、BizTalk 追跡データベースに保存されていることを考慮に入れています。</span><span class="sxs-lookup"><span data-stu-id="b5a26-146">If the orchestration **Shape start and end** option is enabled, take into account that a start and stop event for each shape in each orchestration instance is saved in the BizTalk Tracking database.</span></span>