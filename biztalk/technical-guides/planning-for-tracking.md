---
title: 追跡の計画 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8ffc8573-1b4a-47c7-96ab-0471f43facf5
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c0c45c61efee90b68efc927d88dbcf6429fe13e2
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36973827"
---
# <a name="planning-for-tracking"></a><span data-ttu-id="dd44b-102">追跡の計画</span><span class="sxs-lookup"><span data-stu-id="dd44b-102">Planning for Tracking</span></span>
<span data-ttu-id="dd44b-103">メッセージの追跡は、格納するためのメッセージ本文、メッセージのプロパティやメタデータなどのメッセージ インスタンスの部分はデータベースでは、通常、アーカイブのためのプロセスです。</span><span class="sxs-lookup"><span data-stu-id="dd44b-103">Message tracking is the process by which parts of a message instance, such as the message body, message properties, and metadata are stored in a database, typically for archival purposes.</span></span> <span data-ttu-id="dd44b-104">追跡されるメッセージ インスタンスの部分は、グループ ハブ ページからクエリを実行して、その後表示できます、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソール。</span><span class="sxs-lookup"><span data-stu-id="dd44b-104">Message instance parts that are tracked can subsequently be viewed by running queries from the Group Hub page in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="dd44b-105">アーカイブ済みのデータにアクセスするだけでなく、開発の問題の修正やステージング環境を識別するのに便利なツールは、ライブ データを表示することもできます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-105">In addition to accessing archived data, you can also view live data, which can be a helpful tool for identifying and fixing problems in a development or staging environment.</span></span>  
  
 <span data-ttu-id="dd44b-106">メッセージの追跡のプロセスは非常にリソースを消費できる、ので、プランを作成する前にこのトピックを確認してください。</span><span class="sxs-lookup"><span data-stu-id="dd44b-106">Since the process of message tracking can be very resource intensive, you should review this topic before creating your plan.</span></span>  
  
 <span data-ttu-id="dd44b-107">追跡の詳細については、次を参照してください。[状態と動作状況の追跡](http://go.microsoft.com/fwlink/?LinkId=154187)(http://go.microsoft.com/fwlink/?LinkId=154187)します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-107">For more information about tracking, see [Health and Activity Tracking](http://go.microsoft.com/fwlink/?LinkId=154187) (http://go.microsoft.com/fwlink/?LinkId=154187).</span></span>  
  
## <a name="configuring-and-enabling-the-dta-purge-and-archive-sql-agent-job"></a><span data-ttu-id="dd44b-108">構成して有効 DTA Purge and Archive SQL エージェント ジョブ</span><span class="sxs-lookup"><span data-stu-id="dd44b-108">Configuring and Enabling the DTA Purge and Archive SQL Agent Job</span></span>  
 <span data-ttu-id="dd44b-109">このジョブをアーカイブしてがあまり大きくならないように、BizTalk 追跡データベースから古いデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-109">This job archives and purges old data from the BizTalk Tracking database, thus keeping it from becoming too large.</span></span> <span data-ttu-id="dd44b-110">これは、正常性のために不可欠な[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]システム。</span><span class="sxs-lookup"><span data-stu-id="dd44b-110">This is essential for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] system.</span></span> <span data-ttu-id="dd44b-111">追跡データベースのクエリを実行すると、追跡ホストの他のプロセスのパフォーマンスに影響を与える大きな追跡データベースが開始されます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-111">A large tracking database will begin to affect the performance of the tracking host and any other processes that query the tracking database.</span></span>  
  
-   <span data-ttu-id="dd44b-112">**DTA Purge and Archive SQL エージェント ジョブが適切に構成された、有効化、および正常に完了することを確認します。**</span><span class="sxs-lookup"><span data-stu-id="dd44b-112">**Ensure that the DTA Purge and Archive SQL Agent job is properly configured, enabled, and successfully completing.**</span></span> <span data-ttu-id="dd44b-113">アーカイブ ファイルの書き込み先のディレクトリを含めるように構成する必要がありますまずために、このジョブは既定で有効にできません。</span><span class="sxs-lookup"><span data-stu-id="dd44b-113">This job is not enabled by default because you must first configure it to include a directory where the archive files can be written.</span></span>  
  
-   <span data-ttu-id="dd44b-114">**ジョブが追跡データを受信した追跡データが生成された高速消去できることを確認します。**</span><span class="sxs-lookup"><span data-stu-id="dd44b-114">**Ensure that the job is able to purge the tracking data as fast as the incoming tracking data is generated.**</span></span> <span data-ttu-id="dd44b-115">ジョブの背後にあるをピーク負荷時に取得するのにもかまいませんが、遅延を解消することを必ず。</span><span class="sxs-lookup"><span data-stu-id="dd44b-115">It is acceptable for the job to get behind during peak load times, but it should always be able to catch up.</span></span> <span data-ttu-id="dd44b-116">Purge ジョブでは、背後にある取得し、遅延を解消することはありませんが場合に、増加し、BizTalk 追跡データベースは引き続きし、パフォーマンスが悪影響を受ける最終的には。</span><span class="sxs-lookup"><span data-stu-id="dd44b-116">If the purge job gets behind and is never able to catch up, the BizTalk Tracking database will continue to grow, and performance will eventually be adversely affected.</span></span>  
  
-   <span data-ttu-id="dd44b-117">**論理削除を確認し、ことを確認して物理削除パラメーターがありませんが、十分な時間の長いデータを保持します。**</span><span class="sxs-lookup"><span data-stu-id="dd44b-117">**Review the soft purge and hard purge parameters to ensure you are keeping data long enough but not too long.**</span></span> <span data-ttu-id="dd44b-118">これらのパラメーターの詳細については、次を参照してください。[アーカイブおよび BizTalk 追跡データベースの削除](http://go.microsoft.com/fwlink/?LinkID=153816)(http://go.microsoft.com/fwlink/?LinkID=153816)します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-118">For more information about these parameters see [Archiving and Purging the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816).</span></span>  
  
-   <span data-ttu-id="dd44b-119">**古いデータを消去しないだけの場合必要があります最初に、アーカイブし、変更、SQL エージェント ジョブ"dtasp_PurgeTrackingDatabase"ストアド プロシージャを呼び出します。**</span><span class="sxs-lookup"><span data-stu-id="dd44b-119">**If you only need to purge the old data and do not need to archive it first, then change the SQL Agent job to call the stored procedure “dtasp_PurgeTrackingDatabase”.**</span></span> <span data-ttu-id="dd44b-120">これにより、アーカイブの手順をスキップし、のみ、消去を行います。</span><span class="sxs-lookup"><span data-stu-id="dd44b-120">This skips the archive step, and just does the purge.</span></span> <span data-ttu-id="dd44b-121">ストアド プロシージャおよびそれを使用する SQL エージェント ジョブの変更の詳細については、これはの参照[BizTalk 追跡データベースからのデータの削除方法](http://go.microsoft.com/fwlink/?LinkID=153817)(http://go.microsoft.com/fwlink/?LinkID=153817)します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-121">For more information about this stored procedure and changing the SQL Agent job to use it, see [How to Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817).</span></span>  
  
-   <span data-ttu-id="dd44b-122">**BizTalk 追跡データベースにアーカイブ ファイルを保持する必要がある場合は、正常に復元し、それらを使用する場所にプロセスがあることを確認します。**</span><span class="sxs-lookup"><span data-stu-id="dd44b-122">**If you need to keep the BizTalk Tracking database archive files, ensure that you have a process in place to successfully restore and use them.**</span></span>  
  
-   <span data-ttu-id="dd44b-123">**一時的に、BizTalk 追跡データベースを削除することで対処はパフォーマンスの問題が発生した、不要になった追跡情報を収集する BizTalk を構成する場合は、グローバル追跡を無効にすることを検討する可能性があります。**</span><span class="sxs-lookup"><span data-stu-id="dd44b-123">**If you are having performance issues that are momentarily addressed by purging the BizTalk tracking database, and you want to configure BizTalk to no longer collect tracking information, you may want to consider turning off global tracking.**</span></span> <span data-ttu-id="dd44b-124">グローバル追跡を無効にする方法については、トピックを参照してください。[グローバル追跡をオフにする方法](http://go.microsoft.com/fwlink/?LinkID=154193)(http://go.microsoft.com/fwlink/?LinkID=154193)します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-124">For information about how to turn off global tracking, see the topic [How to Turn Off Global Tracking](http://go.microsoft.com/fwlink/?LinkID=154193) (http://go.microsoft.com/fwlink/?LinkID=154193).</span></span>  
  
## <a name="creating-a-dedicated-tracking-host"></a><span data-ttu-id="dd44b-125">専用の追跡ホストを作成します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-125">Creating a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="dd44b-126">ときにオプション**ホストの追跡を許可する**BizTalk Server 管理コンソール、そのホストのインスタンスでホストは、Tracking Data Decode Service (TDDS) からの履歴データを移動の実行が有効になって、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックスBizTalk 追跡データベースへのデータベースです。</span><span class="sxs-lookup"><span data-stu-id="dd44b-126">When the option to **Allow Host Tracking** is enabled for a host in the BizTalk Server Administration console, instances of that host will run the Tracking Data Decode Service (TDDS) to move tracked data from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database to the BizTalk Tracking database.</span></span> <span data-ttu-id="dd44b-127">TDDS は、リソースの処理を要する可能性があります、ためには、対象の「専用」の追跡ホストを作成することを検討してください、**ホストの追跡を許可する**オプションが有効では実行されません、他の[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)](アダプターまたはオーケストレーション) などのプロセス。</span><span class="sxs-lookup"><span data-stu-id="dd44b-127">Since TDDS may be resource intensive, consider creating a "dedicated" tracking host for which the **Allow Host Tracking** option is enabled and which does not run any other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processes (such as adapters or orchestrations).</span></span> <span data-ttu-id="dd44b-128">BizTalk グループに 1 つ以上の BizTalk server が含まれている場合も TDDS の高可用性を実現する、グループ内の各サーバーでこのホストのインスタンスを作成するベスト プラクティスと見なされます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-128">If your BizTalk group contains more than one BizTalk server, it is also considered a best practice to create an instance of this host on each server in the group to provide high availability for TDDS.</span></span>  
  
## <a name="testing-to-measure-maximum-sustainable-tracking-throughput"></a><span data-ttu-id="dd44b-129">維持可能な最大の追跡スループットを測定するテスト</span><span class="sxs-lookup"><span data-stu-id="dd44b-129">Testing to Measure Maximum Sustainable Tracking Throughput</span></span>  
 <span data-ttu-id="dd44b-130">追跡は大量のメッセージは多くのリソースを集中的なアクティビティと適切に管理しない場合のパフォーマンスに非常に悪影響を与えることができます、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。</span><span class="sxs-lookup"><span data-stu-id="dd44b-130">Extensive message tracking is a very resource intensive activity and if not properly managed can have an extremely adverse effect on the performance of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="dd44b-131">そのための維持可能な最大の追跡スループットを測定する必要があります、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境システムが維持可能な特定のメッセージ フロー レートで無期限に実行されます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-131">Therefore, you should measure maximum sustainable tracking throughput for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment to ensure that the system is sustainable and will run indefinitely at a given message flow rate.</span></span> <span data-ttu-id="dd44b-132">維持可能な最大の追跡スループットの測定の詳細については、次を参照してください。[維持可能な最大の追跡スループットの測定](http://go.microsoft.com/fwlink/?LinkID=153815)(<http://go.microsoft.com/fwlink/?LinkID=153815>)。</span><span class="sxs-lookup"><span data-stu-id="dd44b-132">For more information about measuring maximum sustainable tracking throughput, see [Measuring Maximum Sustainable Tracking Throughput](http://go.microsoft.com/fwlink/?LinkID=153815) (<http://go.microsoft.com/fwlink/?LinkID=153815>).</span></span>  
  
##  <a name="BKMK_TrackingBP"></a> <span data-ttu-id="dd44b-133">追跡のベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="dd44b-133">Best Practices for Tracking</span></span>  
  
- <span data-ttu-id="dd44b-134">**計画時に追跡する必要がある情報を決定する**: 追跡、プロジェクトを配置した後は、追跡オプションを設定および追跡データの量を制限できるようにする必要がある情報のステージングを計画する際に決定する必要があります必要な情報のみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-134">**Determine the information you need to track during planning** : You should decide during the planning stages which information you need to track, so that after you deploy the project you can set the tracking options and limit the amount of tracked data to give you only the information you need.</span></span>  
  
- <span data-ttu-id="dd44b-135">**すべてのメッセージを追跡しない**: すべてのメッセージを追跡しないため、お勧めするたびにメッセージが操作された、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]別のコピーを作成します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-135">**Do not track all messages**: We recommend that you not track all messages, because each time a message is touched, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] makes another copy.</span></span> <span data-ttu-id="dd44b-136">代わりに、特定のポートだけを追跡することによって、スコープを限定できます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-136">You can instead narrow the scope by tracking only a specific port.</span></span> <span data-ttu-id="dd44b-137">これにより、システムのパフォーマンスを最大化して、データベースをきちんと整頓します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-137">This helps to maximize the performance of your system and to keep the databases uncluttered.</span></span>  
  
- <span data-ttu-id="dd44b-138">**送信ポートの追跡を設定し、受信パイプラインでの代わりにポート**: パイプラインを使用するすべてのポートに対してグローバルに追跡オプションを設定するパイプラインに追跡オプションを設定した場合もされます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-138">**Set tracking on send ports and receive ports instead of on a pipeline**: If you set tracking options on pipelines, you will also set the tracking options globally for every port that uses the pipeline.</span></span> <span data-ttu-id="dd44b-139">これは、さらに可能性より多くのデータが意図したものと、追跡されているシステムのパフォーマンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-139">This in turn may result in far more data being tracked than you intend, which will slow system performance.</span></span> <span data-ttu-id="dd44b-140">代わりに、ポートの送信に追跡オプションを設定して、ポートを受信できます。</span><span class="sxs-lookup"><span data-stu-id="dd44b-140">Instead, you can set tracking options on send ports and receive ports.</span></span>  
  
- <span data-ttu-id="dd44b-141">**BizTalk 追跡データベースのサイズを変更するとき、さまざまな要因をアカウントにかかる**:</span><span class="sxs-lookup"><span data-stu-id="dd44b-141">**Take into account various factors when you size the BizTalk Tracking database**:</span></span>  
  
  -   <span data-ttu-id="dd44b-142">BizTalk 追跡データベースのサイズ変更、コンティンジェンシーの乗数を計算の結果に追加することで、インデックス サイズなど、SQL Server の要因を考慮しています。</span><span class="sxs-lookup"><span data-stu-id="dd44b-142">When sizing the BizTalk Tracking database, account for SQL Server factors, such as index size, by adding a contingency multiplier to your calculations.</span></span>  
  
  -   <span data-ttu-id="dd44b-143">BizTalk 追跡データベース内のメッセージのサイズを決定するときにメッセージ コンテキストの平均サイズに追加メッセージのサイズが大幅にある場合メッセージ サイズと比較します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-143">When determining the size of messages in the BizTalk Tracking database, add the average size of the message context to the message size if it is significant compared to the message size.</span></span>  
  
  -   <span data-ttu-id="dd44b-144">BizTalk 追跡データベース内のメッセージのサイズを制限するには、昇格したプロパティの数を制限します。</span><span class="sxs-lookup"><span data-stu-id="dd44b-144">To limit the size of messages in the BizTalk Tracking database, limit the number of properties that you promote.</span></span> <span data-ttu-id="dd44b-145">ルーティングの目的で必要な場合のみ使用して昇格させたプロパティ必要があります、識別フィールドを使用して、それ以外の場合。</span><span class="sxs-lookup"><span data-stu-id="dd44b-145">You should only use promoted properties if you need them for routing purposes, otherwise use distinguished fields.</span></span>  
  
  -   <span data-ttu-id="dd44b-146">場合、オーケストレーション**図形の開始と終了**オプションが有効になっている、各オーケストレーション インスタンス内の各図形の開始および停止イベントは、BizTalk 追跡データベースに保存されている考慮に入れています。</span><span class="sxs-lookup"><span data-stu-id="dd44b-146">If the orchestration **Shape start and end** option is enabled, take into account that a start and stop event for each shape in each orchestration instance is saved in the BizTalk Tracking database.</span></span>