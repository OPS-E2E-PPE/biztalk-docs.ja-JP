---
title: IIS のパフォーマンスの最適化 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 6722a2ee-3704-4aaa-9b0d-cef97bcb9a04
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d1939a3cacdccf613a7665a766c952c6bc9c5e91
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65291392"
---
# <a name="optimizing-iis-performance"></a>IIS のパフォーマンスの最適化
## <a name="apply-iis-configuration-options-to-improve-iis-performance"></a>IIS のパフォーマンスを向上させるために IIS の構成オプションを適用します。  
 インターネット インフォメーション サービス (IIS) では、IIS のパフォーマンスに影響する多数の構成パラメーターを公開します。 このトピックでは、これらのパラメーターのいくつかについて説明し、IIS のパフォーマンスを向上させるためにパラメーター値を設定するための一般的なガイダンスを提供します。  
  
### <a name="log-only-essential-information-or-completely-disable-iis-logging"></a>重要な情報のみを記録または IIS のログ記録を完全に無効にします。  
 IIS ログを最小化または運用環境でも無効にする必要があります。 ログ記録を無効にするには、これらの手順に従います。  
  
1.  クリックして**開始**、 をポイント**すべてのプログラム**、 をクリックして**管理ツール**、順にクリックします**インターネット インフォメーション サービス (IIS) マネージャー**.  
  
2.  **接続** ウィンドウをクリックして展開**サイト**をクリックしてログ記録を無効にするをクリックして選択する Web サイトを選択**機能ビュー**、し、ダブルクリックして、**ログ**機能します。  
  
3.  クリックして**を無効にする**で、**アクション**この Web サイトのログ記録を無効にするウィンドウ。  
  
### <a name="disable-iis-asp-debugging-in-production-environments"></a>運用環境で IIS ASP デバッグを無効にします。  
 運用環境で IIS ASP デバッグを無効にする必要があります。 ASP デバッグを IIS を無効にするには、これらの手順に従います。**接続** ウィンドウをクリックして展開**サイト**、ASP デバッグを無効にするには、選択を web サイトを選択する をクリックします**機能ビュー**、し、。ダブルクリックして、 **ASP**機能します。 クリックして展開**コンパイル**をクリックして展開**デバッグ プロパティ**、ことを確認します両方**クライアント側のデバッグを有効にする**と**サーバー側を有効にします。デバッグ**に設定されている**False**します。  
  
1. クリックして**開始**、 をポイント**すべてのプログラム**、 をクリックして**管理ツール**、順にクリックします**インターネット インフォメーション サービス (IIS) マネージャー**.  
  
2. **接続** ウィンドウをクリックして展開**サイト**、ASP デバッグを無効にするには、選択を web サイトを選択する をクリックします**機能ビュー**、し、。ダブルクリックして、 **ASP**機能します。  
  
3. クリックして展開**コンパイル**をクリックして展開**デバッグ プロパティ**、ことを確認します両方**クライアント側のデバッグを有効にする**と**サーバー側を有効にします。デバッグ**に設定されている**False**します。  
  
4. 必要に応じて、**適用**で、**アクション**ウィンドウ。  
  
   指定することで、ASP.NET アプリケーションおよび Web サービスのデバッグを無効にする、\<コンパイル デバッグ ="false"\> web アプリケーションの web.config ファイルのセクション。  
  
### <a name="tune-the-value-of-the-asp-threads-per-processor-limit-property"></a>プロセッサ数あたりのスレッドの ASP 上限プロパティの値を調整します。  
 ASP**スレッドあたりプロセッサ数の上限**プロパティを IIS に作成するプロセッサあたりのワーカー スレッドの最大数を指定します。 プロセッサ使用率が 50% 以上を満たすまで、またはの上に、プロセッサごとのスレッド制限の値を増やします。 この設定に大きな影響を Web アプリケーションのスケーラビリティおよび、サーバーのパフォーマンス一般にします。 このプロパティは、同時に実行可能な ASP 要求の最大数を定義するため、この設定は、ASP アプリケーションが外部コンポーネントへの拡張の呼び出しを行う場合を除いて既定値に残る必要があります。 この場合、スレッドあたりプロセッサ数の上限の値を増やすことができます。 これによりより多くの同時要求を処理する複数のスレッドを作成するサーバー。 スレッドあたりプロセッサ数の上限の既定値は、25 です。 このプロパティの最大の推奨値は、100 です。  
  
 プロセッサごとのスレッド制限の値を大きくには、以下の手順: で、**接続**ウィンドウで、web サーバーを選択して、クリックして選択**機能ビュー**、し、ダブルクリック、 **ASP**機能します。  
  
1. クリックして**開始**、 をポイント**すべてのプログラム**、 をクリックして**管理ツール**、順にクリックします**インターネット インフォメーション サービス (IIS) マネージャー**.  
  
2. **接続**ウィンドウで、web サーバーを選択して、クリックして選択**機能ビュー**、し、ダブルクリック、 **ASP**機能します。  
  
3. クリックして展開**制限プロパティ**[**動作**、] をクリックして**スレッドあたりプロセッサ数の上限**、目的の値を入力します**スレッドあたりプロセッサ数の上限。** クリック**適用**で、**アクション**ウィンドウ。  
  
   プロパティを変更する方法について、\<制限\>要素 IIS 7.5 または 7.0 の\<asp\>要素を参照してください[ASP 制限\<制限\>](http://go.microsoft.com/fwlink/?LinkId=157483) (http://go.microsoft.com/fwlink/?LinkId=157483).  
  
> [!NOTE]  
>  このプロパティは、サーバー レベルでのみ適用できる、このプロパティの変更は、サーバー上で実行されるすべての Web サイトに影響します。  
  
### <a name="tune-the-value-of-the-asp-queue-length-property"></a>ASP のキューの長さのプロパティの値を調整します。  
 このプロパティのチューニングの目的では、ASP 要求のキューがいっぱいになったとき、サーバーで HTTP 503 (サーバーがビジー状態です) エラーをクライアントに送信する頻度を最小限に抑えながら、良好な応答時間を確認します。 ASP のキューの長さのプロパティの値が小さすぎる場合、サーバーはより高い頻度で HTTP 503 エラーを送信します。 ASP のキューの長さのプロパティの値が高すぎる場合、サーバーが応答していないことと実際の要求がキューで待機しているユーザーが感じる可能性があります。 高トラフィックの期間中に、キューを視聴するには、web 要求の山と谷のパターンを識別する必要があります。 ピーク時の値をメモし、ピーク時の値のすぐ上の ASP キューの長さのプロパティの値を設定します。 キューを使用して短期的な急増を処理、応答時間、ことを確認し、維持、予期しないスパイクが発生したときにオーバー ロードを回避するためにシステムを調整します。 ASP キューの長さのプロパティを調整するためのデータがない場合、適切な開始点は、スレッドの合計にキューの 1 対 1 の比率を設定するになります。 たとえば、4 つのプロセッサを使用して ASP スレッドごとのプロセッサ制限プロパティを 25 に設定されている場合 (4 * 25 = 100 スレッド)、ASP キューの長さのプロパティを 100 に設定し、そこから調整します。  
  
 キューの長さの値を大きくプロパティは次の手順に従います。  
  
1. クリックして**開始**、 をポイント**すべてのプログラム**、 をクリックして**管理ツール**、順にクリックします**インターネット インフォメーション サービス (IIS) マネージャー**.  
  
2. **接続**ウィンドウで、Web サーバーを選択して、クリックして選択**機能ビュー**、し、ダブルクリック、 **ASP**機能します。  
  
3. クリックして展開**制限プロパティ**[**動作**、] をクリックして**キューの長さ**、目的の値を入力します**キューの長さ**し。クリックして**適用**で、**アクション**ウィンドウ。  
  
   プロパティを変更する方法について、\<制限\>要素 IIS 7.5 または 7.0 の\<asp\>要素を参照してください[ASP 制限\<制限\>](http://go.microsoft.com/fwlink/?LinkId=157483) (http://go.microsoft.com/fwlink/?LinkId=157483).  
  
> [!NOTE]  
>  このプロパティは、サーバー レベルでのみ適用できる、このプロパティの変更は、サーバー上で実行されるすべての Web サイトに影響します。  
  
### <a name="tune-the-maxpoolthreads-registry-entry"></a>MaxPoolThreads のレジストリ エントリを調整します。  
 この設定では、プロセッサごとに作成するプールのスレッドの数を指定します。 プールのスレッドでは、ネットワーク要求と受信要求の処理をご覧ください。 MaxPoolThreads 数では ISAPI アプリケーションで使用されるスレッドは含まれません。 一般に、プロセッサごとに 20 個を超えるスレッドを作成しないでください。 MaxPoolThreads では、既定値は 4 の HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\InetInfo\Parameters\ にある REG_DWORD レジストリ エントリです。  
  
### <a name="disable-wcf-services-tracing"></a>WCF サービスのトレースを無効にします。  
 WCF サービスの運用環境でのトレースを無効にするには、構成エディター ツール (SvcConfigEditor.exe) を使用します。 構成エディター ツールの詳細については、次を参照してください。[構成エディター ツール (SvcConfigEditor.exe)](http://go.microsoft.com/fwlink/?LinkID=127070) (http://go.microsoft.com/fwlink/?LinkID=127070)します。  
  
### <a name="configure-aspnet-20-maxconcurrentrequests-for-iis-7570-integrated-mode"></a>IIS 7.5 または 7.0 統合モード用の ASP.NET 2.0 MaxConcurrentRequests の構成します。  
 ASP.NET 2.0 は、IIS 7.5 または 7.0 統合モードでホストされている、ときにスレッド処理が異なりますよりで IIS 7.5 または 7.0 でクラシック モード。 ASP.NET 2.0 が統合モードで IIS 7.5 でホストされている場合、ASP.NET 2.0 は、同時に実行される要求を同時に実行するスレッドの数ではなく要求の数を制限します。 同期のシナリオでこれ直接制限されましていないスレッドの数ため、要求の数には、スレッドの数と同じになります。 非同期のシナリオでは、要求とスレッドの数は可能性があります非常に異なるスレッドよりもはるかに要求する可能性があるためです。 ASP.NET 2.0 を IIS 7.5 統合モードでを実行すると、minFreeThreads と machine.config ファイル内の"httpRuntime"要素の minLocalRequestFreeThreads は無視されます。 IIS 7.5 統合モードでは、HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\2.0.50727.0 内 MaxConcurrentRequestsPerCPU をという名前の DWORD は、CPU あたりの同時要求の数を決定します。 既定では、レジストリ キーが存在しないと、CPU あたりの要求の数は 12 に制限されます。 .NET framework 3.5 SP1 には、aspnet.config ファイルを使用して、構成の IIS アプリケーション プールをサポートする v2.0 バイナリに更新プログラムが含まれています。 この構成は、統合モードのみに適用されます (クラシックまたは ISAPI モードでは、これらの設定を無視します)。既定値を持つ新しい aspnet.config 構成セクションは、次に示します。  
  
```  
<system.web>  
   <applicationPool maxConcurrentRequestsPerCPU="12" maxConcurrentThreadsPerCPU="0" requestQueueLimit="5000"/>  
</system.web>  
```  
  
 IIS 7.5 統合モードで、maxWorkerThreads と maxIoThreads パラメーター、machine.config ファイルの"processModel"セクションでは、本質的に、要求の実行の数を制御するのには使用されませんが、CLR スレッド プールのサイズを制御するのには使用されます。ASP.NET によって使用されます。 ときに、machine.config の"processModel"セクションが"autoConfig = true"(既定の設定では、) アプリケーション プールを論理 CPU あたりの最大 100 個のワーカー スレッド (MaxWorkerThreads) この付与されます。 したがって 2 つのデュアル コア Cpu で共通の汎用的なサーバーは 400 MaxWorkerThreads になります。 要件の高いアプリケーションを除くすべてのための十分な場合があります。  
  
 IIS 7.5 で ASP.NET のスレッドの使用量を構成する方法の詳細については、次を参照してください。 [Thomas Marquardt のブログを IIS 7.0 で ASP.NET スレッドの使用に関する](http://go.microsoft.com/fwlink/?LinkId=157518)(http://go.microsoft.com/fwlink/?LinkId=157518)します。  
  
### <a name="configure-aspnet-4-maxconcurrentrequests-for-iis-7570-integrated-mode"></a>IIS 7.5 または 7.0 統合モード用の ASP.NET 4 MaxConcurrentRequests の構成します。  
 .NET Framework 4 で maxConcurrentRequestsPerCPU の既定の設定は非常に大きい数である 5000、したがってにより、多数の非同期の要求を同時に実行します。 詳細については、次を参照してください。 [ \<applicationPool\>要素 (Web 設定)](http://go.microsoft.com/fwlink/?LinkID=205339) (http://go.microsoft.com/fwlink/?LinkID=205339)します。  
  
 IIS 7.5 または 7.0 の Integrated モードの場合は、HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\4.0.30319.0 内 MaxConcurrentRequestsPerCPU をという名前の DWORD は、CPU あたりの同時要求の数を決定します。 既定では、レジストリ キーが存在しないと、CPU あたりの要求の数が 5000 に制限されています。  
  
### <a name="enable-iis-http-compression"></a>IIS の HTTP 圧縮を有効にします。  
 使用できる帯域幅をより効率的に使用するには、IIS の HTTP 圧縮を有効にします。 HTTP 圧縮は、ローカル ストレージまたは UNC リソースからコンテンツを提供するかどうかに関係なく圧縮が有効なブラウザーおよび IIS の間で高速化の転送時間を提供します。  
  
-   **Web サーバー レベルで圧縮を構成します。**  
  
    1.  クリックして**開始**、 をポイント**すべてのプログラム**、 をクリックして**管理ツール**、順にクリックします**インターネット インフォメーション サービス (IIS) マネージャー**.  
  
    2.  **接続**ウィンドウで、Web サーバーを選択して、クリックして選択**機能ビュー**、し、ダブルクリック、**圧縮**機能します。  
  
    3.  必要な圧縮オプションを設定し、クリックして**適用**で、**アクション**ウィンドウ。  
  
-   **Web サイト レベルで圧縮を構成します。**  
  
    1.  クリックして**開始**、 をポイント**すべてのプログラム**、 をクリックして**管理ツール**、順にクリックします**インターネット インフォメーション サービス (IIS) マネージャー**.  
  
    2.  **接続**] ウィンドウをクリックして展開**サイト**をクリックして圧縮を構成するには、[選択を Web サイトを選択**機能ビュー**とダブルクリックし、**圧縮**機能します。  
  
    3.  必要な圧縮オプションを設定し、クリックして**適用**で、**アクション**ウィンドウ。  
  
## <a name="see-also"></a>参照  
 [パフォーマンスの最適化](../technical-guides/optimizing-performance.md)