---
title: データベースの高可用性 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 63813d87-1ce4-4645-bb2a-d55e413fcace
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 24e17afbf9e33f3e12553d7ded5068370d8ca085
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/01/2017
ms.locfileid: "26009363"
---
# <a name="high-availability-for-databases"></a><span data-ttu-id="24398-102">データベースの高可用性</span><span class="sxs-lookup"><span data-stu-id="24398-102">High Availability for Databases</span></span>
<span data-ttu-id="24398-103">BizTalk Server に大きく依存して SQL Server のデータ ストアとデータの永続化します。</span><span class="sxs-lookup"><span data-stu-id="24398-103">BizTalk Server relies heavily on SQL Server for data store and data persistence.</span></span> <span data-ttu-id="24398-104">その他すべての BizTalk Server コンポーネントおよびホストにも、多種多様な業務アプリケーション (メッセージの受信、処理、ルーティングなど) を統合するプロセスにおいて、それぞれ固有の役割がありますが、この作業をディスクに取り込み、維持するという役割は、データベース コンピューターにあります。</span><span class="sxs-lookup"><span data-stu-id="24398-104">All other components and hosts in BizTalk Server have specific roles in the process of integrating disparate business applications (for example, receiving, processing, or routing messages), but the database computer captures this work and persists it to disk.</span></span> <span data-ttu-id="24398-105">たとえば、BizTalk Server が受信メッセージを受信すると受信ホストに永続化、メッセージ ボックス データベースの他のホストは、オーケストレーションの処理および送信のメッセージを取得する前にします。</span><span class="sxs-lookup"><span data-stu-id="24398-105">For example, when BizTalk Server receives an incoming message, the receive host persists it to the MessageBox database before other hosts retrieve the message for orchestration processing and sending.</span></span> <span data-ttu-id="24398-106">BizTalk ソリューションには、オーケストレーションが含まれている場合、BizTalk Server は (処理ホスト)、ビジネス プロセスを実行し、オーケストレーションの完了後に、メッセージをメッセージ ボックス データベースに保存します。 ホストにメッセージをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="24398-106">If your BizTalk solution involves orchestration, BizTalk Server routes the message to the host that executes the business process (processing host), and saves the message to the MessageBox database after the orchestration finishes.</span></span> <span data-ttu-id="24398-107">その後、送信ホストが、そのメッセージをデータベースから取り出し、適切な送信アダプターを使って外部のアプリケーションに送信します。</span><span class="sxs-lookup"><span data-stu-id="24398-107">The sending host then retrieves the message from the database before sending it to the external application through the appropriate send adapter.</span></span>  
  
 <span data-ttu-id="24398-108">BizTalk Server データベースの高可用性を実現するには、サーバー クラスターを作成するのに SQL Server を実行している 2 つ以上のコンピューターを構成するのに Windows クラスタ リングを使用します。</span><span class="sxs-lookup"><span data-stu-id="24398-108">To provide high availability for the BizTalk Server databases, use Windows Clustering to configure two or more computers that are running SQL Server to create a server cluster.</span></span> <span data-ttu-id="24398-109">このサーバーのクラスター化は、冗長性と、BizTalk Server データベースのフォールト トレランスを提供します。</span><span class="sxs-lookup"><span data-stu-id="24398-109">This server clustering provides redundancy and fault tolerance for the BizTalk Server databases.</span></span> <span data-ttu-id="24398-110">複数のコンピューターを並列に運用して可用性とスケーラビリティを高めようとする負荷分散クラスタリングとは異なり、サーバー クラスタリングでは通常、2 台のデータベース コンピューターをアクティブ/パッシブ構成で使用します。この構成では、一方のコンピューターが他方のコンピューターのバックアップ リソースを提供します。</span><span class="sxs-lookup"><span data-stu-id="24398-110">Unlike load-balanced clustering, where a group of computers functions together to increase availability and scalability, server clustering typically involves a pair of database computers in an active/passive configuration so that one computer provides backup resources for the other.</span></span>  
  
 <span data-ttu-id="24398-111">次の図は、アクティブ/パッシブ構成のサーバー クラスタリングによって高可用性を実現した BizTalk Server のデータベース層を示しています。</span><span class="sxs-lookup"><span data-stu-id="24398-111">The following figure shows a BizTalk Server database tier with high availability through active/passive server clustering.</span></span>  
  
 <span data-ttu-id="24398-112">![BizTalk Server のデータベース層](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span><span class="sxs-lookup"><span data-stu-id="24398-112">![BizTalk Server Database Tier](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span></span>  
  
 <span data-ttu-id="24398-113">アクティブ側のデータベース コンピューターでエラーや障害が発生した場合、障害の起きたコンピューターが復旧するまでの間、パッシブ側のコンピューターがアクティブになり、データベース リソースの管理を引き継ぎます。</span><span class="sxs-lookup"><span data-stu-id="24398-113">If the active database computer encounters errors or fails, the passive computer becomes active and assumes control over the database resources until the failed computer is repaired.</span></span> <span data-ttu-id="24398-114">データベース サービスは、フェールオーバーしデータ接続を新しいアクティブなコンピューターに復元され、継続して機能する BizTalk アプリケーションを有効にします。</span><span class="sxs-lookup"><span data-stu-id="24398-114">The database service fails over and restores data connections to the new active computer and enables the BizTalk application to continue functioning.</span></span>  
  
## <a name="biztalk-server-databases"></a><span data-ttu-id="24398-115">BizTalk Server データベース</span><span class="sxs-lookup"><span data-stu-id="24398-115">BizTalk Server Databases</span></span>  
 <span data-ttu-id="24398-116">Microsoft BizTalk Server によって、SQL Server にいくつかのデータベースがインストールされます。</span><span class="sxs-lookup"><span data-stu-id="24398-116">Microsoft BizTalk Server installs several databases in SQL Server.</span></span> <span data-ttu-id="24398-117">次の表は、BizTalk Server データベースの一般的な使用状況特性を示します。</span><span class="sxs-lookup"><span data-stu-id="24398-117">The following table shows typical usage characteristics for the BizTalk Server databases.</span></span>  
  
|<span data-ttu-id="24398-118">データベース</span><span class="sxs-lookup"><span data-stu-id="24398-118">Database</span></span>|<span data-ttu-id="24398-119">既定のデータベース名</span><span class="sxs-lookup"><span data-stu-id="24398-119">Default database name</span></span>|<span data-ttu-id="24398-120">使用状況特性</span><span class="sxs-lookup"><span data-stu-id="24398-120">Usage characteristics</span></span>|  
|--------------|---------------------------|---------------------------|  
|<span data-ttu-id="24398-121">管理データベース</span><span class="sxs-lookup"><span data-stu-id="24398-121">Management database</span></span>|<span data-ttu-id="24398-122">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="24398-122">BizTalkMgmtDb</span></span>|<span data-ttu-id="24398-123">このデータベース ハンドル使用率の低いは読み取りおよび書き込み操作です。</span><span class="sxs-lookup"><span data-stu-id="24398-123">This database handles low-usage read and write operations.</span></span>|  
|<span data-ttu-id="24398-124">メッセージ ボックス データベース</span><span class="sxs-lookup"><span data-stu-id="24398-124">MessageBox database</span></span>|<span data-ttu-id="24398-125">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="24398-125">BizTalkMsgBoxDb</span></span>|<span data-ttu-id="24398-126">このデータベース ハンドルの使用率の高いは、読み取りおよび書き込み操作です。</span><span class="sxs-lookup"><span data-stu-id="24398-126">This database handles high-usage read and write operations.</span></span>|  
|<span data-ttu-id="24398-127">追跡データベース</span><span class="sxs-lookup"><span data-stu-id="24398-127">Tracking database</span></span>|<span data-ttu-id="24398-128">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="24398-128">BizTalkDTADb</span></span>|<span data-ttu-id="24398-129">このデータベースは、追跡するために構成データの量に応じて可能性のある使用率の高い書き込み操作を処理し、使用率の低い読み取り操作します。</span><span class="sxs-lookup"><span data-stu-id="24398-129">This database handles potentially high-usage write operations depending on the amount of data that you configure to be tracked, and low-usage read operations.</span></span>|  
|<span data-ttu-id="24398-130">SSO データベース</span><span class="sxs-lookup"><span data-stu-id="24398-130">SSO database</span></span>|<span data-ttu-id="24398-131">SSODB</span><span class="sxs-lookup"><span data-stu-id="24398-131">SSODB</span></span>|<span data-ttu-id="24398-132">このデータベース ハンドル使用率の低いは読み取りおよび書き込み操作です。</span><span class="sxs-lookup"><span data-stu-id="24398-132">This database handles low-usage read and write operations.</span></span>|  
|<span data-ttu-id="24398-133">BAM 分析データベース</span><span class="sxs-lookup"><span data-stu-id="24398-133">BAM Analysis database</span></span>|<span data-ttu-id="24398-134">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="24398-134">BAMAnalysis</span></span>|<span data-ttu-id="24398-135">可能性のある使用率の高い読み取りおよび書き込み操作の実行の監視のレベルに応じて、この SQL Server Analysis Services データベースを処理します。</span><span class="sxs-lookup"><span data-stu-id="24398-135">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="24398-136">BAM スター スキーマ データベース</span><span class="sxs-lookup"><span data-stu-id="24398-136">BAM Star Schema database</span></span>|<span data-ttu-id="24398-137">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="24398-137">BAMStarSchema</span></span>|<span data-ttu-id="24398-138">可能性のある使用率の高い読み取りおよび書き込み操作の実行の監視のレベルに応じて、この SQL Server Analysis Services データベースを処理します。</span><span class="sxs-lookup"><span data-stu-id="24398-138">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="24398-139">BAM プライマリ インポート データベース</span><span class="sxs-lookup"><span data-stu-id="24398-139">BAM Primary Import database</span></span>|<span data-ttu-id="24398-140">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="24398-140">BAMPrimaryImport</span></span>|<span data-ttu-id="24398-141">可能性のある使用率の高い読み取りおよび書き込み操作の実行の監視のレベルに応じて、この SQL Server Analysis Services データベースを処理します。</span><span class="sxs-lookup"><span data-stu-id="24398-141">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="24398-142">BAM アーカイブ データベース</span><span class="sxs-lookup"><span data-stu-id="24398-142">BAM Archive database</span></span>|<span data-ttu-id="24398-143">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="24398-143">BAMArchive</span></span>|<span data-ttu-id="24398-144">可能性のある使用率の高い読み取りおよび書き込み操作の実行の監視のレベルに応じて、この SQL Server Analysis Services データベースを処理します。</span><span class="sxs-lookup"><span data-stu-id="24398-144">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="24398-145">ルール エンジン データベース</span><span class="sxs-lookup"><span data-stu-id="24398-145">Rule Engine database</span></span>|<span data-ttu-id="24398-146">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="24398-146">BizTalkRuleEngineDb</span></span>|<span data-ttu-id="24398-147">このデータベースは、ルールを更新する場合を除き、可能性のある使用率の低い読み取りおよび書き込み操作を処理します。</span><span class="sxs-lookup"><span data-stu-id="24398-147">This database handles potentially low-usage read and write operations, unless you update the rules.</span></span>|  
|<span data-ttu-id="24398-148">Analysis Services データベースの追跡</span><span class="sxs-lookup"><span data-stu-id="24398-148">Tracking Analysis Services database</span></span>|<span data-ttu-id="24398-149">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="24398-149">BizTalkAnalysisDb</span></span>|<span data-ttu-id="24398-150">この SQL Server Analysis Services データベースの使用率の高い読み取りおよび書き込み操作のハンドル。</span><span class="sxs-lookup"><span data-stu-id="24398-150">This SQL Server Analysis Services database handles high-usage read and write operations.</span></span>|  
  
 <span data-ttu-id="24398-151">BizTalk Server ランタイム操作は、通常、最初の 4 つのデータベース (管理データベース、メッセージ ボックス データベース、追跡データベース、および SSO データベース) を使用します。</span><span class="sxs-lookup"><span data-stu-id="24398-151">BizTalk Server runtime operations typically use the first four databases (Management database, MessageBox databases, Tracking database, and SSO database).</span></span> <span data-ttu-id="24398-152">によっては、これらのデータベース上のトラフィックを SQL Server を実行している別のコンピューター上に配置できます。</span><span class="sxs-lookup"><span data-stu-id="24398-152">Depending on the traffic on these databases, you can put them on separate computers that are running SQL Server.</span></span> <span data-ttu-id="24398-153">使用するデータベースは、BizTalk Server のどの機能を使うかによって異なります。表に示したデータベースを全部使用する場合も、一部だけを使用する場合もあります。</span><span class="sxs-lookup"><span data-stu-id="24398-153">Depending on the BizTalk Server functionality that you use, you may have some or all of the other databases in the table.</span></span> <span data-ttu-id="24398-154">スケール アウトし、必要に応じて、これらのデータベースをクラスターできます。</span><span class="sxs-lookup"><span data-stu-id="24398-154">You can scale out and cluster these databases as needed.</span></span>  
  
 <span data-ttu-id="24398-155">データベースごとに別々 のディスクの使用などの適切な SQL Server 展開プラクティスに従うことを確認します。</span><span class="sxs-lookup"><span data-stu-id="24398-155">Make sure that you follow good SQL Server deployment practices, such as using separate disks for each database.</span></span>  
  
 <span data-ttu-id="24398-156">BizTalk Server データベースでは、次を行うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="24398-156">For the BizTalk Server databases, we recommend that you do the following:</span></span>  
  
-   <span data-ttu-id="24398-157">**フェールオーバー クラスタ リング設定**です。</span><span class="sxs-lookup"><span data-stu-id="24398-157">**Set up failover clustering**.</span></span> <span data-ttu-id="24398-158">フェールオーバー クラスタ リングにより、SQL Server が稼働中のサーバーに障害が発生したサーバーから SQL Server のインスタンスの処理を自動的に切り替わります。</span><span class="sxs-lookup"><span data-stu-id="24398-158">Failover clustering enables SQL Server to automatically switch the processing for an instance of SQL Server from a failed server to a working server.</span></span>  
  
     <span data-ttu-id="24398-159">BAM プライマリ インポート データベースは、イベント データを収集します。</span><span class="sxs-lookup"><span data-stu-id="24398-159">The BAM Primary Import database collects event data.</span></span> <span data-ttu-id="24398-160">障害が発生した場合、前回のバックアップ以降に BAM プライマリ インポート データベースに書き込まれたデータが失われます。</span><span class="sxs-lookup"><span data-stu-id="24398-160">In the event of a disaster, data that was written to the BAM Primary Import database since the last backup will be lost.</span></span> <span data-ttu-id="24398-161">失われたイベントを再生成する方法はありません、ためには、BAM プライマリ インポート データベースに対してフェールオーバー クラスタ リングを有効にすることが特に重要です。</span><span class="sxs-lookup"><span data-stu-id="24398-161">Because there is no way to regenerate lost events, it is especially important that you enable failover clustering on your BAM Primary Import database.</span></span>  
  
-   <span data-ttu-id="24398-162">**使用して SQL Server RAID 1 + 0 (独立したディスクの冗長アレイ)**、特に、メッセージ ボックス データベースおよび BAM プライマリ インポート データベースのです。</span><span class="sxs-lookup"><span data-stu-id="24398-162">**Use SQL Server RAID 1+0 (redundant array of independent disks)**, especially for the MessageBox database and the BAM Primary Import database.</span></span>  
  
 <span data-ttu-id="24398-163">BizTalk Server データベースのバックアップの詳細については、次を参照してください。[災害復旧のためのベスト プラクティス](../technical-guides/best-practices-for-disaster-recovery.md)です。</span><span class="sxs-lookup"><span data-stu-id="24398-163">For information about backing up your BizTalk Server databases, see [Best Practices for Disaster Recovery](../technical-guides/best-practices-for-disaster-recovery.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="24398-164">Microsoft SQL Server では、データベースが使用可能なである確率を高めるためのデータベース ミラーリングと呼ばれるソフトウェア ソリューションを提供します。</span><span class="sxs-lookup"><span data-stu-id="24398-164">Microsoft SQL Server provides a software solution known as database mirroring for increasing the probability that a database is available.</span></span> <span data-ttu-id="24398-165">SQL Server データベース ミラーリングの使用は、現在、BizTalk Server データベースでトランザクションの一貫性を維持する潜在的な問題があるため、Microsoft BizTalk Server データベースの高可用性を確保するためのサポートされているソリューションではありません。</span><span class="sxs-lookup"><span data-stu-id="24398-165">The use of SQL Server database mirroring is not currently a supported solution for ensuring high availability of the Microsoft BizTalk Server databases because of potential problems maintaining transactional consistency in the BizTalk Server databases.</span></span>  
>   
>  <span data-ttu-id="24398-166">データベース ミラーリングと SQL Server のデータベースにまたがるトランザクションに関する詳細については、次を参照してください。[トランザクションの可用性グループとデータベース ミラーリング](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/transactions-always-on-availability-and-database-mirroring)です。</span><span class="sxs-lookup"><span data-stu-id="24398-166">For more information about database mirroring and cross-database transactions in SQL Server, see [Transactions - availability groups and database mirroring](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/transactions-always-on-availability-and-database-mirroring).</span></span> <span data-ttu-id="24398-167">BizTalk Server データベースを高可用性を確保する SQL Server クラスターにインストールする必要があり、災害復旧の目的には、ログ配布を利用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="24398-167">BizTalk Server databases should be installed on a SQL Server cluster to ensure high availability and log shipping should be utilized for purposes of disaster recovery.</span></span>  
>   
>  <span data-ttu-id="24398-168">ログ配布の詳細については、次を参照してください[新機能は、BizTalk Server ログ配布しますか?。](../technical-guides/what-is-biztalk-server-log-shipping.md)</span><span class="sxs-lookup"><span data-stu-id="24398-168">For more information about log shipping, see [What Is BizTalk Server Log Shipping?](../technical-guides/what-is-biztalk-server-log-shipping.md)</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="24398-169">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="24398-169">In This Section</span></span>  
  
-   [<span data-ttu-id="24398-170">BizTalk Server データベースのクラスタリング</span><span class="sxs-lookup"><span data-stu-id="24398-170">Clustering the BizTalk Server Databases</span></span>](../technical-guides/clustering-the-biztalk-server-databases2.md)  
  
-   [<span data-ttu-id="24398-171">BizTalk Server データベースのスケール アウト</span><span class="sxs-lookup"><span data-stu-id="24398-171">Scaling Out the BizTalk Server Databases</span></span>](../technical-guides/scaling-out-the-biztalk-server-databases.md)  
  
## <a name="see-also"></a><span data-ttu-id="24398-172">参照</span><span class="sxs-lookup"><span data-stu-id="24398-172">See Also</span></span>  
 <span data-ttu-id="24398-173">[高可用性の計画](../technical-guides/planning-for-high-availability2.md) </span><span class="sxs-lookup"><span data-stu-id="24398-173">[Planning for High Availability](../technical-guides/planning-for-high-availability2.md) </span></span>  
 <span data-ttu-id="24398-174">[BizTalk ホストの高可用性](../technical-guides/high-availability-for-biztalk-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="24398-174">[High Availability for BizTalk Hosts](../technical-guides/high-availability-for-biztalk-hosts.md) </span></span>  
 <span data-ttu-id="24398-175">[マスター シークレット サーバーの高可用性](../technical-guides/high-availability-for-the-master-secret-server.md) </span><span class="sxs-lookup"><span data-stu-id="24398-175">[High Availability for the Master Secret Server](../technical-guides/high-availability-for-the-master-secret-server.md) </span></span>  
 [<span data-ttu-id="24398-176">ディザスター リカバリー</span><span class="sxs-lookup"><span data-stu-id="24398-176">Disaster Recovery</span></span>](../technical-guides/disaster-recovery.md)