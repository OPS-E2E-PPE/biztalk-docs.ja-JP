---
title: チェックリスト:保守および BizTalk Server データベースのトラブルシューティング |Microsoft Docs
description: 自動 Update Statistics、Max Degree of Parallelism など、BizTalk Server データベース、インデックスを再構築を維持するためのベスト プラクティスを参照してください、ロックとブロックを探して、データベースのサイズを確認、追跡を使用して、SQL Server エージェント ジョブを有効にするを確認中断されたインスタンスは、し、ディスクのパフォーマンスを確認します。 また、BizTalk 終端記号のツールをについて説明します。
ms.custom: ''
ms.date: 06/11/2018
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 58931faf-fc84-46fe-8359-506da94c3756
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a52e16eb86215ca977ff05b87a3c1baf556b0982
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65294802"
---
# <a name="checklist-maintaining-and-troubleshooting-biztalk-server-databases"></a><span data-ttu-id="77bb2-104">チェックリスト:メンテナンスと BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="77bb2-104">Checklist: Maintaining and Troubleshooting BizTalk Server Databases</span></span>
<span data-ttu-id="77bb2-105">BizTalk Server データベースとその正常性は、成功した BizTalk Server データベースのメッセージング環境の非常に重要です。</span><span class="sxs-lookup"><span data-stu-id="77bb2-105">BizTalk Server databases and their health are very important for a successful BizTalk Server database messaging environment.</span></span> <span data-ttu-id="77bb2-106">このトピックでは、管理、または BizTalk Server データベースのトラブルシューティングに必要な手順を使用します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-106">This topic lists the steps that you must follow when maintaining or troubleshooting the BizTalk Server databases.</span></span>  
  
-   [<span data-ttu-id="77bb2-107">BizTalk Server データベースのメンテナンス</span><span class="sxs-lookup"><span data-stu-id="77bb2-107">Maintaining BizTalk Server Databases</span></span>](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_MaintainDB)  
  
-   [<span data-ttu-id="77bb2-108">BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="77bb2-108">Troubleshooting BizTalk Server Databases</span></span>](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_Troubleshoot)  
  
<a name="BKMK_MaintainDB"></a>   
## <a name="maintaining-biztalk-server-databases"></a><span data-ttu-id="77bb2-109">BizTalk Server データベースの保守</span><span class="sxs-lookup"><span data-stu-id="77bb2-109">Maintaining BizTalk Server Databases</span></span>  
  
|<span data-ttu-id="77bb2-110">手順</span><span class="sxs-lookup"><span data-stu-id="77bb2-110">Steps</span></span>|<span data-ttu-id="77bb2-111">リファレンス</span><span class="sxs-lookup"><span data-stu-id="77bb2-111">Reference</span></span>|  
|---|---|  
|<span data-ttu-id="77bb2-112">無効にする、**統計の自動更新**と**統計の自動作成**オプション (BizTalk Server メッセージ ボックス データベースにのみ適用されます)。</span><span class="sxs-lookup"><span data-stu-id="77bb2-112">Disable the **Auto Update Statistics** and **Auto Create Statistics** options (applies only to BizTalk Server MessageBox databases).</span></span> | <span data-ttu-id="77bb2-113">**注:** これらの設定は、既定では、BizTalk Server 構成の一部として実行されます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-113">**Note:**  These settings are done by default as part of the BizTalk Server configuration.</span></span> <span data-ttu-id="77bb2-114">これらの設定に変更をする必要がありますされません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-114">You should not make changes to these settings.</span></span> <br/><br/> <span data-ttu-id="77bb2-115">これらの設定が無効になっているかどうかを表示するには、SQL Server で次のストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-115">To see if these settings are disabled, execute the following stored procedures in SQL Server:</span></span><br/><br/> <span data-ttu-id="77bb2-116">SELECT DATABASEPROPERTYEX('BizTalkMsgBoxDB', 'IsAutoCreateStatistics') AS IsAutoCreateStatistics</span><span class="sxs-lookup"><span data-stu-id="77bb2-116">SELECT DATABASEPROPERTYEX('BizTalkMsgBoxDB', 'IsAutoCreateStatistics') AS IsAutoCreateStatistics</span></span><br/><span data-ttu-id="77bb2-117">SELECT DATABASEPROPERTYEX('BizTalkMsgBoxDB', 'IsAutoUpdateStatistics') AS IsAutoUpdateStatistics</span><span class="sxs-lookup"><span data-stu-id="77bb2-117">SELECT DATABASEPROPERTYEX('BizTalkMsgBoxDB', 'IsAutoUpdateStatistics') AS IsAutoUpdateStatistics</span></span><br/><br/><span data-ttu-id="77bb2-118">必要があります、値が返される**0**を示す、設定を無効にします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-118">The values returned should be **0** to indicate the setting is disabled.</span></span> <span data-ttu-id="77bb2-119">場合**0**は返されません、SQL Server で、次を実行して設定を無効にします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-119">If **0** is not returned, disable the setting by executing the following in SQL Server:</span></span><br/><br/><span data-ttu-id="77bb2-120">ALTER DATABASE BizTalkMsgBoxDB SET AUTO_CREATE_STATISTICS OFF</span><span class="sxs-lookup"><span data-stu-id="77bb2-120">ALTER DATABASE BizTalkMsgBoxDB SET AUTO_CREATE_STATISTICS OFF</span></span><br/><span data-ttu-id="77bb2-121">ALTER DATABASE BizTalkMsgBoxDB SET AUTO_UPDATE_STATISTICS OFF</span><span class="sxs-lookup"><span data-stu-id="77bb2-121">ALTER DATABASE BizTalkMsgBoxDB SET AUTO_UPDATE_STATISTICS OFF</span></span><br/><br/> <span data-ttu-id="77bb2-122">これらの設定の詳細についてを参照してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-122">For more information about these settings, see:</span></span><br/><br/> <span data-ttu-id="77bb2-123">-   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429)</span><span class="sxs-lookup"><span data-stu-id="77bb2-123">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429)</span></span><br /><span data-ttu-id="77bb2-124">-   **912262**—[「自動更新の統計オプションの自動作成統計のオプションと、BizTalk Server BizTalkMsgBoxDB データベースをホストする SQL Server データベース インスタンスで並列処理の設定がになっています」](http://go.microsoft.com/fwlink/?LinkId=153430)</span><span class="sxs-lookup"><span data-stu-id="77bb2-124">-   **912262**—["The auto update statistics option, the auto create statistics option, and the Parallelism setting are turned off in the SQL Server database instance that hosts the BizTalk Server BizTalkMsgBoxDB database"](http://go.microsoft.com/fwlink/?LinkId=153430)</span></span>|  
|<span data-ttu-id="77bb2-125">プロパティの並列処理の最大限度を設定します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-125">Set the Max Degree of Parallelism property</span></span>|<span data-ttu-id="77bb2-126">**注:** これらの設定は、既定では、BizTalk Server 構成の一部として実行されます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-126">**Note:**  These settings are done by default as part of the BizTalk Server configuration.</span></span> <span data-ttu-id="77bb2-127">これらの設定に変更をする必要がありますされません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-127">You should not make changes to these settings.</span></span> <br /><br /> <span data-ttu-id="77bb2-128">Max Degree of Parallelism の設定**run_value**と**config_value**プロパティ値を 1 つ (1) BizTalk Server メッセージ ボックス データベースをホストする SQL Server インスタンス上にします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-128">Set the Max Degree of Parallelism **run_value** and **config_value** properties to a value of one (1) on the SQL Server instances that host the BizTalk Server Messagebox databases.</span></span> <span data-ttu-id="77bb2-129">並列処理の最大限度を確認したり、次を実行するストアド プロシージャ、マスターに対して SQL Server データベース。</span><span class="sxs-lookup"><span data-stu-id="77bb2-129">To check the Max Degree of Parallelism setting, execute the following stored procedure against the Master database in SQL Server:</span></span><br /><br /> <span data-ttu-id="77bb2-130">exec sp_configure 'max degree of parallelism'</span><span class="sxs-lookup"><span data-stu-id="77bb2-130">exec sp_configure 'max degree of parallelism'</span></span><br /><br /> <span data-ttu-id="77bb2-131">場合、 **run_value**と**config_value**はありません (1) 1 つの値に設定、SQL Server で次のストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-131">If the **run_value** and **config_value** are not set to a value of one (1), execute the following stored procedure in SQL Server:</span></span><br /><br /> <span data-ttu-id="77bb2-132">exec sp_configure 'max degree of parallelism', '1'                 reconfigure with override</span><span class="sxs-lookup"><span data-stu-id="77bb2-132">exec sp_configure 'max degree of parallelism', '1'                 reconfigure with override</span></span><br /><br /> <span data-ttu-id="77bb2-133">BizTalk Server の並列処理の最大限度の影響の詳細については、次のマイクロソフト サポート技術情報の記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-133">For more information about how the Max Degree of Parallelism setting affects BizTalk Server, see the following Microsoft Knowledge Base articles:</span></span><br /><br /> <span data-ttu-id="77bb2-134">-   **899000**—[「BizTalk Server を構成するときに、SQL Server のインスタンスの並列処理の設定」](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-134">-   **899000**—["The Parallelism setting for the instance of SQL Server when you configure BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432).</span></span><br /><span data-ttu-id="77bb2-135">-   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-135">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>|  
|<span data-ttu-id="77bb2-136">BizTalk Server のインデックスを再構築する場合の判断します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-136">Determine when you can rebuild BizTalk Server indexes</span></span>|<span data-ttu-id="77bb2-137">BizTalk Server データベース内のインデックスのほとんどのクラスター化された (インデックス ID:1).</span><span class="sxs-lookup"><span data-stu-id="77bb2-137">Most of the indexes in BizTalk Server databases are clustered (index ID: 1).</span></span> <span data-ttu-id="77bb2-138">DBCC SHOWCONTIG コマンドは、BizTalk Server データベースにテーブルの断片化情報を表示する使用できます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-138">The DBCC SHOWCONTIG command can be used to display fragmentation information for tables in the BizTalk Server databases.</span></span> <span data-ttu-id="77bb2-139">これらのインデックスは GUID に基づくため、断片化が発生するは正常であることです。</span><span class="sxs-lookup"><span data-stu-id="77bb2-139">These indexes are GUID-based so it is normal for fragmentation to occur.</span></span> <span data-ttu-id="77bb2-140">DBCC SHOWCONTIG のスキャン密度の値が 30% 未満の場合は、ダウンタイム中にインデックスが再構築することができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-140">If the Scan Density value of DBCC SHOWCONTIG is less than 30%, the indexes can be rebuilt during downtime.</span></span> <span data-ttu-id="77bb2-141">BizTalk Server データベースに多数のテーブルには、オンラインのインデックスを作成することはできません型の定義を使用する列が含まれます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-141">Many tables in the BizTalk Server databases contain columns that use DataType definitions where online indexing cannot be done.</span></span> <span data-ttu-id="77bb2-142">そのため、BizTalk Server データベースのテーブルのインデックスは、BizTalk がデータを処理する際にことはありませんリビルドする必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-142">Therefore, the indexes for tables in the BizTalk Server databases should never be rebuilt while BizTalk is processing data.</span></span> <span data-ttu-id="77bb2-143">BizTalk のインデックスを再構築する方法の詳細については、次のマイクロソフト サポート技術情報の記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-143">For more information on how to rebuild the BizTalk indexes, see the following Microsoft Knowledge Base article:</span></span><br /><br /> <span data-ttu-id="77bb2-144">-   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-144">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span><br /><br /> <span data-ttu-id="77bb2-145">**注:** SQL Server での断片化情報を探す sys.dm_db_index_physical_stats 関数を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-145">**Note:**  You can also use the sys.dm_db_index_physical_stats function to look for fragmentation information in SQL Server.</span></span> <span data-ttu-id="77bb2-146">詳細については、次を参照してください。 [sys.dm_db_index_physical_stats (TRANSACT-SQL)](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-physical-stats-transact-sql)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-146">For more information, see [sys.dm_db_index_physical_stats (Transact-SQL)](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-physical-stats-transact-sql).</span></span>|  
|<span data-ttu-id="77bb2-147">データベースのロック、ブロック、またはデッドロックの監視します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-147">Monitor the database for locks, blocks, or deadlocks</span></span>|<span data-ttu-id="77bb2-148">ロックと BizTalk Server で使用される SQL Server データベースで発生するブロックの通常の動作になります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-148">It is an expected behavior for locks and blocks to occur on the SQL Server databases used by BizTalk Server.</span></span> <span data-ttu-id="77bb2-149">ただし、これらのロックまたは長期間継続するブロックには必要ありません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-149">However, it is not expected to have these locks or blocks to continue for an extended period of time.</span></span> <span data-ttu-id="77bb2-150">ブロックと、SQL Server でデッドロックを拡張する BizTalk Server で使用されるデータベースは、潜在的な問題の兆候です。</span><span class="sxs-lookup"><span data-stu-id="77bb2-150">Extended blocking and deadlocking on the SQL Server databases used by BizTalk Server are indicators of a potential problem.</span></span> <span data-ttu-id="77bb2-151">現在の既知のデッドロックと BizTalk Server で使用される SQL Server データベースでのブロックの原因は、次のマイクロソフト サポート技術情報の記事を確認してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-151">For the current known causes of deadlocking and blocking on the SQL Server databases used by BizTalk Server, review the following Microsoft Knowledge Base article:</span></span><br /><br /> <span data-ttu-id="77bb2-152">-   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-152">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>|  
|<span data-ttu-id="77bb2-153">データベースとテーブルのサイズを監視します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-153">Monitor the size of databases and tables</span></span>|<span data-ttu-id="77bb2-154">BizTalk Server メッセージ ボックス データベースのサイズ通常約 5 GB があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-154">The size of the BizTalk Server Messagebox database should typically be no more than approximately 5GB.</span></span>  <span data-ttu-id="77bb2-155">BizTalkMsgBoxDb データベースは、任意のデータを保持することはできませんし、データが処理されるか、BizTalkDTADb データベースに移動されるまでバッファーを考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-155">The BizTalkMsgBoxDb database should not be holding any data, and should be considered a buffer until the data is processed or moved to the BizTalkDTADb database.</span></span> <span data-ttu-id="77bb2-156">強力な SQL Server バックエンドと多数の実行時間の長いオーケストレーションの環境では、5 GB を超える BizTalkMsgBoxDb データベースがあります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-156">An environment with a powerful SQL Server backend and numerous long running orchestrations may have a BizTalkMsgBoxDb database larger than 5GB.</span></span> <span data-ttu-id="77bb2-157">大量環境にない実行時間の長いオーケストレーションを BizTalk Server メッセージ ボックス データベースは 5 GB よりもはるかに小さいが必要です。</span><span class="sxs-lookup"><span data-stu-id="77bb2-157">A high volume environment with no long-running orchestrations should have a BizTalk Server Messagebox database much smaller than 5GB.</span></span> <span data-ttu-id="77bb2-158">サイズで、BizTalk Server 追跡データベースが大きく異なることができますが、クエリのパフォーマンスが大幅に低下する場合、追跡データベースがおそらく大きすぎます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-158">The BizTalk Server tracking database can vary greatly in size but if query performance decreases dramatically, then the tracking database is probably too large.</span></span> <span data-ttu-id="77bb2-159">ルールの一般的に、BizTalk Server 追跡データベースの 15 ~ 20 GB を超えるは大きすぎると見なされます、パフォーマンスに悪影響を及ぼす可能性があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-159">As a rule of thumb, a BizTalk Server tracking database larger than 15-20 GB is considered too large and may adversely impact performance.</span></span> <span data-ttu-id="77bb2-160">次の問題は、BizTalk Server データベースは大きすぎるに起因する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-160">The following issues may be attributable to BizTalk Server databases that are too large:</span></span><br /><br /> <span data-ttu-id="77bb2-161">-BizTalk Server メッセージ ボックス データベースは、データ サイズ (ログ ファイルだけでなく) の大規模なままに増え続けています。</span><span class="sxs-lookup"><span data-stu-id="77bb2-161">-   The BizTalk Server Messagebox database continues to grow while the data size (not just the log file) remains large.</span></span> <span data-ttu-id="77bb2-162">BizTalk Server では、単純なメッセージ フローのシナリオでも処理に通常よりも長い時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-162">BizTalk Server takes a longer time than normal to process even a simple message flow scenario.</span></span><br /><span data-ttu-id="77bb2-163">グループ ハブ クエリでは、通常よりも長い時間がかかるし、偶数のタイムアウトの可能性があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-163">-   Group Hub queries take a longer time than normal and may even timeout.</span></span><br /><span data-ttu-id="77bb2-164">-データベースのログ ファイルは決して切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-164">-   The database log file never gets truncated.</span></span><br /><span data-ttu-id="77bb2-165">-BizTalk SQL エージェント ジョブが通常よりも低速に実行します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-165">-   The BizTalk SQL Agent jobs run slower than normal.</span></span><br /><span data-ttu-id="77bb2-166">-一部のテーブルがかなり大きくまたは正常に多くの行を比較します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-166">-   Some tables are considerably large or have too many rows compared to normal.</span></span><br /><br /> <span data-ttu-id="77bb2-167">BizTalk Server データベース サイズが大きくなるいくつか考えられます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-167">The BizTalk Server databases can become large for several reasons including:</span></span><br /><br /> <span data-ttu-id="77bb2-168">-BizTalk SQL エージェント ジョブが実行されていません</span><span class="sxs-lookup"><span data-stu-id="77bb2-168">-   BizTalk SQL Agent Jobs not running</span></span><br /><span data-ttu-id="77bb2-169">-過剰な中断されたメッセージまたはサービス インスタンス</span><span class="sxs-lookup"><span data-stu-id="77bb2-169">-   Excessive suspended message or service instances</span></span><br /><span data-ttu-id="77bb2-170">-ディスクの障害</span><span class="sxs-lookup"><span data-stu-id="77bb2-170">-   Disk failures</span></span><br /><span data-ttu-id="77bb2-171">-高レベルの追跡</span><span class="sxs-lookup"><span data-stu-id="77bb2-171">-   High levels of tracking</span></span><br /><span data-ttu-id="77bb2-172">-BizTalk Server の調整</span><span class="sxs-lookup"><span data-stu-id="77bb2-172">-   BizTalk Server throttling</span></span><br /><span data-ttu-id="77bb2-173">の SQL Server のパフォーマンス低下</span><span class="sxs-lookup"><span data-stu-id="77bb2-173">-   Poor SQL Server performance</span></span><br /><span data-ttu-id="77bb2-174">-ネットワークの待機時間に関する問題</span><span class="sxs-lookup"><span data-stu-id="77bb2-174">-   Network latency issues</span></span><br /><br /> <span data-ttu-id="77bb2-175">同様に、テーブルの行が多すぎることができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-175">Similarly, you can have too many rows in a table.</span></span> <span data-ttu-id="77bb2-176">セットの数が多すぎて行はありません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-176">There is no set number of rows that are too many.</span></span> <span data-ttu-id="77bb2-177">さらに、この行数は、どのような種類のデータがテーブルに格納されているによって異なります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-177">Additionally, this number of rows varies by what kind of data is stored in the table.</span></span> <span data-ttu-id="77bb2-178">たとえば、 *dta_DebugTrace*おそらく 100万以上の行を持つテーブルに行が多すぎます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-178">For example, a *dta_DebugTrace* table that has more than 1 million rows probably has too many rows.</span></span> <span data-ttu-id="77bb2-179">A *HostNameQ_Suspended*おそらく 200,000 台を超える行を持つテーブルに行が多すぎます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-179">A *HostNameQ_Suspended* table that has more than 200,000 rows probably has too many rows.</span></span><br /><br /> <span data-ttu-id="77bb2-180">データの問題が発生しているかどうかを判断する、環境に必要とされるがわかっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-180">Make sure that you know what is expected in your environment to determine whether a data issue is occurring.</span></span>|  
|<span data-ttu-id="77bb2-181">BizTalk Server ホストの追跡を有効にします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-181">Enable tracking on BizTalk Server host</span></span>|<span data-ttu-id="77bb2-182">既定のホストでは既定では、追跡が有効にします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-182">By default, tracking is enabled on the default host.</span></span> <span data-ttu-id="77bb2-183">BizTalk が必要です、**ホストの追跡を許可する**1 つのホストでオプションを確認します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-183">BizTalk requires the **Allow Host Tracking** option be checked on a single HOST.</span></span> <span data-ttu-id="77bb2-184">Tracking Data Decode Service (TDDS) が、追跡を移動の追跡が有効にすると、BizTalk Server 追跡データベースへの BizTalk Server メッセージ ボックス データベースからイベント データ。</span><span class="sxs-lookup"><span data-stu-id="77bb2-184">When tracking is enabled, the Tracking Data Decode Service (TDDS) moves the tracking event data from the BizTalk Server Messagebox database to the BizTalk Server tracking database.</span></span> <span data-ttu-id="77bb2-185">オプションで、BizTalk Server ホストが構成されていないかどうか**ホストの追跡を許可する**または追跡ホストを停止すると、し、TDDS は実行されず、BizTalk Server メッセージ ボックス データベース内の TrackingData_x_x テーブルをオフに拡張されます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-185">If no BizTalk Server hosts are configured with the option to **Allow Host Tracking** or if the tracking host is stopped, then TDDS will not run and the TrackingData_x_x tables in the BizTalk Server Messagebox database will grow unchecked.</span></span> <span data-ttu-id="77bb2-186">したがって、専用の BizTalk Server ホストを構成するオプションを使用する必要がある**ホストの追跡を許可する**します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-186">Therefore, a dedicated BizTalk Server host should be configured with the option to **Allow Host Tracking**.</span></span> <span data-ttu-id="77bb2-187">専用の追跡ホストの構成の詳細については、次を参照してください。[専用の追跡ホストを構成する](~/technical-guides/configuring-a-dedicated-tracking-host.md)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-187">For more information about configuring a dedicated tracking host see [Configuring a Dedicated Tracking Host](~/technical-guides/configuring-a-dedicated-tracking-host.md).</span></span> <span data-ttu-id="77bb2-188">**注:** 大量のシナリオでの新しい追跡イベントを維持するために、TDDS を許可するのには、1 つの追跡ホストの複数のインスタンスを作成できますが、追跡の複数のホストを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-188">**Note:**  To allow TDDS to maintain new tracking events in high volume scenarios, you can create multiple instances of a single tracking host but no more than one host should be configured for tracking.</span></span>|  
|<span data-ttu-id="77bb2-189">適切な BizTalk SQL Server エージェント ジョブを使用します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-189">Use the correct BizTalk SQL Server Agent jobs</span></span>|<span data-ttu-id="77bb2-190">BizTalk Server は SQL エージェント ジョブの実行は、BizTalk Server データベースを管理するため、最適なパフォーマンスを維持するために重要です。</span><span class="sxs-lookup"><span data-stu-id="77bb2-190">Execution of the BizTalk Server SQL Agent jobs are crucial for managing the BizTalk Server databases and for maintaining optimal performance.</span></span><br /><br /> <span data-ttu-id="77bb2-191">- **Backup BizTalk Server** SQL Server エージェント ジョブは、BizTalk Server データベースをバックアップする方法のみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-191">-   The  **Backup BizTalk Server** SQL Server Agent job is the only supported method to back up the BizTalk Server databases.</span></span> <span data-ttu-id="77bb2-192">このジョブでは、完全復旧モデルを使用するすべての BizTalk Server データベースを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-192">This job requires you to set up all BizTalk Server databases to use a Full Recovery Model.</span></span> <span data-ttu-id="77bb2-193">このジョブを正常な BizTalk Server 環境を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-193">You should configure this job for a healthy BizTalk Server environment.</span></span> <span data-ttu-id="77bb2-194">SQL Server サービスが停止している場合にのみ、およびすべての BizTalk Server プロセスが停止している場合、BizTalk Server データベースをバックアップする SQL Server メソッドを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-194">You can use the SQL Server methods to back up the BizTalk Server databases only if the SQL Server service is stopped and if all BizTalk Server processes are stopped.</span></span> <span data-ttu-id="77bb2-195">**注:**    詳細については、BizTalk Server のバックアップ SQL エージェント ジョブを構成するときに、SQL Server の完全復旧モデルを使用して、次を参照してください[ログ配布](http://go.microsoft.com/fwlink/?LinkId=153450)(http://go.microsoft.com/fwlink/?LinkId=153450)または[バックアップ完全復旧モデルでの](http://go.microsoft.com/fwlink/?LinkId=156509)(。 http://go.microsoft.com/fwlink/?LinkId=156509).</span><span class="sxs-lookup"><span data-stu-id="77bb2-195">**Note:**      For more information about using the SQL Server full recovery model when configuring the SQL Agent Backup BizTalk Server job, see [Log Shipping](http://go.microsoft.com/fwlink/?LinkId=153450) (http://go.microsoft.com/fwlink/?LinkId=153450) or [Backup Under the Full Recovery Model](http://go.microsoft.com/fwlink/?LinkId=156509) (http://go.microsoft.com/fwlink/?LinkId=156509).</span></span><br /><span data-ttu-id="77bb2-196">- **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが無期限に実行するように設計します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-196">-   The **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server Agent job is designed to run indefinitely.</span></span> <span data-ttu-id="77bb2-197">その結果、SQL エージェント ジョブ履歴示さない場合があります、この SQL エージェント ジョブが正常に完了します。この動作は仕様です。</span><span class="sxs-lookup"><span data-stu-id="77bb2-197">As a result the SQL Agent job history may not indicate that this SQL Agent job has successfully completed; this behavior is by design.</span></span> <span data-ttu-id="77bb2-198">エラーが発生した、ジョブは 1 分以内に再起動し、に伴って実行を継続します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-198">If there is a failure, the job will restart within 1 minute and continue running unabated.</span></span> <span data-ttu-id="77bb2-199">そのため、このジョブのエラー通知通常は無視されます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-199">Therefore, failure notifications for this job can typically be ignored.</span></span> <span data-ttu-id="77bb2-200">MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb SQL Server エージェント ジョブのジョブ履歴には、このジョブは常に失敗しましたを再起動することが示されている場合は、障害/再起動サイクルの原因をさらに調査が必要に可能性があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-200">If the job history for the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb SQL Server Agent job indicates that this job is constantly failing and restarting then further investigation into the cause of the failure/restart cycle may be required.</span></span><br /><span data-ttu-id="77bb2-201">- **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** SQL Server エージェント ジョブがない手動で有効にするため、MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb ジョブによって開始されます。 唯一の仕事です。</span><span class="sxs-lookup"><span data-stu-id="77bb2-201">-   The **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** SQL Server Agent job is the only job that should not be manually enabled because it is initiated by the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job.</span></span><br /><span data-ttu-id="77bb2-202">- **DTA Purge and Archive** SQL Server エージェント ジョブの削除と追跡メッセージをアーカイブして、BizTalk Server 追跡データベースを保持します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-202">-   The **DTA Purge and Archive** SQL Server Agent job maintains the BizTalk Server tracking database by purging and archiving tracked messages.</span></span> <span data-ttu-id="77bb2-203">このジョブでは、テーブル内のすべての行を読み取るし、レコードを削除するかどうかを判断する各行のタイムスタンプを比較します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-203">This job reads every row in the table and compares the timestamp of each row to determine if the record should be removed.</span></span> <span data-ttu-id="77bb2-204">**注:** BizTalk Server SQL Server エージェント ジョブをトラブルシューティングするときは、エラーなし、MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb を除くすべての SQL エージェント ジョブが完了することを確認します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-204">**Note:**  When troubleshooting the BizTalk Server SQL Server Agent jobs, verify that all SQL Agent jobs except the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb are completing without errors.</span></span> <br /><br /> <span data-ttu-id="77bb2-205">SQL Server で使用される BizTalk Server の SQL エージェント ジョブの詳細については。</span><span class="sxs-lookup"><span data-stu-id="77bb2-205">For more information about the BizTalk Server SQL Agent Jobs used in SQL Server:</span></span><br /><br /> <span data-ttu-id="77bb2-206">-「[データベースの構造とジョブ](http://go.microsoft.com/fwlink/?LinkId=153451)(http://go.microsoft.com/fwlink/?LinkId=153451)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-206">-   See [Database Structure and Jobs](http://go.microsoft.com/fwlink/?LinkId=153451) (http://go.microsoft.com/fwlink/?LinkId=153451).</span></span><br /><span data-ttu-id="77bb2-207">-「 [BizTalk Server のジョブの SQL Server エージェントの説明](http://go.microsoft.com/fwlink/?LinkId=153452)(http://go.microsoft.com/fwlink/?LinkId=153452)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-207">-   See [Description of the SQL Server Agent jobs in BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153452) (http://go.microsoft.com/fwlink/?LinkId=153452).</span></span>|  
|<span data-ttu-id="77bb2-208">監視して中断されたインスタンスを終了します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-208">Monitor and terminate suspended instances</span></span>|<span data-ttu-id="77bb2-209">サービス インスタンスの中断 (再開可能) または中断 (再開不可) ことができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-209">Service instances can be suspended (resumable) or suspended (not resumable).</span></span> <span data-ttu-id="77bb2-210">これらのサービス インスタンスには、メッセージング、オーケストレーション、またはポートがあります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-210">These service instances may be Messaging, Orchestration, or Port.</span></span> <span data-ttu-id="77bb2-211">BizTalk Server または Terminate.vbs スクリプトを使用して、BizTalk Server 管理コンソールで、[グループ ハブ] ページを使用して終了し、これらのインスタンスの削除に対応します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-211">BizTalk Server accommodates termination and removal of these instances by using the Group Hub page in the BizTalk Server Administration Console or through the use of the Terminate.vbs script.</span></span> <span data-ttu-id="77bb2-212">Terminate.vbs 実行スクリプトの詳細については、次を参照してください。[中断サービス インスタンスを削除する](http://go.microsoft.com/fwlink/?LinkId=153453)(http://go.microsoft.com/fwlink/?LinkId=153453)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-212">For more information about the Terminate.vbs script, see [Removing Suspended Service Instance](http://go.microsoft.com/fwlink/?LinkId=153453) (http://go.microsoft.com/fwlink/?LinkId=153453).</span></span> <span data-ttu-id="77bb2-213">**ヒント:** 中断されたインスタンスを削除するのに、終端記号のツールを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-213">**Tip:**  You can also use the Terminator tool to remove suspended instances.</span></span> <span data-ttu-id="77bb2-214">[ターミネータ ツール](http://go.microsoft.com/fwlink/?LinkId=151931)いただけます[ http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-214">The [Terminator tool](http://go.microsoft.com/fwlink/?LinkId=151931) is available at [http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931).</span></span> <span data-ttu-id="77bb2-215">、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関する保証をいたしません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-215">Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="77bb2-216">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-216">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="77bb2-217">用語「孤立」と「ゾンビ」は、同じ意味で使用されます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-217">The terms "orphans” and "zombies" are often used interchangeably.</span></span> <span data-ttu-id="77bb2-218">またはゾンビの孤立したメッセージは、メッセージがない関連付けられているサービス インスタンスでは、通常、メッセージを受信する前に、サービス インスタンスが終了したためです。</span><span class="sxs-lookup"><span data-stu-id="77bb2-218">An orphaned or zombie message is a message that does not have an associated service instance, typically because the service instance has terminated before the message was received.</span></span> <span data-ttu-id="77bb2-219">孤立したまたはゾンビ サービスは、関連するメッセージがないサービスです。</span><span class="sxs-lookup"><span data-stu-id="77bb2-219">An orphaned or zombie service is a service that does not have any associated messages.</span></span> <span data-ttu-id="77bb2-220">BizTalk Server のインスタンスを参照してくださいゾンビ メッセージとサービスの詳細については[BizTalk Server のゾンビ](http://go.microsoft.com/fwlink/?LinkId=153454)(http://go.microsoft.com/fwlink/?LinkId=153454)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-220">For more information about zombie messages and service instances in BizTalk Server see [Zombies in BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153454) (http://go.microsoft.com/fwlink/?LinkId=153454).</span></span>|  
|<span data-ttu-id="77bb2-221">パフォーマンス カウンターを監視、 **PhysicalDisk**パフォーマンス オブジェクト</span><span class="sxs-lookup"><span data-stu-id="77bb2-221">Monitor the performance counters of the **PhysicalDisk** performance object</span></span>|<span data-ttu-id="77bb2-222">BizTalk Server は、1 分以内で、SQL Server を多数の短い、非常に高速のトランザクションを作成します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-222">BizTalk Server makes a large number of short, very quick transactions to SQL Server within one minute.</span></span> <span data-ttu-id="77bb2-223">場合は、SQL Server では、このアクティビティを受けることができない、BizTalk Server パフォーマンスの問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-223">If the SQL Server cannot sustain this activity, you may experience BizTalk Server performance issues.</span></span> <span data-ttu-id="77bb2-224">モニター、**平均Disk Sec/read**、**平均Disk Sec/transfer**、および**平均Disk Sec/write**パフォーマンス モニター カウンター、 **PhysicalDisk**パフォーマンス オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="77bb2-224">Monitor the **Avg. Disk sec/Read**, **Avg. Disk sec/Transfer**, and **Avg. Disk sec/Write** performance monitor counters in the **PhysicalDisk** performance object.</span></span> <span data-ttu-id="77bb2-225">最適な値は、10 ミリ秒未満 (ミリ秒単位です)。</span><span class="sxs-lookup"><span data-stu-id="77bb2-225">The optimal value is less than 10 ms (milliseconds).</span></span> <span data-ttu-id="77bb2-226">以上 20 ミリ秒の値は、パフォーマンスの低下と見なされます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-226">A value of 20 ms or larger is considered poor performance.</span></span><br /><br /><span data-ttu-id="77bb2-227">BizTalk Server データベースの高可用性の詳細については、次を参照してください。 [BizTalk Server データベースの高可用性の実現](../core/providing-high-availability-for-biztalk-server-databases.md)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-227">-   For more information about BizTalk Server database high availability, see [Providing High Availability for BizTalk Server Databases](../core/providing-high-availability-for-biztalk-server-databases.md).</span></span>|  
|<span data-ttu-id="77bb2-228">BizTalk Server データベースのベスト プラクティスに従ってください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-228">Follow best practices for BizTalk Server databases.</span></span>|<span data-ttu-id="77bb2-229">参照してください[BizTalk Server データベースを維持するためのベスト プラクティス](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-229">See [Best Practices for Maintaining BizTalk Server Databases](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md).</span></span>|  
  
<a name="BKMK_Troubleshoot"></a>   
## <a name="troubleshooting-biztalk-server-databases"></a><span data-ttu-id="77bb2-230">BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="77bb2-230">Troubleshooting BizTalk Server Databases</span></span>  
 <span data-ttu-id="77bb2-231">BizTalk Server データベースの問題をトラブルシューティングするには、次のタスクを実行します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-231">Perform the following tasks to troubleshoot any issues with BizTalk Server databases.</span></span>  
  
|<span data-ttu-id="77bb2-232">手順</span><span class="sxs-lookup"><span data-stu-id="77bb2-232">Steps</span></span>|<span data-ttu-id="77bb2-233">リファレンス</span><span class="sxs-lookup"><span data-stu-id="77bb2-233">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="77bb2-234">必要なすべての BizTalk SQL Server エージェント ジョブが有効で実行されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-234">Ensure all required BizTalk SQL Server Agent jobs are enabled and running</span></span>|<span data-ttu-id="77bb2-235">除くすべての BizTalk SQL Server エージェントのジョブ、 **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb**ジョブは実行されていて正常にします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-235">All the BizTalk SQL Server Agent jobs except the **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** job should be enabled and running successfully.</span></span> <span data-ttu-id="77bb2-236">その他の任意のジョブを無効にしないでください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-236">Do not disable any other job.</span></span><br /><br /> <span data-ttu-id="77bb2-237">障害が発生する場合は、使用、**履歴の表示**エラー情報を表示し、それに応じて、エラーをトラブルシューティングする SQL Server オプション。</span><span class="sxs-lookup"><span data-stu-id="77bb2-237">If a failure occurs, use the **View History** option in SQL Server to view the error information, and then troubleshoot the failure accordingly.</span></span> <span data-ttu-id="77bb2-238">注意、 **MessageBox _Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが永続的に実行します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-238">Remember that the **MessageBox _Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server Agent job runs infinitely.</span></span> <span data-ttu-id="77bb2-239">そのため、ジョブの履歴レポート ジョブが常に失敗し、再起動するときは注意する必要があります必ず。</span><span class="sxs-lookup"><span data-stu-id="77bb2-239">Therefore, you should only be concerned if the job history reports that the job constantly fails and restarts.</span></span>|  
|<span data-ttu-id="77bb2-240">MsgBoxViewer ツールを使用して、BizTalk メッセージ ボックスとその他のデータベースを分析するには</span><span class="sxs-lookup"><span data-stu-id="77bb2-240">Use the MsgBoxViewer tool to analyze the BizTalk MessageBox and other databases</span></span>|<span data-ttu-id="77bb2-241">**重要:**、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関する保証をいたしません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-241">**Important:**  Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="77bb2-242">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-242">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="77bb2-243">MsgBoxViewer ツールはから[ http://go.microsoft.com/fwlink/?LinkId=151930 ](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-243">The MsgBoxViewer tool is available from [http://go.microsoft.com/fwlink/?LinkId=151930](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930).</span></span> <span data-ttu-id="77bb2-244">MsgBoxViewer ツールは、テーブルのサイズと行の数の詳細については、html 形式のレポートを提供するためのトラブルシューティングに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-244">The MsgBoxViewer tool is useful for troubleshooting because it provides an HTML report that has detailed information about table sizes and the row count.</span></span> <span data-ttu-id="77bb2-245">レポートでは、BizTalk Server を調整するかどうかを判断することができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-245">The report can also help determine whether BizTalk Server is throttling.</span></span> <span data-ttu-id="77bb2-246">さらに、このツールは、BizTalk Server データベースと BizTalk Server の構成のスナップショットを提供します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-246">Additionally, the tool provides a snapshot of the BizTalk Server databases and the BizTalk Server configuration.</span></span><br /><br /> <span data-ttu-id="77bb2-247">BizTalk Server が実行されている場合、通常よりも低下 MsgBoxViewer ツールを実行ですべてのクエリを選択する をクリックして、**オプション クエリ**タブをクリックし、問題は、生成される HTML レポートを確認します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-247">When BizTalk Server is running slower than usual, run the MsgBoxViewer tool, click to select all queries on the **Optional Queries** tab, and then review the generated HTML report for any problems.</span></span> <span data-ttu-id="77bb2-248">**概要レポート**セクションは、黄色、および潜在的な問題は赤色の警告を一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-248">The **Summary Report** section lists warnings in yellow and potential problems in red.</span></span><br /><br /> <span data-ttu-id="77bb2-249">さらに、テーブルは、最大規模のおよびほとんどのレコードがある判別を MsgBoxViewer ツールを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-249">Additionally, you can use the MsgBoxViewer tool to determine which tables are the largest and have the most records.</span></span> <span data-ttu-id="77bb2-250">通常、これを拡張するテーブルの一覧、およびそれらのテーブルを管理する方法の詳細については、「 [BizTalk Server データベース テーブルの大きな成長を続けている](~/technical-guides/large-growing-biztalk-server-database-tables.md)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-250">For a list of tables that typically grow the larges and for instructions on how to manage those tables, see [Large-growing BizTalk Server Database Tables](~/technical-guides/large-growing-biztalk-server-database-tables.md).</span></span>|  
|<span data-ttu-id="77bb2-251">MsgBoxViewer ツールによって、識別された場合、問題を解決するのには終端記号ツールを使用します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-251">Use the Terminator tool to resolve issues, if any, identified by the MsgBoxViewer tool</span></span>|<span data-ttu-id="77bb2-252">**重要:**、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関する保証をいたしません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-252">**Important:**  Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="77bb2-253">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-253">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="77bb2-254">使用可能なターミネータ ツールを実行して[ターミネータ](http://go.microsoft.com/fwlink/?LinkId=151931)(http://go.microsoft.com/fwlink/?LinkId=151931)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-254">Run the Terminator tool available at [Terminator](http://go.microsoft.com/fwlink/?LinkId=151931) (http://go.microsoft.com/fwlink/?LinkId=151931).</span></span> <span data-ttu-id="77bb2-255">このツールでは、簡単に BizTalk MsgBoxViewer ツールによって特定された問題を解決することができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-255">This tool enables users to easily resolve any issues identified by the BizTalk MsgBoxViewer tool.</span></span> <span data-ttu-id="77bb2-256">BizTalk MsgBoxViewer ツールを使用して、終端記号のツールを統合する方法の詳細については、次を参照してください。 [BizTalk MsgBoxViewer によって特定された問題を解決するには BizTalk 終端記号のを使用して](http://go.microsoft.com/fwlink/?LinkId=151932)(http://go.microsoft.com/fwlink/?LinkId=151932)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-256">For more information on how the Terminator tool integrates with the BizTalk MsgBoxViewer tool, see [Using BizTalk Terminator to resolve issues identified by BizTalk MsgBoxViewer](http://go.microsoft.com/fwlink/?LinkId=151932) (http://go.microsoft.com/fwlink/?LinkId=151932).</span></span>|  
|<span data-ttu-id="77bb2-257">デッドロックのシナリオを調査します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-257">Investigate deadlock scenarios</span></span>|<span data-ttu-id="77bb2-258">デッドロックのシナリオでデッドロック情報が、SQLERROR ログに書き込まれるように、SQL Server 上で DBCC の追跡を有効にします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-258">In a deadlock scenario, enable DBCC tracing on the SQL Server so that the deadlock information is written to the SQLERROR log.</span></span><br /><br /> <span data-ttu-id="77bb2-259">SQL Server でデッドロック シナリオの DBCC のトレースを有効にするのには、次のステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-259">In SQL Server, execute the following statement to enable DBCC tracing for deadlock scenarios:</span></span><br /><br /> <span data-ttu-id="77bb2-260">DBCC TRACEON (1222、-1)</span><span class="sxs-lookup"><span data-stu-id="77bb2-260">DBCC TRACEON (1222,-1)</span></span><br /><br /> <span data-ttu-id="77bb2-261">データを収集する PSSDIAG ユーティリティを使用することもできます、 **Lock:deadlock**イベントと**Lock:deadlock Chain**イベント。</span><span class="sxs-lookup"><span data-stu-id="77bb2-261">You can also use the PSSDIAG utility to collect data on the **Lock:Deadlock** event and the **Lock:Deadlock Chain** event.</span></span> <span data-ttu-id="77bb2-262">PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-262">For more information about the PSSDIAG utility, see [PSSDIAG data collection utility](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).</span></span><br /><br /> <span data-ttu-id="77bb2-263">BizTalkMsgBoxDB データベースは、大量かつ高トランザクション オンライン トランザクション処理 (OLTP) データベースです。</span><span class="sxs-lookup"><span data-stu-id="77bb2-263">The BizTalkMsgBoxDB database is a high-volume and high-transaction Online Transaction Processing (OLTP) database.</span></span> <span data-ttu-id="77bb2-264">このようなデータベースでは、デッドロックの一部が必要ですし、BizTalk Server エンジンによって内部的に処理がこのデッドロックします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-264">With such databases, some deadlocking is expected and this deadlocking is handled internally by the BizTalk Server engine.</span></span> <span data-ttu-id="77bb2-265">この動作が発生したときに、エラー ログでエラーが表示されません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-265">When this behavior occurs, no errors are listed in the error logs.</span></span> <span data-ttu-id="77bb2-266">デッドロックのシナリオを調査するときに、デッドロックの出力に調査しているがイベント ログのデッドロック エラーと相関する必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-266">When you investigate a deadlock scenario, the deadlock that you are investigating in the output must be correlated with a deadlock error in the event logs.</span></span>|  
|<span data-ttu-id="77bb2-267">ブロックされたプロセスを参照してください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-267">Look for blocked processes</span></span>|<span data-ttu-id="77bb2-268">SQL Server での利用状況モニターを使用すると、ロックのシステム プロセスのサーバー プロセス識別子 (SPID) を取得します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-268">You can use Activity Monitor in SQL Server to obtain the server process identifier (SPID) of a locking system process.</span></span> <span data-ttu-id="77bb2-269">ロックの SPID が実行されている SQL ステートメントに SQL Profiler を実行することができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-269">You can then run the SQL Profiler to determine the SQL statement that is executing in the locking SPID.</span></span> <span data-ttu-id="77bb2-270">PSSDIAG ユーティリティを使用して、SQL Server でのロックとブロッキングの問題をトラブルシューティングすることができます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-270">You can use the PSSDIAG utility to troubleshoot locking and blocking issues in SQL Server.</span></span> <span data-ttu-id="77bb2-271">ユーティリティは、有効になっているスクリプトのブロックを持つすべての TRANSACT-SQL イベントをキャプチャします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-271">The utility captures all the Transact-SQL events that have the blocking script enabled.</span></span> <span data-ttu-id="77bb2-272">PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-272">For more information about the PSSDIAG utility, see [PSSDIAG data collection utility](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).</span></span><br /><br /> <span data-ttu-id="77bb2-273">SQL Server, で指定できます、**ブロック プロセスのしきい値**SPID または Spid が指定したしきい値を超えるブロックを判断するために設定します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-273">In SQL Server, you can specify the **blocked process threshold** setting to determine which SPID or SPIDs are blocking longer than the threshold that you specify.</span></span> <span data-ttu-id="77bb2-274">Blocked process threshold のオプションの詳細については、次を参照してください。 [blocked process threshold オプション](http://go.microsoft.com/fwlink/?LinkId=153628)(http://go.microsoft.com/fwlink/?LinkId=153628)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-274">For more information about the blocked process threshold option, see [blocked process threshold Option](http://go.microsoft.com/fwlink/?LinkId=153628) (http://go.microsoft.com/fwlink/?LinkId=153628).</span></span> <span data-ttu-id="77bb2-275">**注:** ロックが発生した場合、または SQL Server のブロッキングの問題、マイクロソフト カスタマー サポート サービスに問い合わせることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-275">**Note:**  When you experience a locking or blocking issue in SQL Server, we recommend that you contact Microsoft Customer Support Services.</span></span> <span data-ttu-id="77bb2-276">マイクロソフト カスタマー サポート サービスでは、正しい PSSDiag ユーティリティのオプションを構成できます。</span><span class="sxs-lookup"><span data-stu-id="77bb2-276">Microsoft Customer Support Services can help you configure the correct PSSDiag utility options.</span></span>|  
|<span data-ttu-id="77bb2-277">すべての不要なデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-277">Delete all unwanted data</span></span>|<span data-ttu-id="77bb2-278">データベースが大きくなりすぎたために拡大し、データベースに含まれるデータは必要ありませんなくなった場合は、データを削除することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-278">If the databases have grown to become too large and if the data contained in the databases will not be required any longer, the preferred method is to delete the data.</span></span> <span data-ttu-id="77bb2-279">**注意が必要です。** メソッドを使用しないこの任意の環境でのデータが重要なビジネスまたはデータが必要なかどうかです。</span><span class="sxs-lookup"><span data-stu-id="77bb2-279">**Caution:**  Do not use this method in any environment where the data is business critical or if the data is needed.</span></span> <br /><br /> <span data-ttu-id="77bb2-280">**BizTalkMsgBox データベースを消去するには**</span><span class="sxs-lookup"><span data-stu-id="77bb2-280">**To purge the BizTalkMsgBox database**</span></span><br /> <span data-ttu-id="77bb2-281">1.ダウンロードしてインストールでは、ターミネータ ツール[Biztalk 終端記号](http://go.microsoft.com/fwlink/?LinkId=220869)(http://go.microsoft.com/fwlink/?LinkId=220869)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-281">1.  Download and install the Terminator tool at [Biztalk Terminator](http://go.microsoft.com/fwlink/?LinkId=220869) (http://go.microsoft.com/fwlink/?LinkId=220869).</span></span><br /><span data-ttu-id="77bb2-282">2.トピックの手順に従って[テスト環境でメッセージ ボックス データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkID=158064)(http://go.microsoft.com/fwlink/?LinkID=158064) BizTalk メッセージ ボックス データベースでストアド プロシージャ、bts_CleanupMsgbox を作成します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-282">2.  Follow the steps in the topic [How to Manually Purge Data from the MessageBox Database in a Test Environment](http://go.microsoft.com/fwlink/?LinkID=158064) (http://go.microsoft.com/fwlink/?LinkID=158064) to create the bts_CleanupMsgbox stored procedure in the BizTalk MessageBox database.</span></span><br /><span data-ttu-id="77bb2-283">3.ターミネータ ツールを使用して、bts_CleanupMsgbox ストアド プロシージャを実行して、BizTalk メッセージ ボックス データベースを消去します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-283">3.  Use the Terminator tool to execute the bts_CleanupMsgbox stored procedure and purge the BizTalk MessageBox database.</span></span> <span data-ttu-id="77bb2-284">**警告:**     BizTalk Server を実行している運用サーバーでは、bts_CleanupMsgbox ストアド プロシージャは実行されません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-284">**Warning:**      Do not run the bts_CleanupMsgbox stored procedure on a production server that is running BizTalk Server.</span></span> <span data-ttu-id="77bb2-285">テスト環境でのみ、bts_CleanupMsgbox ストアド プロシージャを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-285">You should only run the bts_CleanupMsgbox stored procedure in a test environment.</span></span> <span data-ttu-id="77bb2-286">実行、bts_CleanupMsgbox ストアド プロシージャ、運用環境ではサポートされません。</span><span class="sxs-lookup"><span data-stu-id="77bb2-286">Running the bts_CleanupMsgbox stored procedure in a production environment is not supported.</span></span><br /><span data-ttu-id="77bb2-287">4.すべてのホストと BizTalk Server サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-287">4.  Restart all hosts and BizTalk Server services.</span></span><br /><br /> <span data-ttu-id="77bb2-288">**BizTalkDTADb データベースを消去するには**</span><span class="sxs-lookup"><span data-stu-id="77bb2-288">**To purge the BizTalkDTADb database**</span></span><br /> <ul><li><span data-ttu-id="77bb2-289">**方法 1**</span><span class="sxs-lookup"><span data-stu-id="77bb2-289">**Method 1**</span></span><br /><br /> <ol><li><span data-ttu-id="77bb2-290">すべての BizTalk Server データベースをバックアップします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-290">Back up all BizTalk Server databases.</span></span></li><li><span data-ttu-id="77bb2-291">実行、 **[dtasp_purgeallcompletedtrackingdata]** ストアド プロシージャ。</span><span class="sxs-lookup"><span data-stu-id="77bb2-291">Execute the **dtasp_PurgeAllCompletedTrackingData** stored procedure.</span></span> <span data-ttu-id="77bb2-292">ストアド プロシージャの詳細については、次を参照してください。 [BizTalk 追跡データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkId=153635)(http://go.microsoft.com/fwlink/?LinkId=153635)します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-292">For more information about the stored procedure, see [How to Manually Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkId=153635) (http://go.microsoft.com/fwlink/?LinkId=153635).</span></span></li></ol></li><li><span data-ttu-id="77bb2-293">**方法 2**します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-293">**Method 2**.</span></span> <span data-ttu-id="77bb2-294">BizTalkDTADb データベースには、削除する必要がある多くの不完全なインスタンスが含まれている場合にのみ、このオプションを使用します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-294">Use this option only if the BizTalkDTADb database contains many incomplete instances that must be removed.</span></span><br /><br /> <ol><li><span data-ttu-id="77bb2-295">すべての BizTalk Server データベースをバックアップします。</span><span class="sxs-lookup"><span data-stu-id="77bb2-295">Back up all BizTalk Server databases.</span></span></li><li><span data-ttu-id="77bb2-296">すべての BizTalk ホスト、サービス、およびカスタム分離アダプターを停止します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-296">Stop all BizTalk hosts, services, and custom isolated adapters.</span></span> <span data-ttu-id="77bb2-297">HTTP アダプタまたは SOAP アダプタを使用する場合は、IIS サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-297">If you use HTTP or the SOAP adapter, restart the IIS services.</span></span></li><li><span data-ttu-id="77bb2-298">実行、 **dtasp_CleanHMData** BizTalkDTADb データベースでストアド プロシージャ。</span><span class="sxs-lookup"><span data-stu-id="77bb2-298">Execute the **dtasp_CleanHMData** stored procedure on the BizTalkDTADb database.</span></span></li><li><span data-ttu-id="77bb2-299">すべてのホストと BizTalk Server サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-299">Restart all hosts and BizTalk Server services.</span></span></li></ol></li></ul> <span data-ttu-id="77bb2-300">**注:** 追跡データが必要な場合、BizTalkDTADb データベースをバックアップするには、別の SQL Server にデータベースを復元し、元の BizTalkDTADb データベースを消去します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-300">**Note:**  If you must have the tracking data, back up the BizTalkDTADb database, restore the database to another SQL Server, and then purge the original BizTalkDTADb database.</span></span>|  
  
 <span data-ttu-id="77bb2-301">ヘルプ MsgBoxViewer データまたは PSSDIAG 出力を分析する場合は、マイクロソフト カスタマー サポート サービスにお問い合わせください。</span><span class="sxs-lookup"><span data-stu-id="77bb2-301">If you want help analyzing the MsgBoxViewer data or PSSDIAG output, contact Microsoft Customer Support Services.</span></span> <span data-ttu-id="77bb2-302">カスタマー サポート サービスを連絡する前に、MsgBoxViewer データ、PSSDIAG 出力、および更新されたイベント ログ (.evt ファイル) を圧縮します。</span><span class="sxs-lookup"><span data-stu-id="77bb2-302">Before you contact Customer Support Services, compress the MsgBoxViewer data, the PSSDIAG output, and the updated event logs (.evt files).</span></span> <span data-ttu-id="77bb2-303">これらのファイルを BizTalk Server のサポート エンジニアに送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="77bb2-303">You may have to send these files to a BizTalk Server support engineer.</span></span>
  
## <a name="next"></a><span data-ttu-id="77bb2-304">Next</span><span class="sxs-lookup"><span data-stu-id="77bb2-304">Next</span></span>
  
-   [<span data-ttu-id="77bb2-305">BizTalk Server データベースを保守する場合のベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="77bb2-305">Best Practices for Maintaining BizTalk Server Databases</span></span>](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)  
  
-   [<span data-ttu-id="77bb2-306">BizTalk Server データベース テーブルの大規模な成長</span><span class="sxs-lookup"><span data-stu-id="77bb2-306">Large-growing BizTalk Server Database Tables</span></span>](~/technical-guides/large-growing-biztalk-server-database-tables.md)  
  
-   [<span data-ttu-id="77bb2-307">トラブルシューティング用のツールとユーティリティ</span><span class="sxs-lookup"><span data-stu-id="77bb2-307">Tools and Utilities for Troubleshooting</span></span>](../technical-guides/tools-and-utilities-for-troubleshooting.md)  
  
## <a name="see-also"></a><span data-ttu-id="77bb2-308">参照</span><span class="sxs-lookup"><span data-stu-id="77bb2-308">See Also</span></span>  
 [<span data-ttu-id="77bb2-309">変更しない SQL Server の設定</span><span class="sxs-lookup"><span data-stu-id="77bb2-309">SQL Server Settings That Should Not Be Changed</span></span>](~/technical-guides/sql-server-settings-that-should-not-be-changed.md)
