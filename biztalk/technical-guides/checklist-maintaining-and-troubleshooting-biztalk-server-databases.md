---
title: "チェックリスト: を維持し、BizTalk Server データベースのトラブルシューティング |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/29/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 58931faf-fc84-46fe-8359-506da94c3756
caps.latest.revision: "4"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 3e5ef7cdc4fb136a9fc80b04a04cdbe4f1e064e3
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="checklist-maintaining-and-troubleshooting-biztalk-server-databases"></a><span data-ttu-id="e93ed-102">チェックリスト: を維持し、BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="e93ed-102">Checklist: Maintaining and Troubleshooting BizTalk Server Databases</span></span>
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="e93ed-103">データベースとその正常性は、適切な非常に重要な[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージング環境のデータベースです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-103"> databases and their health are very important for a successful [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] database messaging environment.</span></span> <span data-ttu-id="e93ed-104">このトピックには、メンテナンスとトラブルシューティングを行う必要があります手順が示されて、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-104">This topic lists the steps that you must follow when maintaining or troubleshooting the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>  
  
-   [<span data-ttu-id="e93ed-105">BizTalk Server データベースの保守</span><span class="sxs-lookup"><span data-stu-id="e93ed-105">Maintaining BizTalk Server Databases</span></span>](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_MaintainDB)  
  
-   [<span data-ttu-id="e93ed-106">BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="e93ed-106">Troubleshooting BizTalk Server Databases</span></span>](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_Troubleshoot)  
  
<a name="BKMK_MaintainDB"></a>   
## <a name="maintaining-biztalk-server-databases"></a><span data-ttu-id="e93ed-107">BizTalk Server データベースの保守</span><span class="sxs-lookup"><span data-stu-id="e93ed-107">Maintaining BizTalk Server Databases</span></span>  
  
|<span data-ttu-id="e93ed-108">手順</span><span class="sxs-lookup"><span data-stu-id="e93ed-108">Steps</span></span>|<span data-ttu-id="e93ed-109">リファレンス</span><span class="sxs-lookup"><span data-stu-id="e93ed-109">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="e93ed-110">無効にする、**統計の自動更新**と**統計の自動作成**オプション (のみに適用できる[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックス データベース)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-110">Disable the **Auto Update Statistics** and **Auto Create Statistics** Options (applicable only to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox databases).</span></span>|<span data-ttu-id="e93ed-111">**注:**の一部として既定ではこれらの設定が完了したら、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]構成します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-111">**Note:**  These settings are done by default as part of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] configuration.</span></span> <span data-ttu-id="e93ed-112">これらの設定に変更を加えないでください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-112">You should not make changes to these settings.</span></span> <br /><br /> <span data-ttu-id="e93ed-113">無効にする必要があります、**統計の自動作成**と**統計の自動更新**オプション。</span><span class="sxs-lookup"><span data-stu-id="e93ed-113">You must disable the **Auto Create Statistics** and the **Auto Update Statistics** options.</span></span> <span data-ttu-id="e93ed-114">これらの設定が無効になっているかどうかを判断するのには、SQL Server で次のストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-114">To determine if these settings are disabled, execute the following stored procedures in SQL Server:</span></span><br /><br /> <span data-ttu-id="e93ed-115">exec sp_dboption 'BizTalkMsgBoxDB'、'統計の自動作成' exec sp_dboption 'BizTalkMsgBoxDB'、'自動 update statistics'</span><span class="sxs-lookup"><span data-stu-id="e93ed-115">exec sp_dboption 'BizTalkMsgBoxDB', 'auto create statistics'                 exec sp_dboption 'BizTalkMsgBoxDB', 'auto update statistics'</span></span><br /><br /> <span data-ttu-id="e93ed-116">返される値**CurrentSetting** OFF にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-116">The value returned for **CurrentSetting** should be OFF.</span></span> <span data-ttu-id="e93ed-117">この値が返される場合は**CurrentSetting** on、SQL Server の次のストアド プロシージャを実行して、OFF に変更します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-117">If this value returned for **CurrentSetting** is ON, change it to OFF by executing the following stored procedures in SQL Server:</span></span><br /><br /> <span data-ttu-id="e93ed-118">exec sp_dboption 'BizTalkMsgBoxDB'、'統計の自動作成'、'off' exec sp_dboption 'BizTalkMsgBoxDB'、'統計の自動更新'、'off'</span><span class="sxs-lookup"><span data-stu-id="e93ed-118">exec sp_dboption 'BizTalkMsgBoxDB', 'auto create statistics', 'off'                 exec sp_dboption 'BizTalkMsgBoxDB', 'auto update statistics', 'off'</span></span><br /><br /> <span data-ttu-id="e93ed-119">これらの設定の詳細については、次の Microsoft サポート技術情報記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-119">For more information about these settings see the following Microsoft Knowledge Base articles:</span></span><br /><br /> <span data-ttu-id="e93ed-120">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-120">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span><br /><span data-ttu-id="e93ed-121">-   **912262**—[「、自動統計更新オプション、自動統計の作成オプション、および並列処理の設定が、BizTalk Server BizTalkMsgBoxDB データベースをホストする SQL Server データベース インスタンスでになっている」](http://go.microsoft.com/fwlink/?LinkId=153430)(http://go.microsoft.com/fwlink/?LinkId=153430)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-121">-   **912262**—["The auto update statistics option, the auto create statistics option, and the Parallelism setting are turned off in the SQL Server database instance that hosts the BizTalk Server BizTalkMsgBoxDB database"](http://go.microsoft.com/fwlink/?LinkId=153430) (http://go.microsoft.com/fwlink/?LinkId=153430).</span></span>|  
|<span data-ttu-id="e93ed-122">プロパティの並列処理の最大限度を設定します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-122">Set the Max Degree of Parallelism property</span></span>|<span data-ttu-id="e93ed-123">**注:**の一部として既定ではこれらの設定が完了したら、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]構成します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-123">**Note:**  These settings are done by default as part of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] configuration.</span></span> <span data-ttu-id="e93ed-124">これらの設定に変更を加えないでください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-124">You should not make changes to these settings.</span></span> <br /><br /> <span data-ttu-id="e93ed-125">Max Degree of Parallelism 設定**run_value**と**config_value**プロパティに 1 つ (1) の値を[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]をホストするインスタンス、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックス データベースです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-125">Set the Max Degree of Parallelism **run_value** and **config_value** properties to a value of one (1) on the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instances that host the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Messagebox databases.</span></span> <span data-ttu-id="e93ed-126">並列処理の最大限度を確認して、次を実行するストアド プロシージャ、マスター _ に対してデータベース[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="e93ed-126">To check the Max Degree of Parallelism setting, execute the following stored procedure against the Master database in [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]:</span></span><br /><br /> <span data-ttu-id="e93ed-127">exec sp_configure 'max degree of parallelism'</span><span class="sxs-lookup"><span data-stu-id="e93ed-127">exec sp_configure 'max degree of parallelism'</span></span><br /><br /> <span data-ttu-id="e93ed-128">場合、 **run_value**と**config_value**はありません (1) 1 つの値に設定は、SQL Server で次のストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-128">If the **run_value** and **config_value** are not set to a value of one (1), execute the following stored procedure in SQL Server:</span></span><br /><br /> <span data-ttu-id="e93ed-129">exec sp_configure 'max degree of parallelism'、'1' の再構成の上書き</span><span class="sxs-lookup"><span data-stu-id="e93ed-129">exec sp_configure 'max degree of parallelism', '1'                 reconfigure with override</span></span><br /><br /> <span data-ttu-id="e93ed-130">並列処理の最大限度の影響の詳細については[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]、次の Microsoft サポート技術情報記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-130">For more information about how the Max Degree of Parallelism setting affects [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], see the following Microsoft Knowledge Base articles:</span></span><br /><br /> <span data-ttu-id="e93ed-131">-   **899000**—[「BizTalk Server を構成するときに、SQL Server のインスタンスの並列処理の設定」](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-131">-   **899000**—["The Parallelism setting for the instance of SQL Server when you configure BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432).</span></span><br /><span data-ttu-id="e93ed-132">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-132">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>|  
|<span data-ttu-id="e93ed-133">再構築するときに決定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]インデックス</span><span class="sxs-lookup"><span data-stu-id="e93ed-133">Determine when you can rebuild [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] indexes</span></span>|<span data-ttu-id="e93ed-134">内のインデックスのほとんど[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースはクラスター化 (インデックス ID: 1)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-134">Most of the indexes in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases are clustered (index ID: 1).</span></span> <span data-ttu-id="e93ed-135">DBCC SHOWCONTIG コマンドは、内のテーブルの断片化情報の表示を使用することができます、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-135">The DBCC SHOWCONTIG command can be used to display fragmentation information for tables in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span> <span data-ttu-id="e93ed-136">これらのインデックスは、GUID ベースは、通常の断片化が発生するようにします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-136">These indexes are GUID-based so it is normal for fragmentation to occur.</span></span> <span data-ttu-id="e93ed-137">DBCC SHOWCONTIG のスキャン密度の値が 30% 未満の場合に、ダウンタイム中にインデックスが再構築できます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-137">If the Scan Density value of DBCC SHOWCONTIG is less than 30%, the indexes can be rebuilt during downtime.</span></span> <span data-ttu-id="e93ed-138">多数のテーブルの[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースには、オンライン インデックス作成を実行できませんデータ型の定義を使用する列が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e93ed-138">Many tables in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases contain columns that use DataType definitions where online indexing cannot be done.</span></span> <span data-ttu-id="e93ed-139">そのため、内のテーブルのインデックス、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] BizTalk がデータを処理中に、データベースをリビルドしない必要があります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-139">Therefore, the indexes for tables in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases should never be rebuilt while BizTalk is processing data.</span></span> <span data-ttu-id="e93ed-140">BizTalk のインデックスを再構築する方法の詳細については、次の Microsoft サポート技術情報記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-140">For more information on how to rebuild the BizTalk indexes, see the following Microsoft Knowledge Base article:</span></span><br /><br /> <span data-ttu-id="e93ed-141">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-141">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span><br /><br /> <span data-ttu-id="e93ed-142">インデックスの断片化とワークロードの種類の詳細については、ホワイト ペーパーを参照してください。 [Microsoft SQL Server 2000 インデックスの最適化に関するベスト プラクティス](http://go.microsoft.com/fwlink/?LinkId=101580)(http://go.microsoft.com/fwlink/?LinkId=101580)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-142">For more information about index fragmentation and workload types, see the white paper [Microsoft SQL Server 2000 Index Defragmentation Best Practices](http://go.microsoft.com/fwlink/?LinkId=101580) (http://go.microsoft.com/fwlink/?LinkId=101580).</span></span> <span data-ttu-id="e93ed-143">**注:**で断片化情報を探す sys.dm_db_index_physical_stats 関数を使用することもできます[!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)]と[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-143">**Note:**  You can also use the sys.dm_db_index_physical_stats function to look for fragmentation information in [!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)] and [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)].</span></span> <span data-ttu-id="e93ed-144">詳細については、次を参照してください。 [sys.dm_db_index_physical_stats (TRANSACT-SQL)](http://go.microsoft.com/fwlink/?LinkId=158493) (http://go.microsoft.com/fwlink/?LinkId=158493)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-144">For more information, see [sys.dm_db_index_physical_stats (Transact-SQL)](http://go.microsoft.com/fwlink/?LinkId=158493) (http://go.microsoft.com/fwlink/?LinkId=158493).</span></span>|  
|<span data-ttu-id="e93ed-145">データベースのロック、ブロック、またはデッドロックの監視します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-145">Monitor the database for locks, blocks, or deadlocks</span></span>|<span data-ttu-id="e93ed-146">予期される動作のロックおよびブロックで実行するのには、[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]によって使用されるデータベース[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-146">It is an expected behavior for locks and blocks to occur on the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] databases used by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="e93ed-147">ただし、これらのロックやブロックが長時間にわたってを続行するには必要ありません。</span><span class="sxs-lookup"><span data-stu-id="e93ed-147">However, it is not expected to have these locks or blocks to continue for an extended period of time.</span></span> <span data-ttu-id="e93ed-148">拡張をブロックおよびのデッドロック、[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]によって使用されるデータベース[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]潜在的な問題の指標であります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-148">Extended blocking and deadlocking on the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] databases used by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] are indicators of a potential problem.</span></span> <span data-ttu-id="e93ed-149">デッドロックとでのブロックの原因は、現在の既知の[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]によって使用されるデータベース[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]、次の Microsoft サポート技術情報記事を確認します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-149">For the current known causes of deadlocking and blocking on the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] databases used by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], review the following Microsoft Knowledge Base article:</span></span><br /><br /> <span data-ttu-id="e93ed-150">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-150">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>|  
|<span data-ttu-id="e93ed-151">データベースとテーブルのサイズを監視します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-151">Monitor the size of databases and tables</span></span>|<span data-ttu-id="e93ed-152">サイズ、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックス データベースは、主に超えるおよそ 5 GB です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-152">The size of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Messagebox database should typically be no more than approximately 5GB.</span></span>  <span data-ttu-id="e93ed-153">BizTalkMsgBoxDb データベースは、任意のデータを保持することはできませんし、データが処理または BizTalkDTADb データベースに移動するまでバッファーを考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-153">The BizTalkMsgBoxDb database should not be holding any data, and should be considered a buffer until the data is processed or moved to the BizTalkDTADb database.</span></span> <span data-ttu-id="e93ed-154">強力な SQL Server のバックエンドと多数の長時間実行オーケストレーションを含む環境では、5 GB を超える BizTalkMsgBoxDb データベースがあります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-154">An environment with a powerful SQL Server backend and numerous long running orchestrations may have a BizTalkMsgBoxDb database larger than 5GB.</span></span> <span data-ttu-id="e93ed-155">ありません長時間のオーケストレーションと頻度の高い環境が必要な[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]5 GB よりはるかに小さいメッセージ ボックス データベースです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-155">A high volume environment with no long-running orchestrations should have a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Messagebox database much smaller than 5GB.</span></span> <span data-ttu-id="e93ed-156">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]サイズを大幅に変更できる追跡データベースが、クエリのパフォーマンスが大幅に低下する場合、追跡データベースがおそらくが大きすぎます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-156">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking database can vary greatly in size but if query performance decreases dramatically, then the tracking database is probably too large.</span></span> <span data-ttu-id="e93ed-157">原則として、として、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]追跡データベースを超える 15 ~ 20 GB が大きすぎると見なされ、パフォーマンスに悪影響を及ぼす可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-157">As a rule of thumb, a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking database larger than 15-20 GB is considered too large and may adversely impact performance.</span></span> <span data-ttu-id="e93ed-158">次の問題に起因する場合があります[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]が大きすぎるデータベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-158">The following issues may be attributable to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases that are too large:</span></span><br /><br /> <span data-ttu-id="e93ed-159">-[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックス データベースがアプリケーションを大規模な状態に維持したまま、データのサイズ (ログ ファイルだけでなく) に増加し続けます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-159">-   The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Messagebox database continues to grow while the data size (not just the log file) remains large.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="e93ed-160">単純なメッセージ フローのシナリオでも処理に通常よりも長い時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-160"> takes a longer time than normal to process even a simple message flow scenario.</span></span><br /><span data-ttu-id="e93ed-161">グループ ハブ クエリでは、通常よりも長い時間がかかるし、偶数のタイムアウトの可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-161">-   Group Hub queries take a longer time than normal and may even timeout.</span></span><br /><span data-ttu-id="e93ed-162">-データベースのログ ファイルは決して切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-162">-   The database log file never gets truncated.</span></span><br /><span data-ttu-id="e93ed-163">-BizTalk SQL エージェント ジョブが通常よりも低速に実行します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-163">-   The BizTalk SQL Agent jobs run slower than normal.</span></span><br /><span data-ttu-id="e93ed-164">-一部のテーブルがかなり大きくまたは normal あまり多くの行を比較します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-164">-   Some tables are considerably large or have too many rows compared to normal.</span></span><br /><br /> <span data-ttu-id="e93ed-165">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]いくつかの理由を含むデータベースが大きくなることができます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-165">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases can become large for several reasons including:</span></span><br /><br /> <span data-ttu-id="e93ed-166">BizTalk SQL エージェント ジョブが実行されていません</span><span class="sxs-lookup"><span data-stu-id="e93ed-166">-   BizTalk SQL Agent Jobs not running</span></span><br /><span data-ttu-id="e93ed-167">-過度の保留メッセージやサービス インスタンス</span><span class="sxs-lookup"><span data-stu-id="e93ed-167">-   Excessive suspended message or service instances</span></span><br /><span data-ttu-id="e93ed-168">ディスクの障害</span><span class="sxs-lookup"><span data-stu-id="e93ed-168">-   Disk failures</span></span><br /><span data-ttu-id="e93ed-169">-高レベルの追跡</span><span class="sxs-lookup"><span data-stu-id="e93ed-169">-   High levels of tracking</span></span><br /><span data-ttu-id="e93ed-170">-   [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]調整</span><span class="sxs-lookup"><span data-stu-id="e93ed-170">-   [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] throttling</span></span><br /><span data-ttu-id="e93ed-171">-低下[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]パフォーマンス</span><span class="sxs-lookup"><span data-stu-id="e93ed-171">-   Poor [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] performance</span></span><br /><span data-ttu-id="e93ed-172">ネットワーク待機時間に関する問題</span><span class="sxs-lookup"><span data-stu-id="e93ed-172">-   Network latency issues</span></span><br /><br /> <span data-ttu-id="e93ed-173">同様に、テーブルの行が多すぎることができます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-173">Similarly, you can have too many rows in a table.</span></span> <span data-ttu-id="e93ed-174">セットの数が多すぎて行はありません。</span><span class="sxs-lookup"><span data-stu-id="e93ed-174">There is no set number of rows that are too many.</span></span> <span data-ttu-id="e93ed-175">さらに、この行の数は、どのような種類のデータがテーブルに格納されているによって異なります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-175">Additionally, this number of rows varies by what kind of data is stored in the table.</span></span> <span data-ttu-id="e93ed-176">たとえば、 *dta_DebugTrace*おそらく 100万を超える行を持つテーブルに行が多すぎます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-176">For example, a *dta_DebugTrace* table that has more than 1 million rows probably has too many rows.</span></span> <span data-ttu-id="e93ed-177">A *HostNameQ_Suspended*おそらく 200,000 台を超える行を持つテーブルに行が多すぎます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-177">A *HostNameQ_Suspended* table that has more than 200,000 rows probably has too many rows.</span></span><br /><br /> <span data-ttu-id="e93ed-178">期待される環境でデータの問題が発生しているかどうかを決定するを理解していることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-178">Make sure that you know what is expected in your environment to determine whether a data issue is occurring.</span></span>|  
|<span data-ttu-id="e93ed-179">追跡を有効にする[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ホスト</span><span class="sxs-lookup"><span data-stu-id="e93ed-179">Enable tracking on [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host</span></span>|<span data-ttu-id="e93ed-180">既定では、既定のホストの追跡が有効にします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-180">By default, tracking is enabled on the default host.</span></span> <span data-ttu-id="e93ed-181">BizTalk が必要です、**ホストの追跡を許可する**1 つのホストでオプションを確認します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-181">BizTalk requires the **Allow Host Tracking** option be checked on a single HOST.</span></span> <span data-ttu-id="e93ed-182">Tracking Data Decode Service (TDDS) が、追跡を移動の追跡を有効にするからのイベント データ、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]をメッセージ ボックス データベース、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースを追跡します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-182">When tracking is enabled, the Tracking Data Decode Service (TDDS) moves the tracking event data from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Messagebox database to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking database.</span></span> <span data-ttu-id="e93ed-183">ない場合は[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]をオプションでホストが構成されている**ホストの追跡を許可する**や追跡ホストを停止すると、TDDS は実行されず TrackingData_x_x テーブル、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]メッセージ ボックス データベースがチェックされていない拡張.</span><span class="sxs-lookup"><span data-stu-id="e93ed-183">If no [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] hosts are configured with the option to **Allow Host Tracking** or if the tracking host is stopped, then TDDS will not run and the TrackingData_x_x tables in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Messagebox database will grow unchecked.</span></span> <span data-ttu-id="e93ed-184">そのため、専用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]をオプションでホストを構成する必要があります**ホストの追跡を許可する**です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-184">Therefore, a dedicated [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host should be configured with the option to **Allow Host Tracking**.</span></span> <span data-ttu-id="e93ed-185">専用の追跡ホストの構成の詳細については、次を参照してください。[専用追跡ホストの構成](~/technical-guides/configuring-a-dedicated-tracking-host.md)です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-185">For more information about configuring a dedicated tracking host see [Configuring a Dedicated Tracking Host](~/technical-guides/configuring-a-dedicated-tracking-host.md).</span></span> <span data-ttu-id="e93ed-186">**注:**頻度の高いシナリオで新しい追跡イベントを維持するために TDDS を許可するのには、1 つの追跡ホストの複数のインスタンスを作成できますが、2 つ以上のホストは、追跡を構成してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-186">**Note:**  To allow TDDS to maintain new tracking events in high volume scenarios, you can create multiple instances of a single tracking host but no more than one host should be configured for tracking.</span></span>|  
|<span data-ttu-id="e93ed-187">適切な BizTalk SQL Server エージェント ジョブを使用します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-187">Use the correct BizTalk SQL Server Agent jobs</span></span>|<span data-ttu-id="e93ed-188">実行、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] SQL エージェント ジョブが管理するために重要な[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースおよび最適なパフォーマンスを維持するためです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-188">Execution of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] SQL Agent jobs are crucial for managing the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases and for maintaining optimal performance.</span></span><br /><br /> <span data-ttu-id="e93ed-189">-**バックアップ[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]**をバックアップする唯一のサポートされているメソッドは、SQL Server エージェント ジョブ、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-189">-   The  **Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]** SQL Server Agent job is the only supported method to back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span> <span data-ttu-id="e93ed-190">このジョブでは、すべてを設定する必要があります[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]完全復旧モデルを使用するデータベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-190">This job requires you to set up all [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases to use a Full Recovery Model.</span></span> <span data-ttu-id="e93ed-191">正常なは、このジョブを構成する必要があります[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。</span><span class="sxs-lookup"><span data-stu-id="e93ed-191">You should configure this job for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="e93ed-192">バックアップする SQL Server メソッドを使用することができます、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースおよび SQL Server サービスが停止している場合にのみ、すべて[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]プロセスが停止します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-192">You can use the SQL Server methods to back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases only if the SQL Server service is stopped and if all [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processes are stopped.</span></span> <span data-ttu-id="e93ed-193">**注:** SQL エージェントのバックアップを構成するときに、SQL Server の完全復旧モデルを使用しての詳細については[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ジョブを参照してください[ログ配布](http://go.microsoft.com/fwlink/?LinkId=153450)(http://go.microsoft.com/fwlink/?LinkId = 153450) または[完全復旧モデルでバックアップ](http://go.microsoft.com/fwlink/?LinkId=156509)(http://go.microsoft.com/fwlink/?LinkId = 156509)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-193">**Note:**      For more information about using the SQL Server full recovery model when configuring the SQL Agent Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job, see [Log Shipping](http://go.microsoft.com/fwlink/?LinkId=153450) (http://go.microsoft.com/fwlink/?LinkId=153450) or [Backup Under the Full Recovery Model](http://go.microsoft.com/fwlink/?LinkId=156509) (http://go.microsoft.com/fwlink/?LinkId=156509).</span></span><br /><span data-ttu-id="e93ed-194">- **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが無期限に実行するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="e93ed-194">-   The **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server Agent job is designed to run indefinitely.</span></span> <span data-ttu-id="e93ed-195">その結果、SQL エージェント ジョブ履歴ことは必ずしもこの SQL エージェント ジョブが正常に完了したことです。この動作は仕様です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-195">As a result the SQL Agent job history may not indicate that this SQL Agent job has successfully completed; this behavior is by design.</span></span> <span data-ttu-id="e93ed-196">エラーがある場合、ジョブが 1 分以内に再起動し、低下の実行を継続します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-196">If there is a failure, the job will restart within 1 minute and continue running unabated.</span></span> <span data-ttu-id="e93ed-197">そのため、このジョブの障害の発生の通知は通常無視できます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-197">Therefore, failure notifications for this job can typically be ignored.</span></span> <span data-ttu-id="e93ed-198">MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb SQL Server エージェント ジョブのジョブ履歴には、このジョブは常に失敗しました、再起動することが示されている場合、失敗/再起動サイクルの原因の詳細な調査必要があります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-198">If the job history for the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb SQL Server Agent job indicates that this job is constantly failing and restarting then further investigation into the cause of the failure/restart cycle may be required.</span></span><br /><span data-ttu-id="e93ed-199">- **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** SQL Server エージェント ジョブはのみジョブを手動で有効にできません MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb ジョブによって開始されたためです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-199">-   The **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** SQL Server Agent job is the only job that should not be manually enabled because it is initiated by the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job.</span></span><br /><span data-ttu-id="e93ed-200">- **DTA Purge and Archive** SQL Server エージェント ジョブを維持、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]消去および追跡メッセージをアーカイブして、データベースを追跡します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-200">-   The **DTA Purge and Archive** SQL Server Agent job maintains the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking database by purging and archiving tracked messages.</span></span> <span data-ttu-id="e93ed-201">このジョブは、テーブル内のすべての行を読み取るし、かどうか、レコードを削除するかを決定する各行のタイムスタンプを比較します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-201">This job reads every row in the table and compares the timestamp of each row to determine if the record should be removed.</span></span> <span data-ttu-id="e93ed-202">**注:**トラブルシューティングを行うとき、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] SQL Server エージェント ジョブでは、エラーなし、MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb を除くすべての SQL エージェント ジョブが完了することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-202">**Note:**  When troubleshooting the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] SQL Server Agent jobs, verify that all SQL Agent jobs except the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb are completing without errors.</span></span> <br /><br /> <span data-ttu-id="e93ed-203">詳細については、[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]に使用される SQL エージェント ジョブ[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="e93ed-203">For more information about the [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] SQL Agent Jobs used in [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]:</span></span><br /><br /> <span data-ttu-id="e93ed-204">-参照[データベース構造とジョブ](http://go.microsoft.com/fwlink/?LinkId=153451)(http://go.microsoft.com/fwlink/?LinkId=153451)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-204">-   See [Database Structure and Jobs](http://go.microsoft.com/fwlink/?LinkId=153451) (http://go.microsoft.com/fwlink/?LinkId=153451).</span></span><br /><span data-ttu-id="e93ed-205">-参照[BizTalk Server のジョブの SQL Server エージェントの説明](http://go.microsoft.com/fwlink/?LinkId=153452)(http://go.microsoft.com/fwlink/?LinkId=153452)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-205">-   See [Description of the SQL Server Agent jobs in BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153452) (http://go.microsoft.com/fwlink/?LinkId=153452).</span></span>|  
|<span data-ttu-id="e93ed-206">監視して中断されたインスタンスを終了します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-206">Monitor and terminate suspended instances</span></span>|<span data-ttu-id="e93ed-207">サービス インスタンスの中断 (再開可能) または中断 (再開不可) ことができます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-207">Service instances can be suspended (resumable) or suspended (not resumable).</span></span> <span data-ttu-id="e93ed-208">これらのサービス インスタンスには、メッセージング、オーケストレーション、またはポートがあります。</span><span class="sxs-lookup"><span data-stu-id="e93ed-208">These service instances may be Messaging, Orchestration, or Port.</span></span> [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]<span data-ttu-id="e93ed-209">[グループ ハブ] ページを使用して終了し、これらのインスタンスの削除に対応、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールまたは Terminate.vbs スクリプトを使用しています。</span><span class="sxs-lookup"><span data-stu-id="e93ed-209"> accommodates termination and removal of these instances by using the Group Hub page in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console or through the use of the Terminate.vbs script.</span></span> <span data-ttu-id="e93ed-210">Terminate.vbs スクリプトの詳細については、次を参照してください。[中断サービス インスタンスを削除する](http://go.microsoft.com/fwlink/?LinkId=153453)(http://go.microsoft.com/fwlink/?LinkId=153453)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-210">For more information about the Terminate.vbs script, see [Removing Suspended Service Instance](http://go.microsoft.com/fwlink/?LinkId=153453) (http://go.microsoft.com/fwlink/?LinkId=153453).</span></span> <span data-ttu-id="e93ed-211">**ヒント:**中断されたインスタンスを削除する、ターミネータ ツールを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-211">**Tip:**  You can also use the Terminator tool to remove suspended instances.</span></span> <span data-ttu-id="e93ed-212">[ターミネータ ツール](http://go.microsoft.com/fwlink/?LinkId=151931)は、「 [http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931)です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-212">The [Terminator tool](http://go.microsoft.com/fwlink/?LinkId=151931) is available at [http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931).</span></span> <span data-ttu-id="e93ed-213">、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関して保証を行いません。</span><span class="sxs-lookup"><span data-stu-id="e93ed-213">Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="e93ed-214">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-214">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="e93ed-215">用語「孤立アイテム」と「ゾンビ」は、同じ意味で使用されます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-215">The terms "orphans” and "zombies" are often used interchangeably.</span></span> <span data-ttu-id="e93ed-216">またはゾンビの孤立したメッセージは、メッセージがない関連付けられているサービス インスタンス、通常、メッセージを受け取る前に、サービス インスタンスが終了したためです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-216">An orphaned or zombie message is a message that does not have an associated service instance, typically because the service instance has terminated before the message was received.</span></span> <span data-ttu-id="e93ed-217">孤立したやゾンビ サービスは、サービス、関連するメッセージがないです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-217">An orphaned or zombie service is a service that does not have any associated messages.</span></span> <span data-ttu-id="e93ed-218">ゾンビ メッセージおよびサービス インスタンスの詳細については[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]を参照してください[BizTalk Server のゾンビ](http://go.microsoft.com/fwlink/?LinkId=153454)(http://go.microsoft.com/fwlink/?LinkId=153454)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-218">For more information about zombie messages and service instances in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] see [Zombies in BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153454) (http://go.microsoft.com/fwlink/?LinkId=153454).</span></span>|  
|<span data-ttu-id="e93ed-219">パフォーマンス カウンターを監視、 **PhysicalDisk**パフォーマンス オブジェクト</span><span class="sxs-lookup"><span data-stu-id="e93ed-219">Monitor the performance counters of the **PhysicalDisk** performance object</span></span>|[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="e93ed-220">1 分以内で SQL Server への多数の非常に高速、短いトランザクションを作成します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-220"> makes a large number of short, very quick transactions to SQL Server within one minute.</span></span> <span data-ttu-id="e93ed-221">発生する可能性が場合は、SQL Server は、このアクティビティに耐えることはできません、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]パフォーマンスの問題です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-221">If the SQL Server cannot sustain this activity, you may experience [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] performance issues.</span></span> <span data-ttu-id="e93ed-222">モニター、 **avg.Disk Sec/read**、 **avg.Disk Sec/transfer**、および**avg.ディスク書き込み秒数**パフォーマンス モニター カウンター、 **PhysicalDisk**パフォーマンス オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-222">Monitor the **Avg. Disk sec/Read**, **Avg. Disk sec/Transfer**, and **Avg. Disk sec/Write** performance monitor counters in the **PhysicalDisk** performance object.</span></span> <span data-ttu-id="e93ed-223">最適な値は、10 ミリ秒未満 (ミリ秒) です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-223">The optimal value is less than 10 ms (milliseconds).</span></span> <span data-ttu-id="e93ed-224">以上 20 ミリ秒の値は、パフォーマンスの低下と見なされます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-224">A value of 20 ms or larger is considered poor performance.</span></span><br /><br /> <span data-ttu-id="e93ed-225">-SQL Server 2005 のパフォーマンスに関する詳細についてを参照してください[SQL Server 2005 でのパフォーマンス問題のトラブルシューティング](http://go.microsoft.com/fwlink/?LinkID=153585)(http://go.microsoft.com/fwlink/?LinkID=153585)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-225">-   For more information about SQL Server 2005 performance, see [Troubleshooting Performance Problems in SQL Server 2005](http://go.microsoft.com/fwlink/?LinkID=153585) (http://go.microsoft.com/fwlink/?LinkID=153585).</span></span><br /><span data-ttu-id="e93ed-226">-SQL Server 2008 のパフォーマンスに関する詳細についてを参照してください[SQL Server 2008 でのパフォーマンス問題のトラブルシューティング](http://go.microsoft.com/fwlink/?LinkID=153586)(http://go.microsoft.com/fwlink/?LinkID=153586)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-226">-   For more information about SQL Server 2008 performance, see [Troubleshooting Performance Problems in SQL Server 2008](http://go.microsoft.com/fwlink/?LinkID=153586) (http://go.microsoft.com/fwlink/?LinkID=153586).</span></span><br /><span data-ttu-id="e93ed-227">、詳細については[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]データベースの高可用性を参照してください[BizTalk Server データベースの高可用性の実現](http://go.microsoft.com/fwlink/?LinkId=153587)(http://go.microsoft.com/fwlink/?LinkId=153587)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-227">-   For more information about [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] database high availability, see [Providing High Availability for BizTalk Server Databases](http://go.microsoft.com/fwlink/?LinkId=153587) (http://go.microsoft.com/fwlink/?LinkId=153587).</span></span><br /><br /> <span data-ttu-id="e93ed-228">SQL Server のパフォーマンスの詳細については、次の Microsoft サポート技術情報記事を参照することもできます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-228">You can also refer to the following Microsoft Knowledge Base articles for more information about SQL Server performance:</span></span><br /><br /> <span data-ttu-id="e93ed-229">-   **298475** – [「SQL Server のパフォーマンスの問題をトラブルシューティングする方法」](http://go.microsoft.com/fwlink/?LinkId=153588) (http://go.microsoft.com/fwlink/?LinkId=153588)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-229">-   **298475** – ["How to troubleshoot SQL Server performance issues”](http://go.microsoft.com/fwlink/?LinkId=153588) (http://go.microsoft.com/fwlink/?LinkId=153588).</span></span><br /><span data-ttu-id="e93ed-230">-   **271509** – [「SQL Server 2005 でのブロックを監視する方法」](http://go.microsoft.com/fwlink/?LinkId=153589) (http://go.microsoft.com/fwlink/?LinkId=153589)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-230">-   **271509** – ["How to monitor blocking in SQL Server 2005"](http://go.microsoft.com/fwlink/?LinkId=153589) (http://go.microsoft.com/fwlink/?LinkId=153589).</span></span>|  
|<span data-ttu-id="e93ed-231">ベスト プラクティスに従う[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-231">Follow best practices for [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>|<span data-ttu-id="e93ed-232">参照してください[BizTalk Server データベースを維持するためのベスト プラクティス](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-232">See [Best Practices for Maintaining BizTalk Server Databases](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md).</span></span>|  
  
<a name="BKMK_Troubleshoot"></a>   
## <a name="troubleshooting-biztalk-server-databases"></a><span data-ttu-id="e93ed-233">BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="e93ed-233">Troubleshooting BizTalk Server Databases</span></span>  
 <span data-ttu-id="e93ed-234">に関する問題のトラブルシューティングを行うには、次のタスク実行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-234">Perform the following tasks to troubleshoot any issues with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>  
  
|<span data-ttu-id="e93ed-235">手順</span><span class="sxs-lookup"><span data-stu-id="e93ed-235">Steps</span></span>|<span data-ttu-id="e93ed-236">リファレンス</span><span class="sxs-lookup"><span data-stu-id="e93ed-236">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="e93ed-237">必要なすべての BizTalk SQL Server エージェント ジョブを有効にして実行されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-237">Ensure all required BizTalk SQL Server Agent jobs are enabled and running</span></span>|<span data-ttu-id="e93ed-238">すべての BizTalk SQL Server エージェントのジョブを除く、 **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb**ジョブ必要がありますで実行されていて正常にします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-238">All the BizTalk SQL Server Agent jobs except the **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** job should be enabled and running successfully.</span></span> <span data-ttu-id="e93ed-239">その他の任意のジョブを無効にしないでください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-239">Do not disable any other job.</span></span><br /><br /> <span data-ttu-id="e93ed-240">障害が発生する場合を使用して、**履歴を表示する**SQL Server のエラー情報を表示し、それに応じて、失敗のトラブルシューティングのオプションです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-240">If a failure occurs, use the **View History** option in SQL Server to view the error information, and then troubleshoot the failure accordingly.</span></span> <span data-ttu-id="e93ed-241">注意して、 **MessageBox _Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが無限に実行されます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-241">Remember that the **MessageBox _Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server Agent job runs infinitely.</span></span> <span data-ttu-id="e93ed-242">したがって、おく必要がありますのみジョブ ヒストリをレポート ジョブが常に失敗し、再起動するときは注意します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-242">Therefore, you should only be concerned if the job history reports that the job constantly fails and restarts.</span></span>|  
|<span data-ttu-id="e93ed-243">MsgBoxViewer ツールを使用して、BizTalk メッセージ ボックス データベースとその他のデータベースの分析</span><span class="sxs-lookup"><span data-stu-id="e93ed-243">Use the MsgBoxViewer tool to analyze the BizTalk MessageBox and other databases</span></span>|<span data-ttu-id="e93ed-244">**重要:** Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関して保証を行いません。</span><span class="sxs-lookup"><span data-stu-id="e93ed-244">**Important:**  Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="e93ed-245">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-245">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="e93ed-246">MsgBoxViewer ツールはから利用可能な[http://go.microsoft.com/fwlink/?LinkId=151930](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-246">The MsgBoxViewer tool is available from [http://go.microsoft.com/fwlink/?LinkId=151930](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930).</span></span> <span data-ttu-id="e93ed-247">MsgBoxViewer ツールは、テーブルのサイズと、行の数の詳細については、html 形式のレポートを提供するためのトラブルシューティングに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-247">The MsgBoxViewer tool is useful for troubleshooting because it provides an HTML report that has detailed information about table sizes and the row count.</span></span> <span data-ttu-id="e93ed-248">レポートにも役立ちますを決定するかどうか[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]調整です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-248">The report can also help determine whether [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is throttling.</span></span> <span data-ttu-id="e93ed-249">さらに、ツールは、のスナップショット、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースおよび[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]構成します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-249">Additionally, the tool provides a snapshot of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases and the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] configuration.</span></span><br /><br /> <span data-ttu-id="e93ed-250">ときに[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]は MsgBoxViewer ツールを実行して、通常より時間がかかります実行上のすべてのクエリを選択する をクリックして、**省略可能なクエリ**タブをクリックし、問題に生成された HTML レポートを確認します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-250">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is running slower than usual, run the MsgBoxViewer tool, click to select all queries on the **Optional Queries** tab, and then review the generated HTML report for any problems.</span></span> <span data-ttu-id="e93ed-251">**概要レポート**セクションには、黄色、および潜在的な問題は赤色で警告が一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-251">The **Summary Report** section lists warnings in yellow and potential problems in red.</span></span><br /><br /> <span data-ttu-id="e93ed-252">さらに、テーブルは、最大規模およびほとんどのレコードがある判別を MsgBoxViewer ツールを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-252">Additionally, you can use the MsgBoxViewer tool to determine which tables are the largest and have the most records.</span></span> <span data-ttu-id="e93ed-253">通常、larges を拡大テーブルの一覧とそれらのテーブルを管理する方法の手順を参照してください。 [BizTalk Server データベース テーブルの大きな増加](~/technical-guides/large-growing-biztalk-server-database-tables.md)です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-253">For a list of tables that typically grow the larges and for instructions on how to manage those tables, see [Large-growing BizTalk Server Database Tables](~/technical-guides/large-growing-biztalk-server-database-tables.md).</span></span>|  
|<span data-ttu-id="e93ed-254">ツールを使用して、終端記号の問題を解決 MsgBoxViewer ツールによって、識別された場合</span><span class="sxs-lookup"><span data-stu-id="e93ed-254">Use the Terminator tool to resolve issues, if any, identified by the MsgBoxViewer tool</span></span>|<span data-ttu-id="e93ed-255">**重要:** Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関して保証を行いません。</span><span class="sxs-lookup"><span data-stu-id="e93ed-255">**Important:**  Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="e93ed-256">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-256">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="e93ed-257">使用可能なターミネータ ツールを実行して[ターミネータ](http://go.microsoft.com/fwlink/?LinkId=151931)(http://go.microsoft.com/fwlink/?LinkId=151931)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-257">Run the Terminator tool available at [Terminator](http://go.microsoft.com/fwlink/?LinkId=151931) (http://go.microsoft.com/fwlink/?LinkId=151931).</span></span> <span data-ttu-id="e93ed-258">このツールでは、簡単に BizTalk MsgBoxViewer ツールによって識別される問題を解決することができます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-258">This tool enables users to easily resolve any issues identified by the BizTalk MsgBoxViewer tool.</span></span> <span data-ttu-id="e93ed-259">ターミネータ ツールが、BizTalk MsgBoxViewer ツールと統合する方法の詳細については、次を参照してください。 [BizTalk MsgBoxViewer によって特定された問題を解決するには BizTalk のターミネータを使用して](http://go.microsoft.com/fwlink/?LinkId=151932)(http://go.microsoft.com/fwlink/?LinkId=151932)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-259">For more information on how the Terminator tool integrates with the BizTalk MsgBoxViewer tool, see [Using BizTalk Terminator to resolve issues identified by BizTalk MsgBoxViewer](http://go.microsoft.com/fwlink/?LinkId=151932) (http://go.microsoft.com/fwlink/?LinkId=151932).</span></span>|  
|<span data-ttu-id="e93ed-260">デッドロックのシナリオを調査します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-260">Investigate deadlock scenarios</span></span>|<span data-ttu-id="e93ed-261">シナリオでは、デッドロック、デッドロック情報が、SQLERROR ログに書き込まれるように、SQL Server 上で DBCC の追跡を有効にします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-261">In a deadlock scenario, enable DBCC tracing on the SQL Server so that the deadlock information is written to the SQLERROR log.</span></span><br /><br /> <span data-ttu-id="e93ed-262">SQL Server 2008 または SQL Server 2005 では、デッドロックのシナリオの DBCC トレースを有効にするのには、次のステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-262">In SQL Server 2008 or SQL Server 2005, execute the following statement to enable DBCC tracing for deadlock scenarios:</span></span><br /><br /> <span data-ttu-id="e93ed-263">DBCC TRACEON (1222、-1)</span><span class="sxs-lookup"><span data-stu-id="e93ed-263">DBCC TRACEON (1222,-1)</span></span><br /><br /> <span data-ttu-id="e93ed-264">PSSDIAG ユーティリティを使用してデータを収集する、 **Lock:deadlock**イベントおよび**Lock:deadlock Chain**イベント。</span><span class="sxs-lookup"><span data-stu-id="e93ed-264">You can also use the PSSDIAG utility to collect data on the **Lock:Deadlock** event and the **Lock:Deadlock Chain** event.</span></span> <span data-ttu-id="e93ed-265">PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-265">For more information about the PSSDIAG utility, see [PSSDIAG data collection utility](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).</span></span><br /><br /> <span data-ttu-id="e93ed-266">BizTalkMsgBoxDB データベースは、大量の高いトランザクション オンライン トランザクション処理 (OLTP) データベースです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-266">The BizTalkMsgBoxDB database is a high-volume and high-transaction Online Transaction Processing (OLTP) database.</span></span> <span data-ttu-id="e93ed-267">そのようなデータベースのデッドロックの一部が予想され、によって内部的に処理は、このデッドロック、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]エンジンです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-267">With such databases, some deadlocking is expected and this deadlocking is handled internally by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] engine.</span></span> <span data-ttu-id="e93ed-268">この現象が発生したときに、エラー ログでエラーは表示されません。</span><span class="sxs-lookup"><span data-stu-id="e93ed-268">When this behavior occurs, no errors are listed in the error logs.</span></span> <span data-ttu-id="e93ed-269">デッドロックのシナリオを調査するときに、出力で調査している場合、デッドロックする必要がありますと相関しているイベント ログでデッドロック エラーです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-269">When you investigate a deadlock scenario, the deadlock that you are investigating in the output must be correlated with a deadlock error in the event logs.</span></span>|  
|<span data-ttu-id="e93ed-270">ブロックされたプロセスを探します</span><span class="sxs-lookup"><span data-stu-id="e93ed-270">Look for blocked processes</span></span>|<span data-ttu-id="e93ed-271">SQL Server の利用状況モニターを使用すると、ロックのシステム プロセスのサーバー プロセス識別子 (SPID) を取得します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-271">You can use Activity Monitor in SQL Server to obtain the server process identifier (SPID) of a locking system process.</span></span> <span data-ttu-id="e93ed-272">ロックの SPID で実行されている SQL ステートメントに SQL Profiler を実行することができます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-272">You can then run the SQL Profiler to determine the SQL statement that is executing in the locking SPID.</span></span> <span data-ttu-id="e93ed-273">PSSDIAG ユーティリティを使用すると、SQL Server のロックおよびブロックしている問題をトラブルシューティングします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-273">You can use the PSSDIAG utility to troubleshoot locking and blocking issues in SQL Server.</span></span> <span data-ttu-id="e93ed-274">ユーティリティは、有効になっているスクリプトのブロックを持つすべての TRANSACT-SQL イベントをキャプチャします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-274">The utility captures all the Transact-SQL events that have the blocking script enabled.</span></span> <span data-ttu-id="e93ed-275">PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-275">For more information about the PSSDIAG utility, see [PSSDIAG data collection utility](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).</span></span><br /><br /> <span data-ttu-id="e93ed-276">SQL Server 2005 およびそれ以降のバージョンで指定できます、**プロセスのしきい値をブロック**SPID または Spid を指定したしきい値よりも長くブロックしているを確認する設定。</span><span class="sxs-lookup"><span data-stu-id="e93ed-276">In SQL Server 2005 and later versions, you can specify the **blocked process threshold** setting to determine which SPID or SPIDs are blocking longer than the threshold that you specify.</span></span> <span data-ttu-id="e93ed-277">Blocked process threshold オプションの詳細については、次を参照してください。 [blocked process threshold オプション](http://go.microsoft.com/fwlink/?LinkId=153628)(http://go.microsoft.com/fwlink/?LinkId=153628)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-277">For more information about the blocked process threshold option, see [blocked process threshold Option](http://go.microsoft.com/fwlink/?LinkId=153628) (http://go.microsoft.com/fwlink/?LinkId=153628).</span></span> <span data-ttu-id="e93ed-278">**注:**マイクロソフト カスタマー サポート サービスにお問い合わせくださいを SQL Server でのロックまたはブロックしている問題が発生した場合にお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-278">**Note:**  When you experience a locking or blocking issue in SQL Server, we recommend that you contact Microsoft Customer Support Services.</span></span> <span data-ttu-id="e93ed-279">Microsoft カスタマー サポート サービスには、正しい PSSDiag ユーティリティのオプションを構成するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="e93ed-279">Microsoft Customer Support Services can help you configure the correct PSSDiag utility options.</span></span>|  
|<span data-ttu-id="e93ed-280">すべての不要なデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-280">Delete all unwanted data</span></span>|<span data-ttu-id="e93ed-281">データベースが大きくなりすぎたために拡大している場合、データベースに含まれるデータは必要ありませんできなくなった場合は、データを削除することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e93ed-281">If the databases have grown to become too large and if the data contained in the databases will not be required any longer, the preferred method is to delete the data.</span></span> <span data-ttu-id="e93ed-282">**注意:**使用しないでくださいこのメソッドすべての環境でデータがビジネス上重要またはデータが必要なかどうかを格納します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-282">**Caution:**  Do not use this method in any environment where the data is business critical or if the data is needed.</span></span> <br /><br /> <span data-ttu-id="e93ed-283">**BizTalkMsgBox データベースを消去するには**</span><span class="sxs-lookup"><span data-stu-id="e93ed-283">**To purge the BizTalkMsgBox database**</span></span><br /> <span data-ttu-id="e93ed-284">1.ダウンロードしてインストールでは、ターミネータ ツール[Biztalk 終端記号](http://go.microsoft.com/fwlink/?LinkId=220869)(http://go.microsoft.com/fwlink/?LinkId=220869)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-284">1.  Download and install the Terminator tool at [Biztalk Terminator](http://go.microsoft.com/fwlink/?LinkId=220869) (http://go.microsoft.com/fwlink/?LinkId=220869).</span></span><br /><span data-ttu-id="e93ed-285">2.トピックの手順に従って[テスト環境でメッセージ ボックス データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkID=158064)(http://go.microsoft.com/fwlink/?LinkID=158064) を作成、bts_CleanupMsgbox ストアド プロシージャを BizTalk メッセージ ボックス データベースです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-285">2.  Follow the steps in the topic [How to Manually Purge Data from the MessageBox Database in a Test Environment](http://go.microsoft.com/fwlink/?LinkID=158064) (http://go.microsoft.com/fwlink/?LinkID=158064) to create the bts_CleanupMsgbox stored procedure in the BizTalk MessageBox database.</span></span><br /><span data-ttu-id="e93ed-286">3.ターミネータ ツールを使用して、bts_CleanupMsgbox ストアド プロシージャを実行して、BizTalk メッセージ ボックス データベースを削除します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-286">3.  Use the Terminator tool to execute the bts_CleanupMsgbox stored procedure and purge the BizTalk MessageBox database.</span></span> <span data-ttu-id="e93ed-287">**警告:** BizTalk Server を実行している実稼働サーバーで、bts_CleanupMsgbox ストアド プロシージャを実行しないでください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-287">**Warning:**      Do not run the bts_CleanupMsgbox stored procedure on a production server that is running BizTalk Server.</span></span> <span data-ttu-id="e93ed-288">bts_CleanupMsgbox ストアド プロシージャは、テスト環境でのみ実行してください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-288">You should only run the bts_CleanupMsgbox stored procedure in a test environment.</span></span> <span data-ttu-id="e93ed-289">運用環境での bts_CleanupMsgbox ストアド プロシージャの実行はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="e93ed-289">Running the bts_CleanupMsgbox stored procedure in a production environment is not supported.</span></span><br /><span data-ttu-id="e93ed-290">4.すべてのホストを再起動し、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] services です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-290">4.  Restart all hosts and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] services.</span></span><br /><br /> <span data-ttu-id="e93ed-291">**BizTalkDTADb データベースを消去するには**</span><span class="sxs-lookup"><span data-stu-id="e93ed-291">**To purge the BizTalkDTADb database**</span></span><br /> <ul><li><span data-ttu-id="e93ed-292">**方法 1**</span><span class="sxs-lookup"><span data-stu-id="e93ed-292">**Method 1**</span></span><br /><br /> <ol><li><span data-ttu-id="e93ed-293">すべてをバックアップ[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-293">Back up all [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span></li><li><span data-ttu-id="e93ed-294">実行、 **[dtasp_purgeallcompletedtrackingdata]**ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-294">Execute the **dtasp_PurgeAllCompletedTrackingData** stored procedure.</span></span> <span data-ttu-id="e93ed-295">ストアド プロシージャの詳細については、次を参照してください。 [BizTalk 追跡データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkId=153635)(http://go.microsoft.com/fwlink/?LinkId=153635)。</span><span class="sxs-lookup"><span data-stu-id="e93ed-295">For more information about the stored procedure, see [How to Manually Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkId=153635) (http://go.microsoft.com/fwlink/?LinkId=153635).</span></span></li></ol></li><li><span data-ttu-id="e93ed-296">**方法 2**です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-296">**Method 2**.</span></span> <span data-ttu-id="e93ed-297">BizTalkDTADb データベースには、削除する必要がある多くの不完全なインスタンスが含まれている場合にのみ、このオプションを使用します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-297">Use this option only if the BizTalkDTADb database contains many incomplete instances that must be removed.</span></span><br /><br /> <ol><li><span data-ttu-id="e93ed-298">すべてをバックアップ[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース。</span><span class="sxs-lookup"><span data-stu-id="e93ed-298">Back up all [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span></li><li><span data-ttu-id="e93ed-299">すべての BizTalk ホスト、サービス、およびカスタム分離アダプターを停止します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-299">Stop all BizTalk hosts, services, and custom isolated adapters.</span></span> <span data-ttu-id="e93ed-300">HTTP アダプタまたは SOAP アダプタを使用する場合は、IIS サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-300">If you use HTTP or the SOAP adapter, restart the IIS services.</span></span></li><li><span data-ttu-id="e93ed-301">実行、 **dtasp_CleanHMData** BizTalkDTADb データベースでストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="e93ed-301">Execute the **dtasp_CleanHMData** stored procedure on the BizTalkDTADb database.</span></span></li><li><span data-ttu-id="e93ed-302">すべてのホストを再起動し、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] services です。</span><span class="sxs-lookup"><span data-stu-id="e93ed-302">Restart all hosts and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] services.</span></span></li></ol></li></ul> <span data-ttu-id="e93ed-303">**注:**場合は、追跡データを BizTalkDTADb データベースをバックアップする必要がありますを別の SQL サーバー データベースを復元し、元の BizTalkDTADb データベースを削除します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-303">**Note:**  If you must have the tracking data, back up the BizTalkDTADb database, restore the database to another SQL Server, and then purge the original BizTalkDTADb database.</span></span>|  
  
 <span data-ttu-id="e93ed-304">ヘルプ MsgBoxViewer データまたは PSSDIAG 出力を分析する場合は、マイクロソフト カスタマー サポート サービスにお問い合わせください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-304">If you want help analyzing the MsgBoxViewer data or PSSDIAG output, contact Microsoft Customer Support Services.</span></span> <span data-ttu-id="e93ed-305">カスタマー サポート サービスに問い合わせる前に、MsgBoxViewer データ、PSSDIAG 出力、および更新後のイベント ログ (.evt ファイル) を圧縮します。</span><span class="sxs-lookup"><span data-stu-id="e93ed-305">Before you contact Customer Support Services, compress the MsgBoxViewer data, the PSSDIAG output, and the updated event logs (.evt files).</span></span> <span data-ttu-id="e93ed-306">これらのファイルを送信する必要があります、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]サポート エンジニア</span><span class="sxs-lookup"><span data-stu-id="e93ed-306">You may have to send these files to a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] support engineer</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="e93ed-307">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="e93ed-307">In This Section</span></span>  
  
-   [<span data-ttu-id="e93ed-308">BizTalk Server データベースを維持するためのベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="e93ed-308">Best Practices for Maintaining BizTalk Server Databases</span></span>](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)  
  
-   [<span data-ttu-id="e93ed-309">BizTalk Server データベース テーブルの大規模な成長</span><span class="sxs-lookup"><span data-stu-id="e93ed-309">Large-growing BizTalk Server Database Tables</span></span>](~/technical-guides/large-growing-biztalk-server-database-tables.md)  
  
-   [<span data-ttu-id="e93ed-310">ツールとユーティリティのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="e93ed-310">Tools and Utilities for Troubleshooting</span></span>](../technical-guides/tools-and-utilities-for-troubleshooting.md)  
  
## <a name="see-also"></a><span data-ttu-id="e93ed-311">参照</span><span class="sxs-lookup"><span data-stu-id="e93ed-311">See Also</span></span>  
 [<span data-ttu-id="e93ed-312">SQL Server の設定を変更しないでください。</span><span class="sxs-lookup"><span data-stu-id="e93ed-312">SQL Server Settings That Should Not Be Changed</span></span>](~/technical-guides/sql-server-settings-that-should-not-be-changed.md)