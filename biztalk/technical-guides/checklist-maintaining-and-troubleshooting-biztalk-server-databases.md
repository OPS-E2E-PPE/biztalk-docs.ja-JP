---
title: チェックリスト:保守および BizTalk Server データベースのトラブルシューティング |Microsoft Docs
description: 自動 Update Statistics、Max Degree of Parallelism など、BizTalk Server データベース、インデックスを再構築を維持するためのベスト プラクティスを参照してください、ロックとブロックを探して、データベースのサイズを確認、追跡を使用して、SQL Server エージェント ジョブを有効にするを確認中断されたインスタンスは、し、ディスクのパフォーマンスを確認します。 また、BizTalk 終端記号のツールをについて説明します。
ms.custom: ''
ms.date: 06/11/2018
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 58931faf-fc84-46fe-8359-506da94c3756
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a52e16eb86215ca977ff05b87a3c1baf556b0982
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65294802"
---
# <a name="checklist-maintaining-and-troubleshooting-biztalk-server-databases"></a>チェックリスト:メンテナンスと BizTalk Server データベースのトラブルシューティング
BizTalk Server データベースとその正常性は、成功した BizTalk Server データベースのメッセージング環境の非常に重要です。 このトピックでは、管理、または BizTalk Server データベースのトラブルシューティングに必要な手順を使用します。  
  
-   [BizTalk Server データベースのメンテナンス](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_MaintainDB)  
  
-   [BizTalk Server データベースのトラブルシューティング](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_Troubleshoot)  
  
<a name="BKMK_MaintainDB"></a>   
## <a name="maintaining-biztalk-server-databases"></a>BizTalk Server データベースの保守  
  
|手順|リファレンス|  
|---|---|  
|無効にする、**統計の自動更新**と**統計の自動作成**オプション (BizTalk Server メッセージ ボックス データベースにのみ適用されます)。 | **注:** これらの設定は、既定では、BizTalk Server 構成の一部として実行されます。 これらの設定に変更をする必要がありますされません。 <br/><br/> これらの設定が無効になっているかどうかを表示するには、SQL Server で次のストアド プロシージャを実行します。<br/><br/> SELECT DATABASEPROPERTYEX('BizTalkMsgBoxDB', 'IsAutoCreateStatistics') AS IsAutoCreateStatistics<br/>SELECT DATABASEPROPERTYEX('BizTalkMsgBoxDB', 'IsAutoUpdateStatistics') AS IsAutoUpdateStatistics<br/><br/>必要があります、値が返される**0**を示す、設定を無効にします。 場合**0**は返されません、SQL Server で、次を実行して設定を無効にします。<br/><br/>ALTER DATABASE BizTalkMsgBoxDB SET AUTO_CREATE_STATISTICS OFF<br/>ALTER DATABASE BizTalkMsgBoxDB SET AUTO_UPDATE_STATISTICS OFF<br/><br/> これらの設定の詳細についてを参照してください。<br/><br/> -   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429)<br />-   **912262**—[「自動更新の統計オプションの自動作成統計のオプションと、BizTalk Server BizTalkMsgBoxDB データベースをホストする SQL Server データベース インスタンスで並列処理の設定がになっています」](http://go.microsoft.com/fwlink/?LinkId=153430)|  
|プロパティの並列処理の最大限度を設定します。|**注:** これらの設定は、既定では、BizTalk Server 構成の一部として実行されます。 これらの設定に変更をする必要がありますされません。 <br /><br /> Max Degree of Parallelism の設定**run_value**と**config_value**プロパティ値を 1 つ (1) BizTalk Server メッセージ ボックス データベースをホストする SQL Server インスタンス上にします。 並列処理の最大限度を確認したり、次を実行するストアド プロシージャ、マスターに対して SQL Server データベース。<br /><br /> exec sp_configure 'max degree of parallelism'<br /><br /> 場合、 **run_value**と**config_value**はありません (1) 1 つの値に設定、SQL Server で次のストアド プロシージャを実行します。<br /><br /> exec sp_configure 'max degree of parallelism', '1'                 reconfigure with override<br /><br /> BizTalk Server の並列処理の最大限度の影響の詳細については、次のマイクロソフト サポート技術情報の記事を参照してください。<br /><br /> -   **899000**—[「BizTalk Server を構成するときに、SQL Server のインスタンスの並列処理の設定」](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432)します。<br />-   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)します。|  
|BizTalk Server のインデックスを再構築する場合の判断します。|BizTalk Server データベース内のインデックスのほとんどのクラスター化された (インデックス ID:1). DBCC SHOWCONTIG コマンドは、BizTalk Server データベースにテーブルの断片化情報を表示する使用できます。 これらのインデックスは GUID に基づくため、断片化が発生するは正常であることです。 DBCC SHOWCONTIG のスキャン密度の値が 30% 未満の場合は、ダウンタイム中にインデックスが再構築することができます。 BizTalk Server データベースに多数のテーブルには、オンラインのインデックスを作成することはできません型の定義を使用する列が含まれます。 そのため、BizTalk Server データベースのテーブルのインデックスは、BizTalk がデータを処理する際にことはありませんリビルドする必要があります。 BizTalk のインデックスを再構築する方法の詳細については、次のマイクロソフト サポート技術情報の記事を参照してください。<br /><br /> -   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)します。<br /><br /> **注:** SQL Server での断片化情報を探す sys.dm_db_index_physical_stats 関数を使用することもできます。 詳細については、次を参照してください。 [sys.dm_db_index_physical_stats (TRANSACT-SQL)](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-physical-stats-transact-sql)します。|  
|データベースのロック、ブロック、またはデッドロックの監視します。|ロックと BizTalk Server で使用される SQL Server データベースで発生するブロックの通常の動作になります。 ただし、これらのロックまたは長期間継続するブロックには必要ありません。 ブロックと、SQL Server でデッドロックを拡張する BizTalk Server で使用されるデータベースは、潜在的な問題の兆候です。 現在の既知のデッドロックと BizTalk Server で使用される SQL Server データベースでのブロックの原因は、次のマイクロソフト サポート技術情報の記事を確認してください。<br /><br /> -   **917845**—[「、発生したブロックしている BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)します。|  
|データベースとテーブルのサイズを監視します。|BizTalk Server メッセージ ボックス データベースのサイズ通常約 5 GB があります。  BizTalkMsgBoxDb データベースは、任意のデータを保持することはできませんし、データが処理されるか、BizTalkDTADb データベースに移動されるまでバッファーを考慮する必要があります。 強力な SQL Server バックエンドと多数の実行時間の長いオーケストレーションの環境では、5 GB を超える BizTalkMsgBoxDb データベースがあります。 大量環境にない実行時間の長いオーケストレーションを BizTalk Server メッセージ ボックス データベースは 5 GB よりもはるかに小さいが必要です。 サイズで、BizTalk Server 追跡データベースが大きく異なることができますが、クエリのパフォーマンスが大幅に低下する場合、追跡データベースがおそらく大きすぎます。 ルールの一般的に、BizTalk Server 追跡データベースの 15 ~ 20 GB を超えるは大きすぎると見なされます、パフォーマンスに悪影響を及ぼす可能性があります。 次の問題は、BizTalk Server データベースは大きすぎるに起因する可能性があります。<br /><br /> -BizTalk Server メッセージ ボックス データベースは、データ サイズ (ログ ファイルだけでなく) の大規模なままに増え続けています。 BizTalk Server では、単純なメッセージ フローのシナリオでも処理に通常よりも長い時間がかかります。<br />グループ ハブ クエリでは、通常よりも長い時間がかかるし、偶数のタイムアウトの可能性があります。<br />-データベースのログ ファイルは決して切り捨てられます。<br />-BizTalk SQL エージェント ジョブが通常よりも低速に実行します。<br />-一部のテーブルがかなり大きくまたは正常に多くの行を比較します。<br /><br /> BizTalk Server データベース サイズが大きくなるいくつか考えられます。<br /><br /> -BizTalk SQL エージェント ジョブが実行されていません<br />-過剰な中断されたメッセージまたはサービス インスタンス<br />-ディスクの障害<br />-高レベルの追跡<br />-BizTalk Server の調整<br />の SQL Server のパフォーマンス低下<br />-ネットワークの待機時間に関する問題<br /><br /> 同様に、テーブルの行が多すぎることができます。 セットの数が多すぎて行はありません。 さらに、この行数は、どのような種類のデータがテーブルに格納されているによって異なります。 たとえば、 *dta_DebugTrace*おそらく 100万以上の行を持つテーブルに行が多すぎます。 A *HostNameQ_Suspended*おそらく 200,000 台を超える行を持つテーブルに行が多すぎます。<br /><br /> データの問題が発生しているかどうかを判断する、環境に必要とされるがわかっていることを確認します。|  
|BizTalk Server ホストの追跡を有効にします。|既定のホストでは既定では、追跡が有効にします。 BizTalk が必要です、**ホストの追跡を許可する**1 つのホストでオプションを確認します。 Tracking Data Decode Service (TDDS) が、追跡を移動の追跡が有効にすると、BizTalk Server 追跡データベースへの BizTalk Server メッセージ ボックス データベースからイベント データ。 オプションで、BizTalk Server ホストが構成されていないかどうか**ホストの追跡を許可する**または追跡ホストを停止すると、し、TDDS は実行されず、BizTalk Server メッセージ ボックス データベース内の TrackingData_x_x テーブルをオフに拡張されます。 したがって、専用の BizTalk Server ホストを構成するオプションを使用する必要がある**ホストの追跡を許可する**します。 専用の追跡ホストの構成の詳細については、次を参照してください。[専用の追跡ホストを構成する](~/technical-guides/configuring-a-dedicated-tracking-host.md)します。 **注:** 大量のシナリオでの新しい追跡イベントを維持するために、TDDS を許可するのには、1 つの追跡ホストの複数のインスタンスを作成できますが、追跡の複数のホストを構成する必要があります。|  
|適切な BizTalk SQL Server エージェント ジョブを使用します。|BizTalk Server は SQL エージェント ジョブの実行は、BizTalk Server データベースを管理するため、最適なパフォーマンスを維持するために重要です。<br /><br /> - **Backup BizTalk Server** SQL Server エージェント ジョブは、BizTalk Server データベースをバックアップする方法のみがサポートされます。 このジョブでは、完全復旧モデルを使用するすべての BizTalk Server データベースを設定する必要があります。 このジョブを正常な BizTalk Server 環境を構成する必要があります。 SQL Server サービスが停止している場合にのみ、およびすべての BizTalk Server プロセスが停止している場合、BizTalk Server データベースをバックアップする SQL Server メソッドを使用することができます。 **注:**    詳細については、BizTalk Server のバックアップ SQL エージェント ジョブを構成するときに、SQL Server の完全復旧モデルを使用して、次を参照してください[ログ配布](http://go.microsoft.com/fwlink/?LinkId=153450)(http://go.microsoft.com/fwlink/?LinkId=153450)または[バックアップ完全復旧モデルでの](http://go.microsoft.com/fwlink/?LinkId=156509)(。 http://go.microsoft.com/fwlink/?LinkId=156509).<br />- **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが無期限に実行するように設計します。 その結果、SQL エージェント ジョブ履歴示さない場合があります、この SQL エージェント ジョブが正常に完了します。この動作は仕様です。 エラーが発生した、ジョブは 1 分以内に再起動し、に伴って実行を継続します。 そのため、このジョブのエラー通知通常は無視されます。 MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb SQL Server エージェント ジョブのジョブ履歴には、このジョブは常に失敗しましたを再起動することが示されている場合は、障害/再起動サイクルの原因をさらに調査が必要に可能性があります。<br />- **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** SQL Server エージェント ジョブがない手動で有効にするため、MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb ジョブによって開始されます。 唯一の仕事です。<br />- **DTA Purge and Archive** SQL Server エージェント ジョブの削除と追跡メッセージをアーカイブして、BizTalk Server 追跡データベースを保持します。 このジョブでは、テーブル内のすべての行を読み取るし、レコードを削除するかどうかを判断する各行のタイムスタンプを比較します。 **注:** BizTalk Server SQL Server エージェント ジョブをトラブルシューティングするときは、エラーなし、MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb を除くすべての SQL エージェント ジョブが完了することを確認します。 <br /><br /> SQL Server で使用される BizTalk Server の SQL エージェント ジョブの詳細については。<br /><br /> -「[データベースの構造とジョブ](http://go.microsoft.com/fwlink/?LinkId=153451)(http://go.microsoft.com/fwlink/?LinkId=153451)します。<br />-「 [BizTalk Server のジョブの SQL Server エージェントの説明](http://go.microsoft.com/fwlink/?LinkId=153452)(http://go.microsoft.com/fwlink/?LinkId=153452)します。|  
|監視して中断されたインスタンスを終了します。|サービス インスタンスの中断 (再開可能) または中断 (再開不可) ことができます。 これらのサービス インスタンスには、メッセージング、オーケストレーション、またはポートがあります。 BizTalk Server または Terminate.vbs スクリプトを使用して、BizTalk Server 管理コンソールで、[グループ ハブ] ページを使用して終了し、これらのインスタンスの削除に対応します。 Terminate.vbs 実行スクリプトの詳細については、次を参照してください。[中断サービス インスタンスを削除する](http://go.microsoft.com/fwlink/?LinkId=153453)(http://go.microsoft.com/fwlink/?LinkId=153453)します。 **ヒント:** 中断されたインスタンスを削除するのに、終端記号のツールを使用することもできます。 [ターミネータ ツール](http://go.microsoft.com/fwlink/?LinkId=151931)いただけます[ http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931)します。 、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関する保証をいたしません。 このプログラムは、ユーザー自身の責任で使用してください。 <br /><br /> 用語「孤立」と「ゾンビ」は、同じ意味で使用されます。 またはゾンビの孤立したメッセージは、メッセージがない関連付けられているサービス インスタンスでは、通常、メッセージを受信する前に、サービス インスタンスが終了したためです。 孤立したまたはゾンビ サービスは、関連するメッセージがないサービスです。 BizTalk Server のインスタンスを参照してくださいゾンビ メッセージとサービスの詳細については[BizTalk Server のゾンビ](http://go.microsoft.com/fwlink/?LinkId=153454)(http://go.microsoft.com/fwlink/?LinkId=153454)します。|  
|パフォーマンス カウンターを監視、 **PhysicalDisk**パフォーマンス オブジェクト|BizTalk Server は、1 分以内で、SQL Server を多数の短い、非常に高速のトランザクションを作成します。 場合は、SQL Server では、このアクティビティを受けることができない、BizTalk Server パフォーマンスの問題が発生する可能性があります。 モニター、**平均Disk Sec/read**、**平均Disk Sec/transfer**、および**平均Disk Sec/write**パフォーマンス モニター カウンター、 **PhysicalDisk**パフォーマンス オブジェクトです。 最適な値は、10 ミリ秒未満 (ミリ秒単位です)。 以上 20 ミリ秒の値は、パフォーマンスの低下と見なされます。<br /><br />BizTalk Server データベースの高可用性の詳細については、次を参照してください。 [BizTalk Server データベースの高可用性の実現](../core/providing-high-availability-for-biztalk-server-databases.md)します。|  
|BizTalk Server データベースのベスト プラクティスに従ってください。|参照してください[BizTalk Server データベースを維持するためのベスト プラクティス](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)します。|  
  
<a name="BKMK_Troubleshoot"></a>   
## <a name="troubleshooting-biztalk-server-databases"></a>BizTalk Server データベースのトラブルシューティング  
 BizTalk Server データベースの問題をトラブルシューティングするには、次のタスクを実行します。  
  
|手順|リファレンス|  
|-----------|---------------|  
|必要なすべての BizTalk SQL Server エージェント ジョブが有効で実行されていることを確認します。|除くすべての BizTalk SQL Server エージェントのジョブ、 **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb**ジョブは実行されていて正常にします。 その他の任意のジョブを無効にしないでください。<br /><br /> 障害が発生する場合は、使用、**履歴の表示**エラー情報を表示し、それに応じて、エラーをトラブルシューティングする SQL Server オプション。 注意、 **MessageBox _Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが永続的に実行します。 そのため、ジョブの履歴レポート ジョブが常に失敗し、再起動するときは注意する必要があります必ず。|  
|MsgBoxViewer ツールを使用して、BizTalk メッセージ ボックスとその他のデータベースを分析するには|**重要:**、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関する保証をいたしません。 このプログラムは、ユーザー自身の責任で使用してください。 <br /><br /> MsgBoxViewer ツールはから[ http://go.microsoft.com/fwlink/?LinkId=151930 ](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930)します。 MsgBoxViewer ツールは、テーブルのサイズと行の数の詳細については、html 形式のレポートを提供するためのトラブルシューティングに役立ちます。 レポートでは、BizTalk Server を調整するかどうかを判断することができます。 さらに、このツールは、BizTalk Server データベースと BizTalk Server の構成のスナップショットを提供します。<br /><br /> BizTalk Server が実行されている場合、通常よりも低下 MsgBoxViewer ツールを実行ですべてのクエリを選択する をクリックして、**オプション クエリ**タブをクリックし、問題は、生成される HTML レポートを確認します。 **概要レポート**セクションは、黄色、および潜在的な問題は赤色の警告を一覧表示されます。<br /><br /> さらに、テーブルは、最大規模のおよびほとんどのレコードがある判別を MsgBoxViewer ツールを使用することができます。 通常、これを拡張するテーブルの一覧、およびそれらのテーブルを管理する方法の詳細については、「 [BizTalk Server データベース テーブルの大きな成長を続けている](~/technical-guides/large-growing-biztalk-server-database-tables.md)します。|  
|MsgBoxViewer ツールによって、識別された場合、問題を解決するのには終端記号ツールを使用します。|**重要:**、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関する保証をいたしません。 このプログラムは、ユーザー自身の責任で使用してください。 <br /><br /> 使用可能なターミネータ ツールを実行して[ターミネータ](http://go.microsoft.com/fwlink/?LinkId=151931)(http://go.microsoft.com/fwlink/?LinkId=151931)します。 このツールでは、簡単に BizTalk MsgBoxViewer ツールによって特定された問題を解決することができます。 BizTalk MsgBoxViewer ツールを使用して、終端記号のツールを統合する方法の詳細については、次を参照してください。 [BizTalk MsgBoxViewer によって特定された問題を解決するには BizTalk 終端記号のを使用して](http://go.microsoft.com/fwlink/?LinkId=151932)(http://go.microsoft.com/fwlink/?LinkId=151932)します。|  
|デッドロックのシナリオを調査します。|デッドロックのシナリオでデッドロック情報が、SQLERROR ログに書き込まれるように、SQL Server 上で DBCC の追跡を有効にします。<br /><br /> SQL Server でデッドロック シナリオの DBCC のトレースを有効にするのには、次のステートメントを実行します。<br /><br /> DBCC TRACEON (1222、-1)<br /><br /> データを収集する PSSDIAG ユーティリティを使用することもできます、 **Lock:deadlock**イベントと**Lock:deadlock Chain**イベント。 PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)します。<br /><br /> BizTalkMsgBoxDB データベースは、大量かつ高トランザクション オンライン トランザクション処理 (OLTP) データベースです。 このようなデータベースでは、デッドロックの一部が必要ですし、BizTalk Server エンジンによって内部的に処理がこのデッドロックします。 この動作が発生したときに、エラー ログでエラーが表示されません。 デッドロックのシナリオを調査するときに、デッドロックの出力に調査しているがイベント ログのデッドロック エラーと相関する必要があります。|  
|ブロックされたプロセスを参照してください。|SQL Server での利用状況モニターを使用すると、ロックのシステム プロセスのサーバー プロセス識別子 (SPID) を取得します。 ロックの SPID が実行されている SQL ステートメントに SQL Profiler を実行することができます。 PSSDIAG ユーティリティを使用して、SQL Server でのロックとブロッキングの問題をトラブルシューティングすることができます。 ユーティリティは、有効になっているスクリプトのブロックを持つすべての TRANSACT-SQL イベントをキャプチャします。 PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)します。<br /><br /> SQL Server, で指定できます、**ブロック プロセスのしきい値**SPID または Spid が指定したしきい値を超えるブロックを判断するために設定します。 Blocked process threshold のオプションの詳細については、次を参照してください。 [blocked process threshold オプション](http://go.microsoft.com/fwlink/?LinkId=153628)(http://go.microsoft.com/fwlink/?LinkId=153628)します。 **注:** ロックが発生した場合、または SQL Server のブロッキングの問題、マイクロソフト カスタマー サポート サービスに問い合わせることをお勧めします。 マイクロソフト カスタマー サポート サービスでは、正しい PSSDiag ユーティリティのオプションを構成できます。|  
|すべての不要なデータを削除します。|データベースが大きくなりすぎたために拡大し、データベースに含まれるデータは必要ありませんなくなった場合は、データを削除することをお勧めします。 **注意が必要です。** メソッドを使用しないこの任意の環境でのデータが重要なビジネスまたはデータが必要なかどうかです。 <br /><br /> **BizTalkMsgBox データベースを消去するには**<br /> 1.ダウンロードしてインストールでは、ターミネータ ツール[Biztalk 終端記号](http://go.microsoft.com/fwlink/?LinkId=220869)(http://go.microsoft.com/fwlink/?LinkId=220869)します。<br />2.トピックの手順に従って[テスト環境でメッセージ ボックス データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkID=158064)(http://go.microsoft.com/fwlink/?LinkID=158064) BizTalk メッセージ ボックス データベースでストアド プロシージャ、bts_CleanupMsgbox を作成します。<br />3.ターミネータ ツールを使用して、bts_CleanupMsgbox ストアド プロシージャを実行して、BizTalk メッセージ ボックス データベースを消去します。 **警告:**     BizTalk Server を実行している運用サーバーでは、bts_CleanupMsgbox ストアド プロシージャは実行されません。 テスト環境でのみ、bts_CleanupMsgbox ストアド プロシージャを実行する必要があります。 実行、bts_CleanupMsgbox ストアド プロシージャ、運用環境ではサポートされません。<br />4.すべてのホストと BizTalk Server サービスを再起動します。<br /><br /> **BizTalkDTADb データベースを消去するには**<br /> <ul><li>**方法 1**<br /><br /> <ol><li>すべての BizTalk Server データベースをバックアップします。</li><li>実行、 **[dtasp_purgeallcompletedtrackingdata]** ストアド プロシージャ。 ストアド プロシージャの詳細については、次を参照してください。 [BizTalk 追跡データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkId=153635)(http://go.microsoft.com/fwlink/?LinkId=153635)します。</li></ol></li><li>**方法 2**します。 BizTalkDTADb データベースには、削除する必要がある多くの不完全なインスタンスが含まれている場合にのみ、このオプションを使用します。<br /><br /> <ol><li>すべての BizTalk Server データベースをバックアップします。</li><li>すべての BizTalk ホスト、サービス、およびカスタム分離アダプターを停止します。 HTTP アダプタまたは SOAP アダプタを使用する場合は、IIS サービスを再起動します。</li><li>実行、 **dtasp_CleanHMData** BizTalkDTADb データベースでストアド プロシージャ。</li><li>すべてのホストと BizTalk Server サービスを再起動します。</li></ol></li></ul> **注:** 追跡データが必要な場合、BizTalkDTADb データベースをバックアップするには、別の SQL Server にデータベースを復元し、元の BizTalkDTADb データベースを消去します。|  
  
 ヘルプ MsgBoxViewer データまたは PSSDIAG 出力を分析する場合は、マイクロソフト カスタマー サポート サービスにお問い合わせください。 カスタマー サポート サービスを連絡する前に、MsgBoxViewer データ、PSSDIAG 出力、および更新されたイベント ログ (.evt ファイル) を圧縮します。 これらのファイルを BizTalk Server のサポート エンジニアに送信する必要があります。
  
## <a name="next"></a>Next
  
-   [BizTalk Server データベースを保守する場合のベスト プラクティス](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)  
  
-   [BizTalk Server データベース テーブルの大規模な成長](~/technical-guides/large-growing-biztalk-server-database-tables.md)  
  
-   [トラブルシューティング用のツールとユーティリティ](../technical-guides/tools-and-utilities-for-troubleshooting.md)  
  
## <a name="see-also"></a>参照  
 [変更しない SQL Server の設定](~/technical-guides/sql-server-settings-that-should-not-be-changed.md)
