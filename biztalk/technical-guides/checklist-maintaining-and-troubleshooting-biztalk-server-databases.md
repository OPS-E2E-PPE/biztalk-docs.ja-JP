---
title: "チェックリスト: を維持し、BizTalk Server データベースのトラブルシューティング |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/29/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 58931faf-fc84-46fe-8359-506da94c3756
caps.latest.revision: "4"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5f30dbb156abd7e0c0daa4dd0a8d0082a7d63622
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/01/2017
---
# <a name="checklist-maintaining-and-troubleshooting-biztalk-server-databases"></a><span data-ttu-id="7fe92-102">チェックリスト: を維持し、BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="7fe92-102">Checklist: Maintaining and Troubleshooting BizTalk Server Databases</span></span>
<span data-ttu-id="7fe92-103">BizTalk Server データベースとその正常性は、成功した BizTalk Server データベースのメッセージング環境にとって非常に重要です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-103">BizTalk Server databases and their health are very important for a successful BizTalk Server database messaging environment.</span></span> <span data-ttu-id="7fe92-104">このトピックでは、維持すると、BizTalk Server データベースのトラブルシューティングを行う必要がありますの手順を示します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-104">This topic lists the steps that you must follow when maintaining or troubleshooting the BizTalk Server databases.</span></span>  
  
-   [<span data-ttu-id="7fe92-105">BizTalk Server データベースのメンテナンス</span><span class="sxs-lookup"><span data-stu-id="7fe92-105">Maintaining BizTalk Server Databases</span></span>](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_MaintainDB)  
  
-   [<span data-ttu-id="7fe92-106">BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="7fe92-106">Troubleshooting BizTalk Server Databases</span></span>](../technical-guides/checklist-maintaining-and-troubleshooting-biztalk-server-databases.md#BKMK_Troubleshoot)  
  
<a name="BKMK_MaintainDB"></a>   
## <a name="maintaining-biztalk-server-databases"></a><span data-ttu-id="7fe92-107">BizTalk Server データベースの保守</span><span class="sxs-lookup"><span data-stu-id="7fe92-107">Maintaining BizTalk Server Databases</span></span>  
  
|<span data-ttu-id="7fe92-108">手順</span><span class="sxs-lookup"><span data-stu-id="7fe92-108">Steps</span></span>|<span data-ttu-id="7fe92-109">リファレンス</span><span class="sxs-lookup"><span data-stu-id="7fe92-109">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="7fe92-110">無効にする、**統計の自動更新**と**統計の自動作成**オプション (BizTalk Server メッセージ ボックス データベースにのみ適用されます)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-110">Disable the **Auto Update Statistics** and **Auto Create Statistics** Options (applicable only to BizTalk Server MessageBox databases).</span></span>|<span data-ttu-id="7fe92-111">**注:**これらの設定は、BizTalk Server 構成の一部として既定で行われます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-111">**Note:**  These settings are done by default as part of the BizTalk Server configuration.</span></span> <span data-ttu-id="7fe92-112">これらの設定に変更を加えないでください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-112">You should not make changes to these settings.</span></span> <br /><br /> <span data-ttu-id="7fe92-113">無効にする必要があります、**統計の自動作成**と**統計の自動更新**オプション。</span><span class="sxs-lookup"><span data-stu-id="7fe92-113">You must disable the **Auto Create Statistics** and the **Auto Update Statistics** options.</span></span> <span data-ttu-id="7fe92-114">これらの設定が無効になっているかどうかを判断するのには、SQL Server で次のストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-114">To determine if these settings are disabled, execute the following stored procedures in SQL Server:</span></span><br /><br /> <span data-ttu-id="7fe92-115">exec sp_dboption 'BizTalkMsgBoxDB'、'統計の自動作成' exec sp_dboption 'BizTalkMsgBoxDB'、'自動 update statistics'</span><span class="sxs-lookup"><span data-stu-id="7fe92-115">exec sp_dboption 'BizTalkMsgBoxDB', 'auto create statistics'                 exec sp_dboption 'BizTalkMsgBoxDB', 'auto update statistics'</span></span><br /><br /> <span data-ttu-id="7fe92-116">返される値**CurrentSetting** OFF にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-116">The value returned for **CurrentSetting** should be OFF.</span></span> <span data-ttu-id="7fe92-117">この値が返される場合は**CurrentSetting** on、SQL Server の次のストアド プロシージャを実行して、OFF に変更します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-117">If this value returned for **CurrentSetting** is ON, change it to OFF by executing the following stored procedures in SQL Server:</span></span><br /><br /> <span data-ttu-id="7fe92-118">exec sp_dboption 'BizTalkMsgBoxDB'、'統計の自動作成'、'off' exec sp_dboption 'BizTalkMsgBoxDB'、'統計の自動更新'、'off'</span><span class="sxs-lookup"><span data-stu-id="7fe92-118">exec sp_dboption 'BizTalkMsgBoxDB', 'auto create statistics', 'off'                 exec sp_dboption 'BizTalkMsgBoxDB', 'auto update statistics', 'off'</span></span><br /><br /> <span data-ttu-id="7fe92-119">これらの設定の詳細については、次の Microsoft サポート技術情報記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-119">For more information about these settings see the following Microsoft Knowledge Base articles:</span></span><br /><br /> <span data-ttu-id="7fe92-120">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-120">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span><br /><span data-ttu-id="7fe92-121">-   **912262**—[「、自動統計更新オプション、自動統計の作成オプション、および並列処理の設定が、BizTalk Server BizTalkMsgBoxDB データベースをホストする SQL Server データベース インスタンスでになっている」](http://go.microsoft.com/fwlink/?LinkId=153430)(http://go.microsoft.com/fwlink/?LinkId=153430)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-121">-   **912262**—["The auto update statistics option, the auto create statistics option, and the Parallelism setting are turned off in the SQL Server database instance that hosts the BizTalk Server BizTalkMsgBoxDB database"](http://go.microsoft.com/fwlink/?LinkId=153430) (http://go.microsoft.com/fwlink/?LinkId=153430).</span></span>|  
|<span data-ttu-id="7fe92-122">プロパティの並列処理の最大限度を設定します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-122">Set the Max Degree of Parallelism property</span></span>|<span data-ttu-id="7fe92-123">**注:**これらの設定は、BizTalk Server 構成の一部として既定で行われます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-123">**Note:**  These settings are done by default as part of the BizTalk Server configuration.</span></span> <span data-ttu-id="7fe92-124">これらの設定に変更を加えないでください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-124">You should not make changes to these settings.</span></span> <br /><br /> <span data-ttu-id="7fe92-125">Max Degree of Parallelism の設定**run_value**と**config_value**いずれかの値 (1)、BizTalk Server メッセージ ボックス データベースをホストする SQL Server インスタンス上のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-125">Set the Max Degree of Parallelism **run_value** and **config_value** properties to a value of one (1) on the SQL Server instances that host the BizTalk Server Messagebox databases.</span></span> <span data-ttu-id="7fe92-126">並列処理の最大限度を確認して、次を実行するストアド プロシージャ、マスター _ に対して SQL Server でデータベース。</span><span class="sxs-lookup"><span data-stu-id="7fe92-126">To check the Max Degree of Parallelism setting, execute the following stored procedure against the Master database in SQL Server:</span></span><br /><br /> <span data-ttu-id="7fe92-127">exec sp_configure 'max degree of parallelism'</span><span class="sxs-lookup"><span data-stu-id="7fe92-127">exec sp_configure 'max degree of parallelism'</span></span><br /><br /> <span data-ttu-id="7fe92-128">場合、 **run_value**と**config_value**はありません (1) 1 つの値に設定は、SQL Server で次のストアド プロシージャを実行します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-128">If the **run_value** and **config_value** are not set to a value of one (1), execute the following stored procedure in SQL Server:</span></span><br /><br /> <span data-ttu-id="7fe92-129">exec sp_configure 'max degree of parallelism'、'1' の再構成の上書き</span><span class="sxs-lookup"><span data-stu-id="7fe92-129">exec sp_configure 'max degree of parallelism', '1'                 reconfigure with override</span></span><br /><br /> <span data-ttu-id="7fe92-130">BizTalk Server の並列処理の最大限度の影響の詳細については、次の Microsoft サポート技術情報記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-130">For more information about how the Max Degree of Parallelism setting affects BizTalk Server, see the following Microsoft Knowledge Base articles:</span></span><br /><br /> <span data-ttu-id="7fe92-131">-   **899000**—[「BizTalk Server を構成するときに、SQL Server のインスタンスの並列処理の設定」](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-131">-   **899000**—["The Parallelism setting for the instance of SQL Server when you configure BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432).</span></span><br /><span data-ttu-id="7fe92-132">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-132">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>|  
|<span data-ttu-id="7fe92-133">BizTalk Server のインデックスを再構築するときの決定します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-133">Determine when you can rebuild BizTalk Server indexes</span></span>|<span data-ttu-id="7fe92-134">BizTalk Server データベース内のインデックスのほとんどはクラスター化 (インデックス ID: 1)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-134">Most of the indexes in BizTalk Server databases are clustered (index ID: 1).</span></span> <span data-ttu-id="7fe92-135">DBCC SHOWCONTIG コマンドは、BizTalk Server データベースにテーブルの断片化情報を表示する使用できます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-135">The DBCC SHOWCONTIG command can be used to display fragmentation information for tables in the BizTalk Server databases.</span></span> <span data-ttu-id="7fe92-136">これらのインデックスは、GUID ベースは、通常の断片化が発生するようにします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-136">These indexes are GUID-based so it is normal for fragmentation to occur.</span></span> <span data-ttu-id="7fe92-137">DBCC SHOWCONTIG のスキャン密度の値が 30% 未満の場合に、ダウンタイム中にインデックスが再構築できます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-137">If the Scan Density value of DBCC SHOWCONTIG is less than 30%, the indexes can be rebuilt during downtime.</span></span> <span data-ttu-id="7fe92-138">BizTalk Server データベース内の多数のテーブルは、データ型の定義を使用して、オンライン インデックス作成を実行できません列を含めます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-138">Many tables in the BizTalk Server databases contain columns that use DataType definitions where online indexing cannot be done.</span></span> <span data-ttu-id="7fe92-139">そのため、BizTalk Server データベース内のテーブルのインデックスことはありません再構築 BizTalk がデータを処理中にします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-139">Therefore, the indexes for tables in the BizTalk Server databases should never be rebuilt while BizTalk is processing data.</span></span> <span data-ttu-id="7fe92-140">BizTalk のインデックスを再構築する方法の詳細については、次の Microsoft サポート技術情報記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-140">For more information on how to rebuild the BizTalk indexes, see the following Microsoft Knowledge Base article:</span></span><br /><br /> <span data-ttu-id="7fe92-141">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-141">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span><br /><br /> <span data-ttu-id="7fe92-142">**注:** SQL Server での断片化情報を探す sys.dm_db_index_physical_stats 関数を使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-142">**Note:**  You can also use the sys.dm_db_index_physical_stats function to look for fragmentation information in SQL Server.</span></span> <span data-ttu-id="7fe92-143">詳細については、次を参照してください。 [sys.dm_db_index_physical_stats (TRANSACT-SQL)](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-physical-stats-transact-sql)です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-143">For more information, see [sys.dm_db_index_physical_stats (Transact-SQL)](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-physical-stats-transact-sql).</span></span>|  
|<span data-ttu-id="7fe92-144">データベースのロック、ブロック、またはデッドロックの監視します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-144">Monitor the database for locks, blocks, or deadlocks</span></span>|<span data-ttu-id="7fe92-145">ロックと BizTalk Server によって使用される SQL Server データベースで発生するブロックの通常の動作することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-145">It is an expected behavior for locks and blocks to occur on the SQL Server databases used by BizTalk Server.</span></span> <span data-ttu-id="7fe92-146">ただし、これらのロックやブロックが長時間にわたってを続行するには必要ありません。</span><span class="sxs-lookup"><span data-stu-id="7fe92-146">However, it is not expected to have these locks or blocks to continue for an extended period of time.</span></span> <span data-ttu-id="7fe92-147">ブロッキングと SQL Server でデッドロックを拡張 BizTalk Server によって使用されるデータベースは、潜在的な問題のインジケーターです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-147">Extended blocking and deadlocking on the SQL Server databases used by BizTalk Server are indicators of a potential problem.</span></span> <span data-ttu-id="7fe92-148">現在の既知のデッドロックと BizTalk Server によって使用される SQL Server データベースでのブロックの原因として、次の Microsoft サポート技術情報記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-148">For the current known causes of deadlocking and blocking on the SQL Server databases used by BizTalk Server, review the following Microsoft Knowledge Base article:</span></span><br /><br /> <span data-ttu-id="7fe92-149">-   **917845**—[「するブロックが発生する、BizTalk Server で、BizTalkMsgBoxDb データベースに接続しようとすると、条件、またはその他の SQL Server の問題をデッドロック」](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-149">-   **917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>|  
|<span data-ttu-id="7fe92-150">データベースとテーブルのサイズを監視します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-150">Monitor the size of databases and tables</span></span>|<span data-ttu-id="7fe92-151">BizTalk Server メッセージ ボックス データベースのサイズは、超えるおよそ 5 GB を通常する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-151">The size of the BizTalk Server Messagebox database should typically be no more than approximately 5GB.</span></span>  <span data-ttu-id="7fe92-152">BizTalkMsgBoxDb データベースは、任意のデータを保持することはできませんし、データが処理または BizTalkDTADb データベースに移動するまでバッファーを考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-152">The BizTalkMsgBoxDb database should not be holding any data, and should be considered a buffer until the data is processed or moved to the BizTalkDTADb database.</span></span> <span data-ttu-id="7fe92-153">強力な SQL Server のバックエンドと多数の長時間実行オーケストレーションを含む環境では、5 GB を超える BizTalkMsgBoxDb データベースがあります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-153">An environment with a powerful SQL Server backend and numerous long running orchestrations may have a BizTalkMsgBoxDb database larger than 5GB.</span></span> <span data-ttu-id="7fe92-154">頻度の高い環境にない長時間のオーケストレーションを BizTalk Server メッセージ ボックス データベースは 5 GB よりはるかに小さいが必要です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-154">A high volume environment with no long-running orchestrations should have a BizTalk Server Messagebox database much smaller than 5GB.</span></span> <span data-ttu-id="7fe92-155">サイズで、BizTalk Server 追跡データベースが大幅に異なりますがクエリのパフォーマンスが大幅に低下する場合、追跡データベースがおそらくが大きすぎます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-155">The BizTalk Server tracking database can vary greatly in size but if query performance decreases dramatically, then the tracking database is probably too large.</span></span> <span data-ttu-id="7fe92-156">原則として、BizTalk Server 追跡データベースの 15 ~ 20 GB を超える大きすぎると見なされます、パフォーマンスに悪影響を及ぼす可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-156">As a rule of thumb, a BizTalk Server tracking database larger than 15-20 GB is considered too large and may adversely impact performance.</span></span> <span data-ttu-id="7fe92-157">次の問題は、BizTalk Server データベースが大きすぎるに起因する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-157">The following issues may be attributable to BizTalk Server databases that are too large:</span></span><br /><br /> <span data-ttu-id="7fe92-158">-BizTalk Server メッセージ ボックス データベース、データ サイズ (ログ ファイルだけでなく) の大規模なままに増加し続けます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-158">-   The BizTalk Server Messagebox database continues to grow while the data size (not just the log file) remains large.</span></span> <span data-ttu-id="7fe92-159">BizTalk Server では、単純なメッセージ フローのシナリオでも処理に通常よりも長い時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-159">BizTalk Server takes a longer time than normal to process even a simple message flow scenario.</span></span><br /><span data-ttu-id="7fe92-160">グループ ハブ クエリでは、通常よりも長い時間がかかるし、偶数のタイムアウトの可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-160">-   Group Hub queries take a longer time than normal and may even timeout.</span></span><br /><span data-ttu-id="7fe92-161">-データベースのログ ファイルは決して切り捨てられます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-161">-   The database log file never gets truncated.</span></span><br /><span data-ttu-id="7fe92-162">-BizTalk SQL エージェント ジョブが通常よりも低速に実行します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-162">-   The BizTalk SQL Agent jobs run slower than normal.</span></span><br /><span data-ttu-id="7fe92-163">-一部のテーブルがかなり大きくまたは normal あまり多くの行を比較します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-163">-   Some tables are considerably large or have too many rows compared to normal.</span></span><br /><br /> <span data-ttu-id="7fe92-164">BizTalk Server データベース サイズが大きくなるなど、いくつかの理由。</span><span class="sxs-lookup"><span data-stu-id="7fe92-164">The BizTalk Server databases can become large for several reasons including:</span></span><br /><br /> <span data-ttu-id="7fe92-165">BizTalk SQL エージェント ジョブが実行されていません</span><span class="sxs-lookup"><span data-stu-id="7fe92-165">-   BizTalk SQL Agent Jobs not running</span></span><br /><span data-ttu-id="7fe92-166">-過度の保留メッセージやサービス インスタンス</span><span class="sxs-lookup"><span data-stu-id="7fe92-166">-   Excessive suspended message or service instances</span></span><br /><span data-ttu-id="7fe92-167">ディスクの障害</span><span class="sxs-lookup"><span data-stu-id="7fe92-167">-   Disk failures</span></span><br /><span data-ttu-id="7fe92-168">-高レベルの追跡</span><span class="sxs-lookup"><span data-stu-id="7fe92-168">-   High levels of tracking</span></span><br /><span data-ttu-id="7fe92-169">BizTalk Server の制限</span><span class="sxs-lookup"><span data-stu-id="7fe92-169">-   BizTalk Server throttling</span></span><br /><span data-ttu-id="7fe92-170">の SQL Server のパフォーマンス低下</span><span class="sxs-lookup"><span data-stu-id="7fe92-170">-   Poor SQL Server performance</span></span><br /><span data-ttu-id="7fe92-171">ネットワーク待機時間に関する問題</span><span class="sxs-lookup"><span data-stu-id="7fe92-171">-   Network latency issues</span></span><br /><br /> <span data-ttu-id="7fe92-172">同様に、テーブルの行が多すぎることができます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-172">Similarly, you can have too many rows in a table.</span></span> <span data-ttu-id="7fe92-173">セットの数が多すぎて行はありません。</span><span class="sxs-lookup"><span data-stu-id="7fe92-173">There is no set number of rows that are too many.</span></span> <span data-ttu-id="7fe92-174">さらに、この行の数は、どのような種類のデータがテーブルに格納されているによって異なります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-174">Additionally, this number of rows varies by what kind of data is stored in the table.</span></span> <span data-ttu-id="7fe92-175">たとえば、 *dta_DebugTrace*おそらく 100万を超える行を持つテーブルに行が多すぎます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-175">For example, a *dta_DebugTrace* table that has more than 1 million rows probably has too many rows.</span></span> <span data-ttu-id="7fe92-176">A *HostNameQ_Suspended*おそらく 200,000 台を超える行を持つテーブルに行が多すぎます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-176">A *HostNameQ_Suspended* table that has more than 200,000 rows probably has too many rows.</span></span><br /><br /> <span data-ttu-id="7fe92-177">期待される環境でデータの問題が発生しているかどうかを決定するを理解していることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-177">Make sure that you know what is expected in your environment to determine whether a data issue is occurring.</span></span>|  
|<span data-ttu-id="7fe92-178">BizTalk Server ホスト上での追跡を有効にします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-178">Enable tracking on BizTalk Server host</span></span>|<span data-ttu-id="7fe92-179">既定では、既定のホストの追跡が有効にします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-179">By default, tracking is enabled on the default host.</span></span> <span data-ttu-id="7fe92-180">BizTalk が必要です、**ホストの追跡を許可する**1 つのホストでオプションを確認します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-180">BizTalk requires the **Allow Host Tracking** option be checked on a single HOST.</span></span> <span data-ttu-id="7fe92-181">Tracking Data Decode Service (TDDS) が、追跡を移動の追跡を有効にすると、BizTalk Server メッセージ ボックス データベースから BizTalk Server 追跡データベースへのイベント データ。</span><span class="sxs-lookup"><span data-stu-id="7fe92-181">When tracking is enabled, the Tracking Data Decode Service (TDDS) moves the tracking event data from the BizTalk Server Messagebox database to the BizTalk Server tracking database.</span></span> <span data-ttu-id="7fe92-182">オプションで、BizTalk Server ホストが構成されていないかどうかは**ホストの追跡を許可する**追跡ホストを停止すると、し、TDDS は実行されず、BizTalk Server メッセージ ボックス データベース内の TrackingData_x_x テーブルが増大していきますオンになっていない場合またはします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-182">If no BizTalk Server hosts are configured with the option to **Allow Host Tracking** or if the tracking host is stopped, then TDDS will not run and the TrackingData_x_x tables in the BizTalk Server Messagebox database will grow unchecked.</span></span> <span data-ttu-id="7fe92-183">オプションで専用の BizTalk Server ホストを構成するため、**ホストの追跡を許可する**です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-183">Therefore, a dedicated BizTalk Server host should be configured with the option to **Allow Host Tracking**.</span></span> <span data-ttu-id="7fe92-184">専用の追跡ホストの構成の詳細については、次を参照してください。[専用追跡ホストの構成](~/technical-guides/configuring-a-dedicated-tracking-host.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-184">For more information about configuring a dedicated tracking host see [Configuring a Dedicated Tracking Host](~/technical-guides/configuring-a-dedicated-tracking-host.md).</span></span> <span data-ttu-id="7fe92-185">**注:**頻度の高いシナリオで新しい追跡イベントを維持するために TDDS を許可するのには、1 つの追跡ホストの複数のインスタンスを作成できますが、2 つ以上のホストは、追跡を構成してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-185">**Note:**  To allow TDDS to maintain new tracking events in high volume scenarios, you can create multiple instances of a single tracking host but no more than one host should be configured for tracking.</span></span>|  
|<span data-ttu-id="7fe92-186">適切な BizTalk SQL Server エージェント ジョブを使用します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-186">Use the correct BizTalk SQL Server Agent jobs</span></span>|<span data-ttu-id="7fe92-187">BizTalk Server の SQL エージェント ジョブの実行は、BizTalk Server データベースを管理するため、最適なパフォーマンスを維持するために重要です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-187">Execution of the BizTalk Server SQL Agent jobs are crucial for managing the BizTalk Server databases and for maintaining optimal performance.</span></span><br /><br /> <span data-ttu-id="7fe92-188">- **Backup BizTalk Server** SQL Server エージェント ジョブは、BizTalk Server データベースをバックアップする方法のみがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-188">-   The  **Backup BizTalk Server** SQL Server Agent job is the only supported method to back up the BizTalk Server databases.</span></span> <span data-ttu-id="7fe92-189">このジョブでは、完全復旧モデルを使用するすべての BizTalk Server データベースを設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-189">This job requires you to set up all BizTalk Server databases to use a Full Recovery Model.</span></span> <span data-ttu-id="7fe92-190">このジョブを正常な BizTalk Server 環境を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-190">You should configure this job for a healthy BizTalk Server environment.</span></span> <span data-ttu-id="7fe92-191">SQL Server メソッドを使用すると、SQL Server サービスが停止している場合にのみ、およびすべての BizTalk Server プロセスが停止している場合、BizTalk Server データベースをバックアップします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-191">You can use the SQL Server methods to back up the BizTalk Server databases only if the SQL Server service is stopped and if all BizTalk Server processes are stopped.</span></span> <span data-ttu-id="7fe92-192">**注:** SQL エージェントの BizTalk Server のバックアップ ジョブを構成するときに、SQL Server の完全復旧モデルの使用に関する詳細については、次を参照してください[ログ配布](http://go.microsoft.com/fwlink/?LinkId=153450)(http://go.microsoft.com/fwlink/?。LinkId = 153450) または[完全復旧モデルでバックアップ](http://go.microsoft.com/fwlink/?LinkId=156509)(http://go.microsoft.com/fwlink/?LinkId = 156509)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-192">**Note:**      For more information about using the SQL Server full recovery model when configuring the SQL Agent Backup BizTalk Server job, see [Log Shipping](http://go.microsoft.com/fwlink/?LinkId=153450) (http://go.microsoft.com/fwlink/?LinkId=153450) or [Backup Under the Full Recovery Model](http://go.microsoft.com/fwlink/?LinkId=156509) (http://go.microsoft.com/fwlink/?LinkId=156509).</span></span><br /><span data-ttu-id="7fe92-193">- **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが無期限に実行するように設計されています。</span><span class="sxs-lookup"><span data-stu-id="7fe92-193">-   The **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server Agent job is designed to run indefinitely.</span></span> <span data-ttu-id="7fe92-194">その結果、SQL エージェント ジョブ履歴ことは必ずしもこの SQL エージェント ジョブが正常に完了したことです。この動作は仕様です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-194">As a result the SQL Agent job history may not indicate that this SQL Agent job has successfully completed; this behavior is by design.</span></span> <span data-ttu-id="7fe92-195">エラーがある場合、ジョブが 1 分以内に再起動し、低下の実行を継続します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-195">If there is a failure, the job will restart within 1 minute and continue running unabated.</span></span> <span data-ttu-id="7fe92-196">そのため、このジョブの障害の発生の通知は通常無視できます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-196">Therefore, failure notifications for this job can typically be ignored.</span></span> <span data-ttu-id="7fe92-197">MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb SQL Server エージェント ジョブのジョブ履歴には、このジョブは常に失敗しました、再起動することが示されている場合、失敗/再起動サイクルの原因の詳細な調査必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-197">If the job history for the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb SQL Server Agent job indicates that this job is constantly failing and restarting then further investigation into the cause of the failure/restart cycle may be required.</span></span><br /><span data-ttu-id="7fe92-198">- **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** SQL Server エージェント ジョブはのみジョブを手動で有効にできません MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb ジョブによって開始されたためです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-198">-   The **MessageBox_Message_Cleanup_BizTalkMsgBoxDb** SQL Server Agent job is the only job that should not be manually enabled because it is initiated by the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job.</span></span><br /><span data-ttu-id="7fe92-199">- **DTA Purge and Archive** SQL Server エージェント ジョブが消去および追跡メッセージをアーカイブして、BizTalk Server 追跡データベースを管理します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-199">-   The **DTA Purge and Archive** SQL Server Agent job maintains the BizTalk Server tracking database by purging and archiving tracked messages.</span></span> <span data-ttu-id="7fe92-200">このジョブは、テーブル内のすべての行を読み取るし、かどうか、レコードを削除するかを決定する各行のタイムスタンプを比較します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-200">This job reads every row in the table and compares the timestamp of each row to determine if the record should be removed.</span></span> <span data-ttu-id="7fe92-201">**注:** BizTalk Server SQL Server エージェント ジョブをトラブルシューティングするには、エラーのない、MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb を除くすべての SQL エージェント ジョブが完了することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-201">**Note:**  When troubleshooting the BizTalk Server SQL Server Agent jobs, verify that all SQL Agent jobs except the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb are completing without errors.</span></span> <br /><br /> <span data-ttu-id="7fe92-202">SQL Server で使用される BizTalk Server の SQL エージェント ジョブに関する詳細については。</span><span class="sxs-lookup"><span data-stu-id="7fe92-202">For more information about the BizTalk Server SQL Agent Jobs used in SQL Server:</span></span><br /><br /> <span data-ttu-id="7fe92-203">-参照[データベース構造とジョブ](http://go.microsoft.com/fwlink/?LinkId=153451)(http://go.microsoft.com/fwlink/?LinkId=153451)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-203">-   See [Database Structure and Jobs](http://go.microsoft.com/fwlink/?LinkId=153451) (http://go.microsoft.com/fwlink/?LinkId=153451).</span></span><br /><span data-ttu-id="7fe92-204">-参照[BizTalk Server のジョブの SQL Server エージェントの説明](http://go.microsoft.com/fwlink/?LinkId=153452)(http://go.microsoft.com/fwlink/?LinkId=153452)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-204">-   See [Description of the SQL Server Agent jobs in BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153452) (http://go.microsoft.com/fwlink/?LinkId=153452).</span></span>|  
|<span data-ttu-id="7fe92-205">監視して中断されたインスタンスを終了します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-205">Monitor and terminate suspended instances</span></span>|<span data-ttu-id="7fe92-206">サービス インスタンスの中断 (再開可能) または中断 (再開不可) ことができます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-206">Service instances can be suspended (resumable) or suspended (not resumable).</span></span> <span data-ttu-id="7fe92-207">これらのサービス インスタンスには、メッセージング、オーケストレーション、またはポートがあります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-207">These service instances may be Messaging, Orchestration, or Port.</span></span> <span data-ttu-id="7fe92-208">BizTalk Server または Terminate.vbs スクリプトを使用して、BizTalk Server 管理コンソールで、グループ ハブ ページを使用して終了し、これらのインスタンスの削除に対応します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-208">BizTalk Server accommodates termination and removal of these instances by using the Group Hub page in the BizTalk Server Administration Console or through the use of the Terminate.vbs script.</span></span> <span data-ttu-id="7fe92-209">Terminate.vbs スクリプトの詳細については、次を参照してください。[中断サービス インスタンスを削除する](http://go.microsoft.com/fwlink/?LinkId=153453)(http://go.microsoft.com/fwlink/?LinkId=153453)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-209">For more information about the Terminate.vbs script, see [Removing Suspended Service Instance](http://go.microsoft.com/fwlink/?LinkId=153453) (http://go.microsoft.com/fwlink/?LinkId=153453).</span></span> <span data-ttu-id="7fe92-210">**ヒント:**中断されたインスタンスを削除する、ターミネータ ツールを使用することもできます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-210">**Tip:**  You can also use the Terminator tool to remove suspended instances.</span></span> <span data-ttu-id="7fe92-211">[ターミネータ ツール](http://go.microsoft.com/fwlink/?LinkId=151931)は、「 [http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931)です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-211">The [Terminator tool](http://go.microsoft.com/fwlink/?LinkId=151931) is available at [http://go.microsoft.com/fwlink/?LinkId=151931](http://go.microsoft.com/fwlink/?LinkId=151931).</span></span> <span data-ttu-id="7fe92-212">、Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関して保証を行いません。</span><span class="sxs-lookup"><span data-stu-id="7fe92-212">Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="7fe92-213">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-213">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="7fe92-214">用語「孤立アイテム」と「ゾンビ」は、同じ意味で使用されます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-214">The terms "orphans” and "zombies" are often used interchangeably.</span></span> <span data-ttu-id="7fe92-215">またはゾンビの孤立したメッセージは、メッセージがない関連付けられているサービス インスタンス、通常、メッセージを受け取る前に、サービス インスタンスが終了したためです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-215">An orphaned or zombie message is a message that does not have an associated service instance, typically because the service instance has terminated before the message was received.</span></span> <span data-ttu-id="7fe92-216">孤立したやゾンビ サービスは、サービス、関連するメッセージがないです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-216">An orphaned or zombie service is a service that does not have any associated messages.</span></span> <span data-ttu-id="7fe92-217">BizTalk Server のインスタンスを参照してくださいゾンビ メッセージとサービスの詳細については[BizTalk Server のゾンビ](http://go.microsoft.com/fwlink/?LinkId=153454)(http://go.microsoft.com/fwlink/?LinkId=153454)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-217">For more information about zombie messages and service instances in BizTalk Server see [Zombies in BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=153454) (http://go.microsoft.com/fwlink/?LinkId=153454).</span></span>|  
|<span data-ttu-id="7fe92-218">パフォーマンス カウンターを監視、 **PhysicalDisk**パフォーマンス オブジェクト</span><span class="sxs-lookup"><span data-stu-id="7fe92-218">Monitor the performance counters of the **PhysicalDisk** performance object</span></span>|<span data-ttu-id="7fe92-219">BizTalk Server は、SQL Server に多数の短い、非常に高速トランザクションを 1 分以内でいます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-219">BizTalk Server makes a large number of short, very quick transactions to SQL Server within one minute.</span></span> <span data-ttu-id="7fe92-220">場合は、SQL Server は、このアクティビティに耐えることはできません、BizTalk Server のパフォーマンスの問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-220">If the SQL Server cannot sustain this activity, you may experience BizTalk Server performance issues.</span></span> <span data-ttu-id="7fe92-221">モニター、 **avg.Disk Sec/read**、 **avg.Disk Sec/transfer**、および**avg.ディスク書き込み秒数**パフォーマンス モニター カウンター、 **PhysicalDisk**パフォーマンス オブジェクトです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-221">Monitor the **Avg. Disk sec/Read**, **Avg. Disk sec/Transfer**, and **Avg. Disk sec/Write** performance monitor counters in the **PhysicalDisk** performance object.</span></span> <span data-ttu-id="7fe92-222">最適な値は、10 ミリ秒未満 (ミリ秒) です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-222">The optimal value is less than 10 ms (milliseconds).</span></span> <span data-ttu-id="7fe92-223">以上 20 ミリ秒の値は、パフォーマンスの低下と見なされます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-223">A value of 20 ms or larger is considered poor performance.</span></span><br /><br /><span data-ttu-id="7fe92-224">BizTalk Server データベースの高可用性の詳細については、次を参照してください。 [BizTalk Server データベースの高可用性の実現](../core/providing-high-availability-for-biztalk-server-databases.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-224">-   For more information about BizTalk Server database high availability, see [Providing High Availability for BizTalk Server Databases](../core/providing-high-availability-for-biztalk-server-databases.md).</span></span>|  
|<span data-ttu-id="7fe92-225">BizTalk Server データベースのベスト プラクティスに従います。</span><span class="sxs-lookup"><span data-stu-id="7fe92-225">Follow best practices for BizTalk Server databases.</span></span>|<span data-ttu-id="7fe92-226">参照してください[BizTalk Server データベースを維持するためのベスト プラクティス](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-226">See [Best Practices for Maintaining BizTalk Server Databases](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md).</span></span>|  
  
<a name="BKMK_Troubleshoot"></a>   
## <a name="troubleshooting-biztalk-server-databases"></a><span data-ttu-id="7fe92-227">BizTalk Server データベースのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="7fe92-227">Troubleshooting BizTalk Server Databases</span></span>  
 <span data-ttu-id="7fe92-228">BizTalk Server データベースと問題のトラブルシューティングを行うには、次のタスクを実行します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-228">Perform the following tasks to troubleshoot any issues with BizTalk Server databases.</span></span>  
  
|<span data-ttu-id="7fe92-229">手順</span><span class="sxs-lookup"><span data-stu-id="7fe92-229">Steps</span></span>|<span data-ttu-id="7fe92-230">リファレンス</span><span class="sxs-lookup"><span data-stu-id="7fe92-230">Reference</span></span>|  
|-----------|---------------|  
|<span data-ttu-id="7fe92-231">必要なすべての BizTalk SQL Server エージェント ジョブを有効にして実行されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-231">Ensure all required BizTalk SQL Server Agent jobs are enabled and running</span></span>|<span data-ttu-id="7fe92-232">すべての BizTalk SQL Server エージェントのジョブを除く、 **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb**ジョブ必要がありますで実行されていて正常にします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-232">All the BizTalk SQL Server Agent jobs except the **MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb** job should be enabled and running successfully.</span></span> <span data-ttu-id="7fe92-233">その他の任意のジョブを無効にしないでください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-233">Do not disable any other job.</span></span><br /><br /> <span data-ttu-id="7fe92-234">障害が発生する場合を使用して、**履歴を表示する**SQL Server のエラー情報を表示し、それに応じて、失敗のトラブルシューティングのオプションです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-234">If a failure occurs, use the **View History** option in SQL Server to view the error information, and then troubleshoot the failure accordingly.</span></span> <span data-ttu-id="7fe92-235">注意して、 **MessageBox _Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server エージェント ジョブが無限に実行されます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-235">Remember that the **MessageBox _Message_ManageRefCountLog_BizTalkMsgBoxDb** SQL Server Agent job runs infinitely.</span></span> <span data-ttu-id="7fe92-236">したがって、おく必要がありますのみジョブ ヒストリをレポート ジョブが常に失敗し、再起動するときは注意します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-236">Therefore, you should only be concerned if the job history reports that the job constantly fails and restarts.</span></span>|  
|<span data-ttu-id="7fe92-237">MsgBoxViewer ツールを使用して、BizTalk メッセージ ボックス データベースとその他のデータベースの分析</span><span class="sxs-lookup"><span data-stu-id="7fe92-237">Use the MsgBoxViewer tool to analyze the BizTalk MessageBox and other databases</span></span>|<span data-ttu-id="7fe92-238">**重要:** Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関して保証を行いません。</span><span class="sxs-lookup"><span data-stu-id="7fe92-238">**Important:**  Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="7fe92-239">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-239">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="7fe92-240">MsgBoxViewer ツールはから利用可能な[http://go.microsoft.com/fwlink/?LinkId=151930](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-240">The MsgBoxViewer tool is available from [http://go.microsoft.com/fwlink/?LinkId=151930](http://go.microsoft.com/fwlink/?LinkId=151930) (http://go.microsoft.com/fwlink/?LinkId=151930).</span></span> <span data-ttu-id="7fe92-241">MsgBoxViewer ツールは、テーブルのサイズと、行の数の詳細については、html 形式のレポートを提供するためのトラブルシューティングに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-241">The MsgBoxViewer tool is useful for troubleshooting because it provides an HTML report that has detailed information about table sizes and the row count.</span></span> <span data-ttu-id="7fe92-242">レポートでは、BizTalk Server で制限されているかどうかを判断できます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-242">The report can also help determine whether BizTalk Server is throttling.</span></span> <span data-ttu-id="7fe92-243">さらに、このツールは、BizTalk Server データベースと BizTalk Server の構成のスナップショットを提供します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-243">Additionally, the tool provides a snapshot of the BizTalk Server databases and the BizTalk Server configuration.</span></span><br /><br /> <span data-ttu-id="7fe92-244">BizTalk Server が実行されている場合、通常より時間がかかります MsgBoxViewer ツールを実行して、クリックして選択のすべてのクエリで、**省略可能なクエリ**タブをクリックし、問題に生成された HTML レポートを確認します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-244">When BizTalk Server is running slower than usual, run the MsgBoxViewer tool, click to select all queries on the **Optional Queries** tab, and then review the generated HTML report for any problems.</span></span> <span data-ttu-id="7fe92-245">**概要レポート**セクションには、黄色、および潜在的な問題は赤色で警告が一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-245">The **Summary Report** section lists warnings in yellow and potential problems in red.</span></span><br /><br /> <span data-ttu-id="7fe92-246">さらに、テーブルは、最大規模およびほとんどのレコードがある判別を MsgBoxViewer ツールを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-246">Additionally, you can use the MsgBoxViewer tool to determine which tables are the largest and have the most records.</span></span> <span data-ttu-id="7fe92-247">通常、larges を拡大テーブルの一覧とそれらのテーブルを管理する方法の手順を参照してください。 [BizTalk Server データベース テーブルの大きな増加](~/technical-guides/large-growing-biztalk-server-database-tables.md)です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-247">For a list of tables that typically grow the larges and for instructions on how to manage those tables, see [Large-growing BizTalk Server Database Tables](~/technical-guides/large-growing-biztalk-server-database-tables.md).</span></span>|  
|<span data-ttu-id="7fe92-248">ツールを使用して、終端記号の問題を解決 MsgBoxViewer ツールによって、識別された場合</span><span class="sxs-lookup"><span data-stu-id="7fe92-248">Use the Terminator tool to resolve issues, if any, identified by the MsgBoxViewer tool</span></span>|<span data-ttu-id="7fe92-249">**重要:** Microsoft では、このツールの使用はサポートされていないと、Microsoft はこのプログラムの適合性に関して保証を行いません。</span><span class="sxs-lookup"><span data-stu-id="7fe92-249">**Important:**  Use of this tool is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this programs.</span></span> <span data-ttu-id="7fe92-250">このプログラムは、ユーザー自身の責任で使用してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-250">Use of this program is entirely at your own risk.</span></span> <br /><br /> <span data-ttu-id="7fe92-251">使用可能なターミネータ ツールを実行して[ターミネータ](http://go.microsoft.com/fwlink/?LinkId=151931)(http://go.microsoft.com/fwlink/?LinkId=151931)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-251">Run the Terminator tool available at [Terminator](http://go.microsoft.com/fwlink/?LinkId=151931) (http://go.microsoft.com/fwlink/?LinkId=151931).</span></span> <span data-ttu-id="7fe92-252">このツールでは、簡単に BizTalk MsgBoxViewer ツールによって識別される問題を解決することができます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-252">This tool enables users to easily resolve any issues identified by the BizTalk MsgBoxViewer tool.</span></span> <span data-ttu-id="7fe92-253">ターミネータ ツールが、BizTalk MsgBoxViewer ツールと統合する方法の詳細については、次を参照してください。 [BizTalk MsgBoxViewer によって特定された問題を解決するには BizTalk のターミネータを使用して](http://go.microsoft.com/fwlink/?LinkId=151932)(http://go.microsoft.com/fwlink/?LinkId=151932)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-253">For more information on how the Terminator tool integrates with the BizTalk MsgBoxViewer tool, see [Using BizTalk Terminator to resolve issues identified by BizTalk MsgBoxViewer](http://go.microsoft.com/fwlink/?LinkId=151932) (http://go.microsoft.com/fwlink/?LinkId=151932).</span></span>|  
|<span data-ttu-id="7fe92-254">デッドロックのシナリオを調査します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-254">Investigate deadlock scenarios</span></span>|<span data-ttu-id="7fe92-255">シナリオでは、デッドロック、デッドロック情報が、SQLERROR ログに書き込まれるように、SQL Server 上で DBCC の追跡を有効にします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-255">In a deadlock scenario, enable DBCC tracing on the SQL Server so that the deadlock information is written to the SQLERROR log.</span></span><br /><br /> <span data-ttu-id="7fe92-256">SQL Server では、デッドロックのシナリオの DBCC トレースを有効にするのには、次のステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-256">In SQL Server, execute the following statement to enable DBCC tracing for deadlock scenarios:</span></span><br /><br /> <span data-ttu-id="7fe92-257">DBCC TRACEON (1222、-1)</span><span class="sxs-lookup"><span data-stu-id="7fe92-257">DBCC TRACEON (1222,-1)</span></span><br /><br /> <span data-ttu-id="7fe92-258">PSSDIAG ユーティリティを使用してデータを収集する、 **Lock:deadlock**イベントおよび**Lock:deadlock Chain**イベント。</span><span class="sxs-lookup"><span data-stu-id="7fe92-258">You can also use the PSSDIAG utility to collect data on the **Lock:Deadlock** event and the **Lock:Deadlock Chain** event.</span></span> <span data-ttu-id="7fe92-259">PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-259">For more information about the PSSDIAG utility, see [PSSDIAG data collection utility](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).</span></span><br /><br /> <span data-ttu-id="7fe92-260">BizTalkMsgBoxDB データベースは、大量の高いトランザクション オンライン トランザクション処理 (OLTP) データベースです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-260">The BizTalkMsgBoxDB database is a high-volume and high-transaction Online Transaction Processing (OLTP) database.</span></span> <span data-ttu-id="7fe92-261">このようなデータベースでは、デッドロックの一部が予想され、BizTalk Server エンジンによって内部的に処理は、このデッドロックします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-261">With such databases, some deadlocking is expected and this deadlocking is handled internally by the BizTalk Server engine.</span></span> <span data-ttu-id="7fe92-262">この現象が発生したときに、エラー ログでエラーは表示されません。</span><span class="sxs-lookup"><span data-stu-id="7fe92-262">When this behavior occurs, no errors are listed in the error logs.</span></span> <span data-ttu-id="7fe92-263">デッドロックのシナリオを調査するときに、出力で調査している場合、デッドロックする必要がありますと相関しているイベント ログでデッドロック エラーです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-263">When you investigate a deadlock scenario, the deadlock that you are investigating in the output must be correlated with a deadlock error in the event logs.</span></span>|  
|<span data-ttu-id="7fe92-264">ブロックされたプロセスを探します</span><span class="sxs-lookup"><span data-stu-id="7fe92-264">Look for blocked processes</span></span>|<span data-ttu-id="7fe92-265">SQL Server の利用状況モニターを使用すると、ロックのシステム プロセスのサーバー プロセス識別子 (SPID) を取得します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-265">You can use Activity Monitor in SQL Server to obtain the server process identifier (SPID) of a locking system process.</span></span> <span data-ttu-id="7fe92-266">ロックの SPID で実行されている SQL ステートメントに SQL Profiler を実行することができます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-266">You can then run the SQL Profiler to determine the SQL statement that is executing in the locking SPID.</span></span> <span data-ttu-id="7fe92-267">PSSDIAG ユーティリティを使用すると、SQL Server のロックおよびブロックしている問題をトラブルシューティングします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-267">You can use the PSSDIAG utility to troubleshoot locking and blocking issues in SQL Server.</span></span> <span data-ttu-id="7fe92-268">ユーティリティは、有効になっているスクリプトのブロックを持つすべての TRANSACT-SQL イベントをキャプチャします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-268">The utility captures all the Transact-SQL events that have the blocking script enabled.</span></span> <span data-ttu-id="7fe92-269">PSSDIAG ユーティリティの詳細については、次を参照してください。 [PSSDIAG データ収集ユーティリティ](http://go.microsoft.com/fwlink/?LinkId=153627)(http://go.microsoft.com/fwlink/?LinkId=153627)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-269">For more information about the PSSDIAG utility, see [PSSDIAG data collection utility](http://go.microsoft.com/fwlink/?LinkId=153627) (http://go.microsoft.com/fwlink/?LinkId=153627).</span></span><br /><br /> <span data-ttu-id="7fe92-270">SQL Server で指定できます、**プロセスのしきい値をブロック**SPID または Spid を指定したしきい値よりも長くブロックしているを確認する設定。</span><span class="sxs-lookup"><span data-stu-id="7fe92-270">In SQL Server, you can specify the **blocked process threshold** setting to determine which SPID or SPIDs are blocking longer than the threshold that you specify.</span></span> <span data-ttu-id="7fe92-271">Blocked process threshold オプションの詳細については、次を参照してください。 [blocked process threshold オプション](http://go.microsoft.com/fwlink/?LinkId=153628)(http://go.microsoft.com/fwlink/?LinkId=153628)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-271">For more information about the blocked process threshold option, see [blocked process threshold Option](http://go.microsoft.com/fwlink/?LinkId=153628) (http://go.microsoft.com/fwlink/?LinkId=153628).</span></span> <span data-ttu-id="7fe92-272">**注:**マイクロソフト カスタマー サポート サービスにお問い合わせくださいを SQL Server でのロックまたはブロックしている問題が発生した場合にお勧めします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-272">**Note:**  When you experience a locking or blocking issue in SQL Server, we recommend that you contact Microsoft Customer Support Services.</span></span> <span data-ttu-id="7fe92-273">Microsoft カスタマー サポート サービスには、正しい PSSDiag ユーティリティのオプションを構成するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="7fe92-273">Microsoft Customer Support Services can help you configure the correct PSSDiag utility options.</span></span>|  
|<span data-ttu-id="7fe92-274">すべての不要なデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-274">Delete all unwanted data</span></span>|<span data-ttu-id="7fe92-275">データベースが大きくなりすぎたために拡大している場合、データベースに含まれるデータは必要ありませんできなくなった場合は、データを削除することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-275">If the databases have grown to become too large and if the data contained in the databases will not be required any longer, the preferred method is to delete the data.</span></span> <span data-ttu-id="7fe92-276">**注意:**使用しないでくださいこのメソッドすべての環境でデータがビジネス上重要またはデータが必要なかどうかを格納します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-276">**Caution:**  Do not use this method in any environment where the data is business critical or if the data is needed.</span></span> <br /><br /> <span data-ttu-id="7fe92-277">**BizTalkMsgBox データベースを消去するには**</span><span class="sxs-lookup"><span data-stu-id="7fe92-277">**To purge the BizTalkMsgBox database**</span></span><br /> <span data-ttu-id="7fe92-278">1.ダウンロードしてインストールでは、ターミネータ ツール[Biztalk 終端記号](http://go.microsoft.com/fwlink/?LinkId=220869)(http://go.microsoft.com/fwlink/?LinkId=220869)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-278">1.  Download and install the Terminator tool at [Biztalk Terminator](http://go.microsoft.com/fwlink/?LinkId=220869) (http://go.microsoft.com/fwlink/?LinkId=220869).</span></span><br /><span data-ttu-id="7fe92-279">2.トピックの手順に従って[テスト環境でメッセージ ボックス データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkID=158064)(http://go.microsoft.com/fwlink/?LinkID=158064) を作成、bts_CleanupMsgbox ストアド プロシージャを BizTalk メッセージ ボックス データベースです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-279">2.  Follow the steps in the topic [How to Manually Purge Data from the MessageBox Database in a Test Environment](http://go.microsoft.com/fwlink/?LinkID=158064) (http://go.microsoft.com/fwlink/?LinkID=158064) to create the bts_CleanupMsgbox stored procedure in the BizTalk MessageBox database.</span></span><br /><span data-ttu-id="7fe92-280">3.ターミネータ ツールを使用して、bts_CleanupMsgbox ストアド プロシージャを実行して、BizTalk メッセージ ボックス データベースを削除します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-280">3.  Use the Terminator tool to execute the bts_CleanupMsgbox stored procedure and purge the BizTalk MessageBox database.</span></span> <span data-ttu-id="7fe92-281">**警告:** BizTalk Server を実行している実稼働サーバーで、bts_CleanupMsgbox ストアド プロシージャを実行しないでください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-281">**Warning:**      Do not run the bts_CleanupMsgbox stored procedure on a production server that is running BizTalk Server.</span></span> <span data-ttu-id="7fe92-282">bts_CleanupMsgbox ストアド プロシージャは、テスト環境でのみ実行してください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-282">You should only run the bts_CleanupMsgbox stored procedure in a test environment.</span></span> <span data-ttu-id="7fe92-283">運用環境での bts_CleanupMsgbox ストアド プロシージャの実行はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="7fe92-283">Running the bts_CleanupMsgbox stored procedure in a production environment is not supported.</span></span><br /><span data-ttu-id="7fe92-284">4.すべてのホストと BizTalk Server サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-284">4.  Restart all hosts and BizTalk Server services.</span></span><br /><br /> <span data-ttu-id="7fe92-285">**BizTalkDTADb データベースを消去するには**</span><span class="sxs-lookup"><span data-stu-id="7fe92-285">**To purge the BizTalkDTADb database**</span></span><br /> <ul><li><span data-ttu-id="7fe92-286">**方法 1**</span><span class="sxs-lookup"><span data-stu-id="7fe92-286">**Method 1**</span></span><br /><br /> <ol><li><span data-ttu-id="7fe92-287">すべての BizTalk Server データベースをバックアップします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-287">Back up all BizTalk Server databases.</span></span></li><li><span data-ttu-id="7fe92-288">実行、 **[dtasp_purgeallcompletedtrackingdata]**ストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-288">Execute the **dtasp_PurgeAllCompletedTrackingData** stored procedure.</span></span> <span data-ttu-id="7fe92-289">ストアド プロシージャの詳細については、次を参照してください。 [BizTalk 追跡データベースからデータを手動で消去する方法](http://go.microsoft.com/fwlink/?LinkId=153635)(http://go.microsoft.com/fwlink/?LinkId=153635)。</span><span class="sxs-lookup"><span data-stu-id="7fe92-289">For more information about the stored procedure, see [How to Manually Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkId=153635) (http://go.microsoft.com/fwlink/?LinkId=153635).</span></span></li></ol></li><li><span data-ttu-id="7fe92-290">**方法 2**です。</span><span class="sxs-lookup"><span data-stu-id="7fe92-290">**Method 2**.</span></span> <span data-ttu-id="7fe92-291">BizTalkDTADb データベースには、削除する必要がある多くの不完全なインスタンスが含まれている場合にのみ、このオプションを使用します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-291">Use this option only if the BizTalkDTADb database contains many incomplete instances that must be removed.</span></span><br /><br /> <ol><li><span data-ttu-id="7fe92-292">すべての BizTalk Server データベースをバックアップします。</span><span class="sxs-lookup"><span data-stu-id="7fe92-292">Back up all BizTalk Server databases.</span></span></li><li><span data-ttu-id="7fe92-293">すべての BizTalk ホスト、サービス、およびカスタム分離アダプターを停止します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-293">Stop all BizTalk hosts, services, and custom isolated adapters.</span></span> <span data-ttu-id="7fe92-294">HTTP アダプタまたは SOAP アダプタを使用する場合は、IIS サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-294">If you use HTTP or the SOAP adapter, restart the IIS services.</span></span></li><li><span data-ttu-id="7fe92-295">実行、 **dtasp_CleanHMData** BizTalkDTADb データベースでストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="7fe92-295">Execute the **dtasp_CleanHMData** stored procedure on the BizTalkDTADb database.</span></span></li><li><span data-ttu-id="7fe92-296">すべてのホストと BizTalk Server サービスを再起動します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-296">Restart all hosts and BizTalk Server services.</span></span></li></ol></li></ul> <span data-ttu-id="7fe92-297">**注:**場合は、追跡データを BizTalkDTADb データベースをバックアップする必要がありますを別の SQL サーバー データベースを復元し、元の BizTalkDTADb データベースを削除します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-297">**Note:**  If you must have the tracking data, back up the BizTalkDTADb database, restore the database to another SQL Server, and then purge the original BizTalkDTADb database.</span></span>|  
  
 <span data-ttu-id="7fe92-298">ヘルプ MsgBoxViewer データまたは PSSDIAG 出力を分析する場合は、マイクロソフト カスタマー サポート サービスにお問い合わせください。</span><span class="sxs-lookup"><span data-stu-id="7fe92-298">If you want help analyzing the MsgBoxViewer data or PSSDIAG output, contact Microsoft Customer Support Services.</span></span> <span data-ttu-id="7fe92-299">カスタマー サポート サービスに問い合わせる前に、MsgBoxViewer データ、PSSDIAG 出力、および更新後のイベント ログ (.evt ファイル) を圧縮します。</span><span class="sxs-lookup"><span data-stu-id="7fe92-299">Before you contact Customer Support Services, compress the MsgBoxViewer data, the PSSDIAG output, and the updated event logs (.evt files).</span></span> <span data-ttu-id="7fe92-300">これらのファイル、BizTalk Server をサポート技術者に送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7fe92-300">You may have to send these files to a BizTalk Server support engineer.</span></span>
  
## <a name="next"></a><span data-ttu-id="7fe92-301">Next</span><span class="sxs-lookup"><span data-stu-id="7fe92-301">Next</span></span>
  
-   [<span data-ttu-id="7fe92-302">BizTalk Server データベースを保守する場合のベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="7fe92-302">Best Practices for Maintaining BizTalk Server Databases</span></span>](~/technical-guides/best-practices-for-maintaining-biztalk-server-databases.md)  
  
-   [<span data-ttu-id="7fe92-303">BizTalk Server データベース テーブルの大規模な成長</span><span class="sxs-lookup"><span data-stu-id="7fe92-303">Large-growing BizTalk Server Database Tables</span></span>](~/technical-guides/large-growing-biztalk-server-database-tables.md)  
  
-   [<span data-ttu-id="7fe92-304">トラブルシューティング用のツールとユーティリティ</span><span class="sxs-lookup"><span data-stu-id="7fe92-304">Tools and Utilities for Troubleshooting</span></span>](../technical-guides/tools-and-utilities-for-troubleshooting.md)  
  
## <a name="see-also"></a><span data-ttu-id="7fe92-305">参照</span><span class="sxs-lookup"><span data-stu-id="7fe92-305">See Also</span></span>  
 [<span data-ttu-id="7fe92-306">変更しない SQL Server の設定</span><span class="sxs-lookup"><span data-stu-id="7fe92-306">SQL Server Settings That Should Not Be Changed</span></span>](~/technical-guides/sql-server-settings-that-should-not-be-changed.md)