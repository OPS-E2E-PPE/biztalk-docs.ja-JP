---
title: "スケール アウトは、BizTalk Server データベース |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 18853ceb-7975-4c30-878f-6b162005f795
caps.latest.revision: "2"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e3116b7aae087e74ade089c8020a7d35c883cd2e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="scaling-out-the-biztalk-server-databases"></a><span data-ttu-id="aa2d5-102">BizTalk Server データベースのスケール アウト</span><span class="sxs-lookup"><span data-stu-id="aa2d5-102">Scaling Out the BizTalk Server Databases</span></span>
<span data-ttu-id="aa2d5-103">高可用性を実現する、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース、構成を実行している 2 台のコンピューター[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]または[!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)]Windows クラスターでします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-103">To provide high availability for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, configure two computers that are running [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)] or [!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)] in a Windows cluster.</span></span> <span data-ttu-id="aa2d5-104">これらのコンピューターは、アクティブ/アクティブ、アクティブ/パッシブまたはアクティブ/アクティブ/パッシブ (3 台のコンピューターが必要です) で実行できる冗長性の構成を共有ドライブ上のデータを格納できます (RAID など 1 + 0 SCSI ディスク アレイ) またはストレージ エリア ネットワーク (SAN)。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-104">These computers can run in an active/active, active/passive, or active/active/passive (requires three computers) configuration for redundancy and can store data on a shared drive (such as a RAID 1+0 SCSI disk array) or storage area network (SAN).</span></span>  
  
 <span data-ttu-id="aa2d5-105">場合、[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]何らかの理由でサービスが使用できなくなった、データベース クラスターは、リソースを active コンピューターからパッシブ側コンピューターに転送します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-105">If the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] service becomes unavailable for any reason, the database cluster transfers resources from the active computer to the passive computer.</span></span> <span data-ttu-id="aa2d5-106">このフェールオーバー処理中に、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]サービス インスタンスがデータベース接続エラーが発生し、データベースへの再接続を自動的に再起動します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-106">During this failover process, the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] service instances experience database connection failures and automatically restart to reconnect to the databases.</span></span> <span data-ttu-id="aa2d5-107">正常に動作しているデータベース コンピューター (先ほどまでパッシブ側であったコンピューター) が、フェールオーバーでリソースを引き継いだ後、データベース接続の処理を開始します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-107">The functioning database computer (previously the passive computer) begins processing the database connections after assuming the resources during failover.</span></span>  
  
 <span data-ttu-id="aa2d5-108">クラスタ リング、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースは、後ほど[BizTalk Server Databases2 をクラスタ リング](../technical-guides/clustering-the-biztalk-server-databases2.md)です。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-108">Clustering the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases is discussed in [Clustering the BizTalk Server Databases2](../technical-guides/clustering-the-biztalk-server-databases2.md).</span></span> <span data-ttu-id="aa2d5-109">このセクションでは、スケール アウト重点的、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースを高可用性を提供します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-109">This section focuses on scaling out the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases to provide high availability.</span></span>  
  
## <a name="providing-high-availability-for-the-biztalk-messagebox-database"></a><span data-ttu-id="aa2d5-110">BizTalk メッセージ ボックス データベースの高可用性を実現します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-110">Providing High Availability for the BizTalk MessageBox Database</span></span>  
 <span data-ttu-id="aa2d5-111">このセクションを高可用性のための BizTalk メッセージ ボックス データベースを構成する情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-111">This section provides information about to configure BizTalk MessageBox database for high availability.</span></span>  
  
### <a name="running-multiple-messagebox-databases"></a><span data-ttu-id="aa2d5-112">複数のメッセージ ボックス データベースの実行</span><span class="sxs-lookup"><span data-stu-id="aa2d5-112">Running Multiple MessageBox Databases</span></span>  
 <span data-ttu-id="aa2d5-113">スケーラビリティを強化するために、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベースとアドレス CPU 使用率が高く、メッセージ ボックス データベースに[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]、コンピューターを構成できます[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]を複数のメッセージ ボックス データベース間でデータを格納します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-113">To enhance the scalability of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases and to address high CPU utilization on the MessageBox database [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] computer, you can configure [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to store data across multiple MessageBox databases.</span></span> <span data-ttu-id="aa2d5-114">最初のメッセージ ボックス データベースは、構成ウィザードの実行時に作成されます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-114">You create the first MessageBox database when you run the Configuration Wizard.</span></span> <span data-ttu-id="aa2d5-115">このメッセージ ボックス データベースは、マスターのメッセージ ボックス データベースです。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-115">This MessageBox database is the master MessageBox database.</span></span> <span data-ttu-id="aa2d5-116">内の単一のマスター メッセージ ボックス データベースがある、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]展開します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-116">There is a single master MessageBox database in your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] deployment.</span></span> <span data-ttu-id="aa2d5-117">マスターのメッセージ ボックス データベースは、マスターのサブスクリプション情報を含み、メッセージを適切なメッセージ ボックス データベースにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-117">The master MessageBox database contains the master subscription information and routes messages to the appropriate MessageBox database.</span></span> <span data-ttu-id="aa2d5-118">通常、する専用のルーティングのみを行うマスター メッセージ ボックス データベースに対して処理を実行して、他のメッセージ ボックス データベースを使用できます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-118">Typically, you want to dedicate the master MessageBox database to do routing only and let the other MessageBox databases do the processing.</span></span> <span data-ttu-id="aa2d5-119">メッセージ ボックス データベースをルーティングのみを行うには、次のように選択します。**新しいメッセージの公開を無効にする**BizTalk 管理コンソールで、メッセージ ボックス プロパティです。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-119">To make a MessageBox database to do routing only, select **Disable new message publication** from the MessageBox properties in BizTalk Administration console.</span></span>  
  
 <span data-ttu-id="aa2d5-120">メッセージ ボックス データベースの処理フローの例は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-120">An example of MessageBox database processing flow is as follows:</span></span>  
  
1.  <span data-ttu-id="aa2d5-121">マスター メッセージ ボックス データベースが新しいアクティベーション メッセージを受信すると、ビジネス プロセスまたはサブスクリプションのメッセージの新しいインスタンス — マスター メッセージ ボックス データベースは、[次へ] の使用可能なメッセージ ボックス データベースにアクティブ化メッセージを配信します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-121">When the master MessageBox database receives a new activation message—a brand new instance of a business process or a subscription message—the master MessageBox database distributes the activation message to the next available MessageBox database.</span></span> <span data-ttu-id="aa2d5-122">たとえば、1 つのマスター メッセージ ボックス データベースと 2 つのメッセージ ボックス データベースを使用する場合、マスター メッセージ ボックス データベースは、ラウンドロビン方式で、最初のアクティベーション メッセージをメッセージ ボックス データベース 1 に、2 つ目のアクティベーション メッセージをメッセージ ボックス データベース 2 に、3 つ目のアクティベーション メッセージをメッセージ ボックス データベース 1 に送信します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-122">For example, if you have one master MessageBox database and two MessageBox databases, the master MessageBox database routes the first activation message to MessageBox database 1, the second activation message to MessageBox database 2, the third activation message to MessageBox database 1, and so on in a round-robin pattern.</span></span> <span data-ttu-id="aa2d5-123">マスターのメッセージ ボックス データベースでは、負荷分散のロジックを組み込んでいるので、追加の負荷分散メカニズムは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-123">The master MessageBox database uses built-in logic to load balance, and does not need additional load-balancing mechanisms.</span></span>  
  
2.  <span data-ttu-id="aa2d5-124">マスターのメッセージ ボックス データベースがアクティベーション メッセージを特定のメッセージ ボックス データベース (メッセージ ボックス データベース 1 など) に送信してから、ビジネス プロセスがメモリに読み込まれ、実行されます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-124">After the master MessageBox database routes the activation message to a particular MessageBox database (for example, MessageBox database 1), the business process goes into memory and runs.</span></span>  
  
3.  <span data-ttu-id="aa2d5-125">ビジネス プロセスには、メッセージに対して待機すると、待機時間は数秒以上、ビジネス プロセスはメッセージ ボックス データベース 1 に保存されます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-125">If the business process has to wait for a message, and the wait time is longer than several seconds, the business process is persisted back into MessageBox database 1.</span></span> <span data-ttu-id="aa2d5-126">ビジネス プロセスは、関連メッセージを待機しています。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-126">The business process is waiting for a correlation message.</span></span>  
  
4.  <span data-ttu-id="aa2d5-127">マスター メッセージ ボックス データベースで関連メッセージが到着すると、メッセージ エンジンが (この例では、メッセージ ボックス 1) で関連メッセージの状態を含むメッセージ ボックス データベースのデータベースでルックアップ操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-127">When the correlation message arrives at the master MessageBox database, the Message Engine does a lookup operation in the database for the MessageBox database that contains the state for the correlation message (in this example, MessageBox 1).</span></span> <span data-ttu-id="aa2d5-128">マスター メッセージ ボックス データベースでは、ビジネス プロセスを含むメッセージ ボックス データベースにメッセージが配信されます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-128">The master MessageBox database delivers the message to the MessageBox database that contains the business process.</span></span>  
  
5.  <span data-ttu-id="aa2d5-129">ビジネス プロセスは、完了するまで、または別の関連メッセージを待機する必要がある処理を続行するメモリに戻さはします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-129">The business process is brought back into memory to continue processing until it finishes or until it has to wait for another correlation message.</span></span>  
  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="aa2d5-130">ストア、メッセージ ボックス データベース内のすべての状態および各メッセージ ボックス データベースには、さまざまなビジネス プロセスの状態情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-130"> stores all the states in the MessageBox databases, and each MessageBox database contains state information for different business processes.</span></span> <span data-ttu-id="aa2d5-131">信頼性を確保するため、マスター メッセージ ボックス データベースおよびセカンダリ メッセージ ボックス データベースを含むすべてのメッセージ ボックス データベースをクラスター化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-131">For reliability, you must cluster all the MessageBox databases, including the master and secondary MessageBox databases.</span></span>  
  
 <span data-ttu-id="aa2d5-132">使用する複数のメッセージ ボックス データベースを構成するのには[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールを実行しているコンピューターの追加を[!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)]または[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-132">To configure multiple MessageBox databases, you use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console to add the computers that are running [!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)] or [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)].</span></span> <span data-ttu-id="aa2d5-133">管理的には、新しいメッセージ ボックス データベースを追加する必要があるだけです。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-133">From an administration perspective, you only have to add new MessageBox databases.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="aa2d5-134">自動的にアクティベーション メッセージのラウンドロビン配信を処理し、正しいメッセージ ボックス データベースに関連付けられたメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-134"> automatically handles the round-robin distribution of activation messages and sends correlation messages to the correct MessageBox databases.</span></span>  
  
 <span data-ttu-id="aa2d5-135">環境内で複数のメッセージ ボックス データベースを構成する場合は、3 つのメッセージ ボックス データベースの最小値を作成する必要があります、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]グループと、マスター メッセージ ボックス データベースでメッセージの公開を無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-135">If you configure multiple MessageBox databases in your environment you should create a minimum of three MessageBox databases for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] group and you should disable message publication on the master MessageBox database.</span></span> <span data-ttu-id="aa2d5-136">この推奨事項はメッセージ ボックス データベース間でメッセージのルーティング用のマスター メッセージ ボックス データベースによってオーバーヘッドが追加のメッセージ ボックス データベースを追加するためになります。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-136">This recommendation is made because adding additional MessageBox databases incurs overhead by the master MessageBox database for routing messages between the MessageBox databases.</span></span> <span data-ttu-id="aa2d5-137">2 つのメッセージ ボックス データベースを構成するだけの場合、追加のメッセージ ボックス データベースによって得られる利点のほとんどは、メッセージのルーティングにマスター メッセージ ボックス データベースによって使用されるオーバーヘッドで相殺されます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-137">If you only configure two MessageBox databases then most of the benefit gained by the additional MessageBox database is offset by the overhead consumed by the master MessageBox database for message routing.</span></span>  
  
> [!IMPORTANT]  
>  [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="aa2d5-138">ストア、メッセージ ボックス データベース内のすべての状態および各メッセージ ボックス データベースには、さまざまなビジネス プロセスの状態情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-138"> stores all the states in the MessageBox databases, and each MessageBox database contains state information for different business processes.</span></span> <span data-ttu-id="aa2d5-139">信頼性を確保するため、マスター メッセージ ボックス データベースおよびセカンダリ メッセージ ボックス データベースを含むすべてのメッセージ ボックス データベースをクラスター化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-139">For reliability, you must cluster all the MessageBox databases, including the master and secondary MessageBox databases.</span></span>  
  
### <a name="providing-high-availability-for-multiple-messagebox-databases"></a><span data-ttu-id="aa2d5-140">複数のメッセージ ボックス データベースの高可用性を実現する</span><span class="sxs-lookup"><span data-stu-id="aa2d5-140">Providing High Availability for Multiple MessageBox Databases</span></span>  
 <span data-ttu-id="aa2d5-141">メッセージ ボックス データベースを追加するときに、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]展開がスケーラビリティを向上させ、各メッセージ ボックス データベースで一意で独立したありの単一障害点になる可能性があるために、高可用性は提供しません、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-141">While adding MessageBox databases to your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] deployment improves scalability, it does not provide high availability because each MessageBox database is unique and independent and is potentially a single point of failure for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="aa2d5-142">冗長性を拡張するには、各メッセージ ボックス データベースについてサーバー クラスターを構成します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-142">To add redundancy involves configuring a server cluster for each MessageBox database.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="aa2d5-143">データベースのデータを共有またはしないサーバーがクラスター化されていない冗長性を提供するための複数のメッセージ ボックス データベース間でデータを配布します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-143"> distributes data across the multiple MessageBox databases, so the databases do not share data or otherwise provide redundancy without server clustering.</span></span>  
  
## <a name="providing-high-availability-for-the-biztalk-tracking-database"></a><span data-ttu-id="aa2d5-144">BizTalk 追跡データベースの高可用性を実現する</span><span class="sxs-lookup"><span data-stu-id="aa2d5-144">Providing High Availability for the BizTalk Tracking Database</span></span>  
 <span data-ttu-id="aa2d5-145">個別に BizTalk 追跡データベースを分離することによって追跡のパフォーマンスを強化するために、特定の展開の要件に応じてする可能性があります[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]コンピューター別に作成する、ホストの追跡に専用の BizTalk ホストとします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-145">Depending on the requirements of your particular deployment, you might want to enhance performance for tracking by isolating the BizTalk Tracking database onto a separate [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] computer and by creating a separate BizTalk Host dedicated to host tracking.</span></span> <span data-ttu-id="aa2d5-146">次の図は、2 つのホスト インスタンスおよびクラスター化されたデータベースを専用の追跡ホストの一覧です。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-146">The following figure shows a dedicated tracking host with two host instances and clustered databases.</span></span>  
  
 <span data-ttu-id="aa2d5-147">![追跡データベースのスケール アウト](../technical-guides/media/4fc1d448-2a6c-4cea-ac17-96c1263dfb68.gif "4fc1d448-2a6c-4cea-ac17-96c1263dfb68")</span><span class="sxs-lookup"><span data-stu-id="aa2d5-147">![Scaling out the tracking databases](../technical-guides/media/4fc1d448-2a6c-4cea-ac17-96c1263dfb68.gif "4fc1d448-2a6c-4cea-ac17-96c1263dfb68")</span></span>  
  
 <span data-ttu-id="aa2d5-148">追跡のオーバーヘッドが実行しているコンピューターで多くのリソースを消費可能性がある場合は、展開には高いスループットがあり、これらのメッセージのデータの大量に追跡、[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-148">If your deployment has high throughput and involves tracking lots of data for these messages, the tracking overhead could potentially consume lots of resources on the computer that is running [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span> <span data-ttu-id="aa2d5-149">このような状況が発生し、受信メッセージの率が高いが引き続き発生する場合[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]を処理できない新着メッセージを追跡するために必要なリソースが、他の実行に必要なリソースを超えているため、ポイントに達すると[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]コンポーネント (メッセージを受信して、それらをメッセージ ボックス データベースに保存する) などです。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-149">If this situation occurs and a high rate of incoming messages continues, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] reaches a point where it cannot process new messages because the resources required to track messages are greater than the resources required to run the other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] components (such as receiving messages and persisting them to the MessageBox database).</span></span>  
  
 <span data-ttu-id="aa2d5-150">パフォーマンスとセキュリティを向上させるのには、その他の項目 (受信場所、オーケストレーション、パイプラインなど) を含まない追跡ホスト専用の使用してを処理、および送信ホスト、受信からの追跡を無効にすることを勧めします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-150">To improve performance and security, we recommend that you dedicate a host for tracking that does not contain any other items (such as receive locations, orchestrations, or pipelines) and that you disable tracking from the receiving, processing, and sending hosts.</span></span> <span data-ttu-id="aa2d5-151">追跡ホストの高可用性を実現するには、追跡ホストの複数のインスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-151">To provide high availability for the tracking host, create more than one host instance of the tracking host.</span></span> <span data-ttu-id="aa2d5-152">追跡ホストの作成の詳細については、次を参照してください。[を新しいホストを作成する方法](http://go.microsoft.com/fwlink/?LinkId=156825)(http://go.microsoft.com/fwlink/?LinkId=156825) で[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ヘルプ。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-152">For more information about creating a tracking host, see [How to Create a New Host](http://go.microsoft.com/fwlink/?LinkId=156825) (http://go.microsoft.com/fwlink/?LinkId=156825) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
 <span data-ttu-id="aa2d5-153">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は、各メッセージ ボックス データベースについて追跡ホスト インスタンスを 1 つだけ使用し、メッセージ ボックス データベースから BizTalk 追跡データベース (BizTalkDTADb) にメッセージを移動します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-153">For each MessageBox database, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses only one tracking host instance to move messages from the MessageBox database to the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="aa2d5-154">追加のコンピューター、追跡ホストのインスタンスを実行する場合は[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]追跡ホストの別のインスタンスには、各メッセージ ボックス データベースの処理を自動的にスケールを設定します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-154">If additional computers run instances of the tracking host, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] automatically scales out the handling of each MessageBox database to a separate instance of the tracking host.</span></span> <span data-ttu-id="aa2d5-155">メッセージ ボックス データベースの数が追跡ホストのインスタンスの数よりも多くなった場合は、1 つまたは複数の追跡ホストのインスタンスが、複数のメッセージ ボックス データベースに対するサービスを提供します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-155">If the number of MessageBox databases is larger than the number of tracking host instances, one or more tracking host instances will service more than one MessageBox database.</span></span>  
  
 <span data-ttu-id="aa2d5-156">BizTalk 追跡データベースの高可用性を実現するを使用して Windows クラスタ リングを実行している 2 つのデータベース コンピューターを構成する[!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)]または[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]アクティブ/パッシブ構成にします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-156">To provide high availability for the BizTalk Tracking database, use Windows Clustering to configure two database computers that are running [!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)] or [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)] in an active/passive configuration.</span></span>  
  
## <a name="providing-high-availability-for-the-bam-databases"></a><span data-ttu-id="aa2d5-157">BAM データベースの高可用性を実現する</span><span class="sxs-lookup"><span data-stu-id="aa2d5-157">Providing High Availability for the BAM Databases</span></span>  
 <span data-ttu-id="aa2d5-158">*ビジネス アクティビティ監視*(BAM) は、IT の実装のや異種 IT 実装間で独立したビジネス プロセスの可視性を提供します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-158">*Business Activity Monitoring* (BAM) provides visibility into business processes independent of the IT implementation or across a heterogeneous IT implementation.</span></span> <span data-ttu-id="aa2d5-159">BAM[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]データベース (BAM スター スキーマ データベース、BAM プライマリ インポート データベース、および BAM アーカイブ データベース) および BAM 分析データベースが運用の監視データとは異なるビジネス アクティビティ データを格納します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-159">The BAM [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] databases (BAM Star Schema database, BAM Primary Import database, and BAM Archive database) and the BAM Analysis database store the business activity data that is different from the operational monitoring data.</span></span> <span data-ttu-id="aa2d5-160">次の図は、BAM データベースのインフラストラクチャです。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-160">The following diagram shows the BAM database infrastructure.</span></span>  
  
 <span data-ttu-id="aa2d5-161">![BAM データベースのインフラストラクチャ](../technical-guides/media/769c3b7c-fe16-4260-967e-6af003c4f08d.gif "769c3b7c-fe16-4260-967e-6af003c4f08d")</span><span class="sxs-lookup"><span data-stu-id="aa2d5-161">![BAM database infrastructure](../technical-guides/media/769c3b7c-fe16-4260-967e-6af003c4f08d.gif "769c3b7c-fe16-4260-967e-6af003c4f08d")</span></span>  
  
 <span data-ttu-id="aa2d5-162">BAM インフラストラクチャの高可用性を確保するには、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-162">To make sure your BAM infrastructure is highly available, do the following:</span></span>  
  
-   <span data-ttu-id="aa2d5-163">**BAM プライマリ インポート データベースおよび BAM 分析データベースをクラスタです。**</span><span class="sxs-lookup"><span data-stu-id="aa2d5-163">**Cluster the BAM Primary Import database and the BAM Analysis database.**</span></span> <span data-ttu-id="aa2d5-164">BAM プライマリ インポート データベースは、ビジネス アクティビティ監視システムの中心です。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-164">The BAM Primary Import database is the center of the Business Activity Monitoring system.</span></span> <span data-ttu-id="aa2d5-165">このため、Windows クラスタリングを使用してこのデータベースの高可用性を実現し、次の 2 つの推奨方法に従ってこのデータベースがいっぱいになるのを防ぐことが重要です。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-165">It is therefore important that you make this database highly available by using Windows Clustering and that you follow the next two recommendations to prevent this database from filling up.</span></span> <span data-ttu-id="aa2d5-166">BAM 分析データベースは、ビジネス アナリストがアクティビティの集計や OLAP キューブの構築に使用するデータを格納する Analysis Services データベースです。このため、このデータベースのダウンタイムは、生産性に影響します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-166">The BAM Analysis database is an Analysis Services database that stores the data that business analysts use to build activity aggregations and OLAP cubes, and therefore any downtime of this database affects their productivity.</span></span> <span data-ttu-id="aa2d5-167">BAM アーカイブ データベースをクラスターにはない、ことをお勧め、SQL Server Integration Services (SSIS) パッケージの実行をデータが正常に転送されるかどうかを確認し、データベースのサイズを監視するときに、イベント ログでエラーを監視します。置き換えることができます、前に、塗りつぶしをします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-167">While you do not have to cluster the BAM Archive database, we recommend that you monitor the event log for errors when the SQL Server Integration Services (SSIS) packages run to make sure the data has been transferred successfully, and to monitor the size of the database so that you can replace it before it fills up.</span></span>  
  
-   <span data-ttu-id="aa2d5-168">**オンライン ウィンドウを定義します。**</span><span class="sxs-lookup"><span data-stu-id="aa2d5-168">**Define an online window.**</span></span> <span data-ttu-id="aa2d5-169">パフォーマンス向上のための許可を回避するためダウンタイム、BAM のパーティション、BAM プライマリ インポート データベース内のデータをアクティビティが完了した時点のタイムスタンプに基づいてテーブルにします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-169">To allow for better performance and avoid downtime, BAM partitions the data in the BAM Primary Import database into tables based on the timestamp when the activity was completed.</span></span> <span data-ttu-id="aa2d5-170">BAM は、完了したテーブルと同一フォーマットの空のテーブルを定期的に交換して、この機能を実現します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-170">BAM achieves this by regularly swapping the completed table with another empty table of identical format.</span></span> <span data-ttu-id="aa2d5-171">BAM がこの処理を行った後、BAM は、オンライン ウィンドウに定義されている期間、古いパーティションを保存します。また、追加の完了したアクティビティは、新しいパーティション (テーブル) に格納されます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-171">After BAM does this, the additional completed activities go into the new partition (table), while BAM keeps the old partitions for the time defined in the online window.</span></span> <span data-ttu-id="aa2d5-172">BAM プライマリ インポート データベースのパーティション数が大きくなりすぎないように、オンライン ウィンドウを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-172">You must define an online window to make sure the number of partitions in the BAM Primary Import database does not grow too large.</span></span> <span data-ttu-id="aa2d5-173">オンラインの windows のスケジュール設定に関する詳細については、次を参照してください。[プライマリ インポート データベースのデータのアーカイブ](http://go.microsoft.com/fwlink/?LinkId=156826)(http://go.microsoft.com/fwlink/?LinkId=156826) で[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ヘルプ。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-173">For more information about scheduling online windows, see [Archiving Primary Import Database Data](http://go.microsoft.com/fwlink/?LinkId=156826) (http://go.microsoft.com/fwlink/?LinkId=156826) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
-   <span data-ttu-id="aa2d5-174">**SSIS パッケージを定期的に実行するスケジュールを設定します。**</span><span class="sxs-lookup"><span data-stu-id="aa2d5-174">**Schedule SSIS packages to run periodically.**</span></span> <span data-ttu-id="aa2d5-175">オンライン ウィンドウを定義することにより、古いアクティビティのパーティションで BAM プライマリ インポート データベースがいっぱいになる状態を回避できます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-175">Defining an online window makes sure your BAM Primary Import database does not fill up with old activity partitions.</span></span> <span data-ttu-id="aa2d5-176">また、アクティビティ データに対する新しいパーティションを作成して、BAM プライマリ インポート データベースの古いパーティションから BAM アーカイブ データベースにデータを移動する、定期的に実行する SSIS パッケージをスケジュールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-176">You must also schedule SSIS packages to run periodically to create a new partition for the activity data and to move the data from the old partitions in the BAM Primary Import database into the BAM Archive database.</span></span> <span data-ttu-id="aa2d5-177">SSIS パッケージのスケジュール設定の詳細については、次を参照してください。 [SQL Server Integration Services のパッケージをスケジュール](http://go.microsoft.com/fwlink/?LinkId=156827)(http://go.microsoft.com/fwlink/?LinkId=156827) で[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ヘルプ。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-177">For more information about scheduling SSIS packages, see [Scheduling SQL Server Integration Services Packages](http://go.microsoft.com/fwlink/?LinkId=156827) (http://go.microsoft.com/fwlink/?LinkId=156827) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
-   <span data-ttu-id="aa2d5-178">**慎重にデータ項目 (チェックポイント) の小さなセットを選択し、アクティビティを定義するときに不要なデータ項目が含まれないようにします。**</span><span class="sxs-lookup"><span data-stu-id="aa2d5-178">**Carefully choose small sets of data items (checkpoints), and avoid including unnecessary data items when defining an activity.**</span></span>  
  
-   <span data-ttu-id="aa2d5-179">**スケジュールされたスキャンとリアルタイムの集計、集計をデザインするときに間のトレードオフを理解します。**</span><span class="sxs-lookup"><span data-stu-id="aa2d5-179">**Understand the trade-offs between scheduled and real-time aggregations when you design your aggregations.**</span></span> <span data-ttu-id="aa2d5-180">リアルタイム集計はによって自動的に維持[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]待機時間ゼロとトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-180">Real-time aggregations are automatically maintained by [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] triggers and have zero latency.</span></span> <span data-ttu-id="aa2d5-181">一部のミッション クリティカルな待機時間の短いシナリオに最適ですが、パフォーマンス イベントが BAM プライマリ インポート データベースに書き込まれているときにコストが発生します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-181">They are ideal for some mission-critical low-latency scenarios, but they incur a performance cost whenever the events are being written to the BAM Primary Import database.</span></span> <span data-ttu-id="aa2d5-182">スケジュール済みの集計は、その集計データを更新するキューブの SSIS パッケージをスケジュールに依存します。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-182">Scheduled aggregations rely on scheduled cubing SSIS packages to update their aggregation data.</span></span> <span data-ttu-id="aa2d5-183">それらの遅延時間は、SSIS スケジュールの間隔以上が全体的なパフォーマンスの影響は小さく、BAM プライマリ インポート データベースであります。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-183">Their latency is equal to or greater than the SSIS schedule interval, but overall they have a smaller performance impact on the BAM Primary Import database.</span></span>  
  
-   <span data-ttu-id="aa2d5-184">**スケジュール済みの集計を選択する場合は、キューブ SSIS アーカイブ SSIS よりも頻繁に実行をスケジュールすることを確認してください。**</span><span class="sxs-lookup"><span data-stu-id="aa2d5-184">**If you choose scheduled aggregations, make sure you schedule the cubing SSIS to run more frequently than the archiving SSIS.**</span></span> <span data-ttu-id="aa2d5-185">アーカイブの SSIS が BAM アーカイブ データベースにスケジュール済みの集計が処理されるアクティビティ データを移動しないためにです。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-185">This is because the archiving SSIS will not move the activity data that has been processed for scheduled aggregation to the BAM Archive database.</span></span>  
  
-   <span data-ttu-id="aa2d5-186">**フェールオーバー機能を取得する複数のコンピューターで BAM イベント バス サービスを有効にします。**</span><span class="sxs-lookup"><span data-stu-id="aa2d5-186">**Enable the BAM Event Bus service in multiple computers to obtain failover functionality.**</span></span>  
  
## <a name="providing-high-availability-for-the-other-biztalk-server-databases"></a><span data-ttu-id="aa2d5-187">他の BizTalk Server データベースの高可用性を実現する</span><span class="sxs-lookup"><span data-stu-id="aa2d5-187">Providing High Availability for the Other BizTalk Server Databases</span></span>  
 <span data-ttu-id="aa2d5-188">他の高可用性を実現する[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]データベース、構成を実行している 2 台のコンピューター[!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)]または[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]Windows クラスターでします。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-188">To provide high availability for the other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, configure two computers that are running [!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)] or [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)] in a Windows cluster.</span></span> <span data-ttu-id="aa2d5-189">これらのコンピューターは、冗長性では、アクティブ/アクティブまたはアクティブ/パッシブ構成で実行できるし、共有ドライブ上のデータを格納できます (など、RAID 1 + 0 SCSI ディスク アレイ) またはストレージ エリア ネットワーク (SAN)。</span><span class="sxs-lookup"><span data-stu-id="aa2d5-189">These computers can run in an active/active or active/passive configuration for redundancy and can store data on a shared drive (such as a RAID 1+0 SCSI disk array) or storage area network (SAN).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aa2d5-190">参照</span><span class="sxs-lookup"><span data-stu-id="aa2d5-190">See Also</span></span>  
 [<span data-ttu-id="aa2d5-191">BizTalk Server Databases2 をクラスタ リング</span><span class="sxs-lookup"><span data-stu-id="aa2d5-191">Clustering the BizTalk Server Databases2</span></span>](../technical-guides/clustering-the-biztalk-server-databases2.md)