---
title: アプリケーションを .msi ファイルからインポートする方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a5472df9-9f1e-42d5-82e0-cc559caf56b3
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 677524c03b9cf008095546758b6c3013cf71fe19
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65400400"
---
# <a name="how-to-import-an-application-from-an-msi-file"></a><span data-ttu-id="b5ba4-102">アプリケーションを .msi ファイルからインポートする方法</span><span class="sxs-lookup"><span data-stu-id="b5ba4-102">How to Import an Application from an .msi File</span></span>
<span data-ttu-id="b5ba4-103">BizTalk Server 管理コンソールまたは BTSTask で MSI のインポート ウィザードを使用して、ターゲット環境での BizTalk グループに .msi ファイルから BizTalk アプリケーションをインポートして、グループ内の個々 のホスト インスタンスで、アプリケーションをインストールすることができます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-103">You can use the Import MSI Wizard in the BizTalk Server Administration Console or BTSTask to import a BizTalk application from an .msi file into a BizTalk group in the target environment and install the application on individual host instances in the group.</span></span> <span data-ttu-id="b5ba4-104">フル インポート プロセスでは、次の操作を実行します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-104">The full import process performs the following operations:</span></span>  
  
- <span data-ttu-id="b5ba4-105">アプリケーションのグループ レベルのデプロイ</span><span class="sxs-lookup"><span data-stu-id="b5ba4-105">A group-level deployment of the application</span></span>  
  
- <span data-ttu-id="b5ba4-106">アプリケーションの場合は、サーバー レベルのインストール</span><span class="sxs-lookup"><span data-stu-id="b5ba4-106">A server-level installation of the application.</span></span>  
  
  <span data-ttu-id="b5ba4-107">**グループ レベルのアプリケーションの展開**</span><span class="sxs-lookup"><span data-stu-id="b5ba4-107">**Group-Level Application Deployment**</span></span>  
  
  <span data-ttu-id="b5ba4-108">ウィザードを実行して、インポート MIS BizTalk Server 管理コンソールからまたは BTSTask を使用して、グループ内のサーバー上のアプリケーション グループ レベルのデプロイを実行します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-108">You perform a group-level deployment of an application on a server in the group by running the Import MIS Wizard from the BizTalk Server Administration console or by running BTSTask.</span></span> <span data-ttu-id="b5ba4-109">グループ レベルのデプロイは、次を行います。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-109">The group-level deployment does the following:</span></span>  
  
- <span data-ttu-id="b5ba4-110">グループで、アプリケーションとそのアイテムを作成します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-110">Creates the application and its artifacts in the group</span></span>  
  
- <span data-ttu-id="b5ba4-111">.Msi パッケージに常駐しているバインドをインポートします。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-111">Imports bindings resident in the .msi package</span></span>  
  
- <span data-ttu-id="b5ba4-112">グループの BizTalk 管理データベースにそのアーティファクトを含むすべての BizTalk Server アセンブリを展開します</span><span class="sxs-lookup"><span data-stu-id="b5ba4-112">Deploys all BizTalk Server assemblies with their artifacts to the BizTalk Management database for the group</span></span>  
  
- <span data-ttu-id="b5ba4-113">インポート時に実行する指定されたスクリプトを実行します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-113">Runs scripts specified to run at import time.</span></span>  
  
  <span data-ttu-id="b5ba4-114">環境固有のバインド ファイルをアプリケーションに追加した場合はインポート時に適用するバインドを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-114">If you have added environment-specific binding files to the application, you will have to select the bindings that you want to apply on import.</span></span>  
  
  <span data-ttu-id="b5ba4-115">**サーバー レベルのアプリケーションのインストール**</span><span class="sxs-lookup"><span data-stu-id="b5ba4-115">**Server-Level Application Installation**</span></span>  
  
  <span data-ttu-id="b5ba4-116">自体には、.msi ファイルをダブルクリックするか、MSI のインポート ウィザードの最後に、インストール プロセスを実行するには、グループ内の各サーバーで、アプリケーションのサーバー レベル インストールを実行します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-116">You perform a server-level installation of an application on each server in a group by double-clicking the .msi file itself, or performing the install process at the end of the Import MSI Wizard.</span></span> <span data-ttu-id="b5ba4-117">グループごとに 1 回実行されているの代わりにこれは通常、グループのメンバーである各 BizTalk サーバーで行います。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-117">Instead of being done once per group, it is typically done on each BizTalk server that is a member of the group.</span></span> <span data-ttu-id="b5ba4-118">サーバー レベルのインストールは、次を行います。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-118">The server-level installation does the following:</span></span>  
  
- <span data-ttu-id="b5ba4-119">このコンピューターがあるすべての実行時に必要なバイナリを持つように、サーバーのグローバル アセンブリ キャッシュにすべての BizTalk Server アセンブリと依存関係アセンブリをインストールします。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-119">Installs all BizTalk Server assemblies and dependency assemblies into the global assembly cache of the server, so that this computer has all of the binaries that it needs for runtime</span></span>  
  
- <span data-ttu-id="b5ba4-120">可能性のある、ソリューションの一部など、Web サービスとして公開されたオーケストレーション関連の Web サービスをロールバックします。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-120">Rolls out related Web services that might be part of the solution, for example, orchestrations published as Web services.</span></span>  
  
- <span data-ttu-id="b5ba4-121">事前の MSMQ キューの作成や、ファイル ドロップ フォルダーの構造と、スクリプトのヘルプで実行できるアクセス許可の作成など、コンピューター固有の変更を適用します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-121">Applies computer-specific changes, such as pre-creating MSMQ queues or creating FILE drop folder structures and permissions, which can be done with the help of scripts.</span></span>  
  
  <span data-ttu-id="b5ba4-122">アプリケーションをインストールする .msi ファイルを実行するときに、.msi ファイルがプログラム追加と削除の一覧で登録エントリを作成し、成果物とその依存関係が正しい順序での展開を自動化することで展開を高速化します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-122">When you execute an .msi file to install an application, the .msi file creates registration entries in the Add or Remove Programs list, and accelerates deployment by automating deployment of artifacts and their dependencies in the correct order.</span></span>  
  
  <span data-ttu-id="b5ba4-123">BizTalk アプリケーションをインストールする方法の詳細については、次を参照してください。[アプリケーションをインストールする方法](../technical-guides/how-to-install-an-application.md)します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-123">For more information on installing a BizTalk application, see [How to Install an Application](../technical-guides/how-to-install-an-application.md).</span></span>  
  
  <span data-ttu-id="b5ba4-124">**完全なアプリケーションの展開とインストール プロセス**</span><span class="sxs-lookup"><span data-stu-id="b5ba4-124">**The Complete Application Deployment and Installation Process**</span></span>  
  
  <span data-ttu-id="b5ba4-125">MSI のインポート ウィザードでは、グループにアプリケーションを展開します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-125">The Import MSI Wizard deploys the application on the group.</span></span> <span data-ttu-id="b5ba4-126">グループ内の個々 のサーバーでも、アプリケーションはインストールされません。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-126">It does not install the application on the individual servers in the group.</span></span> <span data-ttu-id="b5ba4-127">アプリケーションには、ファイル ベースのアイテムが含まれている場合は、アセンブリ、アプリケーション (およびこのアプリケーションに依存するアプリケーションを実行しているコンピューター) で実行される各ホスト インスタンスにアプリケーションをインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-127">If the application includes file-based artifacts, you need to install the application on each host instance that will run the assemblies in the application (and any computers running applications that depend on this application).</span></span> <span data-ttu-id="b5ba4-128">サーバー上で実行した MSI のインポート ウィザード、ただし、選択して、行うことができます、 **、ローカル コンピューターにアプリケーションをインストールするアプリケーション インストール ウィザードを実行**によって表示されるインポートに成功しました ページのチェック ボックス、MSI のインポート ウィザード。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-128">You can do so on the server you ran the Import MSI Wizard on, however, by selecting the **Run the Application Installation Wizard to install the application on the local computer** check box on the Import Succeeded page displayed by the Import MSI Wizard.</span></span> <span data-ttu-id="b5ba4-129">そのため操作は、これらのサーバー上の .msi ファイルをダブルクリックして、グループ内の他のサーバーで実行できます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-129">You can do so on the other servers in the group by double-clicking the .msi file on each of those servers.</span></span>  
  
  <span data-ttu-id="b5ba4-130">アプリケーションをテストする準備が完了したらの場合は、テスト環境で BizTalk グループにインポートできます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-130">If you are ready to test the application, you can import it into a BizTalk group in a test environment.</span></span> <span data-ttu-id="b5ba4-131">アプリケーションがステージング環境または運用環境の準備完了の場合は、これらの環境のいずれかにインポートできます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-131">If your application is ready for staging or production, you can import it into one of those environments.</span></span>  
  
## <a name="important-considerations"></a><span data-ttu-id="b5ba4-132">重要な考慮事項</span><span class="sxs-lookup"><span data-stu-id="b5ba4-132">Important Considerations</span></span>  
 <span data-ttu-id="b5ba4-133">.Msi ファイルから BizTalk アプリケーションをインポートするときに、次に留意してください。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-133">When importing a BizTalk application from an .msi file, keep the following in mind:</span></span>  
  
- <span data-ttu-id="b5ba4-134">**成果物を標準のインポート プロセスで上書きすることを指定する必要があります。**</span><span class="sxs-lookup"><span data-stu-id="b5ba4-134">**You must specify that you want artifacts to be overwritten in a standard import process.**</span></span> <span data-ttu-id="b5ba4-135">既存のアイテムを上書きする場合は、.msi ファイルをインポートするときに、既存のアイテムを上書きするオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-135">If you want to overwrite existing artifacts, select the option to overwrite existing artifacts when importing the .msi file.</span></span>  
  
- <span data-ttu-id="b5ba4-136">**インポートされたバインドでは、既存のバインドを上書きします。**</span><span class="sxs-lookup"><span data-stu-id="b5ba4-136">**Imported bindings overwrite existing bindings.**</span></span> <span data-ttu-id="b5ba4-137">既存のアプリケーションにバインドが含まれている .msi ファイルをインポートすると、既存のバインドはインポートされた同じ名前のバインドによって上書きされます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-137">When you import an .msi file that contains bindings into an existing application, the existing bindings are overwritten by imported bindings that have the same name.</span></span> <span data-ttu-id="b5ba4-138">これは、.msi ファイルのインポート時に既存のアイテムを上書きするオプションを選択しなかった場合も同様です。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-138">This is the case even when you have not selected the option to overwrite existing artifacts when importing the .msi file.</span></span> <span data-ttu-id="b5ba4-139">エクスポートするアプリケーションのバインドで、.msi ファイルのインポート先アプリケーションのバインドを上書きしないようにするには、エクスポート操作中にエクスポートするリソースとしてバインド ファイルを選択しないでください。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-139">If you do not want the bindings in the application you are exporting to overwrite the bindings in an application into which you are importing the .msi file, then you should not select the binding file as a resource to export during the export operation.</span></span> <span data-ttu-id="b5ba4-140">エクスポート用のリソースを設定する方法についての詳細については、次を参照してください。 [BizTalk アプリケーションのエクスポート方法](http://go.microsoft.com/fwlink/?LinkID=154848)(http://go.microsoft.com/fwlink/?LinkID=154848)します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-140">For more information about setting the resources for an export, see [How to Export a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154848) (http://go.microsoft.com/fwlink/?LinkID=154848).</span></span>  
  
  <span data-ttu-id="b5ba4-141">インポート プロセスでバインドが適用されるとき、同じ名前を持つ適用済みのバインドは、新しいバインドで上書きされます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-141">As bindings are applied during the import process, bindings that have already been applied are overwritten by new bindings that have the same name.</span></span> <span data-ttu-id="b5ba4-142">つまり、同じ名前のバインドを適用すると、常に、最新のバインドが有効になります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-142">In other words, the last binding of a particular name to be applied takes effect.</span></span> <span data-ttu-id="b5ba4-143">アプリケーションをインポートするときに、バインドは、次の順序で適用されます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-143">When you import an application, bindings are applied in the following order:</span></span>  
  
1.  <span data-ttu-id="b5ba4-144">BizTalk Server によって生成されたアプリケーション バインドのうち、バインド ファイルでアプリケーションに明示的に追加されたバインドではなく、ユーザーがアプリケーション .msi ファイルへのエクスポート対象として明示的に選択したバインド。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-144">Application bindings generated by BizTalk Server that were not explicitly added to the application via a binding file, but that were explicitly selected by the user for export into the application .msi file.</span></span>  
  
2.  <span data-ttu-id="b5ba4-145">明示的に追加されたバインド ファイルのうち、対象の展開環境が指定されていないもの。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-145">Binding files that have been explicitly added, and do not have a target deployment environment specified.</span></span> <span data-ttu-id="b5ba4-146">この一連のバインド内での適用順序は特に決まっていません。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-146">Bindings in this set are applied in no specific order.</span></span>  
  
3.  <span data-ttu-id="b5ba4-147">明示的に追加されたバインドのうち、対象の (アプリケーションのインポート用に選択された展開環境と一致する) 展開環境が関連付けられているもの。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-147">Bindings that have been explicitly added, and that have an associated target deployment environment that matches the deployment environment selected for application import.</span></span> <span data-ttu-id="b5ba4-148">この一連のバインド内での適用順序は特に決まっていません。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-148">Bindings in this set are applied in no specific order.</span></span>  
  
- <span data-ttu-id="b5ba4-149">**指定されたホストが存在する必要があります。**</span><span class="sxs-lookup"><span data-stu-id="b5ba4-149">**The host specified must exist.**</span></span> <span data-ttu-id="b5ba4-150">アプリケーションを .msi ファイルからインポートする .msi ファイルに含まれるアプリケーションのバインドで指定されたホストに対応するホストに既に存在する BizTalk グループまたはインポート操作に失敗します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-150">To import an application from an .msi file, a host corresponding to the host specified in the application bindings contained in the .msi file must already exist in the BizTalk group or the import operation will fail.</span></span> <span data-ttu-id="b5ba4-151">さらに、ホストの信頼レベルが一致する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-151">In addition, the host trust level must match.</span></span>  
  
- <span data-ttu-id="b5ba4-152">**依存関係には、インポート操作時に大きな影響を与えるをことができます。**</span><span class="sxs-lookup"><span data-stu-id="b5ba4-152">**Dependencies can have significant effects upon import operations.**</span></span> <span data-ttu-id="b5ba4-153">別のアプリケーションに依存するアプリケーションをインポートするときに、次の規則が適用されます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-153">When you import an application that has a dependency on another application, the following rules apply:</span></span>  
  
  -   <span data-ttu-id="b5ba4-154">インポートするアプリケーションは、別のアプリケーション内のアイテムに依存する場合は、2 つ目のアプリケーションに最初のアプリケーションから参照を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-154">If an application that you are importing depends on an artifact in another application, you must add a reference from the first application to the second application.</span></span> <span data-ttu-id="b5ba4-155">アプリケーションと必須アイテムが移動先のグループに存在する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-155">The application and the required artifact must already exist in the destination group.</span></span> <span data-ttu-id="b5ba4-156">インポート ウィザードでは、参照を追加することができます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-156">The Import Wizard enables you to add the reference.</span></span> <span data-ttu-id="b5ba4-157">ただし、BTSTask の ImportApp コマンドを使用している場合は、インポート後にアプリケーションへの参照を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-157">However, if you are using the ImportApp command of BTSTask, you must add the reference to the application after import.</span></span> <span data-ttu-id="b5ba4-158">詳細については、次を参照してください。[別のアプリケーションへの参照を追加する方法](http://go.microsoft.com/fwlink/?LinkId=155011)(http://go.microsoft.com/fwlink/?LinkId=155011)します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-158">For more information, see [How to Add a Reference to Another Application](http://go.microsoft.com/fwlink/?LinkId=155011) (http://go.microsoft.com/fwlink/?LinkId=155011).</span></span> <span data-ttu-id="b5ba4-159">インポート ウィザードはグループ内の既存のアプリケーションへの参照を一致させて、新しい参照を追加するか既存の参照を変更するオプションを提供します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-159">The Import Wizard matches the references to existing applications in the group and gives you the option to add a new reference or change an existing reference.</span></span> <span data-ttu-id="b5ba4-160">参照先アプリケーションが存在するかどうかは BizTalk Server によって検証されますが、これに加えて、参照先アプリケーションに必要なアイテムが含まれているかどうかも確認することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-160">While BizTalk Server verifies that the referenced application exists, we recommend that you take the additional step of verifying that the referenced application contains the required artifact.</span></span>  
  
  -   <span data-ttu-id="b5ba4-161">アプリケーションのインストール時には、このアプリケーションが依存しているアプリケーションもすべてインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-161">When you install an application, you must also install any applications on which it depends.</span></span> <span data-ttu-id="b5ba4-162">他のアプリケーションに含まれるアイテム (BizTalk アセンブリなど) と依存関係があるアプリケーションをインストールする場合は、そのアイテムを含むアプリケーションを先にインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-162">When you install an application that has a dependency on an artifact, such as a BizTalk assembly, which is contained in another application, you must first install the application that contains the artifact.</span></span> <span data-ttu-id="b5ba4-163">たとえば、アプリケーション A をインストールするとき、これがアプリケーション B のアセンブリに依存している場合は、アプリケーション B を先にインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-163">For example, if you want to install Application A, and it depends on an assembly in Application B, you must install Application B first.</span></span> <span data-ttu-id="b5ba4-164">アプリケーション A をインストールすることができます。BizTalk アプリケーションのインストールの詳細については、次を参照してください。[アプリケーションをインストールする方法](../technical-guides/how-to-install-an-application.md)します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-164">Then you can install Application A. For more information about installing a BizTalk application, see [How to Install an Application](../technical-guides/how-to-install-an-application.md).</span></span>  
  
  -   <span data-ttu-id="b5ba4-165">アプリケーションを別の BizTalk グループにインポートして、そのグループ内で実行する場合、このアプリケーションが依存するアイテムもすべてインポートする必要があります。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-165">If you want to import an application into a different BizTalk group and run it in that group, you must also import any artifacts on which this application depends.</span></span> <span data-ttu-id="b5ba4-166">これは、最初に参照先の成果物を含むアプリケーションをインポートすることによって、または必要とするアプリケーションに必要なアイテムを追加することで行んだことができます。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-166">You can do this by first importing an application that contains the referenced artifact, or by adding the needed artifact to the application that requires it.</span></span> <span data-ttu-id="b5ba4-167">BizTalk アプリケーションをインポートする方法の詳細については、次を参照してください。[アプリケーションを .msi ファイルからインポートする方法](../technical-guides/how-to-import-an-application-from-an-msi-file.md)します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-167">For more information about importing a BizTalk application, see [How to Import an Application from an .msi File](../technical-guides/how-to-import-an-application-from-an-msi-file.md).</span></span>  
  
  <span data-ttu-id="b5ba4-168">詳細に関する考慮事項と、.msi ファイルから BizTalk アプリケーションをインポートする方法については、次を参照してください。 [BizTalk アプリケーションをインポートする方法](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-168">For more considerations and information about importing a BizTalk application from an .msi file, see [How to Import a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154827) (http://go.microsoft.com/fwlink/?LinkID=154827).</span></span>  
  
## <a name="how-to-import-an-application"></a><span data-ttu-id="b5ba4-169">アプリケーションをインポートする方法</span><span class="sxs-lookup"><span data-stu-id="b5ba4-169">How to Import an Application</span></span>  
 <span data-ttu-id="b5ba4-170">BizTalk アプリケーションを .msi ファイルからインポートする方法の詳細については、次を参照してください。 [BizTalk アプリケーションをインポートする方法](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)します。</span><span class="sxs-lookup"><span data-stu-id="b5ba4-170">For instructions on importing a BizTalk application from an .msi file, see [How to Import a BizTalk Application](http://go.microsoft.com/fwlink/?LinkID=154827) (http://go.microsoft.com/fwlink/?LinkID=154827).</span></span>