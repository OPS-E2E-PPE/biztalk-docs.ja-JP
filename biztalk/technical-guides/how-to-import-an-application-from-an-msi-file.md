---
title: アプリケーションを .msi ファイルからインポートする方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a5472df9-9f1e-42d5-82e0-cc559caf56b3
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4e1cea55ba50a094258a3fcf07eedf30466566d3
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37004923"
---
# <a name="how-to-import-an-application-from-an-msi-file"></a>アプリケーションを .msi ファイルからインポートする方法
BizTalk Server 管理コンソールまたは BTSTask で MSI のインポート ウィザードを使用して、ターゲット環境での BizTalk グループに .msi ファイルから BizTalk アプリケーションをインポートして、グループ内の個々 のホスト インスタンスで、アプリケーションをインストールすることができます。 フル インポート プロセスでは、次の操作を実行します。  
  
- アプリケーションのグループ レベルのデプロイ  
  
- アプリケーションの場合は、サーバー レベルのインストール  
  
  **グループ レベルのアプリケーションの展開**  
  
  ウィザードを実行して、インポート MIS BizTalk Server 管理コンソールからまたは BTSTask を使用して、グループ内のサーバー上のアプリケーション グループ レベルのデプロイを実行します。 グループ レベルのデプロイは、次を行います。  
  
- グループで、アプリケーションとそのアイテムを作成します。  
  
- .Msi パッケージに常駐しているバインドをインポートします。  
  
- グループの BizTalk 管理データベースにそのアーティファクトを含むすべての BizTalk Server アセンブリを展開します  
  
- インポート時に実行する指定されたスクリプトを実行します。  
  
  環境固有のバインド ファイルをアプリケーションに追加した場合はインポート時に適用するバインドを選択する必要があります。  
  
  **サーバー レベルのアプリケーションのインストール**  
  
  自体には、.msi ファイルをダブルクリックするか、MSI のインポート ウィザードの最後に、インストール プロセスを実行するには、グループ内の各サーバーで、アプリケーションのサーバー レベル インストールを実行します。 グループごとに 1 回実行されているの代わりにこれは通常、グループのメンバーである各 BizTalk サーバーで行います。 サーバー レベルのインストールは、次を行います。  
  
- このコンピューターがあるすべての実行時に必要なバイナリを持つように、サーバーのグローバル アセンブリ キャッシュにすべての BizTalk Server アセンブリと依存関係アセンブリをインストールします。  
  
- 可能性のある、ソリューションの一部など、Web サービスとして公開されたオーケストレーション関連の Web サービスをロールバックします。  
  
- 事前の MSMQ キューの作成や、ファイル ドロップ フォルダーの構造と、スクリプトのヘルプで実行できるアクセス許可の作成など、コンピューター固有の変更を適用します。  
  
  アプリケーションをインストールする .msi ファイルを実行するときに、.msi ファイルがプログラム追加と削除の一覧で登録エントリを作成し、成果物とその依存関係が正しい順序での展開を自動化することで展開を高速化します。  
  
  BizTalk アプリケーションをインストールする方法の詳細については、[アプリケーションをインストールする方法](../technical-guides/how-to-install-an-application.md)を参照してください。  
  
  **完全なアプリケーションの展開とインストール プロセス**  
  
  MSI のインポート ウィザードでは、グループにアプリケーションを展開します。 グループ内の個々 のサーバーでも、アプリケーションはインストールされません。 アプリケーションには、ファイル ベースのアイテムが含まれている場合は、アセンブリ、アプリケーション (およびこのアプリケーションに依存するアプリケーションを実行しているコンピューター) で実行される各ホスト インスタンスにアプリケーションをインストールする必要があります。 サーバー上で実行した MSI のインポート ウィザード、ただし、選択して、行うことができます、 **、ローカル コンピューターにアプリケーションをインストールするアプリケーション インストール ウィザードを実行**によって表示されるインポートに成功しました ページのチェック ボックス、MSI のインポート ウィザード。 そのため操作は、これらのサーバー上の .msi ファイルをダブルクリックして、グループ内の他のサーバーで実行できます。  
  
  アプリケーションをテストする準備が完了したらの場合は、テスト環境で BizTalk グループにインポートできます。 アプリケーションがステージング環境または運用環境の準備完了の場合は、これらの環境のいずれかにインポートできます。  
  
## <a name="important-considerations"></a>重要な考慮事項  
 .Msi ファイルから BizTalk アプリケーションをインポートするときに、次に留意してください。  
  
- **成果物を標準のインポート プロセスで上書きすることを指定する必要があります。** 既存のアイテムを上書きする場合は、.msi ファイルをインポートするときに、既存のアイテムを上書きするオプションを選択します。  
  
- **インポートされたバインドでは、既存のバインドを上書きします。** 既存のアプリケーションにバインドが含まれている .msi ファイルをインポートすると、既存のバインドはインポートされた同じ名前のバインドによって上書きされます。 これは、.msi ファイルのインポート時に既存のアイテムを上書きするオプションを選択しなかった場合も同様です。 エクスポートするアプリケーションのバインドで、.msi ファイルのインポート先アプリケーションのバインドを上書きしないようにするには、エクスポート操作中にエクスポートするリソースとしてバインド ファイルを選択しないでください。 エクスポート用のリソースを設定する方法についての詳細については、[BizTalk アプリケーションのエクスポート方法](http://go.microsoft.com/fwlink/?LinkID=154848)(http://go.microsoft.com/fwlink/?LinkID=154848)を参照してください。  
  
  インポート プロセスでバインドが適用されるとき、同じ名前を持つ適用済みのバインドは、新しいバインドで上書きされます。 つまり、同じ名前のバインドを適用すると、常に、最新のバインドが有効になります。 アプリケーションをインポートするときに、バインドは、次の順序で適用されます。  
  
1.  BizTalk Server によって生成されたアプリケーション バインドのうち、バインド ファイルでアプリケーションに明示的に追加されたバインドではなく、ユーザーがアプリケーション .msi ファイルへのエクスポート対象として明示的に選択したバインド。  
  
2.  明示的に追加されたバインド ファイルのうち、対象の展開環境が指定されていないもの。 この一連のバインド内での適用順序は特に決まっていません。  
  
3.  明示的に追加されたバインドのうち、対象の (アプリケーションのインポート用に選択された展開環境と一致する) 展開環境が関連付けられているもの。 この一連のバインド内での適用順序は特に決まっていません。  
  
- **指定されたホストが存在する必要があります。** アプリケーションを .msi ファイルからインポートする .msi ファイルに含まれるアプリケーションのバインドで指定されたホストに対応するホストに既に存在する BizTalk グループまたはインポート操作に失敗します。 さらに、ホストの信頼レベルが一致する必要があります。  
  
- **依存関係には、インポート操作時に大きな影響を与えるをことができます。** 別のアプリケーションに依存するアプリケーションをインポートするときに、次の規則が適用されます。  
  
  -   インポートするアプリケーションは、別のアプリケーション内のアイテムに依存する場合は、2 つ目のアプリケーションに最初のアプリケーションから参照を追加する必要があります。 アプリケーションと必須アイテムが移動先のグループに存在する必要があります。 インポート ウィザードでは、参照を追加することができます。 ただし、BTSTask の ImportApp コマンドを使用している場合は、インポート後にアプリケーションへの参照を追加する必要があります。 詳細については、[別のアプリケーションへの参照を追加する方法](http://go.microsoft.com/fwlink/?LinkId=155011)(http://go.microsoft.com/fwlink/?LinkId=155011)を参照してください。 インポート ウィザードはグループ内の既存のアプリケーションへの参照を一致させて、新しい参照を追加するか既存の参照を変更するオプションを提供します。 参照先アプリケーションが存在するかどうかは BizTalk Server によって検証されますが、これに加えて、参照先アプリケーションに必要なアイテムが含まれているかどうかも確認することをお勧めします。  
  
  -   アプリケーションのインストール時には、このアプリケーションが依存しているアプリケーションもすべてインストールする必要があります。 他のアプリケーションに含まれるアイテム (BizTalk アセンブリなど) と依存関係があるアプリケーションをインストールする場合は、そのアイテムを含むアプリケーションを先にインストールする必要があります。 たとえば、アプリケーション A をインストールするとき、これがアプリケーション B のアセンブリに依存している場合は、アプリケーション B を先にインストールする必要があります。 アプリケーション A をインストールすることができます。BizTalk アプリケーションのインストールの詳細については、[アプリケーションをインストールする方法](../technical-guides/how-to-install-an-application.md)を参照してください。  
  
  -   アプリケーションを別の BizTalk グループにインポートして、そのグループ内で実行する場合、このアプリケーションが依存するアイテムもすべてインポートする必要があります。 これは、最初に参照先の成果物を含むアプリケーションをインポートすることによって、または必要とするアプリケーションに必要なアイテムを追加することで行んだことができます。 BizTalk アプリケーションをインポートする方法の詳細については、[アプリケーションを .msi ファイルからインポートする方法](../technical-guides/how-to-import-an-application-from-an-msi-file.md)を参照してください。  
  
  詳細に関する考慮事項と、.msi ファイルから BizTalk アプリケーションをインポートする方法については、[BizTalk アプリケーションをインポートする方法](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)を参照してください。  
  
## <a name="how-to-import-an-application"></a>アプリケーションをインポートする方法  
 BizTalk アプリケーションを .msi ファイルからインポートする方法の詳細については、[BizTalk アプリケーションをインポートする方法](http://go.microsoft.com/fwlink/?LinkID=154827)(http://go.microsoft.com/fwlink/?LinkID=154827)を参照してください。