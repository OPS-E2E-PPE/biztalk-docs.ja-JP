---
title: ボトルネックを回避するためのベスト プラクティス |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 81da2e31-dce0-43fb-841f-e65ff99e80a7
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 07145b9b46f1527f970ec27511827d385468fcaa
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65401262"
---
# <a name="best-practices-for-avoiding-bottlenecks"></a><span data-ttu-id="5d16c-102">ボトルネックを回避するためのベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="5d16c-102">Best Practices for Avoiding Bottlenecks</span></span>
<span data-ttu-id="5d16c-103">既定の設定中に[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]最適なパフォーマンスを提供する多くのハードウェアおよびソフトウェア構成の一部のシナリオである可能性があります設定または展開の構成を変更すると役立ちます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-103">While the default settings in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provide optimal performance for many hardware and software configurations, in some scenarios it may be beneficial to modify the settings or deployment configuration.</span></span> <span data-ttu-id="5d16c-104">構成するときに[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]、次のパフォーマンス ガイドラインを検討してください。</span><span class="sxs-lookup"><span data-stu-id="5d16c-104">When configuring [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], consider the following performance guidelines:</span></span>  
  
-   <span data-ttu-id="5d16c-105">リソースの競合を防ぐためには、受信、オーケストレーション、および個別のホスト上の送信を分離します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-105">To prevent resource contention, isolate receiving, orchestration, and sending on separate hosts.</span></span> <span data-ttu-id="5d16c-106">競合を最小限に抑えるさらに、他のホストから追跡サービスを分離します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-106">To further minimize contention, isolate the tracking service from other hosts.</span></span>  
  
-   <span data-ttu-id="5d16c-107">BizTalk Server を実行しているコンピューターで CPU の処理がボトルネックになっている場合は、cpu を追加または高速の Cpu にアップグレードして BizTalk Server を実行するコンピューターをスケールします。</span><span class="sxs-lookup"><span data-stu-id="5d16c-107">If CPU processing on the computer running BizTalk Server is the bottleneck, scale up the computer running BizTalk Server by including additional CPUs or upgrading to faster CPUs.</span></span>  
  
## <a name="sql-server-guidelines"></a><span data-ttu-id="5d16c-108">SQL Server のガイドライン</span><span class="sxs-lookup"><span data-stu-id="5d16c-108">SQL Server Guidelines</span></span>  
 <span data-ttu-id="5d16c-109">Microsoft SQL Server を構成するときに、次のパフォーマンス ガイドラインを検討してください[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="5d16c-109">Consider the following performance guidelines when configuring Microsoft SQL Server with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="5d16c-110">可能であれば、SQL Server で高速なディスク サブシステムを使用します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-110">Whenever possible, use a fast disk subsystem with SQL Server.</span></span> <span data-ttu-id="5d16c-111">Redundant array of 10 独立したディスクの種類を使用して (RAID10/0 + 1) またはバックアップ電源装置の記憶域エリア ネットワーク (SAN)。</span><span class="sxs-lookup"><span data-stu-id="5d16c-111">Use a redundant array of independent disks type 10 (RAID10/0+1) or a storage area network (SAN) with backup power supply.</span></span>  
  
-   <span data-ttu-id="5d16c-112">BizTalk 追跡データベース (BizTalkDTADb) から別のサーバー上の各メッセージ ボックス データベースを分離します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-112">Isolate each MessageBox database on a separate server from the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="5d16c-113">小規模な展開の CPU リソースがある場合があります、BizTalk 追跡データベースから別の物理ディスク上のメッセージ ボックス データベースを分離するための十分です。</span><span class="sxs-lookup"><span data-stu-id="5d16c-113">For smaller deployments if CPU resources are available, it might be sufficient to isolate the MessageBox database on a separate physical disk from the BizTalk Tracking database.</span></span>  
  
-   <span data-ttu-id="5d16c-114">プライマリ メッセージ ボックス データベースには、CPU プロセッサの飽和やディスク操作 (ディスクの平均キュー長さ) からの待機時間が原因でボトルネック可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5d16c-114">The primary MessageBox database could be the bottleneck due to CPU processor saturation or latency from disk operations (average disk queue length).</span></span> <span data-ttu-id="5d16c-115">CPU の処理がボトルネックになっている場合は、プライマリ メッセージ ボックスに CPU プロセッサを追加します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-115">If CPU processing is the bottleneck, add CPU processors to the primary MessageBox.</span></span> <span data-ttu-id="5d16c-116">有効でない場合は、マスター メッセージ ボックス データベースでパブリッシングを無効にしてください。</span><span class="sxs-lookup"><span data-stu-id="5d16c-116">If not, try to disable publishing on the master MessageBox database.</span></span> <span data-ttu-id="5d16c-117">こうすると、マスター メッセージ ボックス データベースの詳細は効率的に処理他のメッセージ ボックス データベースにメッセージをルーティングできます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-117">This way the master MessageBox database can more efficiently handle routing of messages to the other MessageBox databases.</span></span> <span data-ttu-id="5d16c-118">パブリッシングを無効にするオプションは、複数のメッセージ ボックス データベースを使用している場合に有効です。</span><span class="sxs-lookup"><span data-stu-id="5d16c-118">The option to disable publishing is valid when you are using multiple MessageBox databases.</span></span>  
  
-   <span data-ttu-id="5d16c-119">ディスク操作がボトルネックとなっている場合は、BizTalk 追跡データベースを専用の SQL Server コンピューターまたは専用のディスクに移動します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-119">If disk operations are the bottleneck, move the BizTalk Tracking database to a dedicated SQL Server computer and/or dedicated disk.</span></span> <span data-ttu-id="5d16c-120">プライマリ メッセージ ボックス データベースでの CPU 処理もディスク操作がボトルネックでない場合は、既存のハードウェアを活用する同じ SQL Server コンピューターに新しいメッセージ ボックス データベースを作成できます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-120">If CPU processing and disk operations on the primary MessageBox database are not the bottleneck, you can create new MessageBox databases on the same SQL Server computer to leverage your existing hardware.</span></span>  
  
-   <span data-ttu-id="5d16c-121">推奨事項に従って[、Databases2 のファイル グループを最適化する](../technical-guides/optimizing-filegroups-for-the-databases2.md)トランザクションとデータ ログを分離する別々 の物理ディスクと、メッセージ ボックスおよび BizTalk 追跡データベースのファイルします。</span><span class="sxs-lookup"><span data-stu-id="5d16c-121">Follow recommendations in [Optimizing Filegroups for the Databases2](../technical-guides/optimizing-filegroups-for-the-databases2.md)to isolate the transaction and data log files for the MessageBox and BizTalk Tracking databases onto separate physical disks.</span></span>  
  
-   <span data-ttu-id="5d16c-122">データとログ ファイルには、十分な記憶域を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-122">Allocate sufficient storage space for the data and log files.</span></span> <span data-ttu-id="5d16c-123">それ以外の場合 SQL Server では、すべてのログ ファイルが保存されているディスクの空き領域の消費が自動的にします。</span><span class="sxs-lookup"><span data-stu-id="5d16c-123">Otherwise SQL Server will automatically consume all of the available space on the disks where the log files are kept.</span></span> <span data-ttu-id="5d16c-124">ログ ファイルの初期サイズは、実際のシナリオでは、特定の要件によって異なります。</span><span class="sxs-lookup"><span data-stu-id="5d16c-124">The initial size of the log files depends on the specific requirements in your scenario.</span></span> <span data-ttu-id="5d16c-125">テスト結果に基づいて展開の平均ファイル サイズを推定し、ソリューションを実装する前に、記憶域スペースを展開します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-125">Estimate the average file size in your deployment based on testing results, and expand the storage space before implementing your solution.</span></span>  
  
-   <span data-ttu-id="5d16c-126">メッセージ ボックス、正常性と動作状況の追跡 (HAT)、およびビジネス アクティビティ監視 (BAM) などのディスク使用の頻度の高いデータベースに十分な記憶域を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-126">Allocate sufficient storage space for high-disk-use databases, such as the MessageBox, Health and Activity Tracking (HAT), and Business Activity Monitoring (BAM).</span></span> <span data-ttu-id="5d16c-127">ソリューションは、BizTalk Framework メッセージング プロトコルを使用している場合は、BizTalk 構成データベース (BizTalkMgmtDb) のための十分な記憶域を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-127">If your solution uses the BizTalk Framework messaging protocol, allocate sufficient storage space for the BizTalk Configuration database (BizTalkMgmtDb).</span></span>  
  
-   <span data-ttu-id="5d16c-128">に応じてビジネス、データの保有期間、およびシナリオでは、処理されたデータの量などを構成して「DTA のアーカイブと削除」の SQL Server エージェント ジョブ、HAT 追跡データベース、BizTalk 追跡データベースが大きくなりすぎません。</span><span class="sxs-lookup"><span data-stu-id="5d16c-128">Depending on business needs, such as data retention periods, and the volume of data processed in your scenario, configure the "DTA Archive and Purge" SQL Server Agent job on the HAT-Tracking database such that the BizTalk Tracking database does not grow too large.</span></span> <span data-ttu-id="5d16c-129">データ挿入率に制限していますが、データベースの完全な容量に達しているために、このデータベースの増加でパフォーマンスが低下することができます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-129">The growth of this database can degrade performance because reaching the full capacity of the database imposes a limit on the rate of data insertion.</span></span> <span data-ttu-id="5d16c-130">これは、1 つの BizTalk 追跡データベースには、複数のメッセージ ボックス データベースがサポートされている場合に特に当てはまります。</span><span class="sxs-lookup"><span data-stu-id="5d16c-130">This is especially true when one BizTalk Tracking database supports multiple MessageBox databases.</span></span>  
  
-   <span data-ttu-id="5d16c-131">スケール アップがボトルネックになっている場合、メッセージ ボックス データベースおよび BizTalk 追跡データベースをホストするサーバー。</span><span class="sxs-lookup"><span data-stu-id="5d16c-131">Scale up the servers hosting the MessageBox and BizTalk Tracking databases if they are the bottleneck.</span></span> <span data-ttu-id="5d16c-132">Cpu の追加、メモリを追加する、高速の Cpu にアップグレードする、高速の専用ディスクを使用して、ハードウェアをスケール アップすることができます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-132">You can scale up the hardware by adding CPUs, adding memory, upgrading to faster CPUs, and using high-speed dedicated disks.</span></span>  
  
-   <span data-ttu-id="5d16c-133">複数のファイル、TempDB ファイルを分割すると、I/O 操作に関連するパフォーマンスの問題は解決します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-133">Splitting the TempDB files across multiple files may resolve performance issues related to I/O operations.</span></span> <span data-ttu-id="5d16c-134">一般的なガイドラインとして 1 プロセッサあたり 1 つのファイルのデータ ファイルを作成し、同じサイズを使用して作成されたすべてのファイル。</span><span class="sxs-lookup"><span data-stu-id="5d16c-134">As a general guideline, create one file data file per processor and use the same size for all files created.</span></span>  
  
-   <span data-ttu-id="5d16c-135">データベースの変更は、100 ~ 150 台 MB などの固定値に設定を自動-拡張します。</span><span class="sxs-lookup"><span data-stu-id="5d16c-135">Change the database auto-grow settings to a fixed value such as 100-150MB.</span></span> <span data-ttu-id="5d16c-136">データベース サイズの増加が 10% に構成が既定では、その遅延をより大きなデータベースの拡張中に潜在顧客ことができます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-136">By default the database growth is configured to 10%, which can lead to delays when growing larger databases.</span></span>  
  
-   <span data-ttu-id="5d16c-137">SQL Server のメモリは、Min Server Memory と Max Server Memory の両方を同じ値に設定して、固定値に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="5d16c-137">SQL Server memory should be set to a fixed value by setting both Min Server Memory and Max Server Memory to the same value.</span></span> <span data-ttu-id="5d16c-138">一般に、SQL Server に物理メモリの 75% を割り当てるし、オペレーティング システムとアプリケーションの残りの 25% のままにします。</span><span class="sxs-lookup"><span data-stu-id="5d16c-138">In general, allocate 75% of physical memory to SQL Server and leave 25% for the rest of the operating system and any applications.</span></span> <span data-ttu-id="5d16c-139">専用の SQL Server の場合は、1 GB の最小オペレーティング システム用に予約量を減らすことができます。</span><span class="sxs-lookup"><span data-stu-id="5d16c-139">If this is a dedicated SQL Server, you can decrease the amount reserved for the operating system to a minimum of 1GB.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5d16c-140">参照</span><span class="sxs-lookup"><span data-stu-id="5d16c-140">See Also</span></span>  
 [<span data-ttu-id="5d16c-141">ボトルネックの検索と解消</span><span class="sxs-lookup"><span data-stu-id="5d16c-141">Finding and Eliminating Bottlenecks</span></span>](../technical-guides/finding-and-eliminating-bottlenecks.md)