---
title: データベースをクラスター |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 1b68bc3f-c0c4-4050-8ca3-df6dd1927637
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bcdc4c2c628a031ab235ce5821c01b56e5f86851
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36991507"
---
# <a name="clustering-the-biztalk-server-databases"></a><span data-ttu-id="d91ea-102">BizTalk Server データベースのクラスター化</span><span class="sxs-lookup"><span data-stu-id="d91ea-102">Clustering the BizTalk Server Databases</span></span>
<span data-ttu-id="d91ea-103">BizTalk Server データベースに障害が発生すると、BizTalk Server 環境は正常に機能することができなくなります。</span><span class="sxs-lookup"><span data-stu-id="d91ea-103">If the BizTalk Server databases become unavailable, the BizTalk Server environment will not function correctly.</span></span> <span data-ttu-id="d91ea-104">次の図に示すように、BizTalk Server データベースに対して、Microsoft SQL Server クラスターを作成することによって高可用性を確保できます。</span><span class="sxs-lookup"><span data-stu-id="d91ea-104">To provide high availability, you can create a Microsoft SQL Server cluster for the BizTalk Server databases, as shown in the following figure.</span></span>  
  
 <span data-ttu-id="d91ea-105">![BizTalk Server のデータベース層](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span><span class="sxs-lookup"><span data-stu-id="d91ea-105">![BizTalk Server Database Tier](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span></span>  
  
 <span data-ttu-id="d91ea-106">BizTalk Server データベースの高可用性ソリューションを構築するためには、SQL Server を実行する 2 台以上のコンピューターと、クラスター内の共有ディスク アレイが必要です。</span><span class="sxs-lookup"><span data-stu-id="d91ea-106">To create a highly available solution for the BizTalk Server databases, you must have at least two computers that are running SQL Server and a shared disk array in the cluster.</span></span>  
  
## <a name="clustering-options"></a><span data-ttu-id="d91ea-107">クラスタ リングのオプション</span><span class="sxs-lookup"><span data-stu-id="d91ea-107">Clustering Options</span></span>  
 <span data-ttu-id="d91ea-108">ビジネス ニーズに合わせて、BizTalk Server データベースの最適なクラスター構成を確認します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-108">Determine the best cluster configuration for the BizTalk Server databases for your business needs.</span></span> <span data-ttu-id="d91ea-109">オプションの一覧を次に示します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-109">Here is a list of the options:</span></span>  
  
-   <span data-ttu-id="d91ea-110">**アクティブ/パッシブ**します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-110">**Active/passive**.</span></span> <span data-ttu-id="d91ea-111">通常、BizTalk Server データベースの高可用性は、アクティブ/パッシブのサーバー クラスター構成で構成されている 2 つ以上のデータベース コンピューターで構成されます。</span><span class="sxs-lookup"><span data-stu-id="d91ea-111">High availability for the BizTalk Server databases typically consists of two or more database computers configured in an active/passive server cluster configuration.</span></span> <span data-ttu-id="d91ea-112">これらのコンピューターが共通のディスク リソースを共有 (など、RAID 1 + 0 SCSI ディスク アレイやストレージ エリア ネットワーク) Windows クラスタ リングを使用してバックアップの冗長性とフォールト トレランスを提供します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-112">These computers share a common disk resource (such as a RAID 1+0 SCSI disk array or storage area network) and use Windows Clustering to provide backup redundancy and fault tolerance.</span></span>  
  
-   <span data-ttu-id="d91ea-113">**アクティブ/アクティブ**します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-113">**Active/active**.</span></span> <span data-ttu-id="d91ea-114">Windows クラスタ リングと SQL Server を使用すると、1 つまたは複数の SQL Server インスタンスを「アクティブ」で実行されて、クラスターの各ノードのアクティブ/アクティブ モードで SQL Server を実行できます。</span><span class="sxs-lookup"><span data-stu-id="d91ea-114">Windows Clustering and SQL Server allow you to run SQL Server in Active/Active mode where each node of the cluster is “active” and running one or more SQL Server instances.</span></span> <span data-ttu-id="d91ea-115">たとえば、これにより他のノードで 1 つのノードおよびその他のすべての BizTalk Server データベースにメッセージ ボックス データベースを使用します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-115">For example, this would allow you to have the MessageBox database on one node and all other BizTalk Server databases on the other node.</span></span> <span data-ttu-id="d91ea-116">クラスターのハードウェア使用率を最大化することができますが、アクティブ/アクティブ SQL Server の構成を注意して使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d91ea-116">This allows you to maximize cluster hardware usage, but an active/active SQL Server configuration should be used with care.</span></span>  
  
     <span data-ttu-id="d91ea-117">各ノードに同時に負荷を処理できるすべての SQL Server インスタンスの SQL Server クラスター ノードのフェールオーバー シナリオ中にしますか。</span><span class="sxs-lookup"><span data-stu-id="d91ea-117">Can each node simultaneously handle the load of all SQL Server instances during a SQL Server cluster node failover scenario?</span></span> <span data-ttu-id="d91ea-118">十分な CPU リソースはありますか。</span><span class="sxs-lookup"><span data-stu-id="d91ea-118">Are there enough CPU resources?</span></span> <span data-ttu-id="d91ea-119">十分なメモリはありますか。</span><span class="sxs-lookup"><span data-stu-id="d91ea-119">Is there sufficient memory?</span></span> <span data-ttu-id="d91ea-120">ネットワーク帯域幅について説明します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-120">What about network bandwidth?</span></span> <span data-ttu-id="d91ea-121">ディスク I/O の競合ですか。</span><span class="sxs-lookup"><span data-stu-id="d91ea-121">How about disk I/O contention?</span></span>  
  
     <span data-ttu-id="d91ea-122">これらは、アクティブ/アクティブ クラスターで SQL Server は、BizTalk アプリケーションの適切なかどうかを決定するために回答する必要がある質問の一部です。</span><span class="sxs-lookup"><span data-stu-id="d91ea-122">These are just some of the questions that need to be answered in order to determine if an active/active SQL Server cluster is right for your BizTalk applications.</span></span> <span data-ttu-id="d91ea-123">1 つのノードはフェールオーバー シナリオでは、すべての SQL Server インスタンスを処理できないと判断された場合、別の方法では、アクティブ/アクティブ/パッシブ クラスタ リングを使用します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-123">If it is determined that one node cannot handle all SQL Server instances in a failover scenario, an alternative is to use active/active/passive clustering.</span></span>  
  
-   <span data-ttu-id="d91ea-124">**アクティブ/アクティブ/パッシブ**します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-124">**Active/active/passive**.</span></span> <span data-ttu-id="d91ea-125">実行時の環境では、BizTalk 管理データベース、メッセージ ボックス データベース、追跡分析サービス データベース、BAM 分析データベース、BAM スター スキーマ データベース、BAM プライマリ インポート データベース、および BAM アーカイブ データベースへの書き込み処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="d91ea-125">The run-time processes write to the BizTalk Management database, MessageBox databases, Tracking Analysis Services database, BAM Analysis database, BAM Star Schema database, BAM Primary Import database, and BAM Archive database.</span></span> <span data-ttu-id="d91ea-126">したがって、これらのデータベースを障害から保護することが特に重要となります。当然、どのデータベースをクラスター化するかという判断において、より高い優先順位が付けられることになります。</span><span class="sxs-lookup"><span data-stu-id="d91ea-126">Therefore, these databases are especially important if a disaster occurs, and must have greater priority when determining what databases to cluster.</span></span> <span data-ttu-id="d91ea-127">その他のデータベースに対する書き込みは、ユーザーまたはツールによってのみ行われます。</span><span class="sxs-lookup"><span data-stu-id="d91ea-127">Only users or tools write to the other databases.</span></span> <span data-ttu-id="d91ea-128">メッセージ ボックス データベースの場合は、アクティブ/アクティブ/パッシブまたはアクティブ/アクティブ/アクティブ/パッシブ構成で必要なハードウェアを最小限に抑えるを検討できます。</span><span class="sxs-lookup"><span data-stu-id="d91ea-128">For the MessageBox databases, you can consider an active/active/passive or active/active/active/passive configuration to minimize the hardware needed.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d91ea-129">SQL Server Standard Edition では、2 ノード フェールオーバー クラスターをサポートします。</span><span class="sxs-lookup"><span data-stu-id="d91ea-129">SQL Server Standard Edition supports 2-node failover clusters.</span></span> <span data-ttu-id="d91ea-130">SQL Server のアクティブ/アクティブ/パッシブ構成を使用する場合は、Enterprise Edition を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d91ea-130">If you decide to use the active/active/passive configuration on SQL Server, you must use the Enterprise Edition.</span></span>  
  
## <a name="procedures-for-clustering-the-databases"></a><span data-ttu-id="d91ea-131">データベースをクラスター化するための手順</span><span class="sxs-lookup"><span data-stu-id="d91ea-131">Procedures for Clustering the Databases</span></span>  
 <span data-ttu-id="d91ea-132">BizTalk Server データベースをクラスタ リングを開始する前に、次の前提条件を満たすことを確認します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-132">Make sure you meet the following prerequisites before you start clustering the BizTalk Server databases.</span></span>  
  
-   <span data-ttu-id="d91ea-133">BizTalk Server 環境のドメイン グループを作成する場合は、グローバル ドメイン アカウントを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d91ea-133">When you create the domain groups for your BizTalk Server environment, you must create global domain accounts.</span></span>  
  
-   <span data-ttu-id="d91ea-134">インストールして、BizTalk Server を構成する前に、SQL Server クラスターを構成します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-134">Configure the SQL Server cluster before you install and configure BizTalk Server.</span></span> <span data-ttu-id="d91ea-135">参照してください[Windows Server のフェールオーバー クラスタ リング (WSFC) を SQL Server](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server)または[Always On フェールオーバー クラスター インスタンス (SQL Server)](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server)します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-135">See [Windows Server Failover Clustering (WSFC) with SQL Server](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server) or [Always On Failover Cluster Instances (SQL Server)](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server).</span></span>  
  
-   <span data-ttu-id="d91ea-136">さらに、マスター シークレット サーバーをクラスター化する場合は、マスター シークレット サーバーを最初に構成しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="d91ea-136">If you are also clustering the master secret server, configure that server first.</span></span> <span data-ttu-id="d91ea-137">参照してください[マスター シークレット サーバーの高可用性](../technical-guides/high-availability-for-the-master-secret-server.md)します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-137">See [High Availability for the Master Secret Server](../technical-guides/high-availability-for-the-master-secret-server.md).</span></span>  
  
#### <a name="run-biztalk-configuration"></a><span data-ttu-id="d91ea-138">BizTalk 構成を実行します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-138">Run BizTalk Configuration</span></span>  
  
1. <span data-ttu-id="d91ea-139">BizTalk Server は、ランタイム サーバーをインストールします。</span><span class="sxs-lookup"><span data-stu-id="d91ea-139">Install BizTalk Server on a runtime server.</span></span>  
  
2. <span data-ttu-id="d91ea-140">**[BizTalk Server 構成]** を開きます。</span><span class="sxs-lookup"><span data-stu-id="d91ea-140">Open **BizTalk Server Configuration**.</span></span>  
  
3. <span data-ttu-id="d91ea-141">カスタム構成を適用するを参照してください。[のインポートとエクスポートの BizTalk Server 構成](../install-and-config-guides/import-and-export-biztalk-server-configuration.md)します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-141">To apply a custom configuration, see [Import and Export BizTalk Server Configuration](../install-and-config-guides/import-and-export-biztalk-server-configuration.md).</span></span> <span data-ttu-id="d91ea-142">BizTalk Server データベースで SQL Server クラスターの名前を入力します。 SQL Server クラスターを指定する、**データベース**構成のダイアログ。</span><span class="sxs-lookup"><span data-stu-id="d91ea-142">To specify the SQL Server cluster for the BizTalk Server databases enter the name of the SQL Server cluster in the **Databases** dialog of the configuration.</span></span>  
  
4. <span data-ttu-id="d91ea-143">BizTalk Server 構成を使用して、完了、[カスタム構成](../install-and-config-guides/configure-biztalk-server.md)します。</span><span class="sxs-lookup"><span data-stu-id="d91ea-143">Complete the BizTalk Server configuration using a [Custom Configuration](../install-and-config-guides/configure-biztalk-server.md).</span></span>
  
   <span data-ttu-id="d91ea-144">BizTalk Server データベースをクラスタ リングの詳細については、[Improving Fault Tolerance in Windows Server 2008 フェールオーバー クラスターまたは Windows Server 2003 サーバー クラスターを使用して BizTalk Server](https://www.microsoft.com/download/details.aspx?id=2290)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d91ea-144">For more information about clustering BizTalk Server databases, see [Improving Fault Tolerance in BizTalk Server by Using a Windows Server 2008 Failover Cluster or Windows Server 2003 Server Cluster](https://www.microsoft.com/download/details.aspx?id=2290).</span></span>  
  
## <a name="behavior-of-biztalk-host-instances-during-sql-server-failover"></a><span data-ttu-id="d91ea-145">SQL Server フェールオーバー時の BizTalk ホスト インスタンスの動作</span><span class="sxs-lookup"><span data-stu-id="d91ea-145">Behavior of BizTalk Host Instances During SQL Server Failover</span></span>  
 <span data-ttu-id="d91ea-146">SQL Server フェールオーバー時の BizTalk ホスト インスタンスの動作の詳細については、[動作の BizTalk Server ホスト インスタンスを SQL Server フェールオーバー時](../core/behavior-of-biztalk-server-host-instances-during-sql-server-failover.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d91ea-146">For more information about behavior of BizTalk host instances during SQL Server failover, see [Behavior of BizTalk Server Host Instances during SQL Server Failover](../core/behavior-of-biztalk-server-host-instances-during-sql-server-failover.md).</span></span>  
  
## <a name="using-sql-server-database-mirroring"></a><span data-ttu-id="d91ea-147">SQL Server データベース ミラーリングの使用</span><span class="sxs-lookup"><span data-stu-id="d91ea-147">Using SQL Server Database Mirroring</span></span>  
 <span data-ttu-id="d91ea-148">詳細については、BizTalk Server データベースのクラスタ リングに関する SQL Server データベース ミラーリングを使用して、[SQL Server データベース ミラーリング、ボリューム シャドウ コピー サービス、および AlwaysOn](../core/sql-server-database-mirroring-volume-shadow-copy-service-and-alwayson.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d91ea-148">For more information about using SQL Server database mirroring with respect to BizTalk Server database clustering, see [SQL Server database mirroring, Volume Shadow Copy service and AlwaysOn](../core/sql-server-database-mirroring-volume-shadow-copy-service-and-alwayson.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d91ea-149">参照</span><span class="sxs-lookup"><span data-stu-id="d91ea-149">See Also</span></span>  
 [<span data-ttu-id="d91ea-150">BizTalk Server データベースのスケール アウト</span><span class="sxs-lookup"><span data-stu-id="d91ea-150">Scaling Out the BizTalk Server Databases</span></span>](../technical-guides/scaling-out-the-biztalk-server-databases.md)