---
title: 'チェックリスト: HYPER-V のパフォーマンスの測定 |Microsoft ドキュメント'
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f32c95f4-a4eb-412b-9fa7-140e80b85e5a
caps.latest.revision: ''
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6aefa415bec4b996fa7b5cd4689c48f834dc36a2
ms.sourcegitcommit: 8418b1a8f38b7f56979cd6e203f0b591e2f40fe1
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/28/2018
---
# <a name="checklist-measuring-performance-on-hyper-v"></a><span data-ttu-id="3d5a8-102">チェックリスト: HYPER-V のパフォーマンスの測定</span><span class="sxs-lookup"><span data-stu-id="3d5a8-102">Checklist: Measuring Performance on Hyper-V</span></span>
<span data-ttu-id="3d5a8-103">コレクション メソッドの多くは、HYPER-V 仮想マシンのパフォーマンスにインストールされているゲスト オペレーティング システムのパフォーマンスを分析する場合の原則のほとんどは、同じ物理コンピューターにインストールされているオペレーティング システムのパフォーマンスを分析するが、します。異なる。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-103">While most of the principles of analyzing performance of a guest operating system installed on a Hyper-V virtual machine performance are the same as analyzing the performance of an operating system installed on a physical machine, many of the collection methods are different.</span></span> <span data-ttu-id="3d5a8-104">以下のセクションでは、HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムで実行されている BizTalk Server ソリューションのパフォーマンスを評価するときに、クイック リファレンスとして使用してください。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-104">The sections below should be used as a quick reference when evaluating performance of your BizTalk Server solution running on a guest operating system installed on a Hyper-V virtual machine.</span></span>  
  
## <a name="measuring-disk-io-performance"></a><span data-ttu-id="3d5a8-105">ディスク I/O パフォーマンスの測定</span><span class="sxs-lookup"><span data-stu-id="3d5a8-105">Measuring Disk I/O Performance</span></span>  
 <span data-ttu-id="3d5a8-106">HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システム上のディスク I/O パフォーマンスを測定するのにには、次のパフォーマンス モニター カウンターを使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-106">Use the following performance monitor counters to measure disk I/O performance on a guest operating system installed on a Hyper-V virtual machine:</span></span>  
  
|<span data-ttu-id="3d5a8-107">手順</span><span class="sxs-lookup"><span data-stu-id="3d5a8-107">Step</span></span>|<span data-ttu-id="3d5a8-108">リファレンス</span><span class="sxs-lookup"><span data-stu-id="3d5a8-108">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="3d5a8-109">**HYPER-V ホストのオペレーティング システム上のディスク待機時間を計測**–"\Logical ディスク (*) \Avg を使用して HYPER-V ホストのオペレーティング システムでディスク パフォーマンスの初期最善の指標が取得されます。Disk sec/Read” and “\Logical Disk(\*)\Avg.Disk Sec/write"パフォーマンス モニター カウンターです。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-109">**Measure disk latency on a Hyper-V host operating system** – The best initial indicator of disk performance on a Hyper-V host operating system is obtained by using the “\Logical Disk(*)\Avg. Disk sec/Read” and “\Logical Disk(\*)\Avg. Disk sec/Write” performance monitor counters.</span></span> <span data-ttu-id="3d5a8-110">これらのパフォーマンス モニター カウンターでは、読み取りし、書き込み操作に、オペレーティング システムに応答する時間を時間を測定します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-110">These performance monitor counters measure the amount of time that read and write operations take to respond to the operating system.</span></span> <span data-ttu-id="3d5a8-111">一般的な則として使うより大きい平均応答時間が最適と見なされます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-111">As a general rule of thumb, average response times greater than 15ms are considered sub-optimal.</span></span> <span data-ttu-id="3d5a8-112">一般的な則として使うより大きい平均応答時間が最適と見なされます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-112">As a general rule of thumb, average response times greater than 15ms are considered sub-optimal.</span></span> <span data-ttu-id="3d5a8-113">これは、基にして、一般的なシーク 7,200 RPM ディスク キャッシュなしの時間。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-113">This is based on the typical seek time of a single 7200 RPM disk drive without cache.</span></span> <span data-ttu-id="3d5a8-114">Windows アプリケーションとサービスは、オペレーティング システムに表示される物理ディスク (LUN) を指定できます、ドライブ文字として表される論理ドライブを利用しているために、物理ディスクのパフォーマンス モニター カウンターではなく、論理ディスクの使用は推奨します。ディスク配列内の複数の物理ディスク ドライブで構成されます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-114">The use of logical disk versus physical disk performance monitor counters is recommended because Windows applications and services utilize logical drives represented as drive letters wherein the physical disk (LUN) presented to the operating system can be comprised of multiple physical disk drives in a disk array.</span></span> <span data-ttu-id="3d5a8-115">\Logical ディスクを使用して HYPER-V ホストのオペレーティング システム上のディスク待機時間を測定するときに、次を大まかな目安を使用して (\*) \Avg です。Disk sec/Read or \Logical Disk(\*)\Avg.ディスク書き込み秒数パフォーマンス モニター カウンター:</span><span class="sxs-lookup"><span data-stu-id="3d5a8-115">Use the following rule of thumb when measuring disk latency on the Hyper-V host operating system using the \Logical Disk(\*)\Avg. Disk sec/Read or \Logical Disk(\*)\Avg. Disk sec/Write performance monitor counters:</span></span><br /><br /> <span data-ttu-id="3d5a8-116">これは、基にして、一般的なシーク 7,200 RPM ディスク キャッシュなしの時間。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-116">This is based on the typical seek time of a single 7200 RPM disk drive without cache.</span></span> <span data-ttu-id="3d5a8-117">Windows アプリケーションとサービスは、オペレーティング システムに表示される物理ディスク (LUN) を指定できます、ドライブ文字として表される論理ドライブを利用しているために、物理ディスクのパフォーマンス モニター カウンターではなく、論理ディスクの使用は推奨します。ディスク配列内の複数の物理ディスク ドライブで構成されます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-117">The use of logical disk versus physical disk performance monitor counters is recommended because Windows applications and services utilize logical drives represented as drive letters wherein the physical disk (LUN) presented to the operating system can be comprised of multiple physical disk drives in a disk array.</span></span> <span data-ttu-id="3d5a8-118">\Logical ディスクを使用して HYPER-V ホストのオペレーティング システム上のディスク待機時間を測定するときに、次を大まかな目安を使用して (\*) \Avg です。Disk sec/Read or \Logical Disk(\*)\Avg.ディスク書き込み秒数パフォーマンス モニター カウンター:</span><span class="sxs-lookup"><span data-stu-id="3d5a8-118">Use the following rule of thumb when measuring disk latency on the Hyper-V host operating system using the \Logical Disk(\*)\Avg. Disk sec/Read or \Logical Disk(\*)\Avg. Disk sec/Write performance monitor counters:</span></span><br /><br /> <span data-ttu-id="3d5a8-119">-1 ミリ秒に使う Healthy を =</span><span class="sxs-lookup"><span data-stu-id="3d5a8-119">-   1ms to 15ms  = Healthy</span></span><br /><span data-ttu-id="3d5a8-120">-使うを 25 = 警告またはモニター</span><span class="sxs-lookup"><span data-stu-id="3d5a8-120">-   15ms to 25ms = Warning or Monitor</span></span><br /><span data-ttu-id="3d5a8-121">-26ms 以上 ="重大"、パフォーマンスが悪影響を受ける**注:**非仮想化環境にインストールされている物理ディスクが HYPER-V ホストのオペレーティング システムを介してアクセス ディスクよりも優れたパフォーマンスを提供します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-121">-   26ms or greater = Critical, performance will be adversely affected **Note:**  Physical disks installed on a non-virtualized environment offer better performance than disks accessed through a Hyper-V host operating system.</span></span> <span data-ttu-id="3d5a8-122">ディスクのパフォーマンスは、アプリケーションの全体的なパフォーマンスが重要ですが、のみ、物理ハードウェア上のディスクをホストしていることを検討してください。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-122">If disk performance is absolutely critical to the overall performance of your application, consider hosting disks on physical hardware only.</span></span> <span data-ttu-id="3d5a8-123">**注:**ディスク I/O のパフォーマンスを評価するときに評価している任意のディスク パーティションのスキャンを除外するウイルス対策ソフトウェアを構成することを確認してください。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-123">**Note:**  When evaluating disk I/O performance, ensure that you configure antivirus software to exclude scanning of any disk partitions that are being evaluated.</span></span> <span data-ttu-id="3d5a8-124">ウイルス対策スキャンには、パフォーマンスとのずれのテスト結果に悪影響のオーバーヘッドが導入されています。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-124">Antivirus scanning introduces overhead that can negatively impact performance and skew test results.</span></span> <br /><br /> <span data-ttu-id="3d5a8-125">**ゲスト オペレーティング システム上のディスク待機時間を計測**– オペレーティング HYPER-V ホストによって使用されるディスクの応答時間を測定するために使用されている、同じパフォーマンス モニター カウンターを使用して、ゲスト オペレーティング システムで使用されているディスクの応答時間を測定することができますシステムです。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-125">**Measure disk latency on guest operating systems** – Response times of the disks used by the guest operating systems can be measured using the same performance monitor counters used to measure response times of the disks used by the Hyper-V host operating system.</span></span>|<span data-ttu-id="3d5a8-126">ディスク パフォーマンス分析の詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-126">For more information about disk performance analysis, see the following resources:</span></span><br /><br /> <span data-ttu-id="3d5a8-127">-「を実行している SQL Server 2008 in a Hyper-v 環境 – ベスト プラクティスとパフォーマンスに関する考慮事項」ホワイト ペーパーの「HYPER-V で実行されている SQL Server のパフォーマンスのオーバーヘッド」セクション[ http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-127">-   “Performance Overhead of Running SQL Server in Hyper-V” section of “Running SQL Server 2008 in a Hyper-V Environment – Best Practices and Performance Considerations” whitepaper at [http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622).</span></span><br /><span data-ttu-id="3d5a8-128">-でのディスク バインドの問題は除きます[ http://go.microsoft.com/fwlink/?LinkId=120947](http://go.microsoft.com/fwlink/?LinkId=120947)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-128">-   Ruling Out Disk-Bound Problems at [http://go.microsoft.com/fwlink/?LinkId=120947](http://go.microsoft.com/fwlink/?LinkId=120947).</span></span><br /><span data-ttu-id="3d5a8-129">SQL Server の展開前 I/O のベスト プラクティスとで[ http://go.microsoft.com/fwlink/?LinkId=120948](http://go.microsoft.com/fwlink/?LinkId=120948)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-129">-   SQL Server Predeployment I/O Best Practices at [http://go.microsoft.com/fwlink/?LinkId=120948](http://go.microsoft.com/fwlink/?LinkId=120948).</span></span><br /><span data-ttu-id="3d5a8-130">-の「I/O ボトルネック」セクションで、"Troubleshooting Performance Problems in SQL Server 2008" に関するホワイト ペーパーで使用可能な[ http://go.microsoft.com/fwlink/?LinkID=202135](http://go.microsoft.com/fwlink/?LinkID=202135)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-130">-   “I/O Bottlenecks” section of the “Troubleshooting Performance Problems in SQL Server 2008” whitepaper available at [http://go.microsoft.com/fwlink/?LinkID=202135](http://go.microsoft.com/fwlink/?LinkID=202135).</span></span><br /><span data-ttu-id="3d5a8-131">-ツールを使用して、Microsoft サーバー パフォーマンス アドバイザー (SPA) でディスク パフォーマンスのボトルネックを特定する方法[ http://go.microsoft.com/fwlink/?LinkID=98096](http://go.microsoft.com/fwlink/?LinkID=98096)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-131">-   How to Identify a Disk Performance Bottleneck Using the Microsoft Server Performance Advisor (SPA) Tool at [http://go.microsoft.com/fwlink/?LinkID=98096](http://go.microsoft.com/fwlink/?LinkID=98096).</span></span>|  
  
## <a name="measuring-memory-performance"></a><span data-ttu-id="3d5a8-132">メモリ パフォーマンスの測定</span><span class="sxs-lookup"><span data-stu-id="3d5a8-132">Measuring Memory Performance</span></span>  
 <span data-ttu-id="3d5a8-133">使用可能なメモリ、HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムのパフォーマンスに影響を測定するのにには、次のパフォーマンス モニター カウンターを使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-133">Use the following performance monitor counters to measure the impact of available memory on the performance of a guest operating system installed on a Hyper-V virtual machine:</span></span>  
  
|<span data-ttu-id="3d5a8-134">手順</span><span class="sxs-lookup"><span data-stu-id="3d5a8-134">Step</span></span>|<span data-ttu-id="3d5a8-135">リファレンス</span><span class="sxs-lookup"><span data-stu-id="3d5a8-135">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="3d5a8-136">**HYPER-V ホストのオペレーティング システムで使用できるメモリを測定**– で"\Memory\Available 領域のメガバイト数"パフォーマンス モニター カウンターを監視することによって、HYPER-V ホストのオペレーティング システムを使用できる物理メモリの量を決定できます、物理コンピューター。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-136">**Measure available memory on the Hyper-V host operating system** – The amount of physical memory available to the Hyper-V host operating system can be determined by monitoring the “\Memory\Available MBytes” performance monitor counter on the physical computer.</span></span> <span data-ttu-id="3d5a8-137">このカウンターは、ホスト オペレーティング システムを使用できる無料の物理メモリの量を報告します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-137">This counter reports the amount of free physical memory available to the host operating system.</span></span> <span data-ttu-id="3d5a8-138">ホスト オペレーティング システムで使用できる使用可能な物理メモリを評価するときに、次の経験則を使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-138">Use the following rules of thumb when evaluating available physical memory available to the host operating system:</span></span><br /><br /> <ul><li><span data-ttu-id="3d5a8-139">**\Memory\Available Mbytes** – Available MBytes は、コンピューターにインストールされている物理メモリの割合として、コンピューターで実行されているプロセスに使用できる物理メモリの量を測定します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-139">**\Memory\Available Mbytes** – Available MBytes measures the amount of physical memory available to processes running on the computer, as a percentage of physical memory installed on the computer.</span></span> <span data-ttu-id="3d5a8-140">このパフォーマンス モニター カウンターの値を測定するときに、次のガイドラインが適用されます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-140">The following guidelines apply when measuring the value of this performance monitor counter:</span></span><br /><br /> <ul><li><span data-ttu-id="3d5a8-141">使用可能な空きメモリの 50% より = 正常または</span><span class="sxs-lookup"><span data-stu-id="3d5a8-141">50% of free memory available or more = Healthy</span></span></li><li><span data-ttu-id="3d5a8-142">使用可能な空きメモリの 25% = モニター</span><span class="sxs-lookup"><span data-stu-id="3d5a8-142">25% of free memory available = Monitor</span></span></li><li><span data-ttu-id="3d5a8-143">使用可能な空きメモリの 10% = 警告</span><span class="sxs-lookup"><span data-stu-id="3d5a8-143">10% of free memory available = Warning</span></span></li><li><span data-ttu-id="3d5a8-144">使用可能な空きメモリの 5% 未満 ="重大"、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="3d5a8-144">Less than 5% of free memory available = Critical, performance will be adversely affected</span></span></li></ul></li><li><span data-ttu-id="3d5a8-145">**\Memory\Pages/sec** – このパフォーマンス モニター カウンターをページの読み取りまたはハード ページ フォールトを解決するのにはディスクに書き込まれる速度を測定します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-145">**\Memory\Pages/sec** – This performance monitor counter measures the rate at which pages are read from or written to disk to resolve hard page faults.</span></span> <span data-ttu-id="3d5a8-146">ハード ページ フォールトを解決するには、オペレーティング システムがディスクで、パフォーマンスが低下するためのメモリの内容を交換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-146">To resolve hard page faults, the operating system must swap the contents of memory to disk, which negatively impacts performance.</span></span> <span data-ttu-id="3d5a8-147">使用可能な物理メモリの不足との相関関係の 1 秒あたりのページ数が高には、物理メモリの不足を可能性があります。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-147">A high number of pages per second in correlation with low available physical memory may indicate a lack of physical memory.</span></span> <span data-ttu-id="3d5a8-148">このパフォーマンス モニター カウンターの値を測定するときに、次のガイドラインが適用されます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-148">The following guidelines apply when measuring the value of this performance monitor counter:</span></span><br /><br /> <ul><li><span data-ttu-id="3d5a8-149">500 未満 = 正常</span><span class="sxs-lookup"><span data-stu-id="3d5a8-149">Less than 500 = Healthy</span></span></li><li><span data-ttu-id="3d5a8-150">500 ~ 1000 = モニターまたは注意が必要</span><span class="sxs-lookup"><span data-stu-id="3d5a8-150">500 - 1000 = Monitor or Caution</span></span></li><li><span data-ttu-id="3d5a8-151">1,000 を超える ="重大"、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="3d5a8-151">Greater than 1000 = Critical, performance will be adversely affected</span></span></li></ul></li></ul><br /> <span data-ttu-id="3d5a8-152">**ゲスト オペレーティング システムで使用できるメモリを測定**– ゲスト オペレーティング システムを使用可能なメモリは、HYPER-V ホストのオペレーティング システムを使用可能なメモリを測定するために使用されている、同じパフォーマンス モニター カウンターで測定できます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-152">**Measure available memory on the guest operating system** – Memory that is available to the guest operating systems can be measured with the same performance monitor counters used to measure memory available to the Hyper-V host operating system.</span></span>|<span data-ttu-id="3d5a8-153">アプリケーション サーバーのパフォーマンス上の使用可能な物理メモリの影響に関する詳細についてで Exchange Server 2003 のヘルプ トピック「ルールをメモリ バインドに関する問題」を参照してください。 [ http://go.microsoft.com/fwlink/?LinkId=121056](http://go.microsoft.com/fwlink/?LinkId=121056)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-153">For more information about the impact of available physical memory on application server performance, see the Exchange Server 2003 Help topic “Ruling Out Memory-Bound Problems” at [http://go.microsoft.com/fwlink/?LinkId=121056](http://go.microsoft.com/fwlink/?LinkId=121056).</span></span>|  
  
## <a name="measuring-network-performance"></a><span data-ttu-id="3d5a8-154">ネットワーク パフォーマンスの測定</span><span class="sxs-lookup"><span data-stu-id="3d5a8-154">Measuring Network Performance</span></span>  
 <span data-ttu-id="3d5a8-155">HYPER-V では、ゲスト コンピューターが同じ物理ネットワーク アダプターを共有できます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-155">Hyper-V allows guest computers to share the same physical network adapter.</span></span> <span data-ttu-id="3d5a8-156">これにより、ハードウェアを統合する、中にしないように注意、物理アダプターが飽和状態です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-156">While this helps to consolidate hardware, take care not to saturate the physical adapter.</span></span> <span data-ttu-id="3d5a8-157">次のメソッドを使用して、HYPER-V 仮想マシンで使用されるネットワークの正常性を確認してください。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-157">Use the following methods to ensure the health of the network used by the Hyper-V virtual machines:</span></span>  
  
|<span data-ttu-id="3d5a8-158">手順</span><span class="sxs-lookup"><span data-stu-id="3d5a8-158">Step</span></span>|<span data-ttu-id="3d5a8-159">リファレンス</span><span class="sxs-lookup"><span data-stu-id="3d5a8-159">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="3d5a8-160">**テスト ネットワークの待機時間**</span><span class="sxs-lookup"><span data-stu-id="3d5a8-160">**Test network latency**</span></span>|<span data-ttu-id="3d5a8-161">適切なネットワーク待機時間を確認するには、各仮想マシンに ping を実行します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-161">Ping each virtual machine to ensure adequate network latency.</span></span> <span data-ttu-id="3d5a8-162">1 ミリ秒未満を受信することがローカル エリア ネットワーク上の応答時間。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-162">On local area networks, expect to receive less than 1ms response times.</span></span>|  
|<span data-ttu-id="3d5a8-163">**パケット損失のテスト**</span><span class="sxs-lookup"><span data-stu-id="3d5a8-163">**Test for packet loss**</span></span>|<span data-ttu-id="3d5a8-164">Pathping.exe ユーティリティを使用すると、仮想マシン間でパケットの損失をテストできます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-164">Use the pathping.exe utility to test packet loss between virtual machines.</span></span> <span data-ttu-id="3d5a8-165">Pathping.exe がネットワークでのパケット損失を測定し、すべてのバージョンのでは利用[!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)]ため[!INCLUDE[btsWin2kSvr](../includes/btswin2ksvr-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-165">Pathping.exe measures packet loss on the network and is available with all versions of [!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)] since [!INCLUDE[btsWin2kSvr](../includes/btswin2ksvr-md.md)].</span></span> <span data-ttu-id="3d5a8-166">Pathping.exe は大量のネットワークの各ノードに 100 回の ping 要求を送信し、ping の数が返されますを計算します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-166">Pathping.exe sends out a burst of 100 ping requests to each network node and calculates how many pings are returned.</span></span> <span data-ttu-id="3d5a8-167">ローカル エリア ネットワークで必要がありますいない pathping.exe ユーティリティからの ping 要求が失われる。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-167">On local area networks there should be no loss of ping requests from the pathping.exe utility.</span></span>|  
|<span data-ttu-id="3d5a8-168">**テスト ネットワークのファイル転送**</span><span class="sxs-lookup"><span data-stu-id="3d5a8-168">**Test network file transfers**</span></span>|<span data-ttu-id="3d5a8-169">仮想マシン間で 100 MB のファイルをコピーし、コピーが完了するために必要な時間の長さを測定します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-169">Copy a 100MB file between virtual machines and measure the length of time required to complete the copy.</span></span> <span data-ttu-id="3d5a8-170">正常な 100 mbit 上 (メガビット) のネットワーク 10 ~ 20 秒で 100 MB (メガバイト) ファイルをコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-170">On a healthy 100Mbit (megabit) network, a 100MB (megabyte) file should copy in 10 to 20 seconds.</span></span> <span data-ttu-id="3d5a8-171">1 ギガ ビットの正常なネットワークで 100 MB のファイルは、約 3 ~ 5 秒にコピーしなければなりません。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-171">On a healthy 1Gbit network, a 100MB file should copy in about 3 to 5 seconds.</span></span> <span data-ttu-id="3d5a8-172">これらのパラメーターの外部でコピー時間は、ネットワークの問題を示しています。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-172">Copy times outside of these parameters are indicative of a network problem.</span></span> <span data-ttu-id="3d5a8-173">不適切なネットワーク転送の 1 つの一般的な原因の場合は、ネットワーク アダプターがある「自動検出」、10 MB の半二重ネットワークするネットワーク アダプターが使用できる帯域幅をフル活用することができません。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-173">One common cause of poor network transfers occurs when the network adapter has “auto detected” a 10MB half-duplex network which prevents the network adapter from taking full advantage of available bandwidth.</span></span>|  
|<span data-ttu-id="3d5a8-174">**HYPER-V ホストのオペレーティング システム上のネットワークの使用率のメジャー**</span><span class="sxs-lookup"><span data-stu-id="3d5a8-174">**Measure network utilization on the Hyper-V host operating system**</span></span>|<span data-ttu-id="3d5a8-175">HYPER-V ホストのオペレーティング システム上のネットワーク使用率を測定するのにには、次のパフォーマンス モニター カウンターを使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-175">Use the following performance monitor counters to measure network utilization on the Hyper-V host operating system:</span></span><br /><br /> <span data-ttu-id="3d5a8-176">**\Network Interface(\*)\Bytes Total/sec** – The percentage of network utilization is calculated by multiplying Bytes Total/sec by 8 to convert it to bits, multiply the result by 100, then divide by the network adapter’s current bandwidth.</span><span class="sxs-lookup"><span data-stu-id="3d5a8-176">**\Network Interface(\*)\Bytes Total/sec** – The percentage of network utilization is calculated by multiplying Bytes Total/sec by 8 to convert it to bits, multiply the result by 100, then divide by the network adapter’s current bandwidth.</span></span> <span data-ttu-id="3d5a8-177">ネットワーク帯域幅の使用率を評価するのにには、次のしきい値を使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-177">Use the following thresholds to evaluate network bandwidth utilization:</span></span><br /><br /> <span data-ttu-id="3d5a8-178">-使用されたインターフェイスの 40% 未満 Healthy を =</span><span class="sxs-lookup"><span data-stu-id="3d5a8-178">-   Less than 40% of the interface consumed = Healthy</span></span><br /><span data-ttu-id="3d5a8-179">-41 ~ 64% 使用されたインターフェイスのモニターまたは注意を =</span><span class="sxs-lookup"><span data-stu-id="3d5a8-179">-   41%-64% of the interface consumed = Monitor or Caution</span></span><br /><span data-ttu-id="3d5a8-180">~ 65 ~ 100% 消費されるインターフェイスの ="重大"、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="3d5a8-180">-   65-100% of the interface consumed = Critical, performance will be adversely affected</span></span><br /><br /> <span data-ttu-id="3d5a8-181">**\Network Interface(\*)\Output Queue Length** – The output queue length measures the number of threads waiting on the network adapter.</span><span class="sxs-lookup"><span data-stu-id="3d5a8-181">**\Network Interface(\*)\Output Queue Length** – The output queue length measures the number of threads waiting on the network adapter.</span></span> <span data-ttu-id="3d5a8-182">ネットワーク アダプターで待機している 2 つ以上のスレッドがある場合、ネットワーク可能性があります、ボトルネックになっています。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-182">If there are more than 2 threads waiting on the network adapter, then the network may be a bottleneck.</span></span> <span data-ttu-id="3d5a8-183">これの一般的な原因は、不適切なネットワーク待機時間やネットワーク上の高い衝突率がします。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-183">Common causes of this are poor network latency and/or high collision rates on the network.</span></span> <span data-ttu-id="3d5a8-184">出力キューの長さを評価するのにには、次のしきい値を使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-184">Use the following thresholds to evaluate output queue length:</span></span><br /><br /> <span data-ttu-id="3d5a8-185">-0 = 正常</span><span class="sxs-lookup"><span data-stu-id="3d5a8-185">-   0 = Healthy</span></span><br /><span data-ttu-id="3d5a8-186">-1-2 = モニターまたは注意が必要</span><span class="sxs-lookup"><span data-stu-id="3d5a8-186">-   1-2 = Monitor or Caution</span></span><br /><span data-ttu-id="3d5a8-187">2 より大きい ="重大"、パフォーマンスが悪影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-187">-   Greater than 2 = Critical, performance will be adversely affected.</span></span><br /><br /> <span data-ttu-id="3d5a8-188">最大転送単位 (MTU) に同じ値を使用するソリューションのすべてのコンピューター (物理およびバーチャル) のネットワーク アダプターが構成されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-188">Ensure that the network adapters for all computers (physical and virtual) in the solution are configured to use the same value for maximum transmission unit (MTU).</span></span> <span data-ttu-id="3d5a8-189">MTU 値を構成する方法の詳細についてを参照してください「付録 a: TCP/IP 構成パラメーター」 [ http://go.microsoft.com/fwlink/?LinkId=113716](http://go.microsoft.com/fwlink/?LinkId=113716)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-189">For more information about configuring the MTU value, see “Appendix A: TCP/IP Configuration Parameters” at [http://go.microsoft.com/fwlink/?LinkId=113716](http://go.microsoft.com/fwlink/?LinkId=113716).</span></span><br /><br /> <span data-ttu-id="3d5a8-190">2 以上の出力キューの長さは、測定される場合は、仮想マシンをホストする物理コンピューターに 1 つまたは複数の物理ネットワーク アダプターを追加するを検討し、ゲスト オペレーティング システムでこれらの物理ネットワーク アダプターを使用するネットワーク アダプターにバインドします。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-190">If an output queue length of 2 or more is measured, consider adding one or more physical network adapters to the physical computer that hosts the virtual machines and bind the network adapters used by the guest operating systems to these physical network adapters.</span></span>|  
|<span data-ttu-id="3d5a8-191">**ゲスト オペレーティング システムでメジャーのネットワーク使用率**</span><span class="sxs-lookup"><span data-stu-id="3d5a8-191">**Measure network utilization on the guest operating systems**</span></span>|<span data-ttu-id="3d5a8-192">どの仮想ネットワークを識別する"\Hyper-V 仮想ネットワーク アダプター (\*) \Bytes/sec"パフォーマンス モニター カウンターの使用を検討し、HYPER-V は、ルート パーティション上のネットワーク アダプターが上記で説明した、パフォーマンス モニター カウンターによって示されるビジー状態である場合は、アダプターは、ほとんどのネットワーク使用率を消費しています。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-192">If a network adapter on the Hyper-V root partition is busy as indicated by the performance monitor counters mentioned above, then consider using the "\Hyper-V Virtual Network Adapter(\*)\Bytes/sec" performance monitor counter to identify which virtual network adapters are consuming the most network utilization.</span></span>|  
  
 <span data-ttu-id="3d5a8-193">ネットワークのパフォーマンス分析の詳細についてを参照してください「章 15-測定 .NET アプリケーション パフォーマンス」 [ http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-193">For more information about network performance analysis, see “Chapter 15 - Measuring .NET Application Performance” at [http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073).</span></span>  
  
## <a name="measuring-processor-performance"></a><span data-ttu-id="3d5a8-194">プロセッサ パフォーマンスの測定</span><span class="sxs-lookup"><span data-stu-id="3d5a8-194">Measuring Processor Performance</span></span>  
 <span data-ttu-id="3d5a8-195">HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムでプロセッサのパフォーマンスを評価するのに、次のメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-195">Use the following methods to evaluate processor performance on a guest operating system installed on a Hyper-V virtual machine:</span></span>  
  
-   <span data-ttu-id="3d5a8-196">**ゲスト オペレーティング システムのプロセッサ使用率の測定**を使用するプロセッサのパフォーマンスを測定できます従来、"\Processor(\*)\\% Processor Time"カウンターのパフォーマンス監視します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-196">**Measure guest operating system processor utilization -** Traditionally, processor performance can be measured using the “\Processor(\*)\\% Processor Time” performance monitor counter.</span></span> <span data-ttu-id="3d5a8-197">これは、HYPER-V を計測して、仮想マシンに割り当てられているプロセッサの数に対してこの値を報告するためもゲスト オペレーティング システムのプロセッサ使用率を評価するため、正確なカウンターではありません。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-197">This is not an accurate counter for evaluating processor utilization of a guest operating system though because Hyper-V measures and reports this value relative to the number of processors allocated to the virtual machine.</span></span> <span data-ttu-id="3d5a8-198">各ゲスト オペレーティング システムによって返される値が実際には、物理コンピューターをよりも、仮想マシンを実行するのより多くのプロセッサが割り当てられている場合、"\Processor (\*)\\% Processor Time"カウンターのパフォーマンス監視実際には、プロセッサ使用率は、ボトルネックになっている場合でもは、少なくなります。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-198">If more processors are allocated to running virtual machines than are actually present on the physical computer, the value returned by each guest operating system for the “\Processor(\*)\\% Processor Time” performance monitor counter will be low, even if in fact processor utilization is a bottleneck.</span></span> <span data-ttu-id="3d5a8-199">これは、仮想プロセッサ、ラウンド ロビン方式で物理プロセッサを利用するために発生します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-199">This occurs because the virtual processors utilize the physical processors in a round-robin fashion.</span></span> <span data-ttu-id="3d5a8-200">各仮想プロセッサとなります自体の全体的なシステム リソースの共有を割り当てるため、4 つの物理プロセッサ システムでシステム リソースの 25% を利用しようと既定では、各仮想プロセッサです。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-200">Each virtual processor will try and allocate itself a share of overall system resources, so in a 4 physical processor system, each virtual processor will by default try to utilize 25% of the system resources.</span></span> <span data-ttu-id="3d5a8-201">8 個の仮想プロセッサ作成つまりをまとめて仮想プロセッサは、サーバーの CPU 容量の 200% を利用しようとします。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-201">If 8 virtual processors are created this means that collectively the virtual processors will attempt to utilize 200% of the server CPU capacity.</span></span> <span data-ttu-id="3d5a8-202">各仮想プロセッサがで測定された使用率の低いを報告するここで、"\Processor (\*)\\% Processor Time"(、予想されるレベル) への相対パフォーマンス モニター カウンターおよびコンテキストの過度の切り替え、仮想プロセッサと、各仮想マシンのパフォーマンスの低下が発生します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-202">In this case, each virtual processor will report a low utilization as measured by the “\Processor(\*)\\% Processor Time” performance monitor counter (relative to the level it expects) and the excessive context switching between the virtual processors will result in poor performance for each virtual machine.</span></span> <span data-ttu-id="3d5a8-203">このシナリオでは、ホスト オペレーティング システム上の HYPER-V 仮想マシンに割り当てられた仮想プロセッサの数を減らすことを検討してください。HYPER-V では、ハイパーバイザー両方論理プロセッサと仮想プロセッサのパフォーマンスを監視するパフォーマンス オブジェクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-203">In this scenario, consider reducing the number of virtual processors allocated to Hyper-V virtual machines on the host operating system.Hyper-V provides hypervisor performance objects to monitor the performance of both logical and virtual processors.</span></span> <span data-ttu-id="3d5a8-204">論理プロセッサのプロセッサまたは物理コンピューターにインストールされているコアの数に直接関連しています。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-204">A logical processor correlates directly to the number of processors or cores that are installed on the physical computer.</span></span> <span data-ttu-id="3d5a8-205">たとえば、2 つのクアッド コア プロセッサ、物理コンピューターにインストールされているは 8 の論理プロセッサに相関します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-205">For example, 2 quad core processors installed on the physical computer would correlate to 8 logical processors.</span></span> <span data-ttu-id="3d5a8-206">仮想プロセッサがどのような仮想マシンを実際に使用、および仮想プロセッサ ルートと子パーティション内のすべての実行が発生します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-206">Virtual processors are what the virtual machines actually use, and all execution in the root and child partitions occurs in virtual processors.</span></span>  
  
     <span data-ttu-id="3d5a8-207">HYPER-V では、ハイパーバイザー両方論理プロセッサと仮想プロセッサのパフォーマンスを監視するパフォーマンス オブジェクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-207">Hyper-V provides hypervisor performance objects to monitor the performance of both logical and virtual processors.</span></span> <span data-ttu-id="3d5a8-208">論理プロセッサのプロセッサまたは物理コンピューターにインストールされているコアの数に直接関連しています。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-208">A logical processor correlates directly to the number of processors or cores that are installed on the physical computer.</span></span> <span data-ttu-id="3d5a8-209">たとえば、2 つのクアッド コア プロセッサ、物理コンピューターにインストールされているは 8 の論理プロセッサに相関します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-209">For example, 2 quad core processors installed on the physical computer would correlate to 8 logical processors.</span></span> <span data-ttu-id="3d5a8-210">仮想プロセッサがどのような仮想マシンを実際に使用、および仮想プロセッサ ルートと子パーティション内のすべての実行が発生します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-210">Virtual processors are what the virtual machines actually use, and all execution in the root and child partitions occurs in virtual processors.</span></span>  
  
     <span data-ttu-id="3d5a8-211">正確に測定するためにゲスト オペレーティング システムのプロセッサ使用率を使用して、"HYPER-V ハイパーバイザー論理 processor (_total) % の合計実行時間"HYPER-V ホストのオペレーティング システムのパフォーマンス モニター カウンターです。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-211">To accurately measure the processor utilization of a guest operating system, use the “Hyper-V Hypervisor Logical Processor(_Total)% Total Run Time” performance monitor counter on the Hyper-V host operating system.</span></span> <span data-ttu-id="3d5a8-212">次のしきい値を使用してゲスト オペレーティング システム プロセッサ使用率を使用して評価を"HYPER-V ハイパーバイザー論理 processor (_total) % の合計実行時間"パフォーマンス カウンターの監視。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-212">Use the following thresholds to evaluate guest operating system processor utilization using the “Hyper-V Hypervisor Logical Processor(_Total)% Total Run Time” performance monitor counter:</span></span>  
  
    -   <span data-ttu-id="3d5a8-213">60% 未満が消費される健全を =</span><span class="sxs-lookup"><span data-stu-id="3d5a8-213">Less than 60% consumed = Healthy</span></span>  
  
    -   <span data-ttu-id="3d5a8-214">60%-89% 消費されるモニターまたは注意を =</span><span class="sxs-lookup"><span data-stu-id="3d5a8-214">60% - 89% consumed = Monitor or Caution</span></span>  
  
    -   <span data-ttu-id="3d5a8-215">90 ~ 100% 消費 ="重大"、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="3d5a8-215">90% - 100% consumed = Critical, performance will be adversely affected</span></span>  
  
     <span data-ttu-id="3d5a8-216">HYPER-V 環境でのゲスト オペレーティング システムのプロセッサのパフォーマンスをトラブルシューティングするをお勧めのホスト オペレーティング システムにより報告された値の間のバランスを目指しています"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計の実行Time"(します) と"\Hyper-V ハイパーバイザー仮想 processor (_total)\\% の合計実行時間"(VPTR)。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-216">To troubleshoot processor performance of guest operating systems on a Hyper-V environment, it is best to strive for a balance between the values reported by the host operating system for “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” (LPTR) and “\Hyper-V Hypervisor Virtual Processor(_Total)\\% Total Run Time” (VPTR).</span></span> <span data-ttu-id="3d5a8-217">しますが高いと VPTR が少ない場合、物理コンピューター上に物理的に使用できるよりも、仮想マシンに割り当てられているより多くのプロセッサがないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-217">If LPTR is high and VPTR is low then verify that there are not more processors allocated to virtual machines than are physically available on the physical computer.</span></span> <span data-ttu-id="3d5a8-218">使用して、"\Hyper-V ハイパーバイザー仮想 Processor(\*)\\ゲストの実行時間の割合"仮想プロセッサを決定するためのカウンターが CPU を消費しているし、仮想プロセッサの一対一マッピングの構成に該当する仮想マシンからの割り当てを解除論理プロセッサに仮想プロセッサです。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-218">Use the “\Hyper-V Hypervisor Virtual Processor(\*)\\%Guest Run Time” counters to determine which virtual Processors are consuming CPU and de-allocate virtual processors from virtual machines as appropriate to configure a one to one mapping of virtual processors to logical processors.</span></span> <span data-ttu-id="3d5a8-219">仮想プロセッサと論理プロセッサの一対一マッピングの構成に関する詳細についてを参照してください「プロセッサのパフォーマンスを最適化する」[チェックリスト: HYPER-V でのパフォーマンスの最適化](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-219">For more information about configuring a one to one mapping of virtual processors to logical processors, see the “Optimizing Processor Performance” section in [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span> <span data-ttu-id="3d5a8-220">VPTR が高いとしますが少ない場合、使用可能な論理プロセッサがある場合、および追加のプロセッサがゲスト オペレーティング システムでサポートされている場合、仮想マシンに追加のプロセッサを割り当てるを検討します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-220">If VPTR is high and LPTR is low then consider allocating additional processors to virtual machines if there are available logical processors and if additional processors are supported by the guest operating system.</span></span> <span data-ttu-id="3d5a8-221">物理コンピューターに追加の仮想マシンを追加することでスケール アウトを検討してください VPTR が高い場合、しますが、低、割り当てるには、使用可能な論理プロセッサがあるが、追加のプロセッサがゲスト オペレーティング システムでサポートされていないとこれらの仮想マシンに使用可能なプロセッサを割り当てました。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-221">In the case where VPTR is high, LPTR is low, there are available logical processors to allocate, but additional processors are not supported by the guest operating system, consider scaling out by adding additional virtual machines to the physical computer and allocating available processors to these virtual machines.</span></span> <span data-ttu-id="3d5a8-222">VPTR およびしますの両方が高い場合は、構成は、物理コンピューターの制限のプッシュが、別の物理コンピューターとその他の HYPER-V 仮想マシンを環境に追加することでスケール アウトを検討してください。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-222">In the case where both VPTR and LPTR are high, the configuration is pushing the limits of the physical computer and should consider scaling out by adding another physical computer and additional Hyper-V virtual machines to the environment.</span></span> <span data-ttu-id="3d5a8-223">次のフローチャートでは、HYPER-V 環境でのプロセッサのパフォーマンスのトラブルシューティングを行うときに使用するプロセスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-223">The flowchart below describes the process that should be used when troubleshooting processor performance in a Hyper-V environment.</span></span>  
  
     <span data-ttu-id="3d5a8-224">VPTR が高しますが少ない場合は、使用可能な論理プロセッサがある場合、および追加のプロセッサがゲスト オペレーティング システムでサポートされている場合、仮想マシンに追加のプロセッサを割り当てるを検討します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-224">If VPTR is high and LPTR is low, then consider allocating additional processors to virtual machines if there are available logical processors and if additional processors are supported by the guest operating system.</span></span> <span data-ttu-id="3d5a8-225">物理コンピューターに追加の仮想マシンを追加することでスケール アウトを検討してください VPTR が高い場合、しますが、低、割り当てるには、使用可能な論理プロセッサがあるが、追加のプロセッサがゲスト オペレーティング システムでサポートされていないとこれらの仮想マシンに使用可能なプロセッサを割り当てました。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-225">In the case where VPTR is high, LPTR is low, there are available logical processors to allocate, but additional processors are not supported by the guest operating system, consider scaling out by adding additional virtual machines to the physical computer and allocating available processors to these virtual machines.</span></span> <span data-ttu-id="3d5a8-226">VPTR およびしますの両方が高い場合は、構成は、物理コンピューターの制限のプッシュが、別の物理コンピューターとその他の HYPER-V 仮想マシンを環境に追加することでスケール アウトを検討してください。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-226">In the case where both VPTR and LPTR are high, the configuration is pushing the limits of the physical computer and should consider scaling out by adding another physical computer and additional Hyper-V virtual machines to the environment.</span></span> <span data-ttu-id="3d5a8-227">次のフローチャートでは、HYPER-V 環境でのプロセッサのパフォーマンスのトラブルシューティングを行うときに使用するプロセスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-227">The flowchart below describes the process that should be used when troubleshooting processor performance in a Hyper-V environment.</span></span>  
  
     <span data-ttu-id="3d5a8-228">![ハイパースレッディングの CPU パフォーマンスのトラブルシューティング&#45;V](../technical-guides/media/623fdcd6-e80b-4ba9-bf46-5d9b92b6612b.gif "623fdcd6-e80b-4ba9-bf46-5d9b92b6612b")</span><span class="sxs-lookup"><span data-stu-id="3d5a8-228">![Troubleshooting CPU Performance on Hyper&#45;V](../technical-guides/media/623fdcd6-e80b-4ba9-bf46-5d9b92b6612b.gif "623fdcd6-e80b-4ba9-bf46-5d9b92b6612b")</span></span>  
<span data-ttu-id="3d5a8-229">HYPER-V 環境での CPU パフォーマンスのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="3d5a8-229">Troubleshooting CPU performance in a Hyper-V Environment</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="3d5a8-230">**ゲスト オペレーティング システムのプロセッサには、物理プロセッサまたはコアをセット アフィニティはありません。** –、ハイパーバイザーは、物理リソースを定義を使用します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-230">**Guest operating system processors do not have a set affinity to physical processors/cores** – The hypervisor determines how physical resources are used.</span></span> <span data-ttu-id="3d5a8-231">プロセッサ使用率の場合は、ハイパーバイザーは、スレッドの形式で物理的なプロセッサにゲスト プロセッサ時間をスケジュールします。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-231">In the case of processor utilization, the hypervisor schedules the guest processor time to physical processor in the form of threads.</span></span> <span data-ttu-id="3d5a8-232">これは、仮想マシンのプロセッサの負荷分散が物理コンピューターのプロセッサを意味します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-232">This means the processor load of virtual machines will be spread across the processors of the physical computer.</span></span> <span data-ttu-id="3d5a8-233">さらに、仮想マシンが構成される 2 つの論理プロセッサを持つコア/8 プロセッサ、物理コンピューター上で実行する単一の仮想マシンが構成されている場合などの論理プロセッサ数のプロセッサ使用率を超えることはできません、仮想マシンは、構成されている論理プロセッサ数 (ここでは 2 つのプロセッサ) のプロセッサの能力を超えることはできません。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-233">Furthermore, virtual machines cannot exceed the processor utilization of the configured number of logical processors, for example if a single virtual machine is configured to run with 2 logical processors on a physical computer with 8 processors/cores, then the virtual machine cannot exceed the processor capacity of the number of configured logical processors (in this case 2 processors).</span></span>  
  
-   <span data-ttu-id="3d5a8-234">**HYPER-V は、パフォーマンスを使用して HYPER-V 環境全体のプロセッサ使用率を測定するカウンターの監視**のプロセッサ使用率を測定するための目的で、ホスト オペレーティング システムが論理的として表示される単なる別のゲスト オペレーティング システム.</span><span class="sxs-lookup"><span data-stu-id="3d5a8-234">**Measure overall processor utilization of the Hyper-V environment using Hyper-V performance monitor counters -** For purposes of measuring processor utilization, the host operating system is logically viewed as just another guest operating system.</span></span> <span data-ttu-id="3d5a8-235">したがって、"\Processor(\*)\\% Processor Time"カウンターの監視が、ホストのオペレーティング システムに対してのみのプロセッサ使用率を測定します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-235">Therefore, the “\Processor(\*)\\% Processor Time” monitor counter measures the processor utilization of the host operating system only.</span></span> <span data-ttu-id="3d5a8-236">ホスト オペレーティング システムとすべてのゲスト オペレーティング システムの物理プロセッサの合計使用率を測定するを使用して、"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行時間"パフォーマンス モニター カウンターです。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-236">To measure total physical processor utilization of the host operating system and all guest operating systems, use the “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” performance monitor counter.</span></span> <span data-ttu-id="3d5a8-237">このカウンタは、両方のホスト オペレーティング システムを実行しているプロセッサで費やされた時間の合計割合を測定し、すべてのゲスト オペレーティング システムです。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-237">This counter measures the total percentage of time spent by the processor running the both the host operating system and all guest operating systems.</span></span>  
  
     <span data-ttu-id="3d5a8-238">次のしきい値を使用して、HYPER-V を使用して環境の全体的なのプロセッサ使用率を評価、"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行時間"パフォーマンス カウンターの監視。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-238">Use the following thresholds to evaluate overall processor utilization of the Hyper-V environment using the “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” performance monitor counter:</span></span>  
  
    -   <span data-ttu-id="3d5a8-239">60% 未満が消費される健全を =</span><span class="sxs-lookup"><span data-stu-id="3d5a8-239">Less than 60% consumed = Healthy</span></span>  
  
    -   <span data-ttu-id="3d5a8-240">60%-89% 消費されるモニターまたは注意を =</span><span class="sxs-lookup"><span data-stu-id="3d5a8-240">60% - 89% consumed = Monitor or Caution</span></span>  
  
    -   <span data-ttu-id="3d5a8-241">90 ~ 100% 消費 ="重大"、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="3d5a8-241">90% - 100% consumed = Critical, performance will be adversely affected</span></span>  
  
     <span data-ttu-id="3d5a8-242">プロセッサ使用率の詳細については、次のリソースを確認します。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-242">For more information about processor utilization review the following resources:</span></span>  
  
    -   <span data-ttu-id="3d5a8-243">"する方法: 運用環境でのサーバー アプリケーションの高いユーザー モード CPU のボトルネックの発生した関数を識別する"で[ http://go.microsoft.com/fwlink/?LinkID=107047](http://go.microsoft.com/fwlink/?LinkID=107047)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-243">“How To: Identify Functions causing a High User-mode CPU Bottleneck for Server Applications in a Production Environment” at [http://go.microsoft.com/fwlink/?LinkID=107047](http://go.microsoft.com/fwlink/?LinkID=107047).</span></span>  
  
    -   <span data-ttu-id="3d5a8-244">「章 15 - .NET アプリケーション パフォーマンスを測定」 [ http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073)です。</span><span class="sxs-lookup"><span data-stu-id="3d5a8-244">“Chapter 15 - Measuring .NET Application Performance” at [http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073).</span></span>