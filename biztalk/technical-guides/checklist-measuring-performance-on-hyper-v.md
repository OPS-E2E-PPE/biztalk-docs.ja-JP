---
title: チェックリスト:HYPER-V のパフォーマンスを測定する |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f32c95f4-a4eb-412b-9fa7-140e80b85e5a
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d2c38bb38f3bf519ff7b82e9dff02f57e3d61106
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65399319"
---
# <a name="checklist-measuring-performance-on-hyper-v"></a>チェックリスト:HYPER-V のパフォーマンスを測定します。
HYPER-V 仮想マシンのパフォーマンスにインストールされているゲスト オペレーティング システムのパフォーマンスを分析する場合の原則のほとんどは、物理マシンにインストールされているオペレーティング システムのパフォーマンスの分析と同じでは、中に、コレクションのメソッドの多くは、します。異なる。 以下のセクションでは、HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムで実行されている BizTalk Server ソリューションのパフォーマンスを評価するときに、クイック リファレンスとして使用する必要があります。  

## <a name="measuring-disk-io-performance"></a>ディスク I/O パフォーマンスを測定します。  
 HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムのディスク I/O パフォーマンスを測定するのにには、次のパフォーマンス モニター カウンターを使用します。  


|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 手順                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                リファレンス                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **HYPER-V ホストのオペレーティング システム ディスクの待機時間を計測**– を使用して、HYPER-V ホストのオペレーティング システム ディスクのパフォーマンスの最適な初期のインジケーターが取得した、"\Logical ディスク (*) \Avg します。Disk Sec/read"と"\Logical ディスク (\*) \Avg します。Disk Sec/write"パフォーマンス モニター カウンターです。これらのパフォーマンス モニター カウンターでは、読み取りし、書き込み操作に、オペレーティング システムに応答する時間を時間を測定します。一般則として使うよりも大きい値の平均応答時間が最適と見なされます。一般則として使うよりも大きい値の平均応答時間が最適と見なされます。これに基づいて、一般的なシーク キャッシュなし 7200 RPM ディスク ドライブを 1 つの時刻。Windows アプリケーションとサービスは、オペレーティング システムに提示される物理ディスク (LUN) を指定できます、ドライブ文字として表される論理ドライブを使用するために物理ディスク パフォーマンス モニター カウンターと論理ディスクの使用がお勧めしますディスクの配列内の複数の物理ディスク ドライブで構成されます。\Logical ディスクを使用して、HYPER-V ホストのオペレーティング システム ディスクの待機時間を測定するときに、次の目安を使用して (\*) \Avg します。Disk sec/Read or \Logical Disk(\*)\Avg.ディスク書き込み秒数パフォーマンス モニター カウンター:<br /><br />これに基づいて、一般的なシーク キャッシュなし 7200 RPM ディスク ドライブを 1 つの時刻。Windows アプリケーションとサービスは、オペレーティング システムに提示される物理ディスク (LUN) を指定できます、ドライブ文字として表される論理ドライブを使用するために物理ディスク パフォーマンス モニター カウンターと論理ディスクの使用がお勧めしますディスクの配列内の複数の物理ディスク ドライブで構成されます。\Logical ディスクを使用して、HYPER-V ホストのオペレーティング システム ディスクの待機時間を測定するときに、次の目安を使用して (\*) \Avg します。Disk sec/Read or \Logical Disk(\*)\Avg.ディスク書き込み秒数パフォーマンス モニター カウンター:<br /> <br /> - 1 ミリ秒に使う ="健全"<br />- 25 に使う = 警告または監視<br />- 26ms 以上 = 重大、パフォーマンスが悪影響を受ける\* \*に注意してください。*\*非仮想化環境にインストールされている物理ディスクでは、HYPER-V ホストのオペレーティング システムを使用してアクセス ディスクよりも優れたパフォーマンスを提供します。 ディスクのパフォーマンスが非常に重要に、アプリケーションの全体的なパフォーマンスの場合は、物理ハードウェアだけでディスクをホストを検討してください。 **注:** ディスク I/O パフォーマンスを評価するときに、除外が評価されているディスク パーティションをスキャンするウイルス対策ソフトウェアを構成することを確認します。 ウイルス対策スキャンでは、パフォーマンスと傾斜のテスト結果が悪影響を与えるオーバーヘッドについて説明します。 <br /><br /> **ゲスト オペレーティング システムでのディスク待機時間を計測**– 運用 HYPER-V ホストで使用されるディスクの応答時間を測定するために使用されている、同じパフォーマンス モニター カウンターを使用して、ゲスト オペレーティング システムで使用されるディスクの応答時間を測定することができますシステム。 | ディスク パフォーマンス分析の詳細については、次のリソースを参照してください。<br /><br /> -「、HYPER-V で実行されている SQL Server のパフォーマンスのオーバーヘッド」セクション「を実行している SQL Server 2008 in a Hyper-v 環境 – ベスト プラクティスとパフォーマンスに関する考慮事項」のホワイト ペーパーの[ http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622)します。<br />-で、ディスクの制限の問題は除きます[ http://go.microsoft.com/fwlink/?LinkId=120947](http://go.microsoft.com/fwlink/?LinkId=120947)します。<br />SQL Server の展開前 I/O のベスト プラクティス[ http://go.microsoft.com/fwlink/?LinkId=120948](http://go.microsoft.com/fwlink/?LinkId=120948)します。<br />-「I/O ボトルネック」セクションの"Troubleshooting Performance Problems in SQL Server 2008" ホワイト ペーパーで使用可能な[ http://go.microsoft.com/fwlink/?LinkID=202135](http://go.microsoft.com/fwlink/?LinkID=202135)します。<br />-方法では、Microsoft のサーバー パフォーマンス アドバイザー (SPA) ツールを使用してディスクのパフォーマンスのボトルネックを識別するために[ http://go.microsoft.com/fwlink/?LinkID=98096](http://go.microsoft.com/fwlink/?LinkID=98096)します。 |

## <a name="measuring-memory-performance"></a>メモリ パフォーマンスを測定します。  
 使用可能なメモリ、HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムのパフォーマンスに影響を測定するのにには、次のパフォーマンス モニター カウンターを使用します。  

|手順|リファレンス|  
|----------|---------------|  
|**HYPER-V ホストのオペレーティング システムで使用可能なメモリを測定**–"\Memory\Available 領域のメガバイト数"パフォーマンス モニター カウンターの監視では、HYPER-V ホストのオペレーティング システムで使用できる物理メモリの量を決定できます、物理コンピューター。 このカウンターは、ホスト オペレーティング システムで使用できる無料の物理メモリの量を報告します。 ホスト オペレーティング システムで使用できる使用可能な物理メモリを評価するときに、次の経験則を使用します。<br /><br /> <ul><li>**\Memory\Available Mbytes** – Available MBytes は、コンピューターにインストールされている物理メモリの割合として、コンピューターで実行されているプロセスに使用できる物理メモリの量を測定します。 このパフォーマンス モニタ カウンタの値を測定するときに、次のガイドラインが適用されます。<br /><br /> <ul><li>使用可能な空きメモリの 50% 以上 = 正常</li><li>使用可能な空きメモリの 25% = 監視</li><li>空きメモリ 10% = 警告</li><li>使用可能な空きメモリの 5% 未満 = 重大、パフォーマンスが悪影響を受ける</li></ul></li><li>**\Memory\Pages/sec** – このパフォーマンス モニタ カウンタは、ページの読み取り、ハード ページ フォールトを解決するのにはディスクに書き込まれる位置の速度を測定します。 ハード ページ フォールトを解決するには、オペレーティング システムはディスクで、パフォーマンスが低下するためのメモリの内容を交換する必要があります。 使用可能な物理メモリの不足との相関関係の 1 秒あたりのページ数が高には、物理メモリの不足を可能性があります。 このパフォーマンス モニタ カウンタの値を測定するときに、次のガイドラインが適用されます。<br /><br /> <ul><li>500 未満 = 正常</li><li>500-1000 = 監視または注意が必要です</li><li>1,000 を超える = 重大、パフォーマンスが悪影響を受ける</li></ul></li></ul><br /> **ゲスト オペレーティング システムで使用可能なメモリを測定**– HYPER-V ホストのオペレーティング システムに使用可能なメモリを測定するために使用されている、同じパフォーマンス モニター カウンターでは、ゲスト オペレーティング システムに使用可能なメモリを測定できます。|アプリケーション サーバーのパフォーマンスの使用可能な物理メモリの影響に関する詳細についてで Exchange Server 2003 のヘルプ トピックの「"判決をメモリ負荷の高い問題"を参照してください。 [ http://go.microsoft.com/fwlink/?LinkId=121056](http://go.microsoft.com/fwlink/?LinkId=121056)します。|  

## <a name="measuring-network-performance"></a>ネットワーク パフォーマンスを測定します。  
 HYPER-V は、ゲスト コンピューターが同じ物理ネットワーク アダプターを共有できます。 これにより、ハードウェアを統合する、中に、物理アダプターが飽和状態にしない処理します。 HYPER-V の仮想マシンで使用されるネットワークの正常性を保証するのに、次のメソッドを使用します。  


|                                 手順                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               リファレンス                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                       **テスト ネットワークの待機時間**                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 適切なネットワーク待機時間を確認するには、各仮想マシンに ping を実行します。 ローカル エリア ネットワークが 1 ミリ秒未満の受信応答時間。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                       **パケット損失のテスト**                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Pathping.exe ユーティリティを使用すると、仮想マシン間のパケット損失をテストできます。 Pathping.exe がネットワーク上のパケット損失の測定されのすべてのバージョンで利用[!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)]ため[!INCLUDE[btsWin2kSvr](../includes/btswin2ksvr-md.md)]します。 Pathping.exe では、大量のネットワークの各ノードに 100 個の ping 要求を送信し、ping の数が返されるを計算します。 ローカル エリア ネットワークではありません、pathping.exe ユーティリティからの ping 要求が失われる。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                   **テスト ネットワークのファイル転送**                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          仮想マシン間で 100 MB のファイルをコピーし、コピーが完了に必要な時間の長さを測定します。 正常である 100 mbit 上 (メガビット) のネットワーク 10 ~ 20 秒で 100 MB (メガバイト) ファイルをコピーする必要があります。 、正常な 1 gb のネットワーク 100 MB のファイルは 3 ~ 5 秒ほどでコピーする必要があります。 これらのパラメーターの範囲外コピーにかかる時間は、ネットワークの問題を示しています。 不適切なネットワーク転送の 1 つの一般的な原因は、ネットワーク アダプターがある「自動検出」ときに発生します。 10 MB 半二重のネットワークがネットワーク アダプターが使用できる帯域幅をフルに活用することを防ぎます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **HYPER-V ホストのオペレーティング システムのメジャーのネットワーク使用率** | HYPER-V ホストのオペレーティング システム上のネットワーク使用率を測定するのにには、次のパフォーマンス モニター カウンターを使用します。<br /><br /> **\Network Interface(\*)\Bytes Total/sec** – The percentage of network utilization is calculated by multiplying Bytes Total/sec by 8 to convert it to bits, multiply the result by 100, then divide by the network adapter’s current bandwidth. ネットワーク帯域幅の使用率を評価するのにには、次のしきい値を使用します。<br /><br /> -使用されるインターフェイスの 40% 未満 = 正常<br />-使用されるインターフェイスの 41% ~ 64% = 監視または注意が必要です<br />~ 使用されるインターフェイスの 65 ~ 100% = 重大、パフォーマンスが悪影響を受ける<br /><br /> **\Network Interface(\*)\Output Queue Length** – The output queue length measures the number of threads waiting on the network adapter. ネットワーク アダプターで待機している 2 つ以上のスレッドがある場合は、ネットワークはボトルネックになる可能性があります。 この一般的な原因は、不適切なネットワーク待機時間や、ネットワーク上の高い衝突率です。 出力キューの長さを評価するのにには、次のしきい値を使用します。<br /><br /> -0 = 正常<br />-1-2 = 監視または注意が必要です<br />2 より大きい = 重大、パフォーマンスが悪影響を受けます。<br /><br /> 最大転送単位 (MTU) に同じ値を使用するソリューションのすべてのコンピューター (物理および仮想) のネットワーク アダプターが構成されていることを確認します。 MTU の値を構成する方法の詳細については、付録 a:"を参照してください。TCP/IP Configuration Parameters で[ http://go.microsoft.com/fwlink/?LinkId=113716](http://go.microsoft.com/fwlink/?LinkId=113716)します。<br /><br /> 2 以上の出力キューの長さを測定すると、仮想マシンをホストする物理コンピューターに 1 つまたは複数の物理ネットワーク アダプターの追加を検討し、これらの物理ネットワーク アダプターにゲスト オペレーティング システムで使用されるネットワーク アダプターにバインドします。 |
|    **メジャー、ゲスト オペレーティング システムでのネットワーク使用率**    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       使用を検討し、HYPER-V のルート パーティション上のネットワーク アダプターが上記のように、パフォーマンス モニター カウンターで示されているビジー状態の場合、"\Hyper-V 仮想ネットワーク アダプター (\*) \Bytes/sec"を特定し、パフォーマンス モニター カウンター仮想ネットワーク アダプターには、ほとんどのネットワーク使用率が消費しています。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

 ネットワークのパフォーマンス分析の詳細についてを参照してください「章 15-測定する .NET アプリケーションのパフォーマンス」 [ http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073)します。  

## <a name="measuring-processor-performance"></a>プロセッサのパフォーマンスを測定します。  
 HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムでプロセッサのパフォーマンスを評価するのにには、次のメソッドを使用します。  

- **ゲスト オペレーティング システムのプロセッサ使用率の測定**を使用してプロセッサのパフォーマンスを測定できます従来、"\Processor(*)\\% プロセッサ時間"パフォーマンス カウンターの監視。 これは、HYPER-V が測定および仮想マシンに割り当てられているプロセッサの数を基準には、この値をレポートするため、ただし、ゲスト オペレーティング システムのプロセッサ使用率を評価するため、正確なカウンターではありません。 各ゲスト オペレーティング システムで、値が返されますが、実際には、物理コンピューターに存在するよりも仮想マシンの実行より多くのプロセッサが割り当てられている場合、"\Processor (\*)\\% プロセッサ時間"パフォーマンス カウンターの監視実際のプロセッサ使用率は、ボトルネックになっている場合でも、低になります。 これには、仮想プロセッサ、ラウンド ロビン方式で物理プロセッサを利用するために発生します。 各仮想プロセッサを自体の全体的なシステム リソースの共有を割り当てるため、各仮想プロセッサがシステム リソースの 25% を利用しようと既定では、4 つの物理プロセッサ システムでします。 8 個の仮想プロセッサをまとめてつまりが作成仮想プロセッサは、サーバーの CPU 容量の 200% を利用しようとします。 各仮想プロセッサがで測定された使用率が低いを報告するここで、"\Processor (\*)\\% Processor Time"(想定レベル) の相対パフォーマンス モニター カウンターと、コンテキスト切り替えの間で、仮想プロセッサと、各仮想マシンのパフォーマンスの低下が発生します。 このシナリオでは、ホスト オペレーティング システム上の HYPER-V 仮想マシンに割り当てられている仮想プロセッサの数を減らすことを検討してください。HYPER-V は、ハイパーバイザー論理と virtual の両方のプロセッサのパフォーマンスを監視するパフォーマンス オブジェクトを提供します。 論理プロセッサのプロセッサまたは物理コンピューターにインストールされているコアの数に直接関連しています。 たとえば、2 つのクアッド コア プロセッサ、物理コンピューターにインストールされているには 8 個の論理プロセッサを関連付けます。 仮想プロセッサがどのような仮想マシンを実際に使用、および仮想プロセッサ ルートと子パーティション内のすべての実行が発生します。  

   HYPER-V は、ハイパーバイザー論理と virtual の両方のプロセッサのパフォーマンスを監視するパフォーマンス オブジェクトを提供します。 論理プロセッサのプロセッサまたは物理コンピューターにインストールされているコアの数に直接関連しています。 たとえば、2 つのクアッド コア プロセッサ、物理コンピューターにインストールされているには 8 個の論理プロセッサを関連付けます。 仮想プロセッサがどのような仮想マシンを実際に使用、および仮想プロセッサ ルートと子パーティション内のすべての実行が発生します。  

   ゲスト オペレーティング システムのプロセッサ使用率を正確に測定するを使用して、"HYPER-V ハイパーバイザー論理 processor (_total) % の合計実行時間"、HYPER-V ホストのオペレーティング システムでパフォーマンス モニター カウンター。 ゲスト オペレーティング システムのプロセッサ使用率を使用して評価を次のしきい値を使用して、"HYPER-V ハイパーバイザー論理 processor (_total) % の合計実行時間"パフォーマンス カウンターの監視。  

  - 消費された 60% 未満 = 正常  

  - 60-89% 消費 = 監視または注意が必要です  

  - 90% ~ 100% 消費 = 重大、パフォーマンスが悪影響を受ける  

    HYPER-V 環境でのゲスト オペレーティング システムのプロセッサのパフォーマンスをトラブルシューティングすることをお勧めのホスト オペレーティング システムにより報告された値のバランスについてよう努めること"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行Time"(します) と"\Hyper-V ハイパーバイザー仮想 processor (_total)\\% の合計実行時間"(VPTR)。 しますが高く、VPTR が低い場合、物理コンピューターで物理的に利用できる仮想マシンに割り当てるより多くのプロセッサがないことを確認します。 使用して、"\Hyper-V ハイパーバイザー仮想 Processor(*)\\ゲストの実行時間の割合"仮想プロセッサを決定するためのカウンターが CPU を消費しているし、仮想プロセッサの一対一のマッピングを構成する適切な仮想マシンからの割り当てを解除仮想プロセッサの論理プロセッサ。 仮想プロセッサと論理プロセッサの一対一のマッピングを構成する方法の詳細については、「プロセッサのパフォーマンスの最適化」セクションを参照してください。[チェックリスト。HYPER-V のパフォーマンスを最適化する](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)します。 VPTR が高いとしますが低い場合と使用可能な論理プロセッサがある場合、追加のプロセッサがゲスト オペレーティング システムでサポートされている場合、仮想マシンに追加のプロセッサを割り当てるし検討してください。 物理コンピューターへの追加の仮想マシンの追加によるスケール アウトを検討してください VPTR が高い場合は、しますが、低、割り当てるには、使用可能な論理プロセッサがあるが、ゲスト オペレーティング システムでは、プロセッサの追加はサポートされていない、し、これらの仮想マシンに使用可能なプロセッサに割り当てています。 VPTR としますが高い場合は、構成は、物理コンピューターの制限をプッシュしている、別の物理コンピューターとその他の HYPER-V 仮想マシンを環境に追加することでスケール アウトを検討してください。 次のフローチャートでは、HYPER-V 環境でのプロセッサ パフォーマンスのトラブルシューティング時に使用するプロセスについて説明します。  

    VPTR が高しますが低い場合と使用可能な論理プロセッサがある場合、追加のプロセッサがゲスト オペレーティング システムでサポートされている場合、仮想マシンに追加のプロセッサを割り当てるし検討してください。 物理コンピューターへの追加の仮想マシンの追加によるスケール アウトを検討してください VPTR が高い場合は、しますが、低、割り当てるには、使用可能な論理プロセッサがあるが、ゲスト オペレーティング システムでは、プロセッサの追加はサポートされていない、し、これらの仮想マシンに使用可能なプロセッサに割り当てています。 VPTR としますが高い場合は、構成は、物理コンピューターの制限をプッシュしている、別の物理コンピューターとその他の HYPER-V 仮想マシンを環境に追加することでスケール アウトを検討してください。 次のフローチャートでは、HYPER-V 環境でのプロセッサ パフォーマンスのトラブルシューティング時に使用するプロセスについて説明します。  

    ![ハイパースレッディングでの CPU パフォーマンスのトラブルシューティング&#45;V](../technical-guides/media/623fdcd6-e80b-4ba9-bf46-5d9b92b6612b.gif "623fdcd6-e80b-4ba9-bf46-5d9b92b6612b")  
    HYPER-V 環境での CPU パフォーマンスのトラブルシューティング  

  > [!NOTE]  
  >  **ゲスト オペレーティング システムのプロセッサには、物理プロセッサまたはコアをセットのアフィニティはありません。** – ハイパーバイザーは、どの物理リソースを決定します。 使用されます。 プロセッサ使用率の場合は、ハイパーバイザーは、物理プロセッサのスレッドのフォームにゲストのプロセッサ時間をスケジュールします。 つまり、物理コンピューターのプロセッサ間で仮想マシンのプロセッサの負荷が分散されます。 さらに、仮想マシンが構成されている例では 2 つの論理プロセッサを持つ 8 プロセッサまたはコアを持つ物理コンピューター上で実行する単一の仮想マシンが構成されている場合、論理プロセッサ数のプロセッサ使用率を超えることはできません、仮想マシンには、構成されている論理プロセッサ (ここで 2 つのプロセッサ) の数のプロセッサの能力を超えることはできません。  

- **HYPER-V のパフォーマンスを使用して、HYPER-V 環境の全体的なのプロセッサ使用率を測定するカウンターの監視**のプロセッサ使用率を測定するために、ホスト オペレーティング システムを論理的にもう 1 つのゲスト オペレーティング システムとして表示. そのため、"\Processor(*)\\% Processor Time"カウンターの監視は、のみ、ホスト オペレーティング システムのプロセッサ使用率を測定します。 ホスト オペレーティング システムとすべてのゲスト オペレーティング システムの物理プロセッサの合計使用率を測定するを使用して、"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行時間"パフォーマンス モニター カウンター。 このカウンターは、両方のホスト オペレーティング システムを実行しているプロセッサで費やされた時間の合計の割合を測定し、すべてのゲスト オペレーティング システム。  

   次のしきい値を使用して、使用する HYPER-V 環境の全体的なのプロセッサ使用率を評価する、"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行時間"パフォーマンス カウンターの監視。  

  - 消費された 60% 未満 = 正常  

  - 60-89% 消費 = 監視または注意が必要です  

  - 90% ~ 100% 消費 = 重大、パフォーマンスが悪影響を受ける  

    プロセッサ使用率の詳細については、次のリソースを確認します。  

  - "する方法。特定関数の実稼働環境でサーバー アプリケーションの高いユーザー モード CPU ボトルネックの原因で" [ http://go.microsoft.com/fwlink/?LinkID=107047](http://go.microsoft.com/fwlink/?LinkID=107047)します。  

  - 「章 15 - .NET アプリケーション パフォーマンスを測定」 [ http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073)します。
