---
title: 'チェックリスト: HYPER-V のパフォーマンスを測定する |Microsoft Docs'
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f32c95f4-a4eb-412b-9fa7-140e80b85e5a
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 111ca6bfa37fdfc6af6f484ebc1568cbaca2c8f6
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37007115"
---
# <a name="checklist-measuring-performance-on-hyper-v"></a><span data-ttu-id="d8200-102">チェックリスト: HYPER-V のパフォーマンスを測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-102">Checklist: Measuring Performance on Hyper-V</span></span>
<span data-ttu-id="d8200-103">HYPER-V 仮想マシンのパフォーマンスにインストールされているゲスト オペレーティング システムのパフォーマンスを分析する場合の原則のほとんどは、物理マシンにインストールされているオペレーティング システムのパフォーマンスの分析と同じでは、中に、コレクションのメソッドの多くは、します。異なる。</span><span class="sxs-lookup"><span data-stu-id="d8200-103">While most of the principles of analyzing performance of a guest operating system installed on a Hyper-V virtual machine performance are the same as analyzing the performance of an operating system installed on a physical machine, many of the collection methods are different.</span></span> <span data-ttu-id="d8200-104">以下のセクションでは、HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムで実行されている BizTalk Server ソリューションのパフォーマンスを評価するときに、クイック リファレンスとして使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d8200-104">The sections below should be used as a quick reference when evaluating performance of your BizTalk Server solution running on a guest operating system installed on a Hyper-V virtual machine.</span></span>  

## <a name="measuring-disk-io-performance"></a><span data-ttu-id="d8200-105">ディスク I/O パフォーマンスを測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-105">Measuring Disk I/O Performance</span></span>  
 <span data-ttu-id="d8200-106">HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムのディスク I/O パフォーマンスを測定するのにには、次のパフォーマンス モニター カウンターを使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-106">Use the following performance monitor counters to measure disk I/O performance on a guest operating system installed on a Hyper-V virtual machine:</span></span>  


|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <span data-ttu-id="d8200-107">手順</span><span class="sxs-lookup"><span data-stu-id="d8200-107">Step</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <span data-ttu-id="d8200-108">リファレンス</span><span class="sxs-lookup"><span data-stu-id="d8200-108">Reference</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="d8200-109">**HYPER-V ホストのオペレーティング システム ディスクの待機時間を計測**– を使用して、HYPER-V ホストのオペレーティング システム ディスクのパフォーマンスの最適な初期のインジケーターが取得した、"\Logical ディスク (*) \Avg します。Disk Sec/read"と"\Logical ディスク (\*) \Avg します。Disk Sec/write"パフォーマンス モニター カウンターです。これらのパフォーマンス モニター カウンターでは、読み取りし、書き込み操作に、オペレーティング システムに応答する時間を時間を測定します。一般則として使うよりも大きい値の平均応答時間が最適と見なされます。一般則として使うよりも大きい値の平均応答時間が最適と見なされます。これに基づいて、一般的なシーク キャッシュなし 7200 RPM ディスク ドライブを 1 つの時刻。Windows アプリケーションとサービスは、オペレーティング システムに提示される物理ディスク (LUN) を指定できます、ドライブ文字として表される論理ドライブを使用するために物理ディスク パフォーマンス モニター カウンターと論理ディスクの使用がお勧めしますディスクの配列内の複数の物理ディスク ドライブで構成されます。\Logical ディスクを使用して、HYPER-V ホストのオペレーティング システム ディスクの待機時間を測定するときに、次の目安を使用して (\*) \Avg します。Disk sec/Read or \Logical Disk(\*)\Avg.ディスク書き込み秒数パフォーマンス モニター カウンター:<br /> <br />に基づいて、一般的なシーク キャッシュなし 7200 RPM ディスク ドライブを 1 つの時刻。Windows アプリケーションとサービスは、オペレーティング システムに提示される物理ディスク (LUN) を指定できます、ドライブ文字として表される論理ドライブを使用するために物理ディスク パフォーマンス モニター カウンターと論理ディスクの使用がお勧めしますディスクの配列内の複数の物理ディスク ドライブで構成されます。\Logical ディスクを使用して、HYPER-V ホストのオペレーティング システム ディスクの待機時間を測定するときに、次の目安を使用して (\*) \Avg します。Disk sec/Read or \Logical Disk(\*)\Avg.ディスク書き込み秒数パフォーマンス モニター カウンター:<br /> <br /> - 1 ミリ秒に使う ="健全"<br />- 25 に使う = 警告または監視<br />- 26ms 以上 = 重大、パフォーマンスが悪影響を受ける\* \*注:* \*非仮想化環境にインストールされている物理ディスクが HYPER-V ホストのオペレーティング システムを使用してアクセス ディスクよりも優れたパフォーマンスを提供します。</span><span class="sxs-lookup"><span data-stu-id="d8200-109">**Measure disk latency on a Hyper-V host operating system** – The best initial indicator of disk performance on a Hyper-V host operating system is obtained by using the “\Logical Disk(*)\Avg. Disk sec/Read” and “\Logical Disk(\*)\Avg. Disk sec/Write” performance monitor counters. These performance monitor counters measure the amount of time that read and write operations take to respond to the operating system. As a general rule of thumb, average response times greater than 15ms are considered sub-optimal. As a general rule of thumb, average response times greater than 15ms are considered sub-optimal. This is based on the typical seek time of a single 7200 RPM disk drive without cache. The use of logical disk versus physical disk performance monitor counters is recommended because Windows applications and services utilize logical drives represented as drive letters wherein the physical disk (LUN) presented to the operating system can be comprised of multiple physical disk drives in a disk array. Use the following rule of thumb when measuring disk latency on the Hyper-V host operating system using the \Logical Disk(\*)\Avg. Disk sec/Read or \Logical Disk(\*)\Avg. Disk sec/Write performance monitor counters:<br /><br /> This is based on the typical seek time of a single 7200 RPM disk drive without cache. The use of logical disk versus physical disk performance monitor counters is recommended because Windows applications and services utilize logical drives represented as drive letters wherein the physical disk (LUN) presented to the operating system can be comprised of multiple physical disk drives in a disk array. Use the following rule of thumb when measuring disk latency on the Hyper-V host operating system using the \Logical Disk(\*)\Avg. Disk sec/Read or \Logical Disk(\*)\Avg. Disk sec/Write performance monitor counters:<br /><br /> -   1ms to 15ms  = Healthy<br />-   15ms to 25ms = Warning or Monitor<br />-   26ms or greater = Critical, performance will be adversely affected \*\*Note:*\*  Physical disks installed on a non-virtualized environment offer better performance than disks accessed through a Hyper-V host operating system.</span></span> <span data-ttu-id="d8200-110">ディスクのパフォーマンスが非常に重要に、アプリケーションの全体的なパフォーマンスの場合は、物理ハードウェアだけでディスクをホストを検討してください。</span><span class="sxs-lookup"><span data-stu-id="d8200-110">If disk performance is absolutely critical to the overall performance of your application, consider hosting disks on physical hardware only.</span></span> <span data-ttu-id="d8200-111">**注:** ディスク I/O パフォーマンスを評価するときに、除外が評価されているディスク パーティションをスキャンするウイルス対策ソフトウェアを構成することを確認します。</span><span class="sxs-lookup"><span data-stu-id="d8200-111">**Note:**  When evaluating disk I/O performance, ensure that you configure antivirus software to exclude scanning of any disk partitions that are being evaluated.</span></span> <span data-ttu-id="d8200-112">ウイルス対策スキャンでは、パフォーマンスと傾斜のテスト結果が悪影響を与えるオーバーヘッドについて説明します。</span><span class="sxs-lookup"><span data-stu-id="d8200-112">Antivirus scanning introduces overhead that can negatively impact performance and skew test results.</span></span> <br /><br /> <span data-ttu-id="d8200-113">**ゲスト オペレーティング システムでのディスク待機時間を計測**– 運用 HYPER-V ホストで使用されるディスクの応答時間を測定するために使用されている、同じパフォーマンス モニター カウンターを使用して、ゲスト オペレーティング システムで使用されるディスクの応答時間を測定することができますシステム。</span><span class="sxs-lookup"><span data-stu-id="d8200-113">**Measure disk latency on guest operating systems** – Response times of the disks used by the guest operating systems can be measured using the same performance monitor counters used to measure response times of the disks used by the Hyper-V host operating system.</span></span> | <span data-ttu-id="d8200-114">ディスク パフォーマンス分析の詳細については、次のリソースを参照してください。</span><span class="sxs-lookup"><span data-stu-id="d8200-114">For more information about disk performance analysis, see the following resources:</span></span><br /><br /> <span data-ttu-id="d8200-115">-「、HYPER-V で実行されている SQL Server のパフォーマンスのオーバーヘッド」セクション「を実行している SQL Server 2008 in a Hyper-v 環境 – ベスト プラクティスとパフォーマンスに関する考慮事項」のホワイト ペーパーの[ http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-115">-   “Performance Overhead of Running SQL Server in Hyper-V” section of “Running SQL Server 2008 in a Hyper-V Environment – Best Practices and Performance Considerations” whitepaper at [http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622).</span></span><br /><span data-ttu-id="d8200-116">-で、ディスクの制限の問題は除きます[ http://go.microsoft.com/fwlink/?LinkId=120947](http://go.microsoft.com/fwlink/?LinkId=120947)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-116">-   Ruling Out Disk-Bound Problems at [http://go.microsoft.com/fwlink/?LinkId=120947](http://go.microsoft.com/fwlink/?LinkId=120947).</span></span><br /><span data-ttu-id="d8200-117">SQL Server の展開前 I/O のベスト プラクティス[ http://go.microsoft.com/fwlink/?LinkId=120948](http://go.microsoft.com/fwlink/?LinkId=120948)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-117">-   SQL Server Predeployment I/O Best Practices at [http://go.microsoft.com/fwlink/?LinkId=120948](http://go.microsoft.com/fwlink/?LinkId=120948).</span></span><br /><span data-ttu-id="d8200-118">-「I/O ボトルネック」セクションの"Troubleshooting Performance Problems in SQL Server 2008" ホワイト ペーパーで使用可能な[ http://go.microsoft.com/fwlink/?LinkID=202135](http://go.microsoft.com/fwlink/?LinkID=202135)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-118">-   “I/O Bottlenecks” section of the “Troubleshooting Performance Problems in SQL Server 2008” whitepaper available at [http://go.microsoft.com/fwlink/?LinkID=202135](http://go.microsoft.com/fwlink/?LinkID=202135).</span></span><br /><span data-ttu-id="d8200-119">-方法では、Microsoft のサーバー パフォーマンス アドバイザー (SPA) ツールを使用してディスクのパフォーマンスのボトルネックを識別するために[ http://go.microsoft.com/fwlink/?LinkID=98096](http://go.microsoft.com/fwlink/?LinkID=98096)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-119">-   How to Identify a Disk Performance Bottleneck Using the Microsoft Server Performance Advisor (SPA) Tool at [http://go.microsoft.com/fwlink/?LinkID=98096](http://go.microsoft.com/fwlink/?LinkID=98096).</span></span> |

## <a name="measuring-memory-performance"></a><span data-ttu-id="d8200-120">メモリ パフォーマンスを測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-120">Measuring Memory Performance</span></span>  
 <span data-ttu-id="d8200-121">使用可能なメモリ、HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムのパフォーマンスに影響を測定するのにには、次のパフォーマンス モニター カウンターを使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-121">Use the following performance monitor counters to measure the impact of available memory on the performance of a guest operating system installed on a Hyper-V virtual machine:</span></span>  

|<span data-ttu-id="d8200-122">手順</span><span class="sxs-lookup"><span data-stu-id="d8200-122">Step</span></span>|<span data-ttu-id="d8200-123">リファレンス</span><span class="sxs-lookup"><span data-stu-id="d8200-123">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="d8200-124">**HYPER-V ホストのオペレーティング システムで使用可能なメモリを測定**–"\Memory\Available 領域のメガバイト数"パフォーマンス モニター カウンターの監視では、HYPER-V ホストのオペレーティング システムで使用できる物理メモリの量を決定できます、物理コンピューター。</span><span class="sxs-lookup"><span data-stu-id="d8200-124">**Measure available memory on the Hyper-V host operating system** – The amount of physical memory available to the Hyper-V host operating system can be determined by monitoring the “\Memory\Available MBytes” performance monitor counter on the physical computer.</span></span> <span data-ttu-id="d8200-125">このカウンターは、ホスト オペレーティング システムで使用できる無料の物理メモリの量を報告します。</span><span class="sxs-lookup"><span data-stu-id="d8200-125">This counter reports the amount of free physical memory available to the host operating system.</span></span> <span data-ttu-id="d8200-126">ホスト オペレーティング システムで使用できる使用可能な物理メモリを評価するときに、次の経験則を使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-126">Use the following rules of thumb when evaluating available physical memory available to the host operating system:</span></span><br /><br /> <ul><li><span data-ttu-id="d8200-127">**\Memory\Available Mbytes** – Available MBytes は、コンピューターにインストールされている物理メモリの割合として、コンピューターで実行されているプロセスに使用できる物理メモリの量を測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-127">**\Memory\Available Mbytes** – Available MBytes measures the amount of physical memory available to processes running on the computer, as a percentage of physical memory installed on the computer.</span></span> <span data-ttu-id="d8200-128">このパフォーマンス モニタ カウンタの値を測定するときに、次のガイドラインが適用されます。</span><span class="sxs-lookup"><span data-stu-id="d8200-128">The following guidelines apply when measuring the value of this performance monitor counter:</span></span><br /><br /> <ul><li><span data-ttu-id="d8200-129">使用可能な空きメモリの 50% 以上 = 正常</span><span class="sxs-lookup"><span data-stu-id="d8200-129">50% of free memory available or more = Healthy</span></span></li><li><span data-ttu-id="d8200-130">使用可能な空きメモリの 25% = 監視</span><span class="sxs-lookup"><span data-stu-id="d8200-130">25% of free memory available = Monitor</span></span></li><li><span data-ttu-id="d8200-131">空きメモリ 10% = 警告</span><span class="sxs-lookup"><span data-stu-id="d8200-131">10% of free memory available = Warning</span></span></li><li><span data-ttu-id="d8200-132">使用可能な空きメモリの 5% 未満 = 重大、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="d8200-132">Less than 5% of free memory available = Critical, performance will be adversely affected</span></span></li></ul></li><li><span data-ttu-id="d8200-133">**\Memory\Pages/sec** – このパフォーマンス モニタ カウンタは、ページの読み取り、ハード ページ フォールトを解決するのにはディスクに書き込まれる位置の速度を測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-133">**\Memory\Pages/sec** – This performance monitor counter measures the rate at which pages are read from or written to disk to resolve hard page faults.</span></span> <span data-ttu-id="d8200-134">ハード ページ フォールトを解決するには、オペレーティング システムはディスクで、パフォーマンスが低下するためのメモリの内容を交換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d8200-134">To resolve hard page faults, the operating system must swap the contents of memory to disk, which negatively impacts performance.</span></span> <span data-ttu-id="d8200-135">使用可能な物理メモリの不足との相関関係の 1 秒あたりのページ数が高には、物理メモリの不足を可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d8200-135">A high number of pages per second in correlation with low available physical memory may indicate a lack of physical memory.</span></span> <span data-ttu-id="d8200-136">このパフォーマンス モニタ カウンタの値を測定するときに、次のガイドラインが適用されます。</span><span class="sxs-lookup"><span data-stu-id="d8200-136">The following guidelines apply when measuring the value of this performance monitor counter:</span></span><br /><br /> <ul><li><span data-ttu-id="d8200-137">500 未満 = 正常</span><span class="sxs-lookup"><span data-stu-id="d8200-137">Less than 500 = Healthy</span></span></li><li><span data-ttu-id="d8200-138">500-1000 = 監視または注意が必要です</span><span class="sxs-lookup"><span data-stu-id="d8200-138">500 - 1000 = Monitor or Caution</span></span></li><li><span data-ttu-id="d8200-139">1,000 を超える = 重大、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="d8200-139">Greater than 1000 = Critical, performance will be adversely affected</span></span></li></ul></li></ul><br /> <span data-ttu-id="d8200-140">**ゲスト オペレーティング システムで使用可能なメモリを測定**– HYPER-V ホストのオペレーティング システムに使用可能なメモリを測定するために使用されている、同じパフォーマンス モニター カウンターでは、ゲスト オペレーティング システムに使用可能なメモリを測定できます。</span><span class="sxs-lookup"><span data-stu-id="d8200-140">**Measure available memory on the guest operating system** – Memory that is available to the guest operating systems can be measured with the same performance monitor counters used to measure memory available to the Hyper-V host operating system.</span></span>|<span data-ttu-id="d8200-141">アプリケーション サーバーのパフォーマンスの使用可能な物理メモリの影響に関する詳細についてで Exchange Server 2003 のヘルプ トピックの「"判決をメモリ負荷の高い問題"を参照してください。 [ http://go.microsoft.com/fwlink/?LinkId=121056](http://go.microsoft.com/fwlink/?LinkId=121056)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-141">For more information about the impact of available physical memory on application server performance, see the Exchange Server 2003 Help topic “Ruling Out Memory-Bound Problems” at [http://go.microsoft.com/fwlink/?LinkId=121056](http://go.microsoft.com/fwlink/?LinkId=121056).</span></span>|  

## <a name="measuring-network-performance"></a><span data-ttu-id="d8200-142">ネットワーク パフォーマンスを測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-142">Measuring Network Performance</span></span>  
 <span data-ttu-id="d8200-143">HYPER-V は、ゲスト コンピューターが同じ物理ネットワーク アダプターを共有できます。</span><span class="sxs-lookup"><span data-stu-id="d8200-143">Hyper-V allows guest computers to share the same physical network adapter.</span></span> <span data-ttu-id="d8200-144">これにより、ハードウェアを統合する、中に、物理アダプターが飽和状態にしない処理します。</span><span class="sxs-lookup"><span data-stu-id="d8200-144">While this helps to consolidate hardware, take care not to saturate the physical adapter.</span></span> <span data-ttu-id="d8200-145">HYPER-V の仮想マシンで使用されるネットワークの正常性を保証するのに、次のメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-145">Use the following methods to ensure the health of the network used by the Hyper-V virtual machines:</span></span>  


|                                 <span data-ttu-id="d8200-146">手順</span><span class="sxs-lookup"><span data-stu-id="d8200-146">Step</span></span>                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <span data-ttu-id="d8200-147">リファレンス</span><span class="sxs-lookup"><span data-stu-id="d8200-147">Reference</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                       <span data-ttu-id="d8200-148">**テスト ネットワークの待機時間**</span><span class="sxs-lookup"><span data-stu-id="d8200-148">**Test network latency**</span></span>                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <span data-ttu-id="d8200-149">適切なネットワーク待機時間を確認するには、各仮想マシンに ping を実行します。</span><span class="sxs-lookup"><span data-stu-id="d8200-149">Ping each virtual machine to ensure adequate network latency.</span></span> <span data-ttu-id="d8200-150">ローカル エリア ネットワークが 1 ミリ秒未満の受信応答時間。</span><span class="sxs-lookup"><span data-stu-id="d8200-150">On local area networks, expect to receive less than 1ms response times.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                       <span data-ttu-id="d8200-151">**パケット損失のテスト**</span><span class="sxs-lookup"><span data-stu-id="d8200-151">**Test for packet loss**</span></span>                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <span data-ttu-id="d8200-152">Pathping.exe ユーティリティを使用すると、仮想マシン間のパケット損失をテストできます。</span><span class="sxs-lookup"><span data-stu-id="d8200-152">Use the pathping.exe utility to test packet loss between virtual machines.</span></span> <span data-ttu-id="d8200-153">Pathping.exe がネットワーク上のパケット損失の測定されのすべてのバージョンで利用[!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)]ため[!INCLUDE[btsWin2kSvr](../includes/btswin2ksvr-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="d8200-153">Pathping.exe measures packet loss on the network and is available with all versions of [!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)] since [!INCLUDE[btsWin2kSvr](../includes/btswin2ksvr-md.md)].</span></span> <span data-ttu-id="d8200-154">Pathping.exe では、大量のネットワークの各ノードに 100 個の ping 要求を送信し、ping の数が返されるを計算します。</span><span class="sxs-lookup"><span data-stu-id="d8200-154">Pathping.exe sends out a burst of 100 ping requests to each network node and calculates how many pings are returned.</span></span> <span data-ttu-id="d8200-155">ローカル エリア ネットワークではありません、pathping.exe ユーティリティからの ping 要求が失われる。</span><span class="sxs-lookup"><span data-stu-id="d8200-155">On local area networks there should be no loss of ping requests from the pathping.exe utility.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                   <span data-ttu-id="d8200-156">**テスト ネットワークのファイル転送**</span><span class="sxs-lookup"><span data-stu-id="d8200-156">**Test network file transfers**</span></span>                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <span data-ttu-id="d8200-157">仮想マシン間で 100 MB のファイルをコピーし、コピーが完了に必要な時間の長さを測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-157">Copy a 100MB file between virtual machines and measure the length of time required to complete the copy.</span></span> <span data-ttu-id="d8200-158">正常である 100 mbit 上 (メガビット) のネットワーク 10 ~ 20 秒で 100 MB (メガバイト) ファイルをコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d8200-158">On a healthy 100Mbit (megabit) network, a 100MB (megabyte) file should copy in 10 to 20 seconds.</span></span> <span data-ttu-id="d8200-159">、正常な 1 gb のネットワーク 100 MB のファイルは 3 ~ 5 秒ほどでコピーする必要があります。</span><span class="sxs-lookup"><span data-stu-id="d8200-159">On a healthy 1Gbit network, a 100MB file should copy in about 3 to 5 seconds.</span></span> <span data-ttu-id="d8200-160">これらのパラメーターの範囲外コピーにかかる時間は、ネットワークの問題を示しています。</span><span class="sxs-lookup"><span data-stu-id="d8200-160">Copy times outside of these parameters are indicative of a network problem.</span></span> <span data-ttu-id="d8200-161">不適切なネットワーク転送の 1 つの一般的な原因は、ネットワーク アダプターがある「自動検出」ときに発生します。 10 MB 半二重のネットワークがネットワーク アダプターが使用できる帯域幅をフルに活用することを防ぎます。</span><span class="sxs-lookup"><span data-stu-id="d8200-161">One common cause of poor network transfers occurs when the network adapter has “auto detected” a 10MB half-duplex network which prevents the network adapter from taking full advantage of available bandwidth.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="d8200-162">**HYPER-V ホストのオペレーティング システムのメジャーのネットワーク使用率**</span><span class="sxs-lookup"><span data-stu-id="d8200-162">**Measure network utilization on the Hyper-V host operating system**</span></span> | <span data-ttu-id="d8200-163">HYPER-V ホストのオペレーティング システム上のネットワーク使用率を測定するのにには、次のパフォーマンス モニター カウンターを使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-163">Use the following performance monitor counters to measure network utilization on the Hyper-V host operating system:</span></span><br /><br /> <span data-ttu-id="d8200-164">**\Network Interface(\*)\Bytes Total/sec** – The percentage of network utilization is calculated by multiplying Bytes Total/sec by 8 to convert it to bits, multiply the result by 100, then divide by the network adapter’s current bandwidth.</span><span class="sxs-lookup"><span data-stu-id="d8200-164">**\Network Interface(\*)\Bytes Total/sec** – The percentage of network utilization is calculated by multiplying Bytes Total/sec by 8 to convert it to bits, multiply the result by 100, then divide by the network adapter’s current bandwidth.</span></span> <span data-ttu-id="d8200-165">ネットワーク帯域幅の使用率を評価するのにには、次のしきい値を使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-165">Use the following thresholds to evaluate network bandwidth utilization:</span></span><br /><br /> <span data-ttu-id="d8200-166">-使用されるインターフェイスの 40% 未満 = 正常</span><span class="sxs-lookup"><span data-stu-id="d8200-166">-   Less than 40% of the interface consumed = Healthy</span></span><br /><span data-ttu-id="d8200-167">-使用されるインターフェイスの 41% ~ 64% = 監視または注意が必要です</span><span class="sxs-lookup"><span data-stu-id="d8200-167">-   41%-64% of the interface consumed = Monitor or Caution</span></span><br /><span data-ttu-id="d8200-168">~ 使用されるインターフェイスの 65 ~ 100% = 重大、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="d8200-168">-   65-100% of the interface consumed = Critical, performance will be adversely affected</span></span><br /><br /> <span data-ttu-id="d8200-169">**\Network Interface(\*)\Output Queue Length** – The output queue length measures the number of threads waiting on the network adapter.</span><span class="sxs-lookup"><span data-stu-id="d8200-169">**\Network Interface(\*)\Output Queue Length** – The output queue length measures the number of threads waiting on the network adapter.</span></span> <span data-ttu-id="d8200-170">ネットワーク アダプターで待機している 2 つ以上のスレッドがある場合は、ネットワークはボトルネックになる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="d8200-170">If there are more than 2 threads waiting on the network adapter, then the network may be a bottleneck.</span></span> <span data-ttu-id="d8200-171">この一般的な原因は、不適切なネットワーク待機時間や、ネットワーク上の高い衝突率です。</span><span class="sxs-lookup"><span data-stu-id="d8200-171">Common causes of this are poor network latency and/or high collision rates on the network.</span></span> <span data-ttu-id="d8200-172">出力キューの長さを評価するのにには、次のしきい値を使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-172">Use the following thresholds to evaluate output queue length:</span></span><br /><br /> <span data-ttu-id="d8200-173">-0 = 正常</span><span class="sxs-lookup"><span data-stu-id="d8200-173">-   0 = Healthy</span></span><br /><span data-ttu-id="d8200-174">-1-2 = 監視または注意が必要です</span><span class="sxs-lookup"><span data-stu-id="d8200-174">-   1-2 = Monitor or Caution</span></span><br /><span data-ttu-id="d8200-175">2 より大きい = 重大、パフォーマンスが悪影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="d8200-175">-   Greater than 2 = Critical, performance will be adversely affected.</span></span><br /><br /> <span data-ttu-id="d8200-176">最大転送単位 (MTU) に同じ値を使用するソリューションのすべてのコンピューター (物理および仮想) のネットワーク アダプターが構成されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="d8200-176">Ensure that the network adapters for all computers (physical and virtual) in the solution are configured to use the same value for maximum transmission unit (MTU).</span></span> <span data-ttu-id="d8200-177">MTU の値を構成する方法の詳細についてを参照してください"付録 a: TCP/IP Configuration Parameters [ http://go.microsoft.com/fwlink/?LinkId=113716](http://go.microsoft.com/fwlink/?LinkId=113716)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-177">For more information about configuring the MTU value, see “Appendix A: TCP/IP Configuration Parameters” at [http://go.microsoft.com/fwlink/?LinkId=113716](http://go.microsoft.com/fwlink/?LinkId=113716).</span></span><br /><br /> <span data-ttu-id="d8200-178">2 以上の出力キューの長さを測定すると、仮想マシンをホストする物理コンピューターに 1 つまたは複数の物理ネットワーク アダプターの追加を検討し、これらの物理ネットワーク アダプターにゲスト オペレーティング システムで使用されるネットワーク アダプターにバインドします。</span><span class="sxs-lookup"><span data-stu-id="d8200-178">If an output queue length of 2 or more is measured, consider adding one or more physical network adapters to the physical computer that hosts the virtual machines and bind the network adapters used by the guest operating systems to these physical network adapters.</span></span> |
|    <span data-ttu-id="d8200-179">**メジャー、ゲスト オペレーティング システムでのネットワーク使用率**</span><span class="sxs-lookup"><span data-stu-id="d8200-179">**Measure network utilization on the guest operating systems**</span></span>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <span data-ttu-id="d8200-180">使用を検討し、HYPER-V のルート パーティション上のネットワーク アダプターが上記のように、パフォーマンス モニター カウンターで示されているビジー状態の場合、"\Hyper-V 仮想ネットワーク アダプター (\*) \Bytes/sec"を特定し、パフォーマンス モニター カウンター仮想ネットワーク アダプターには、ほとんどのネットワーク使用率が消費しています。</span><span class="sxs-lookup"><span data-stu-id="d8200-180">If a network adapter on the Hyper-V root partition is busy as indicated by the performance monitor counters mentioned above, then consider using the "\Hyper-V Virtual Network Adapter(\*)\Bytes/sec" performance monitor counter to identify which virtual network adapters are consuming the most network utilization.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

 <span data-ttu-id="d8200-181">ネットワークのパフォーマンス分析の詳細についてを参照してください「章 15-測定する .NET アプリケーションのパフォーマンス」 [ http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-181">For more information about network performance analysis, see “Chapter 15 - Measuring .NET Application Performance” at [http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073).</span></span>  

## <a name="measuring-processor-performance"></a><span data-ttu-id="d8200-182">プロセッサのパフォーマンスを測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-182">Measuring Processor Performance</span></span>  
 <span data-ttu-id="d8200-183">HYPER-V 仮想マシンにインストールされているゲスト オペレーティング システムでプロセッサのパフォーマンスを評価するのにには、次のメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="d8200-183">Use the following methods to evaluate processor performance on a guest operating system installed on a Hyper-V virtual machine:</span></span>  

- <span data-ttu-id="d8200-184">**ゲスト オペレーティング システムのプロセッサ使用率の測定**を使用してプロセッサのパフォーマンスを測定できます従来、"\Processor(\*)\\% プロセッサ時間"パフォーマンス カウンターの監視。</span><span class="sxs-lookup"><span data-stu-id="d8200-184">**Measure guest operating system processor utilization -** Traditionally, processor performance can be measured using the “\Processor(\*)\\% Processor Time” performance monitor counter.</span></span> <span data-ttu-id="d8200-185">これは、HYPER-V が測定および仮想マシンに割り当てられているプロセッサの数を基準には、この値をレポートするため、ただし、ゲスト オペレーティング システムのプロセッサ使用率を評価するため、正確なカウンターではありません。</span><span class="sxs-lookup"><span data-stu-id="d8200-185">This is not an accurate counter for evaluating processor utilization of a guest operating system though because Hyper-V measures and reports this value relative to the number of processors allocated to the virtual machine.</span></span> <span data-ttu-id="d8200-186">各ゲスト オペレーティング システムで、値が返されますが、実際には、物理コンピューターに存在するよりも仮想マシンの実行より多くのプロセッサが割り当てられている場合、"\Processor (\*)\\% プロセッサ時間"パフォーマンス カウンターの監視実際のプロセッサ使用率は、ボトルネックになっている場合でも、低になります。</span><span class="sxs-lookup"><span data-stu-id="d8200-186">If more processors are allocated to running virtual machines than are actually present on the physical computer, the value returned by each guest operating system for the “\Processor(\*)\\% Processor Time” performance monitor counter will be low, even if in fact processor utilization is a bottleneck.</span></span> <span data-ttu-id="d8200-187">これには、仮想プロセッサ、ラウンド ロビン方式で物理プロセッサを利用するために発生します。</span><span class="sxs-lookup"><span data-stu-id="d8200-187">This occurs because the virtual processors utilize the physical processors in a round-robin fashion.</span></span> <span data-ttu-id="d8200-188">各仮想プロセッサを自体の全体的なシステム リソースの共有を割り当てるため、各仮想プロセッサがシステム リソースの 25% を利用しようと既定では、4 つの物理プロセッサ システムでします。</span><span class="sxs-lookup"><span data-stu-id="d8200-188">Each virtual processor will try and allocate itself a share of overall system resources, so in a 4 physical processor system, each virtual processor will by default try to utilize 25% of the system resources.</span></span> <span data-ttu-id="d8200-189">8 個の仮想プロセッサをまとめてつまりが作成仮想プロセッサは、サーバーの CPU 容量の 200% を利用しようとします。</span><span class="sxs-lookup"><span data-stu-id="d8200-189">If 8 virtual processors are created this means that collectively the virtual processors will attempt to utilize 200% of the server CPU capacity.</span></span> <span data-ttu-id="d8200-190">各仮想プロセッサがで測定された使用率が低いを報告するここで、"\Processor (\*)\\% Processor Time"(想定レベル) の相対パフォーマンス モニター カウンターと、コンテキスト切り替えの間で、仮想プロセッサと、各仮想マシンのパフォーマンスの低下が発生します。</span><span class="sxs-lookup"><span data-stu-id="d8200-190">In this case, each virtual processor will report a low utilization as measured by the “\Processor(\*)\\% Processor Time” performance monitor counter (relative to the level it expects) and the excessive context switching between the virtual processors will result in poor performance for each virtual machine.</span></span> <span data-ttu-id="d8200-191">このシナリオでは、ホスト オペレーティング システム上の HYPER-V 仮想マシンに割り当てられている仮想プロセッサの数を減らすことを検討してください。HYPER-V は、ハイパーバイザー論理と virtual の両方のプロセッサのパフォーマンスを監視するパフォーマンス オブジェクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="d8200-191">In this scenario, consider reducing the number of virtual processors allocated to Hyper-V virtual machines on the host operating system.Hyper-V provides hypervisor performance objects to monitor the performance of both logical and virtual processors.</span></span> <span data-ttu-id="d8200-192">論理プロセッサのプロセッサまたは物理コンピューターにインストールされているコアの数に直接関連しています。</span><span class="sxs-lookup"><span data-stu-id="d8200-192">A logical processor correlates directly to the number of processors or cores that are installed on the physical computer.</span></span> <span data-ttu-id="d8200-193">たとえば、2 つのクアッド コア プロセッサ、物理コンピューターにインストールされているには 8 個の論理プロセッサを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="d8200-193">For example, 2 quad core processors installed on the physical computer would correlate to 8 logical processors.</span></span> <span data-ttu-id="d8200-194">仮想プロセッサがどのような仮想マシンを実際に使用、および仮想プロセッサ ルートと子パーティション内のすべての実行が発生します。</span><span class="sxs-lookup"><span data-stu-id="d8200-194">Virtual processors are what the virtual machines actually use, and all execution in the root and child partitions occurs in virtual processors.</span></span>  

   <span data-ttu-id="d8200-195">HYPER-V は、ハイパーバイザー論理と virtual の両方のプロセッサのパフォーマンスを監視するパフォーマンス オブジェクトを提供します。</span><span class="sxs-lookup"><span data-stu-id="d8200-195">Hyper-V provides hypervisor performance objects to monitor the performance of both logical and virtual processors.</span></span> <span data-ttu-id="d8200-196">論理プロセッサのプロセッサまたは物理コンピューターにインストールされているコアの数に直接関連しています。</span><span class="sxs-lookup"><span data-stu-id="d8200-196">A logical processor correlates directly to the number of processors or cores that are installed on the physical computer.</span></span> <span data-ttu-id="d8200-197">たとえば、2 つのクアッド コア プロセッサ、物理コンピューターにインストールされているには 8 個の論理プロセッサを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="d8200-197">For example, 2 quad core processors installed on the physical computer would correlate to 8 logical processors.</span></span> <span data-ttu-id="d8200-198">仮想プロセッサがどのような仮想マシンを実際に使用、および仮想プロセッサ ルートと子パーティション内のすべての実行が発生します。</span><span class="sxs-lookup"><span data-stu-id="d8200-198">Virtual processors are what the virtual machines actually use, and all execution in the root and child partitions occurs in virtual processors.</span></span>  

   <span data-ttu-id="d8200-199">ゲスト オペレーティング システムのプロセッサ使用率を正確に測定するを使用して、"HYPER-V ハイパーバイザー論理 processor (_total) % の合計実行時間"、HYPER-V ホストのオペレーティング システムでパフォーマンス モニター カウンター。</span><span class="sxs-lookup"><span data-stu-id="d8200-199">To accurately measure the processor utilization of a guest operating system, use the “Hyper-V Hypervisor Logical Processor(_Total)% Total Run Time” performance monitor counter on the Hyper-V host operating system.</span></span> <span data-ttu-id="d8200-200">ゲスト オペレーティング システムのプロセッサ使用率を使用して評価を次のしきい値を使用して、"HYPER-V ハイパーバイザー論理 processor (_total) % の合計実行時間"パフォーマンス カウンターの監視。</span><span class="sxs-lookup"><span data-stu-id="d8200-200">Use the following thresholds to evaluate guest operating system processor utilization using the “Hyper-V Hypervisor Logical Processor(_Total)% Total Run Time” performance monitor counter:</span></span>  

  - <span data-ttu-id="d8200-201">消費された 60% 未満 = 正常</span><span class="sxs-lookup"><span data-stu-id="d8200-201">Less than 60% consumed = Healthy</span></span>  

  - <span data-ttu-id="d8200-202">60-89% 消費 = 監視または注意が必要です</span><span class="sxs-lookup"><span data-stu-id="d8200-202">60% - 89% consumed = Monitor or Caution</span></span>  

  - <span data-ttu-id="d8200-203">90% ~ 100% 消費 = 重大、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="d8200-203">90% - 100% consumed = Critical, performance will be adversely affected</span></span>  

    <span data-ttu-id="d8200-204">HYPER-V 環境でのゲスト オペレーティング システムのプロセッサのパフォーマンスをトラブルシューティングすることをお勧めのホスト オペレーティング システムにより報告された値のバランスについてよう努めること"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行Time"(します) と"\Hyper-V ハイパーバイザー仮想 processor (_total)\\% の合計実行時間"(VPTR)。</span><span class="sxs-lookup"><span data-stu-id="d8200-204">To troubleshoot processor performance of guest operating systems on a Hyper-V environment, it is best to strive for a balance between the values reported by the host operating system for “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” (LPTR) and “\Hyper-V Hypervisor Virtual Processor(_Total)\\% Total Run Time” (VPTR).</span></span> <span data-ttu-id="d8200-205">しますが高く、VPTR が低い場合、物理コンピューターで物理的に利用できる仮想マシンに割り当てるより多くのプロセッサがないことを確認します。</span><span class="sxs-lookup"><span data-stu-id="d8200-205">If LPTR is high and VPTR is low then verify that there are not more processors allocated to virtual machines than are physically available on the physical computer.</span></span> <span data-ttu-id="d8200-206">使用して、"\Hyper-V ハイパーバイザー仮想 Processor(\*)\\ゲストの実行時間の割合"仮想プロセッサを決定するためのカウンターが CPU を消費しているし、仮想プロセッサの一対一のマッピングを構成する適切な仮想マシンからの割り当てを解除仮想プロセッサの論理プロセッサ。</span><span class="sxs-lookup"><span data-stu-id="d8200-206">Use the “\Hyper-V Hypervisor Virtual Processor(\*)\\%Guest Run Time” counters to determine which virtual Processors are consuming CPU and de-allocate virtual processors from virtual machines as appropriate to configure a one to one mapping of virtual processors to logical processors.</span></span> <span data-ttu-id="d8200-207">仮想プロセッサと論理プロセッサの一対一のマッピングを構成する方法の詳細については、「プロセッサのパフォーマンスの最適化」セクションを参照してください。[チェックリスト: hyper-v のパフォーマンスの最適化](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-207">For more information about configuring a one to one mapping of virtual processors to logical processors, see the “Optimizing Processor Performance” section in [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span> <span data-ttu-id="d8200-208">VPTR が高いとしますが低い場合と使用可能な論理プロセッサがある場合、追加のプロセッサがゲスト オペレーティング システムでサポートされている場合、仮想マシンに追加のプロセッサを割り当てるし検討してください。</span><span class="sxs-lookup"><span data-stu-id="d8200-208">If VPTR is high and LPTR is low then consider allocating additional processors to virtual machines if there are available logical processors and if additional processors are supported by the guest operating system.</span></span> <span data-ttu-id="d8200-209">物理コンピューターへの追加の仮想マシンの追加によるスケール アウトを検討してください VPTR が高い場合は、しますが、低、割り当てるには、使用可能な論理プロセッサがあるが、ゲスト オペレーティング システムでは、プロセッサの追加はサポートされていない、し、これらの仮想マシンに使用可能なプロセッサに割り当てています。</span><span class="sxs-lookup"><span data-stu-id="d8200-209">In the case where VPTR is high, LPTR is low, there are available logical processors to allocate, but additional processors are not supported by the guest operating system, consider scaling out by adding additional virtual machines to the physical computer and allocating available processors to these virtual machines.</span></span> <span data-ttu-id="d8200-210">VPTR としますが高い場合は、構成は、物理コンピューターの制限をプッシュしている、別の物理コンピューターとその他の HYPER-V 仮想マシンを環境に追加することでスケール アウトを検討してください。</span><span class="sxs-lookup"><span data-stu-id="d8200-210">In the case where both VPTR and LPTR are high, the configuration is pushing the limits of the physical computer and should consider scaling out by adding another physical computer and additional Hyper-V virtual machines to the environment.</span></span> <span data-ttu-id="d8200-211">次のフローチャートでは、HYPER-V 環境でのプロセッサ パフォーマンスのトラブルシューティング時に使用するプロセスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="d8200-211">The flowchart below describes the process that should be used when troubleshooting processor performance in a Hyper-V environment.</span></span>  

    <span data-ttu-id="d8200-212">VPTR が高しますが低い場合と使用可能な論理プロセッサがある場合、追加のプロセッサがゲスト オペレーティング システムでサポートされている場合、仮想マシンに追加のプロセッサを割り当てるし検討してください。</span><span class="sxs-lookup"><span data-stu-id="d8200-212">If VPTR is high and LPTR is low, then consider allocating additional processors to virtual machines if there are available logical processors and if additional processors are supported by the guest operating system.</span></span> <span data-ttu-id="d8200-213">物理コンピューターへの追加の仮想マシンの追加によるスケール アウトを検討してください VPTR が高い場合は、しますが、低、割り当てるには、使用可能な論理プロセッサがあるが、ゲスト オペレーティング システムでは、プロセッサの追加はサポートされていない、し、これらの仮想マシンに使用可能なプロセッサに割り当てています。</span><span class="sxs-lookup"><span data-stu-id="d8200-213">In the case where VPTR is high, LPTR is low, there are available logical processors to allocate, but additional processors are not supported by the guest operating system, consider scaling out by adding additional virtual machines to the physical computer and allocating available processors to these virtual machines.</span></span> <span data-ttu-id="d8200-214">VPTR としますが高い場合は、構成は、物理コンピューターの制限をプッシュしている、別の物理コンピューターとその他の HYPER-V 仮想マシンを環境に追加することでスケール アウトを検討してください。</span><span class="sxs-lookup"><span data-stu-id="d8200-214">In the case where both VPTR and LPTR are high, the configuration is pushing the limits of the physical computer and should consider scaling out by adding another physical computer and additional Hyper-V virtual machines to the environment.</span></span> <span data-ttu-id="d8200-215">次のフローチャートでは、HYPER-V 環境でのプロセッサ パフォーマンスのトラブルシューティング時に使用するプロセスについて説明します。</span><span class="sxs-lookup"><span data-stu-id="d8200-215">The flowchart below describes the process that should be used when troubleshooting processor performance in a Hyper-V environment.</span></span>  

    <span data-ttu-id="d8200-216">![ハイパースレッディングでの CPU パフォーマンスのトラブルシューティング&#45;V](../technical-guides/media/623fdcd6-e80b-4ba9-bf46-5d9b92b6612b.gif "623fdcd6-e80b-4ba9-bf46-5d9b92b6612b")</span><span class="sxs-lookup"><span data-stu-id="d8200-216">![Troubleshooting CPU Performance on Hyper&#45;V](../technical-guides/media/623fdcd6-e80b-4ba9-bf46-5d9b92b6612b.gif "623fdcd6-e80b-4ba9-bf46-5d9b92b6612b")</span></span>  
    <span data-ttu-id="d8200-217">HYPER-V 環境での CPU パフォーマンスのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="d8200-217">Troubleshooting CPU performance in a Hyper-V Environment</span></span>  

  > [!NOTE]  
  >  <span data-ttu-id="d8200-218">**ゲスト オペレーティング システムのプロセッサには、物理プロセッサまたはコアをセットのアフィニティはありません。** – ハイパーバイザーは、どの物理リソースを決定します。 使用されます。</span><span class="sxs-lookup"><span data-stu-id="d8200-218">**Guest operating system processors do not have a set affinity to physical processors/cores** – The hypervisor determines how physical resources are used.</span></span> <span data-ttu-id="d8200-219">プロセッサ使用率の場合は、ハイパーバイザーは、物理プロセッサのスレッドのフォームにゲストのプロセッサ時間をスケジュールします。</span><span class="sxs-lookup"><span data-stu-id="d8200-219">In the case of processor utilization, the hypervisor schedules the guest processor time to physical processor in the form of threads.</span></span> <span data-ttu-id="d8200-220">つまり、物理コンピューターのプロセッサ間で仮想マシンのプロセッサの負荷が分散されます。</span><span class="sxs-lookup"><span data-stu-id="d8200-220">This means the processor load of virtual machines will be spread across the processors of the physical computer.</span></span> <span data-ttu-id="d8200-221">さらに、仮想マシンが構成されている例では 2 つの論理プロセッサを持つ 8 プロセッサまたはコアを持つ物理コンピューター上で実行する単一の仮想マシンが構成されている場合、論理プロセッサ数のプロセッサ使用率を超えることはできません、仮想マシンには、構成されている論理プロセッサ (ここで 2 つのプロセッサ) の数のプロセッサの能力を超えることはできません。</span><span class="sxs-lookup"><span data-stu-id="d8200-221">Furthermore, virtual machines cannot exceed the processor utilization of the configured number of logical processors, for example if a single virtual machine is configured to run with 2 logical processors on a physical computer with 8 processors/cores, then the virtual machine cannot exceed the processor capacity of the number of configured logical processors (in this case 2 processors).</span></span>  

- <span data-ttu-id="d8200-222">**HYPER-V のパフォーマンスを使用して、HYPER-V 環境の全体的なのプロセッサ使用率を測定するカウンターの監視**のプロセッサ使用率を測定するために、ホスト オペレーティング システムを論理的にもう 1 つのゲスト オペレーティング システムとして表示.</span><span class="sxs-lookup"><span data-stu-id="d8200-222">**Measure overall processor utilization of the Hyper-V environment using Hyper-V performance monitor counters -** For purposes of measuring processor utilization, the host operating system is logically viewed as just another guest operating system.</span></span> <span data-ttu-id="d8200-223">そのため、"\Processor(\*)\\% Processor Time"カウンターの監視は、のみ、ホスト オペレーティング システムのプロセッサ使用率を測定します。</span><span class="sxs-lookup"><span data-stu-id="d8200-223">Therefore, the “\Processor(\*)\\% Processor Time” monitor counter measures the processor utilization of the host operating system only.</span></span> <span data-ttu-id="d8200-224">ホスト オペレーティング システムとすべてのゲスト オペレーティング システムの物理プロセッサの合計使用率を測定するを使用して、"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行時間"パフォーマンス モニター カウンター。</span><span class="sxs-lookup"><span data-stu-id="d8200-224">To measure total physical processor utilization of the host operating system and all guest operating systems, use the “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” performance monitor counter.</span></span> <span data-ttu-id="d8200-225">このカウンターは、両方のホスト オペレーティング システムを実行しているプロセッサで費やされた時間の合計の割合を測定し、すべてのゲスト オペレーティング システム。</span><span class="sxs-lookup"><span data-stu-id="d8200-225">This counter measures the total percentage of time spent by the processor running the both the host operating system and all guest operating systems.</span></span>  

   <span data-ttu-id="d8200-226">次のしきい値を使用して、使用する HYPER-V 環境の全体的なのプロセッサ使用率を評価する、"\Hyper-V ハイパーバイザー論理 processor (_total)\\% の合計実行時間"パフォーマンス カウンターの監視。</span><span class="sxs-lookup"><span data-stu-id="d8200-226">Use the following thresholds to evaluate overall processor utilization of the Hyper-V environment using the “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” performance monitor counter:</span></span>  

  - <span data-ttu-id="d8200-227">消費された 60% 未満 = 正常</span><span class="sxs-lookup"><span data-stu-id="d8200-227">Less than 60% consumed = Healthy</span></span>  

  - <span data-ttu-id="d8200-228">60-89% 消費 = 監視または注意が必要です</span><span class="sxs-lookup"><span data-stu-id="d8200-228">60% - 89% consumed = Monitor or Caution</span></span>  

  - <span data-ttu-id="d8200-229">90% ~ 100% 消費 = 重大、パフォーマンスが悪影響を受ける</span><span class="sxs-lookup"><span data-stu-id="d8200-229">90% - 100% consumed = Critical, performance will be adversely affected</span></span>  

    <span data-ttu-id="d8200-230">プロセッサ使用率の詳細については、次のリソースを確認します。</span><span class="sxs-lookup"><span data-stu-id="d8200-230">For more information about processor utilization review the following resources:</span></span>  

  - <span data-ttu-id="d8200-231">"する方法: 関数の実稼働環境でサーバー アプリケーションの高いユーザー モード CPU ボトルネックの原因を識別する"で[ http://go.microsoft.com/fwlink/?LinkID=107047](http://go.microsoft.com/fwlink/?LinkID=107047)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-231">“How To: Identify Functions causing a High User-mode CPU Bottleneck for Server Applications in a Production Environment” at [http://go.microsoft.com/fwlink/?LinkID=107047](http://go.microsoft.com/fwlink/?LinkID=107047).</span></span>  

  - <span data-ttu-id="d8200-232">「章 15 - .NET アプリケーション パフォーマンスを測定」 [ http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073)します。</span><span class="sxs-lookup"><span data-stu-id="d8200-232">“Chapter 15 - Measuring .NET Application Performance” at [http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073).</span></span>
