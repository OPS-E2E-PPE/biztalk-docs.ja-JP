---
title: スクリプト Functoid |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Scripting functoids, about Scripting functoids
- Scripting functoids
- Scripting functoids, configuring
ms.assetid: ea8353da-049b-4e0c-a700-f51708db22a3
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5b26223884bce626404586115da36ff7989ac13b
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36982355"
---
# <a name="scripting-functoid"></a><span data-ttu-id="92690-102">スクリプト Functoid</span><span class="sxs-lookup"><span data-stu-id="92690-102">Scripting Functoid</span></span>
<span data-ttu-id="92690-103">**Scripting** functoid では、実行時に使用できない機能を実行するカスタム スクリプトまたはコードを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="92690-103">The **Scripting** functoid enables you to use custom script or code at run time to perform functions otherwise not available.</span></span> <span data-ttu-id="92690-104">たとえばを使用して実行時に .NET アセンブリを呼び出すことができます、 **Scripting** functoid および独自のカスタム関数の記述。</span><span class="sxs-lookup"><span data-stu-id="92690-104">For example, you can call a .NET assembly at run time by using the **Scripting** functoid and writing your own custom functions.</span></span>  
  
 <span data-ttu-id="92690-105">**Scripting** functoid は、次の言語をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="92690-105">The **Scripting** functoid supports the following languages:</span></span>  
  
- <span data-ttu-id="92690-106">C# .NET</span><span class="sxs-lookup"><span data-stu-id="92690-106">C# .NET</span></span>  
  
- <span data-ttu-id="92690-107">JScript .NET</span><span class="sxs-lookup"><span data-stu-id="92690-107">JScript .NET</span></span>  
  
- <span data-ttu-id="92690-108">Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="92690-108">Visual Basic .NET</span></span>  
  
- <span data-ttu-id="92690-109">XSLT (Extensible Stylesheet Language Transformations)</span><span class="sxs-lookup"><span data-stu-id="92690-109">Extensible Stylesheet Language Transformations (XSLT)</span></span>  
  
- <span data-ttu-id="92690-110">XSLT 呼び出しテンプレート</span><span class="sxs-lookup"><span data-stu-id="92690-110">XSLT Call Templates</span></span>  
  
  <span data-ttu-id="92690-111">もう 1 つの重要な違い現在**Scripting** functoid と以前のバージョンは、スクリプトが必要されなく作成、functoid 自体に格納されています。</span><span class="sxs-lookup"><span data-stu-id="92690-111">Another significant difference between the current **Scripting** functoid and earlier versions is that the script need no longer be created and stored in the functoid itself.</span></span> <span data-ttu-id="92690-112">別の .NET アセンブリにスクリプトを作成し、使用してアセンブリを参照する代わりに、**スクリプト**プロパティ。</span><span class="sxs-lookup"><span data-stu-id="92690-112">Instead, you can create the script in a separate .NET assembly and reference the assembly through the **Script** property.</span></span> <span data-ttu-id="92690-113">個別のアセンブリにスクリプトを格納すると、1 つ以上のマップで同じスクリプトを使用できます。</span><span class="sxs-lookup"><span data-stu-id="92690-113">Having the script in a separate assembly enables you to use the same script in more than one map.</span></span> <span data-ttu-id="92690-114">またを購入することがあります**Scripting**サード パーティ ベンダーから functoid アセンブリ。</span><span class="sxs-lookup"><span data-stu-id="92690-114">Additionally, you may be able to purchase **Scripting** functoid assemblies from third-party vendors.</span></span>  
  
  <span data-ttu-id="92690-115">使用することができます**Scripting** functoid を BizTalk マッパーの現在のバージョンの BizTalk マッパーの以前のバージョンで作成します。</span><span class="sxs-lookup"><span data-stu-id="92690-115">You can use **Scripting** functoids created in previous versions of BizTalk Mapper with the current version of BizTalk Mapper.</span></span> <span data-ttu-id="92690-116">ただし、最初に Functoid を移行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="92690-116">However, you must migrate the functoids first.</span></span> <span data-ttu-id="92690-117">移行する方法の詳細についての**Scripting** functoid を参照してください[Functoid の移行](../core/migrating-functoids.md)します。</span><span class="sxs-lookup"><span data-stu-id="92690-117">For more information about how to migrate **Scripting** functoids, see [Migrating Functoids](../core/migrating-functoids.md).</span></span>  
  
  <span data-ttu-id="92690-118">追加すると、 **Scripting**マップに functoid、functoid を使用してスクリプトを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="92690-118">When you add a **Scripting** functoid to a map, you need to configure the script the functoid uses.</span></span> <span data-ttu-id="92690-119">選択した場合、 **Scripting** functoid、**スクリプト**でプロパティが有効になっている、**プロパティ**ウィンドウ。</span><span class="sxs-lookup"><span data-stu-id="92690-119">If you select a **Scripting** functoid, the **Script** property is enabled in the **Properties** window.</span></span> <span data-ttu-id="92690-120">省略記号をクリックした場合 (**.**)、このプロパティのボタン、**スクリプト Functoid の構成** ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="92690-120">If you click the ellipsis (**...**) button for this property, the **Configure Scripting Functoid** dialog box opens.</span></span> <span data-ttu-id="92690-121">または、ダブルクリック、 **Scripting** functoid。</span><span class="sxs-lookup"><span data-stu-id="92690-121">Alternatively, you can double-click the **Scripting** functoid.</span></span>  
  
  <span data-ttu-id="92690-122">次の表は、このダイアログ ボックスのフィールドを示しています。</span><span class="sxs-lookup"><span data-stu-id="92690-122">The following table shows the fields of this dialog box.</span></span>  
  
|<span data-ttu-id="92690-123">[スクリプト Functoid の構成] ダイアログ ボックスのフィールド</span><span class="sxs-lookup"><span data-stu-id="92690-123">Configure Scripting Functoid dialog box field</span></span>|<span data-ttu-id="92690-124">説明</span><span class="sxs-lookup"><span data-stu-id="92690-124">Description</span></span>|  
|---------------------------------------------------|-----------------|  
|<span data-ttu-id="92690-125">**スクリプトの種類を選択します。**</span><span class="sxs-lookup"><span data-stu-id="92690-125">**Select script type**</span></span>|<span data-ttu-id="92690-126">このフィールドを使用して、これで使用するスクリプトの種類を選択する**Scripting** functoid。</span><span class="sxs-lookup"><span data-stu-id="92690-126">Use this field to select the type of script you want to use in this **Scripting** functoid.</span></span><br /><br /> <span data-ttu-id="92690-127">値:</span><span class="sxs-lookup"><span data-stu-id="92690-127">Values:</span></span><br /><br /> <span data-ttu-id="92690-128">-   **外部アセンブリ**します。</span><span class="sxs-lookup"><span data-stu-id="92690-128">-   **External Assembly**.</span></span> <span data-ttu-id="92690-129">関連付ける場合、この値を使用して、 **Scripting** functoid のアセンブリをグローバル アセンブリ キャッシュ (GAC) にします。</span><span class="sxs-lookup"><span data-stu-id="92690-129">Use this value if you want to associate the **Scripting** functoid with an assembly in the global assembly cache (GAC).</span></span> <span data-ttu-id="92690-130">**警告:** 外部アセンブリ内のコードはスレッド セーフである必要があります。</span><span class="sxs-lookup"><span data-stu-id="92690-130">**Warning:**      The code in the external assembly must be thread-safe.</span></span> <span data-ttu-id="92690-131">ストレス条件下では、マップの複数のインスタンスが同時に実行される場合があります。</span><span class="sxs-lookup"><span data-stu-id="92690-131">Under stress conditions, multiple instances of a map may be running concurrently.</span></span><br /><span data-ttu-id="92690-132">-   **インライン c#** します。</span><span class="sxs-lookup"><span data-stu-id="92690-132">-   **Inline C#**.</span></span>  <span data-ttu-id="92690-133">関連付ける場合、この値を使用して、 **Scripting** functoid の c# コードで、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="92690-133">Use this value if you want to associate the **Scripting** functoid with C# code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="92690-134">-   **インライン JScript .NET**します。</span><span class="sxs-lookup"><span data-stu-id="92690-134">-   **Inline JScript .NET**.</span></span> <span data-ttu-id="92690-135">関連付ける場合、この値を使用して、 **Scripting** JScript .NET スクリプトに functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="92690-135">Use this value if you want to associate the **Scripting** functoid with JScript .NET script in the **Inline script** buffer.</span></span><br /><span data-ttu-id="92690-136">-   **インライン Visual Basic .NET**します。</span><span class="sxs-lookup"><span data-stu-id="92690-136">-   **Inline Visual Basic .NET**.</span></span> <span data-ttu-id="92690-137">関連付ける場合、この値を使用して、 **Scripting** Visual Basic .NET コードに functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="92690-137">Use this value if you want to associate the **Scripting** functoid with Visual Basic .NET code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="92690-138">-   **インライン XSLT**します。</span><span class="sxs-lookup"><span data-stu-id="92690-138">-   **Inline XSLT**.</span></span> <span data-ttu-id="92690-139">関連付ける場合、この値を使用して、 **Scripting** xslt に functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="92690-139">Use this value if you want to associate the **Scripting** functoid with XSLT in the **Inline script** buffer.</span></span><br /><span data-ttu-id="92690-140">-   **インライン XSLT 呼び出しテンプレート**します。</span><span class="sxs-lookup"><span data-stu-id="92690-140">-   **Inline XSLT Call Template**.</span></span> <span data-ttu-id="92690-141">関連付ける場合、この値を使用して、 **Scripting** XSLT 呼び出しテンプレート functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="92690-141">Use this value if you want to associate the **Scripting** functoid with XSLT call templates in the **Inline script** buffer.</span></span>|  
|<span data-ttu-id="92690-142">**スクリプト アセンブリ**</span><span class="sxs-lookup"><span data-stu-id="92690-142">**Script assembly**</span></span>|<span data-ttu-id="92690-143">関連付けるアセンブリを選択して、 **Scripting** functoid。</span><span class="sxs-lookup"><span data-stu-id="92690-143">Select the assembly to associate with the **Scripting** functoid.</span></span> <span data-ttu-id="92690-144">プロジェクト ウィンドウで参照されるアセンブリのみ、この一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="92690-144">Only assemblies referenced in the Project window appear in this list.</span></span> <span data-ttu-id="92690-145">また、GAC にアセンブリを登録する必要があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="92690-145">Note also that you must register assemblies in the GAC.</span></span><br /><br /> <span data-ttu-id="92690-146">ときにこのフィールドは使用可能なだけ**スクリプトの種類を選択します。** に設定されている**外部アセンブリ**します。</span><span class="sxs-lookup"><span data-stu-id="92690-146">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="92690-147">**スクリプト クラス**</span><span class="sxs-lookup"><span data-stu-id="92690-147">**Script class**</span></span>|<span data-ttu-id="92690-148">このように選択したアセンブリ内のクラスを選択します。 **Scripting** functoid で使用します。</span><span class="sxs-lookup"><span data-stu-id="92690-148">Select the class within the chosen assembly that you want this **Scripting** functoid to use.</span></span><br /><br /> <span data-ttu-id="92690-149">ときにこのフィールドは使用可能なだけ**スクリプトの種類を選択します。** に設定されている**外部アセンブリ**します。</span><span class="sxs-lookup"><span data-stu-id="92690-149">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="92690-150">**スクリプト メソッド**</span><span class="sxs-lookup"><span data-stu-id="92690-150">**Script method**</span></span>|<span data-ttu-id="92690-151">このように選択したクラス内のメソッドを選択します。 **Scripting** functoid で使用します。</span><span class="sxs-lookup"><span data-stu-id="92690-151">Select the method within the chosen class that you want this **Scripting** functoid to use.</span></span> <span data-ttu-id="92690-152">**注:** メソッドで想定されている入力パラメーターの数がで指定された入力パラメーターの数と一致するかどうかを確認、**スクリプト Functoid の構成** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="92690-152">**Note:**  Make sure the number of input parameters expected by the method matches the number of input parameters specified in the **Configure Scripting Functoid** dialog box.</span></span>|  
|<span data-ttu-id="92690-153">**インライン スクリプト**</span><span class="sxs-lookup"><span data-stu-id="92690-153">**Inline script**</span></span>|<span data-ttu-id="92690-154">使用するインライン スクリプトをこのテキスト ボックスに書き込みまたはコピーします。</span><span class="sxs-lookup"><span data-stu-id="92690-154">Write or copy the inline script to be used into this text box.</span></span> <span data-ttu-id="92690-155">有効な言語およびスクリプトが含まれます。 c#、JScript .NET、Visual Basic .NET、XSLT、および XSLT 呼び出しテンプレート。</span><span class="sxs-lookup"><span data-stu-id="92690-155">Valid languages and scripts include: C#, JScript .NET, Visual Basic .NET, XSLT, and XSLT call templates.</span></span><br /><br /> <span data-ttu-id="92690-156">ときにこのフィールドは使用可能なだけ**スクリプトの種類を選択します。** のいずれかに設定されている、**インライン**設定します。</span><span class="sxs-lookup"><span data-stu-id="92690-156">This field is only available when **Select script type** is set to one of the **Inline** settings.</span></span> <span data-ttu-id="92690-157">**注意:** 同じメソッド シグネチャを複数回使用を避けてください。</span><span class="sxs-lookup"><span data-stu-id="92690-157">**Caution:**  Avoid using the same method signature more than once.</span></span> <span data-ttu-id="92690-158">複数のスクリプト Functoid が同じメソッド シグネチャを持つ場合、BizTalk は、最初の実装を選択し、他の実装を無視します。</span><span class="sxs-lookup"><span data-stu-id="92690-158">When several Scripting functoids have the same method signature, BizTalk selects the first implementation and disregards the others.</span></span>|  
  
 <span data-ttu-id="92690-159">次に示しますが、どのように**Scripting** c# .Net スクリプトを使用して、電話番号を再フォーマットするマップに functoid が表示されます。</span><span class="sxs-lookup"><span data-stu-id="92690-159">The following figure shows how the **Scripting** functoid appears in a map using the C# .Net script to reformat a telephone number.</span></span>  
  
 <span data-ttu-id="92690-160">![C を使用してマップ&#35;電話番号の書式を設定します。] (../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span><span class="sxs-lookup"><span data-stu-id="92690-160">![Map using the C&#35; to format a telephone number.](../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span></span>  
<span data-ttu-id="92690-161">スクリプト Functoid のマップ</span><span class="sxs-lookup"><span data-stu-id="92690-161">Scripting Functoid Map</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="92690-162">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="92690-162">In This Section</span></span>  
  
-   [<span data-ttu-id="92690-163">外部アセンブリを使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="92690-163">Scripting Using External Assemblies</span></span>](../core/scripting-using-external-assemblies.md)  
  
-   [<span data-ttu-id="92690-164">インライン C#、JScript .NET、および Visual Basic .NET を使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="92690-164">Scripting Using Inline C#, JScript .NET, and Visual Basic .NET</span></span>](../core/scripting-using-inline-csharp-jscript-net-and-visual-basic-net.md)  
  
-   [<span data-ttu-id="92690-165">インライン XSLT および XSLT 呼び出しテンプレートを使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="92690-165">Scripting Using Inline XSLT and XSLT Call Templates</span></span>](../core/scripting-using-inline-xslt-and-xslt-call-templates.md)