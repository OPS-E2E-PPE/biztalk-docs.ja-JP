---
title: スクリプト Functoid |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Scripting functoids, about Scripting functoids
- Scripting functoids
- Scripting functoids, configuring
ms.assetid: ea8353da-049b-4e0c-a700-f51708db22a3
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 72f85d7b542b8ffd6eaf4b7ab6236f11aba8a34f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65395513"
---
# <a name="scripting-functoid"></a><span data-ttu-id="adb6f-102">スクリプト Functoid</span><span class="sxs-lookup"><span data-stu-id="adb6f-102">Scripting Functoid</span></span>
<span data-ttu-id="adb6f-103">**Scripting** functoid では、実行時に使用できない機能を実行するカスタム スクリプトまたはコードを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="adb6f-103">The **Scripting** functoid enables you to use custom script or code at run time to perform functions otherwise not available.</span></span> <span data-ttu-id="adb6f-104">たとえばを使用して実行時に .NET アセンブリを呼び出すことができます、 **Scripting** functoid および独自のカスタム関数の記述。</span><span class="sxs-lookup"><span data-stu-id="adb6f-104">For example, you can call a .NET assembly at run time by using the **Scripting** functoid and writing your own custom functions.</span></span>  
  
 <span data-ttu-id="adb6f-105">**Scripting** functoid は、次の言語をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="adb6f-105">The **Scripting** functoid supports the following languages:</span></span>  
  
- <span data-ttu-id="adb6f-106">C# .NET</span><span class="sxs-lookup"><span data-stu-id="adb6f-106">C# .NET</span></span>  
  
- <span data-ttu-id="adb6f-107">JScript .NET</span><span class="sxs-lookup"><span data-stu-id="adb6f-107">JScript .NET</span></span>  
  
- <span data-ttu-id="adb6f-108">Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="adb6f-108">Visual Basic .NET</span></span>  
  
- <span data-ttu-id="adb6f-109">Extensible Stylesheet Language Transformations (XSLT)</span><span class="sxs-lookup"><span data-stu-id="adb6f-109">Extensible Stylesheet Language Transformations (XSLT)</span></span>  
  
- <span data-ttu-id="adb6f-110">XSLT 呼び出しテンプレート</span><span class="sxs-lookup"><span data-stu-id="adb6f-110">XSLT Call Templates</span></span>  
  
  <span data-ttu-id="adb6f-111">もう 1 つの重要な違い現在**Scripting** functoid と以前のバージョンは、スクリプトが必要されなく作成、functoid 自体に格納されています。</span><span class="sxs-lookup"><span data-stu-id="adb6f-111">Another significant difference between the current **Scripting** functoid and earlier versions is that the script need no longer be created and stored in the functoid itself.</span></span> <span data-ttu-id="adb6f-112">別の .NET アセンブリにスクリプトを作成し、使用してアセンブリを参照する代わりに、**スクリプト**プロパティ。</span><span class="sxs-lookup"><span data-stu-id="adb6f-112">Instead, you can create the script in a separate .NET assembly and reference the assembly through the **Script** property.</span></span> <span data-ttu-id="adb6f-113">別のアセンブリにあるスクリプトには、1 つ以上のマップで同じスクリプトを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="adb6f-113">Having the script in a separate assembly enables you to use the same script in more than one map.</span></span> <span data-ttu-id="adb6f-114">またを購入することがあります**Scripting**サード パーティ ベンダーから functoid アセンブリ。</span><span class="sxs-lookup"><span data-stu-id="adb6f-114">Additionally, you may be able to purchase **Scripting** functoid assemblies from third-party vendors.</span></span>  
  
  <span data-ttu-id="adb6f-115">使用することができます**Scripting** functoid を BizTalk マッパーの現在のバージョンの BizTalk マッパーの以前のバージョンで作成します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-115">You can use **Scripting** functoids created in previous versions of BizTalk Mapper with the current version of BizTalk Mapper.</span></span> <span data-ttu-id="adb6f-116">ただし、最初に、functoid を移行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="adb6f-116">However, you must migrate the functoids first.</span></span> <span data-ttu-id="adb6f-117">移行する方法の詳細についての**Scripting** functoid を参照してください[Functoid の移行](../core/migrating-functoids.md)します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-117">For more information about how to migrate **Scripting** functoids, see [Migrating Functoids](../core/migrating-functoids.md).</span></span>  
  
  <span data-ttu-id="adb6f-118">追加すると、 **Scripting**マップに functoid、functoid を使用してスクリプトを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="adb6f-118">When you add a **Scripting** functoid to a map, you need to configure the script the functoid uses.</span></span> <span data-ttu-id="adb6f-119">選択した場合、 **Scripting** functoid、**スクリプト**でプロパティが有効になっている、**プロパティ**ウィンドウ。</span><span class="sxs-lookup"><span data-stu-id="adb6f-119">If you select a **Scripting** functoid, the **Script** property is enabled in the **Properties** window.</span></span> <span data-ttu-id="adb6f-120">省略記号をクリックした場合 (**.**)、このプロパティのボタン、**スクリプト Functoid の構成** ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="adb6f-120">If you click the ellipsis (**...**) button for this property, the **Configure Scripting Functoid** dialog box opens.</span></span> <span data-ttu-id="adb6f-121">または、ダブルクリック、 **Scripting** functoid。</span><span class="sxs-lookup"><span data-stu-id="adb6f-121">Alternatively, you can double-click the **Scripting** functoid.</span></span>  
  
  <span data-ttu-id="adb6f-122">次の表では、このダイアログ ボックスのフィールドを示します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-122">The following table shows the fields of this dialog box.</span></span>  
  
|<span data-ttu-id="adb6f-123">スクリプト Functoid のダイアログ ボックスのフィールドを構成します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-123">Configure Scripting Functoid dialog box field</span></span>|<span data-ttu-id="adb6f-124">説明</span><span class="sxs-lookup"><span data-stu-id="adb6f-124">Description</span></span>|  
|---------------------------------------------------|-----------------|  
|<span data-ttu-id="adb6f-125">**スクリプトの種類を選択します。**</span><span class="sxs-lookup"><span data-stu-id="adb6f-125">**Select script type**</span></span>|<span data-ttu-id="adb6f-126">このフィールドを使用して、これで使用するスクリプトの種類を選択する**Scripting** functoid。</span><span class="sxs-lookup"><span data-stu-id="adb6f-126">Use this field to select the type of script you want to use in this **Scripting** functoid.</span></span><br /><br /> <span data-ttu-id="adb6f-127">値:</span><span class="sxs-lookup"><span data-stu-id="adb6f-127">Values:</span></span><br /><br /> <span data-ttu-id="adb6f-128">-   **外部アセンブリ**します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-128">-   **External Assembly**.</span></span> <span data-ttu-id="adb6f-129">関連付ける場合、この値を使用して、 **Scripting** functoid のアセンブリをグローバル アセンブリ キャッシュ (GAC) にします。</span><span class="sxs-lookup"><span data-stu-id="adb6f-129">Use this value if you want to associate the **Scripting** functoid with an assembly in the global assembly cache (GAC).</span></span> <span data-ttu-id="adb6f-130">**警告:**     外部アセンブリ内のコードは、スレッド セーフである必要があります。</span><span class="sxs-lookup"><span data-stu-id="adb6f-130">**Warning:**      The code in the external assembly must be thread-safe.</span></span> <span data-ttu-id="adb6f-131">ストレス条件下で、マップの複数のインスタンスを同時に実行される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="adb6f-131">Under stress conditions, multiple instances of a map may be running concurrently.</span></span><br /><span data-ttu-id="adb6f-132">-   **インライン c#** します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-132">-   **Inline C#**.</span></span>  <span data-ttu-id="adb6f-133">関連付ける場合、この値を使用して、 **Scripting** functoid の c# コードで、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="adb6f-133">Use this value if you want to associate the **Scripting** functoid with C# code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="adb6f-134">-   **インライン JScript .NET**します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-134">-   **Inline JScript .NET**.</span></span> <span data-ttu-id="adb6f-135">関連付ける場合、この値を使用して、 **Scripting** JScript .NET スクリプトに functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="adb6f-135">Use this value if you want to associate the **Scripting** functoid with JScript .NET script in the **Inline script** buffer.</span></span><br /><span data-ttu-id="adb6f-136">-   **インライン Visual Basic .NET**します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-136">-   **Inline Visual Basic .NET**.</span></span> <span data-ttu-id="adb6f-137">関連付ける場合、この値を使用して、 **Scripting** Visual Basic .NET コードに functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="adb6f-137">Use this value if you want to associate the **Scripting** functoid with Visual Basic .NET code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="adb6f-138">-   **インライン XSLT**します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-138">-   **Inline XSLT**.</span></span> <span data-ttu-id="adb6f-139">関連付ける場合、この値を使用して、 **Scripting** xslt に functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="adb6f-139">Use this value if you want to associate the **Scripting** functoid with XSLT in the **Inline script** buffer.</span></span><br /><span data-ttu-id="adb6f-140">-   **インライン XSLT 呼び出しテンプレート**します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-140">-   **Inline XSLT Call Template**.</span></span> <span data-ttu-id="adb6f-141">関連付ける場合、この値を使用して、 **Scripting** XSLT 呼び出しテンプレート functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="adb6f-141">Use this value if you want to associate the **Scripting** functoid with XSLT call templates in the **Inline script** buffer.</span></span>|  
|<span data-ttu-id="adb6f-142">**スクリプト アセンブリ**</span><span class="sxs-lookup"><span data-stu-id="adb6f-142">**Script assembly**</span></span>|<span data-ttu-id="adb6f-143">関連付けるアセンブリを選択して、 **Scripting** functoid。</span><span class="sxs-lookup"><span data-stu-id="adb6f-143">Select the assembly to associate with the **Scripting** functoid.</span></span> <span data-ttu-id="adb6f-144">この一覧で、プロジェクトのウィンドウで参照されるアセンブリのみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="adb6f-144">Only assemblies referenced in the Project window appear in this list.</span></span> <span data-ttu-id="adb6f-145">また、GAC にアセンブリを登録する必要がありますに注意してください。</span><span class="sxs-lookup"><span data-stu-id="adb6f-145">Note also that you must register assemblies in the GAC.</span></span><br /><br /> <span data-ttu-id="adb6f-146">ときにこのフィールドは使用可能なだけ**スクリプトの種類を選択します。** に設定されている**外部アセンブリ**します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-146">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="adb6f-147">**スクリプト クラス**</span><span class="sxs-lookup"><span data-stu-id="adb6f-147">**Script class**</span></span>|<span data-ttu-id="adb6f-148">このように選択したアセンブリ内のクラスを選択します。 **Scripting** functoid で使用します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-148">Select the class within the chosen assembly that you want this **Scripting** functoid to use.</span></span><br /><br /> <span data-ttu-id="adb6f-149">ときにこのフィールドは使用可能なだけ**スクリプトの種類を選択します。** に設定されている**外部アセンブリ**します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-149">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="adb6f-150">**スクリプト メソッド**</span><span class="sxs-lookup"><span data-stu-id="adb6f-150">**Script method**</span></span>|<span data-ttu-id="adb6f-151">このように選択したクラス内のメソッドを選択します。 **Scripting** functoid で使用します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-151">Select the method within the chosen class that you want this **Scripting** functoid to use.</span></span> <span data-ttu-id="adb6f-152">**注:** メソッドで想定されている入力パラメーターの数がで指定された入力パラメーターの数と一致するかどうかを確認、**スクリプト Functoid の構成** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="adb6f-152">**Note:**  Make sure the number of input parameters expected by the method matches the number of input parameters specified in the **Configure Scripting Functoid** dialog box.</span></span>|  
|<span data-ttu-id="adb6f-153">**インライン スクリプト**</span><span class="sxs-lookup"><span data-stu-id="adb6f-153">**Inline script**</span></span>|<span data-ttu-id="adb6f-154">書き込みまたは、このテキスト ボックスに使用するインライン スクリプトをコピーします。</span><span class="sxs-lookup"><span data-stu-id="adb6f-154">Write or copy the inline script to be used into this text box.</span></span> <span data-ttu-id="adb6f-155">有効な言語およびスクリプトは、次のとおりです。C#、JScript .NET、Visual Basic .NET、XSLT、および XSLT 呼び出しテンプレート。</span><span class="sxs-lookup"><span data-stu-id="adb6f-155">Valid languages and scripts include: C#, JScript .NET, Visual Basic .NET, XSLT, and XSLT call templates.</span></span><br /><br /> <span data-ttu-id="adb6f-156">ときにこのフィールドは使用可能なだけ**スクリプトの種類を選択します。** のいずれかに設定されている、**インライン**設定します。</span><span class="sxs-lookup"><span data-stu-id="adb6f-156">This field is only available when **Select script type** is set to one of the **Inline** settings.</span></span> <span data-ttu-id="adb6f-157">**注意が必要です。** 同じメソッド シグネチャを複数回使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="adb6f-157">**Caution:**  Avoid using the same method signature more than once.</span></span> <span data-ttu-id="adb6f-158">複数のスクリプト functoid には、同じメソッド シグネチャがある、BizTalk は最初の実装を選択し、他は無視されます。</span><span class="sxs-lookup"><span data-stu-id="adb6f-158">When several Scripting functoids have the same method signature, BizTalk selects the first implementation and disregards the others.</span></span>|  
  
 <span data-ttu-id="adb6f-159">次に示しますが、どのように**Scripting** c# .Net スクリプトを使用して、電話番号を再フォーマットするマップに functoid が表示されます。</span><span class="sxs-lookup"><span data-stu-id="adb6f-159">The following figure shows how the **Scripting** functoid appears in a map using the C# .Net script to reformat a telephone number.</span></span>  
  
 <span data-ttu-id="adb6f-160">![C を使用してマップ&#35;電話番号の書式を設定します。](../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span><span class="sxs-lookup"><span data-stu-id="adb6f-160">![Map using the C&#35; to format a telephone number.](../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span></span>  
<span data-ttu-id="adb6f-161">スクリプト Functoid のマップ</span><span class="sxs-lookup"><span data-stu-id="adb6f-161">Scripting Functoid Map</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="adb6f-162">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="adb6f-162">In This Section</span></span>  
  
-   [<span data-ttu-id="adb6f-163">外部アセンブリを使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="adb6f-163">Scripting Using External Assemblies</span></span>](../core/scripting-using-external-assemblies.md)  
  
-   [<span data-ttu-id="adb6f-164">インライン C#、JScript .NET、および Visual Basic .NET を使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="adb6f-164">Scripting Using Inline C#, JScript .NET, and Visual Basic .NET</span></span>](../core/scripting-using-inline-csharp-jscript-net-and-visual-basic-net.md)  
  
-   [<span data-ttu-id="adb6f-165">インライン XSLT および XSLT 呼び出しテンプレートを使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="adb6f-165">Scripting Using Inline XSLT and XSLT Call Templates</span></span>](../core/scripting-using-inline-xslt-and-xslt-call-templates.md)