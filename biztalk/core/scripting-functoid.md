---
title: スクリプト Functoid |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Scripting functoids, about Scripting functoids
- Scripting functoids
- Scripting functoids, configuring
ms.assetid: ea8353da-049b-4e0c-a700-f51708db22a3
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 822bdbc4482a7e16a7458c7c44d128967203f283
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22273338"
---
# <a name="scripting-functoid"></a><span data-ttu-id="ea030-102">スクリプト Functoid</span><span class="sxs-lookup"><span data-stu-id="ea030-102">Scripting Functoid</span></span>
<span data-ttu-id="ea030-103">**スクリプト**functoid では、実行時に使用できない機能を実行するカスタム スクリプトまたはコードを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="ea030-103">The **Scripting** functoid enables you to use custom script or code at run time to perform functions otherwise not available.</span></span> <span data-ttu-id="ea030-104">たとえばを使用して実行時に .NET アセンブリを呼び出すことができます、**スクリプト**functoid と書き込み、独自の関数。</span><span class="sxs-lookup"><span data-stu-id="ea030-104">For example, you can call a .NET assembly at run time by using the **Scripting** functoid and writing your own custom functions.</span></span>  
  
 <span data-ttu-id="ea030-105">**スクリプト**functoid は、次の言語をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="ea030-105">The **Scripting** functoid supports the following languages:</span></span>  
  
-   <span data-ttu-id="ea030-106">C# .NET</span><span class="sxs-lookup"><span data-stu-id="ea030-106">C# .NET</span></span>  
  
-   <span data-ttu-id="ea030-107">JScript .NET</span><span class="sxs-lookup"><span data-stu-id="ea030-107">JScript .NET</span></span>  
  
-   <span data-ttu-id="ea030-108">Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="ea030-108">Visual Basic .NET</span></span>  
  
-   <span data-ttu-id="ea030-109">XSLT (Extensible Stylesheet Language Transformations)</span><span class="sxs-lookup"><span data-stu-id="ea030-109">Extensible Stylesheet Language Transformations (XSLT)</span></span>  
  
-   <span data-ttu-id="ea030-110">XSLT 呼び出しテンプレート</span><span class="sxs-lookup"><span data-stu-id="ea030-110">XSLT Call Templates</span></span>  
  
 <span data-ttu-id="ea030-111">もう 1 つの大きな違い現在**スクリプト**functoid と以前のバージョンは、スクリプト必要がある不要になった作成された、functoid 自体に格納されています。</span><span class="sxs-lookup"><span data-stu-id="ea030-111">Another significant difference between the current **Scripting** functoid and earlier versions is that the script need no longer be created and stored in the functoid itself.</span></span> <span data-ttu-id="ea030-112">代わりに、別の .NET アセンブリにスクリプトを作成して、によるアセンブリの参照、**スクリプト**プロパティです。</span><span class="sxs-lookup"><span data-stu-id="ea030-112">Instead, you can create the script in a separate .NET assembly and reference the assembly through the **Script** property.</span></span> <span data-ttu-id="ea030-113">個別のアセンブリにスクリプトを格納すると、1 つ以上のマップで同じスクリプトを使用できます。</span><span class="sxs-lookup"><span data-stu-id="ea030-113">Having the script in a separate assembly enables you to use the same script in more than one map.</span></span> <span data-ttu-id="ea030-114">さらに、できる場合がありますを購入する**スクリプト**サード パーティ ベンダーから functoid アセンブリ。</span><span class="sxs-lookup"><span data-stu-id="ea030-114">Additionally, you may be able to purchase **Scripting** functoid assemblies from third-party vendors.</span></span>  
  
 <span data-ttu-id="ea030-115">使用することができます**スクリプト**functoid の BizTalk マッパーの現在のバージョンと以前のバージョンの BizTalk マッパーで作成します。</span><span class="sxs-lookup"><span data-stu-id="ea030-115">You can use **Scripting** functoids created in previous versions of BizTalk Mapper with the current version of BizTalk Mapper.</span></span> <span data-ttu-id="ea030-116">ただし、最初に Functoid を移行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ea030-116">However, you must migrate the functoids first.</span></span> <span data-ttu-id="ea030-117">移行する方法の詳細についての**スクリプト**functoid を参照してください[Functoid の移行](../core/migrating-functoids.md)です。</span><span class="sxs-lookup"><span data-stu-id="ea030-117">For more information about how to migrate **Scripting** functoids, see [Migrating Functoids](../core/migrating-functoids.md).</span></span>  
  
 <span data-ttu-id="ea030-118">追加すると、**スクリプト**マップに functoid、functoid を使用してスクリプトを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="ea030-118">When you add a **Scripting** functoid to a map, you need to configure the script the functoid uses.</span></span> <span data-ttu-id="ea030-119">選択した場合、**スクリプト**functoid、**スクリプト**でプロパティが有効になっている、**プロパティ**ウィンドウです。</span><span class="sxs-lookup"><span data-stu-id="ea030-119">If you select a **Scripting** functoid, the **Script** property is enabled in the **Properties** window.</span></span> <span data-ttu-id="ea030-120">省略記号ボタンをクリックした場合 (**.**) のこのプロパティは、ボタン、**スクリプト Functoid の構成** ダイアログ ボックスが表示されます。</span><span class="sxs-lookup"><span data-stu-id="ea030-120">If you click the ellipsis (**...**) button for this property, the **Configure Scripting Functoid** dialog box opens.</span></span> <span data-ttu-id="ea030-121">または、ダブルクリック、**スクリプト**functoid です。</span><span class="sxs-lookup"><span data-stu-id="ea030-121">Alternatively, you can double-click the **Scripting** functoid.</span></span>  
  
 <span data-ttu-id="ea030-122">次の表は、このダイアログ ボックスのフィールドを示しています。</span><span class="sxs-lookup"><span data-stu-id="ea030-122">The following table shows the fields of this dialog box.</span></span>  
  
|<span data-ttu-id="ea030-123">[スクリプト Functoid の構成] ダイアログ ボックスのフィールド</span><span class="sxs-lookup"><span data-stu-id="ea030-123">Configure Scripting Functoid dialog box field</span></span>|<span data-ttu-id="ea030-124">Description</span><span class="sxs-lookup"><span data-stu-id="ea030-124">Description</span></span>|  
|---------------------------------------------------|-----------------|  
|<span data-ttu-id="ea030-125">**スクリプトの種類を選択します。**</span><span class="sxs-lookup"><span data-stu-id="ea030-125">**Select script type**</span></span>|<span data-ttu-id="ea030-126">このフィールドで使用するスクリプトの種類の選択を使用して**スクリプト**functoid です。</span><span class="sxs-lookup"><span data-stu-id="ea030-126">Use this field to select the type of script you want to use in this **Scripting** functoid.</span></span><br /><br /> <span data-ttu-id="ea030-127">値:</span><span class="sxs-lookup"><span data-stu-id="ea030-127">Values:</span></span><br /><br /> <span data-ttu-id="ea030-128">-   **外部アセンブリ**です。</span><span class="sxs-lookup"><span data-stu-id="ea030-128">-   **External Assembly**.</span></span> <span data-ttu-id="ea030-129">関連付ける場合は、この値を使用して、**スクリプト**functoid のアセンブリ、グローバル アセンブリ キャッシュ (GAC) にします。</span><span class="sxs-lookup"><span data-stu-id="ea030-129">Use this value if you want to associate the **Scripting** functoid with an assembly in the global assembly cache (GAC).</span></span> <span data-ttu-id="ea030-130">**警告:** 外部アセンブリ内のコードはスレッド セーフである必要があります。</span><span class="sxs-lookup"><span data-stu-id="ea030-130">**Warning:**      The code in the external assembly must be thread-safe.</span></span> <span data-ttu-id="ea030-131">ストレス条件下では、マップの複数のインスタンスが同時に実行される場合があります。</span><span class="sxs-lookup"><span data-stu-id="ea030-131">Under stress conditions, multiple instances of a map may be running concurrently.</span></span><br /><span data-ttu-id="ea030-132">-   **インライン c#** です。</span><span class="sxs-lookup"><span data-stu-id="ea030-132">-   **Inline C#**.</span></span>  <span data-ttu-id="ea030-133">関連付ける場合は、この値を使用して、**スクリプト**functoid で c# コード、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="ea030-133">Use this value if you want to associate the **Scripting** functoid with C# code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="ea030-134">-   **インライン JScript .NET**です。</span><span class="sxs-lookup"><span data-stu-id="ea030-134">-   **Inline JScript .NET**.</span></span> <span data-ttu-id="ea030-135">関連付ける場合は、この値を使用して、**スクリプト**JScript .NET スクリプトに functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="ea030-135">Use this value if you want to associate the **Scripting** functoid with JScript .NET script in the **Inline script** buffer.</span></span><br /><span data-ttu-id="ea030-136">-   **インライン Visual Basic .NET**です。</span><span class="sxs-lookup"><span data-stu-id="ea030-136">-   **Inline Visual Basic .NET**.</span></span> <span data-ttu-id="ea030-137">関連付ける場合は、この値を使用して、**スクリプト**Visual Basic .NET コードに functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="ea030-137">Use this value if you want to associate the **Scripting** functoid with Visual Basic .NET code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="ea030-138">-   **インライン XSLT**です。</span><span class="sxs-lookup"><span data-stu-id="ea030-138">-   **Inline XSLT**.</span></span> <span data-ttu-id="ea030-139">関連付ける場合は、この値を使用して、**スクリプト**xslt に functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="ea030-139">Use this value if you want to associate the **Scripting** functoid with XSLT in the **Inline script** buffer.</span></span><br /><span data-ttu-id="ea030-140">-   **インライン XSLT 呼び出しテンプレート**です。</span><span class="sxs-lookup"><span data-stu-id="ea030-140">-   **Inline XSLT Call Template**.</span></span> <span data-ttu-id="ea030-141">関連付ける場合は、この値を使用して、**スクリプト**XSLT 呼び出しテンプレート functoid、**インライン スクリプト**バッファー。</span><span class="sxs-lookup"><span data-stu-id="ea030-141">Use this value if you want to associate the **Scripting** functoid with XSLT call templates in the **Inline script** buffer.</span></span>|  
|<span data-ttu-id="ea030-142">**スクリプト アセンブリ**</span><span class="sxs-lookup"><span data-stu-id="ea030-142">**Script assembly**</span></span>|<span data-ttu-id="ea030-143">関連付けるアセンブリを選択して、**スクリプト**functoid です。</span><span class="sxs-lookup"><span data-stu-id="ea030-143">Select the assembly to associate with the **Scripting** functoid.</span></span> <span data-ttu-id="ea030-144">プロジェクト ウィンドウで参照されるアセンブリのみ、この一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="ea030-144">Only assemblies referenced in the Project window appear in this list.</span></span> <span data-ttu-id="ea030-145">また、GAC にアセンブリを登録する必要があることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="ea030-145">Note also that you must register assemblies in the GAC.</span></span><br /><br /> <span data-ttu-id="ea030-146">このフィールドは、のみ使用可能な場合に**スクリプトの種類を選択して**に設定されている**外部アセンブリ**です。</span><span class="sxs-lookup"><span data-stu-id="ea030-146">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="ea030-147">**スクリプト クラス**</span><span class="sxs-lookup"><span data-stu-id="ea030-147">**Script class**</span></span>|<span data-ttu-id="ea030-148">このように選択したアセンブリ内のクラスを選択して**スクリプト**functoid で使用します。</span><span class="sxs-lookup"><span data-stu-id="ea030-148">Select the class within the chosen assembly that you want this **Scripting** functoid to use.</span></span><br /><br /> <span data-ttu-id="ea030-149">このフィールドは、のみ使用可能な場合に**スクリプトの種類を選択して**に設定されている**外部アセンブリ**です。</span><span class="sxs-lookup"><span data-stu-id="ea030-149">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="ea030-150">**スクリプト メソッド**</span><span class="sxs-lookup"><span data-stu-id="ea030-150">**Script method**</span></span>|<span data-ttu-id="ea030-151">このように選択したクラス内のメソッドを選択して**スクリプト**functoid で使用します。</span><span class="sxs-lookup"><span data-stu-id="ea030-151">Select the method within the chosen class that you want this **Scripting** functoid to use.</span></span> <span data-ttu-id="ea030-152">**注:** メソッドで想定されている入力パラメーターの数で指定された入力パラメーターの数が一致を確認してください、**スクリプト Functoid の構成** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="ea030-152">**Note:**  Make sure the number of input parameters expected by the method matches the number of input parameters specified in the **Configure Scripting Functoid** dialog box.</span></span>|  
|<span data-ttu-id="ea030-153">**インライン スクリプト**</span><span class="sxs-lookup"><span data-stu-id="ea030-153">**Inline script**</span></span>|<span data-ttu-id="ea030-154">使用するインライン スクリプトをこのテキスト ボックスに書き込みまたはコピーします。</span><span class="sxs-lookup"><span data-stu-id="ea030-154">Write or copy the inline script to be used into this text box.</span></span> <span data-ttu-id="ea030-155">有効な言語およびスクリプトが含まれます。 c#、JScript .NET、Visual Basic .NET、XSLT、および XSLT 呼び出しテンプレート。</span><span class="sxs-lookup"><span data-stu-id="ea030-155">Valid languages and scripts include: C#, JScript .NET, Visual Basic .NET, XSLT, and XSLT call templates.</span></span><br /><br /> <span data-ttu-id="ea030-156">このフィールドは、のみ使用可能な場合に**スクリプトの種類を選択して**のいずれかに設定されている、**インライン**設定します。</span><span class="sxs-lookup"><span data-stu-id="ea030-156">This field is only available when **Select script type** is set to one of the **Inline** settings.</span></span> <span data-ttu-id="ea030-157">**注意:** 同じメソッド シグネチャを複数回使用を避けてください。</span><span class="sxs-lookup"><span data-stu-id="ea030-157">**Caution:**  Avoid using the same method signature more than once.</span></span> <span data-ttu-id="ea030-158">複数のスクリプト Functoid が同じメソッド シグネチャを持つ場合、BizTalk は、最初の実装を選択し、他の実装を無視します。</span><span class="sxs-lookup"><span data-stu-id="ea030-158">When several Scripting functoids have the same method signature, BizTalk selects the first implementation and disregards the others.</span></span>|  
  
 <span data-ttu-id="ea030-159">次に示しますが、どのように**スクリプト**c# .Net スクリプトを使用して、電話番号を再フォーマットするマップに functoid が表示されます。</span><span class="sxs-lookup"><span data-stu-id="ea030-159">The following figure shows how the **Scripting** functoid appears in a map using the C# .Net script to reformat a telephone number.</span></span>  
  
 <span data-ttu-id="ea030-160">![C &#35; を使用するマップ電話番号の書式を設定します。] (../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span><span class="sxs-lookup"><span data-stu-id="ea030-160">![Map using the C&#35; to format a telephone number.](../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span></span>  
<span data-ttu-id="ea030-161">スクリプト Functoid のマップ</span><span class="sxs-lookup"><span data-stu-id="ea030-161">Scripting Functoid Map</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="ea030-162">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="ea030-162">In This Section</span></span>  
  
-   [<span data-ttu-id="ea030-163">外部アセンブリを使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="ea030-163">Scripting Using External Assemblies</span></span>](../core/scripting-using-external-assemblies.md)  
  
-   [<span data-ttu-id="ea030-164">インライン c#、JScript .NET、および Visual Basic .NET を使用するスクリプト</span><span class="sxs-lookup"><span data-stu-id="ea030-164">Scripting Using Inline C#, JScript .NET, and Visual Basic .NET</span></span>](../core/scripting-using-inline-csharp-jscript-net-and-visual-basic-net.md)  
  
-   [<span data-ttu-id="ea030-165">スクリプトを使用してインライン XSLT および XSLT 呼び出しテンプレート</span><span class="sxs-lookup"><span data-stu-id="ea030-165">Scripting Using Inline XSLT and XSLT Call Templates</span></span>](../core/scripting-using-inline-xslt-and-xslt-call-templates.md)