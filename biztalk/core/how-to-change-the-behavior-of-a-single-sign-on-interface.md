---
title: シングル サインオン インターフェイスの動作を変更する方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f4a4946a-e345-4c7e-835d-a3f7f72ebaca
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 729b5faee2e6adff6e43a987b1defcb90450eb13
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65387068"
---
# <a name="how-to-change-the-behavior-of-a-single-sign-on-interface"></a><span data-ttu-id="df36c-102">シングル サインオン インターフェイスの動作を変更する方法</span><span class="sxs-lookup"><span data-stu-id="df36c-102">How to Change the Behavior of a Single Sign-On Interface</span></span>
<span data-ttu-id="df36c-103">エンタープライズ シングル サインオン (SSO) オブジェクト モデル内のオブジェクトの多くは、IPropertyBag インターフェイスは、指定したオブジェクトの動作を変更することができますを公開します。</span><span class="sxs-lookup"><span data-stu-id="df36c-103">Many of the objects in the Enterprise Single Sign-On (SSO) object model expose the IPropertyBag interface, which allows you to modify the behavior of the specified object.</span></span> <span data-ttu-id="df36c-104">SSO オブジェクトの QueryInterface を呼び出す場合は、IPropertyBag インターフェイスを取得しを使用して、現在のオブジェクトの動作を変更します。</span><span class="sxs-lookup"><span data-stu-id="df36c-104">If you call QueryInterface on an SSO object, you can retrieve the IPropertyBag interface and use it to change the behavior of your current object.</span></span>  

### <a name="to-change-the-behavior-for-a-specified-sso-interface"></a><span data-ttu-id="df36c-105">指定した SSO インターフェイスの動作を変更するには</span><span class="sxs-lookup"><span data-stu-id="df36c-105">To change the behavior for a specified SSO interface</span></span>  

1.  <span data-ttu-id="df36c-106">指定したインターフェイスの QueryInterface を使用して、IPropertyBag インスタンスを取得します。</span><span class="sxs-lookup"><span data-stu-id="df36c-106">Use QueryInterface on the specified interface to retrieve an IPropertyBag instance.</span></span>  

2.  <span data-ttu-id="df36c-107">IPropertyBag.Write を使用すると、プロパティ、型、およびインターフェイスの値を設定できます。</span><span class="sxs-lookup"><span data-stu-id="df36c-107">Use IPropertyBag.Write to set the property, type, and value for the interface.</span></span>  

     <span data-ttu-id="df36c-108">次の表では、IPropertyBag の propname パラメーターと ptrVar パラメーターの有効な値について説明します。</span><span class="sxs-lookup"><span data-stu-id="df36c-108">The following table describes the valid values for the IPropertyBag propName and ptrVar parameters.</span></span>  

|<span data-ttu-id="df36c-109">propname パラメーター</span><span class="sxs-lookup"><span data-stu-id="df36c-109">propName</span></span>|<span data-ttu-id="df36c-110">型</span><span class="sxs-lookup"><span data-stu-id="df36c-110">Type</span></span>|<span data-ttu-id="df36c-111">ptrValue</span><span class="sxs-lookup"><span data-stu-id="df36c-111">ptrValue</span></span>|<span data-ttu-id="df36c-112">使用できます。</span><span class="sxs-lookup"><span data-stu-id="df36c-112">Usable On</span></span>|  
|--------------|----------|--------------|---------------|  
|<span data-ttu-id="df36c-113">CurrentSSOServer</span><span class="sxs-lookup"><span data-stu-id="df36c-113">CurrentSSOServer</span></span>|<span data-ttu-id="df36c-114">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="df36c-114">VT_BSTR</span></span>|<span data-ttu-id="df36c-115">情報を送信するサーバーの名前</span><span class="sxs-lookup"><span data-stu-id="df36c-115">Name of the server to send the information to</span></span>|<span data-ttu-id="df36c-116">All</span><span class="sxs-lookup"><span data-stu-id="df36c-116">All</span></span>|  
|<span data-ttu-id="df36c-117">トランザクション</span><span class="sxs-lookup"><span data-stu-id="df36c-117">Transaction</span></span>|<span data-ttu-id="df36c-118">VT_UNKNOWN</span><span class="sxs-lookup"><span data-stu-id="df36c-118">VT_UNKNOWN</span></span><br /><br /> <span data-ttu-id="df36c-119">VT_EMPTY</span><span class="sxs-lookup"><span data-stu-id="df36c-119">VT_EMPTY</span></span>|<span data-ttu-id="df36c-120">DTC ITransaction ポインター、またはスコープをクリアする NULL。</span><span class="sxs-lookup"><span data-stu-id="df36c-120">A DTC ITransaction pointer, or NULL to clear the scope.</span></span>|<span data-ttu-id="df36c-121">ISSOConfigStore::SetConfigInfo</span><span class="sxs-lookup"><span data-stu-id="df36c-121">ISSOConfigStore::SetConfigInfo</span></span><br /><span data-ttu-id="df36c-122">ISSOConfigStore::GetConfigInfo</span><span class="sxs-lookup"><span data-stu-id="df36c-122">ISSOConfigStore::GetConfigInfo</span></span> <br /><span data-ttu-id="df36c-123">ISSOConfigStore::DeleteConfigInfo</span><span class="sxs-lookup"><span data-stu-id="df36c-123">ISSOConfigStore::DeleteConfigInfo</span></span><br /><br /> <span data-ttu-id="df36c-124">ISSOAdmin::CreateApplication</span><span class="sxs-lookup"><span data-stu-id="df36c-124">ISSOAdmin::CreateApplication</span></span><br /><span data-ttu-id="df36c-125">ISSOAdmin::DeleteApplication</span><span class="sxs-lookup"><span data-stu-id="df36c-125">ISSOAdmin::DeleteApplication</span></span> <br /><span data-ttu-id="df36c-126">ISSOAdmin::UpdateApplication</span><span class="sxs-lookup"><span data-stu-id="df36c-126">ISSOAdmin::UpdateApplication</span></span><br /><span data-ttu-id="df36c-127">ISSOAdmin::CreateFieldInfo</span><span class="sxs-lookup"><span data-stu-id="df36c-127">ISSOAdmin::CreateFieldInfo</span></span><br /><br /> <span data-ttu-id="df36c-128">ISSOMapper::GetFieldInfo</span><span class="sxs-lookup"><span data-stu-id="df36c-128">ISSOMapper::GetFieldInfo</span></span>|  
|<span data-ttu-id="df36c-129">AppFilterFlags</span><span class="sxs-lookup"><span data-stu-id="df36c-129">AppFilterFlags</span></span>|<span data-ttu-id="df36c-130">VT_I4</span><span class="sxs-lookup"><span data-stu-id="df36c-130">VT_I4</span></span><br /><br /> <span data-ttu-id="df36c-131">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="df36c-131">VT_UI4</span></span>|<span data-ttu-id="df36c-132">どのようなアプリケーションをフィルター処理を制御するフラグを設定します。</span><span class="sxs-lookup"><span data-stu-id="df36c-132">Flags to control what application to filter.</span></span>|<span data-ttu-id="df36c-133">ISSOMapper::GetApplications</span><span class="sxs-lookup"><span data-stu-id="df36c-133">ISSOMapper::GetApplications</span></span><br /><br /> <span data-ttu-id="df36c-134">ISSOMapper2::GetApplications2</span><span class="sxs-lookup"><span data-stu-id="df36c-134">ISSOMapper2::GetApplications2</span></span>|  
|<span data-ttu-id="df36c-135">可</span><span class="sxs-lookup"><span data-stu-id="df36c-135">AppFilterFlagsMask</span></span>|<span data-ttu-id="df36c-136">VT_I4</span><span class="sxs-lookup"><span data-stu-id="df36c-136">VT_I4</span></span><br /><br /> <span data-ttu-id="df36c-137">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="df36c-137">VT_UI4</span></span>|<span data-ttu-id="df36c-138">どのようなアプリケーションをフィルター処理を制御するフラグ マスク。</span><span class="sxs-lookup"><span data-stu-id="df36c-138">Flag mask to control what application to filter.</span></span>|<span data-ttu-id="df36c-139">ISSOMapper::GetApplications</span><span class="sxs-lookup"><span data-stu-id="df36c-139">ISSOMapper::GetApplications</span></span><br /><br /> <span data-ttu-id="df36c-140">ISSOMapper2::GetApplications2</span><span class="sxs-lookup"><span data-stu-id="df36c-140">ISSOMapper2::GetApplications2</span></span>|  
|<span data-ttu-id="df36c-141">AsyncCall</span><span class="sxs-lookup"><span data-stu-id="df36c-141">AsyncCall</span></span>|<span data-ttu-id="df36c-142">VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="df36c-142">VT_BOOL</span></span>|<span data-ttu-id="df36c-143">非同期 RPC; を使用して呼び出す場合は true同期 RPC を使用する場合は false。</span><span class="sxs-lookup"><span data-stu-id="df36c-143">True to call using an async RPC; false to use a synchronous RPC.</span></span>|<span data-ttu-id="df36c-144">ISSOConfigOM::GetServerStatus</span><span class="sxs-lookup"><span data-stu-id="df36c-144">ISSOConfigOM::GetServerStatus</span></span><br /><br /> <span data-ttu-id="df36c-145">ISSOAdmin::GetGlobalInfo</span><span class="sxs-lookup"><span data-stu-id="df36c-145">ISSOAdmin::GetGlobalInfo</span></span>|  

- <span data-ttu-id="df36c-146">**CurrentSSOServer**: SSO 情報を送信する先のサーバーは、次のように決定するには、標準の動作。</span><span class="sxs-lookup"><span data-stu-id="df36c-146">**CurrentSSOServer**: the standard behavior for determining which server to send SSO information to is as follows:</span></span>  

  1. <span data-ttu-id="df36c-147">現在のユーザーのレジストリを検索します。</span><span class="sxs-lookup"><span data-stu-id="df36c-147">Look in the registry for the current user.</span></span> <span data-ttu-id="df36c-148">サーバー名は、コマンド ライン ツールまたは GUI を使用して現在のユーザーに対して設定できます。</span><span class="sxs-lookup"><span data-stu-id="df36c-148">The server name can be set for the current user using the command line tools or GUI.</span></span>  

  2. <span data-ttu-id="df36c-149">すべてのユーザーのレジストリを検索します。</span><span class="sxs-lookup"><span data-stu-id="df36c-149">Look in the registry for all users.</span></span> <span data-ttu-id="df36c-150">サーバー名は、コマンド ライン ツールまたは GUI を使用してすべてのユーザーに対して設定できます。</span><span class="sxs-lookup"><span data-stu-id="df36c-150">The server name can be set for all users using the command line tools or GUI.</span></span>  

  3. <span data-ttu-id="df36c-151">SSO サーバー名がレジストリに存在しない場合は、現在のコンピューターを使用します。</span><span class="sxs-lookup"><span data-stu-id="df36c-151">If no SSO server name is found in the registry then use the current computer.</span></span>  

     <span data-ttu-id="df36c-152">指定したサーバーへの CurrentSSOServer の設定には、指定されたインターフェイスの前のプロセスよりも優先されます。</span><span class="sxs-lookup"><span data-stu-id="df36c-152">Setting CurrentSSOServer to a specified server overrides the previous process for the specified interface.</span></span> <span data-ttu-id="df36c-153">CurrentSSOServer を設定した後は、指定されたサーバーに、インターフェイス上のすべての後続のメソッド呼び出しが送信されます。</span><span class="sxs-lookup"><span data-stu-id="df36c-153">Once you set CurrentSSOServer, all subsequent method calls on the interface will be sent to the specified server.</span></span>  

- <span data-ttu-id="df36c-154">**トランザクション**: DTC トランザクションを SSO によって、操作を実行するスコープ オブジェクト モデルを指定します。</span><span class="sxs-lookup"><span data-stu-id="df36c-154">**Transaction**: specifies a DTC transaction that to scope the operations performed by the SSO object model.</span></span> <span data-ttu-id="df36c-155">DTC ITransaction ポインターを渡す必要があります`ptrValue`、または"null"を現在のトランザクション スコープをオフにします。</span><span class="sxs-lookup"><span data-stu-id="df36c-155">You must pass a DTC ITransaction pointer in `ptrValue`, or "null" to clear the current transaction scope.</span></span>  

- <span data-ttu-id="df36c-156">**AppFilterFlags/AppFilterMask**: アプリケーションの種類を制御 ISSOMapper.GetApplications および ISSOMapper2.GetApplications から返されます。</span><span class="sxs-lookup"><span data-stu-id="df36c-156">**AppFilterFlags/AppFilterMask**: controls what types of applications will be returned from ISSOMapper.GetApplications and ISSOMapper2.GetApplications.</span></span> <span data-ttu-id="df36c-157">アプリケーション フラグがフィルター フラグおよびフィルター フラグ マスクで指定されたフラグに一致する場合は、これらが返されます。</span><span class="sxs-lookup"><span data-stu-id="df36c-157">If the application flags match the flags specified by the filter flags and the filter flag mask they will be returned.</span></span> <span data-ttu-id="df36c-158">アプリケーションのフィルター処理を実行する方法の 1 つは、いずれに可を設定して、AppFilterFlags を次の 1 つ以上に設定するには。</span><span class="sxs-lookup"><span data-stu-id="df36c-158">One way to perform application filtering is to set AppFilterFlagsMask to SSO_FLAG_APP_FILTER_BY_TYPE and to then set AppFilterFlags to one or more of the following:</span></span>  

   <span data-ttu-id="df36c-159">SSO_APP_TYPE_INDIVIDUAL</span><span class="sxs-lookup"><span data-stu-id="df36c-159">SSO_APP_TYPE_INDIVIDUAL</span></span>  

   <span data-ttu-id="df36c-160">SSO_APP_TYPE_GROUP</span><span class="sxs-lookup"><span data-stu-id="df36c-160">SSO_APP_TYPE_GROUP</span></span>  

   <span data-ttu-id="df36c-161">SSO_APP_TYPE_CONFIG_STORE</span><span class="sxs-lookup"><span data-stu-id="df36c-161">SSO_APP_TYPE_CONFIG_STORE</span></span>  

   <span data-ttu-id="df36c-162">SSO_APP_TYPE_HOST_GROUP</span><span class="sxs-lookup"><span data-stu-id="df36c-162">SSO_APP_TYPE_HOST_GROUP</span></span>  

   <span data-ttu-id="df36c-163">SSO_APP_TYPE_PS_ADAPTER</span><span class="sxs-lookup"><span data-stu-id="df36c-163">SSO_APP_TYPE_PS_ADAPTER</span></span>  

   <span data-ttu-id="df36c-164">SSO_APP_TYPE_PS_GROUP_ADAPTER</span><span class="sxs-lookup"><span data-stu-id="df36c-164">SSO_APP_TYPE_PS_GROUP_ADAPTER</span></span>  

- <span data-ttu-id="df36c-165">**AsyncCall**: かどうか true の場合、SSO を実行して非同期リモート プロシージャ コール (RPC) を使用して、メソッド。</span><span class="sxs-lookup"><span data-stu-id="df36c-165">**AsyncCall**: if true, then SSO will perform the method using an asynchronous remote procedure call (RPC).</span></span> <span data-ttu-id="df36c-166">メソッドでは、実行中の E_PENDING を返します。</span><span class="sxs-lookup"><span data-stu-id="df36c-166">The method will return E_PENDING while in progress.</span></span> <span data-ttu-id="df36c-167">その他の戻り値は、メソッドが完了したことを示します。</span><span class="sxs-lookup"><span data-stu-id="df36c-167">Any other return value indicates that the method is completed.</span></span> <span data-ttu-id="df36c-168">AsyncCall では、メソッドの完了をポーリングすることもできます。</span><span class="sxs-lookup"><span data-stu-id="df36c-168">AsyncCall also allows you to poll the method for completion.</span></span>
