---
title: POP3 アダプターでメッセージの処理のマルチパート |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 56ad041f-f155-4c1c-ab87-1405c80d9b68
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 68c02f7a5bded3ccffa60ae7327297342ffdc0d6
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65396973"
---
# <a name="processing-multi-part-messages-with-the-pop3-adapter"></a><span data-ttu-id="b4c21-102">POP3 アダプターでのマルチパート メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="b4c21-102">Processing Multi Part Messages with the POP3 Adapter</span></span>
<span data-ttu-id="b4c21-103">POP3 アダプターに記載された IETF 標準に準拠する MIME でエンコードされたメッセージを処理できる[RFC 2045](http://go.microsoft.com/fwlink/?LinkId=58810)、 [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=58811)、および[RFC 2047](http://go.microsoft.com/fwlink/?LinkId=58812)します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-103">The POP3 Adapter can process MIME-encoded messages that conform to the IETF standards documented in [RFC 2045](http://go.microsoft.com/fwlink/?LinkId=58810), [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=58811), and [RFC 2047](http://go.microsoft.com/fwlink/?LinkId=58812).</span></span> <span data-ttu-id="b4c21-104">MIME エンコード メッセージからさまざまなコンテンツ タイプの多くの部分に 1 つ持つことができます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-104">MIME encoded messages can have from one to many parts with different content types.</span></span> <span data-ttu-id="b4c21-105">このトピックでは、説明、POP3 アダプタがマルチパート MIME エンコード メッセージを処理します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-105">This topic discusses the how the POP3 adapter processes multi part MIME encoded messages.</span></span>  
  
## <a name="receiving-multi-part-messages-with-the-pop3-adapter"></a><span data-ttu-id="b4c21-106">POP3 アダプターでマルチパート メッセージの受信</span><span class="sxs-lookup"><span data-stu-id="b4c21-106">Receiving Multi part Messages with the POP3 Adapter</span></span>  
 <span data-ttu-id="b4c21-107">POP3 アダプターを使用する受信場所がいるかどうか、 **MIME デコードの適用**オプションに設定されて**True** POP3 アダプターが MIME でエンコードされたメッセージを受信するときに、次の操作を実行してから。</span><span class="sxs-lookup"><span data-stu-id="b4c21-107">If a receive location that uses the POP3 adapter has the **Apply MIME Decoding** option set to **True** then the POP3 adapter performs the following actions when receiving a MIME-encoded message:</span></span>  
  
1.  <span data-ttu-id="b4c21-108">受信した MIME エンコード メッセージの部分からマルチパート BizTalk メッセージを作成します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-108">Creates a multi part BizTalk message from the parts of the MIME encoded message that it receives.</span></span> <span data-ttu-id="b4c21-109">このマルチパート メッセージでは、1 から多くの部分に含めることができが受信した MIME エンコード メッセージと同じ数部分にはが含まれます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-109">This multi part message can contain from 1 to many parts and will contain the same number of parts as the MIME encoded message that is received.</span></span>  
  
2.  <span data-ttu-id="b4c21-110">MIME エンコード メッセージのヘッダーをスキャンします。</span><span class="sxs-lookup"><span data-stu-id="b4c21-110">Scans the headers of the MIME encoded message.</span></span> <span data-ttu-id="b4c21-111">すべてのヘッダーかどうかは、トピックに記載されているプロパティの一覧と一致[POP3 アダプター プロパティ スキーマおよびプロパティ](../core/pop3-adapter-property-schema-and-properties.md)し、これらのヘッダーは、コンテキスト プロパティとしてマルチパート BizTalk メッセージに昇格されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-111">If any headers match the list of properties documented in the topic [POP3 Adapter Property Schema and Properties](../core/pop3-adapter-property-schema-and-properties.md) then these headers are promoted to the multi part BizTalk message as context properties.</span></span>  
  
3.  <span data-ttu-id="b4c21-112">構成可能なアルゴリズムを使用して、MIME エンコード メッセージの部分の 1 つの BizTalk メッセージのボディ部として指定します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-112">Uses a configurable algorithm to designate one of the parts of the MIME encoded message as the BizTalk message body part.</span></span> <span data-ttu-id="b4c21-113">BizTalk メッセージのボディ部にどのメッセージ部分を決定するために使用するアルゴリズムは、以下のセクションで説明されて**POP3 アダプターによって使用本文部分選択アルゴリズム**します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-113">The algorithm used to determine which message part will be the BizTalk message body part is described below in the section **Body Part Selection Algorithm Used by the POP3 Adapter**.</span></span>  
  
4.  <span data-ttu-id="b4c21-114">メッセージ ボックスに、マルチパート BizTalk メッセージを発行します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-114">Publishes the multi part BizTalk message to the MessageBox.</span></span>  
  
## <a name="body-part-selection-algorithm-used-by-the-pop3-adapter"></a><span data-ttu-id="b4c21-115">POP3 アダプターによって使用されるボディ部の選択アルゴリズム</span><span class="sxs-lookup"><span data-stu-id="b4c21-115">Body Part Selection Algorithm Used by the POP3 Adapter</span></span>  
 <span data-ttu-id="b4c21-116">POP3 アダプターは、受信した MIME エンコード メッセージの部分からマルチパート BizTalk メッセージを作成するとき、メッセージ部分の 1 つを BizTalk メッセージのボディ部として選択します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-116">When the POP3 adapter creates a multipart BizTalk message from the parts of the MIME-encoded message that it receives, it selects one of the message parts as the BizTalk message body part.</span></span> <span data-ttu-id="b4c21-117">BizTalk メッセージのボディ部は、メッセージの検証、マッピング、プロパティの昇格、フラット ファイル アセンブリおよびその他の操作などの BizTalk Server によって使用されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-117">The BizTalk message body part is used by BizTalk Server for things such as message validation, mapping, property promotion, flat file assembly and other operations.</span></span> <span data-ttu-id="b4c21-118">マルチパート BizTalk メッセージのサブスクライバーは、すべてのメッセージ部分を受け取りますが、オーケストレーション、カスタム パイプライン、またはマルチパート メッセージを理解できるアダプターを使用していない場合のみ、指定された BizTalk メッセージのボディ部が使用されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-118">Subscribers to a multi part BizTalk message receive all of the message parts but will only consume the designated BizTalk message body part unless using an orchestration, a custom pipeline, or an adapter that can understand multi part messages.</span></span> <span data-ttu-id="b4c21-119">たとえば、; マルチパート メッセージのすべての部分を読み取るオーケストレーションを構成できます。SMTP アダプタは、マルチパート メッセージの部分を読み取ることができ、カスタム パイプラインは、MIME/SMIME エンコーダー パイプライン コンポーネントを使用するように構成できます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-119">For example, you can configure an orchestration to read all parts of multi part message; the SMTP adapter can read all of the parts of a multi part message, and a custom pipeline can be configured to use the MIME/SMIME encoder pipeline component.</span></span> <span data-ttu-id="b4c21-120">オーケストレーションを使用して、マルチパート メッセージを使用する方法の詳細については、以下のセクションを参照してください。**マルチパート メッセージの処理オーケストレーションで**します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-120">For more information about using an orchestration to consume a multi part message see the section below, **Processing Multi Part Messages in Orchestrations**.</span></span>  
  
 <span data-ttu-id="b4c21-121">POP3 アダプターの指定された値に基づいて使用可能なボディ部から BizTalk メッセージのボディ部の選択、**ボディ部のインデックス**と**ボディ部のコンテンツの種類**します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-121">The POP3 adapter selects the BizTalk message body part from the available body parts based upon the values supplied for the **Body Part Index** and the **Body Part Content Type**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b4c21-122">POP3 アダプターがで定義されているボディ パーツのコンテンツ型を認識するように設計[RFC 2046](http://go.microsoft.com/fwlink/?LinkId=119569)します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-122">The POP3 adapter is designed to recognize the Body Part Content Types that are defined in [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=119569).</span></span>  
  
 <span data-ttu-id="b4c21-123">電子メールの BizTalk メッセージのボディ部の選択に使用されるアルゴリズムは、次に示します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-123">The algorithm that is used to select the BizTalk message body part of an e-mail is described below:</span></span>  
  
1.  <span data-ttu-id="b4c21-124">場合、**ボディ部のインデックス**0 に設定されていると、**ボディ部のコンテンツの種類**空白であることを BizTalk メッセージのボディ部を選択します。 次のアルゴリズムが使用されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-124">If the **Body Part Index** is set to 0 and the **Body Part Content Type** is blank then the following algorithm is used to select the BizTalk message body part:</span></span>  
  
    -   <span data-ttu-id="b4c21-125">Content-description ヘッダーが"body"を設定するのには、最初の MIME 部分を使用します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-125">Use the first MIME part with the Content-Description header set to "body".</span></span>  
  
    -   <span data-ttu-id="b4c21-126">それ以外の場合、"text/xml"に設定するコンテンツ タイプ ヘッダーと最初の MIME 部分を使用します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-126">Otherwise use the first MIME part with the Content-Type header set to "text/xml".</span></span>  
  
    -   <span data-ttu-id="b4c21-127">それ以外の場合"text/plain"に設定するコンテンツ タイプ ヘッダーと最初の MIME 部分を使用します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-127">Otherwise use the first MIME part with the Content-Type header set to "text/plain".</span></span>  
  
    -   <span data-ttu-id="b4c21-128">それ以外の場合、最初の MIME 部分を Content-type ヘッダーに設定を使用"text/"。</span><span class="sxs-lookup"><span data-stu-id="b4c21-128">Otherwise use the first MIME part with the Content-Type header set to "text/".</span></span>  
  
    -   <span data-ttu-id="b4c21-129">それ以外の場合、最初の MIME 部分を使用します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-129">Otherwise use the first MIME part.</span></span>  
  
2.  <span data-ttu-id="b4c21-130">それ以外の場合、**ボディ部のインデックス**0 に設定されている、**ボディ部のコンテンツの種類**セットし、指定された一致する受信メッセージの最初のボディ部が**ボディ部のコンテンツの種類**が BizTalk メッセージのボディ部として選択されています。</span><span class="sxs-lookup"><span data-stu-id="b4c21-130">Otherwise if the **Body Part Index** is set to 0 and the **Body Part Content Type** is set, then the first body part of the incoming message that matches the specified **Body Part Content Type** is selected as the BizTalk message body part.</span></span> <span data-ttu-id="b4c21-131">コンテンツの種類が一致する部分がない場合は、メッセージは中断されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-131">If there are no parts with a matching content type then the message is suspended.</span></span>  
  
3.  <span data-ttu-id="b4c21-132">それ以外の場合、**ボディ部のインデックス**0 より大きい値に設定されて、**ボディ部のコンテンツの種類**は、BizTalk メッセージのボディ部として指定したインデックスのボディ部を選択し、空白、します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-132">Otherwise if the **Body Part Index** is set to a value greater than 0 and the **Body Part Content Type** is blank, then the body part with the specified index is selected as the BizTalk message body part.</span></span> <span data-ttu-id="b4c21-133">指定したインデックスがボディ部の数より大きい場合は、メッセージは中断します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-133">If the specified index is greater than the number of body parts then the message is suspended.</span></span>  
  
4.  <span data-ttu-id="b4c21-134">それ以外の場合、**ボディ部のインデックス**0 より大きい値に設定されて、**ボディ部のコンテンツの種類**が設定されている、**ボディ部のインデックス**のみに適用に本文のパーツを指定された一致**ボディ部のコンテンツの種類**対応するボディ部が BizTalk メッセージのボディ部として選択されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-134">Otherwise if the **Body Part Index** is set to a value greater than 0 and the **Body Part Content Type** is set, then the **Body Part Index** is only applied to those body parts that match the specified **Body Part Content Type** and the corresponding body part is selected as the BizTalk message body part.</span></span> <span data-ttu-id="b4c21-135">指定したインデックスが、コンテンツの種類が一致する部分の数より大きい場合は、メッセージは中断します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-135">If the specified index is greater than the number of parts with a matching content type then the message is suspended.</span></span> <span data-ttu-id="b4c21-136">コンテンツの種類が一致する部分がない場合は、メッセージは中断されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-136">If there are no parts with a matching content type then the message is suspended.</span></span>  
  
5.  <span data-ttu-id="b4c21-137">BizTalk メッセージのボディ部が、マルチパート BizTalk メッセージのメッセージ ボックスに公開されている最初の部分が選択されている部分、メッセージの残りの部分では、元の MIME でエンコードされたメッセージの順序を維持します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-137">The part that is selected as the BizTalk message body part becomes the first part of the multi part BizTalk message that is published to the MessageBox, the remaining parts of the message maintain the order that they had in the original MIME encoded message.</span></span>  
  
## <a name="processing-multi-part-messages-in-orchestrations"></a><span data-ttu-id="b4c21-138">オーケストレーションでマルチパート メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="b4c21-138">Processing Multi Part Messages in Orchestrations</span></span>  
 <span data-ttu-id="b4c21-139">POP3 アダプターは、受信した MIME エンコード メッセージからマルチパート BizTalk メッセージを作成するときは、1 つの部分のみが BizTalk メッセージのボディ部として指定された場合でも、メッセージ ボックス データベースに発行すべての部分されます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-139">When the POP3 adapter creates a multi part BizTalk message from a MIME encoded message that it receives, all of the parts are published to the MessageBox database even though only one of the parts is designated as the BizTalk message body part.</span></span> <span data-ttu-id="b4c21-140">これらの部分は、その後、マルチパート メッセージをサブスクライブするオーケストレーションによって使用できます。</span><span class="sxs-lookup"><span data-stu-id="b4c21-140">These parts can be subsequently consumed by an orchestration that subscribes to the multi part message.</span></span> <span data-ttu-id="b4c21-141">このセクションは、オーケストレーションでマルチパート メッセージを処理するときに、いくつかの考慮事項を説明します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-141">This section documents some considerations when processing multi part messages in an orchestration.</span></span>  
  
### <a name="processing-multi-part-messages-with-a-known-number-of-parts-and-known-part-types"></a><span data-ttu-id="b4c21-142">既知のパーツと既知の部分の種類の数とマルチパート メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="b4c21-142">Processing multi part messages with a known number of parts and known part types</span></span>  
 <span data-ttu-id="b4c21-143">オーケストレーションが既知の数の部分と既知のパーツの種類、マルチパート メッセージを受信している場合ことができます、オーケストレーションでマルチパート メッセージを宣言し、デザイン時にパーツと部分の種類の数を設定します。</span><span class="sxs-lookup"><span data-stu-id="b4c21-143">If your orchestration is receiving a multi part message with a known number of parts and known part types then you can declare a multi part message in the orchestration and set the number of parts and part types at design time.</span></span>  
  
### <a name="processing-multi-part-messages-with-unknown-part-types"></a><span data-ttu-id="b4c21-144">不明な部分の種類とマルチパート メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="b4c21-144">Processing multi part messages with unknown part types</span></span>  
 <span data-ttu-id="b4c21-145">オーケストレーションが不明な部分の種類とマルチパート メッセージを受信し、使用して、オーケストレーションでマルチパート メッセージを宣言するかどうか、 **XmlDocument**の各部分を型が既知の型。</span><span class="sxs-lookup"><span data-stu-id="b4c21-145">If your orchestration is receiving a multi part message with unknown part types then you can declare a multi part message in the orchestration and use the **XmlDocument** type for each of the parts for which the type is unknown.</span></span>  
  
### <a name="processing-multi-part-messages-with-an-unknown-number-of-parts-and-all-of-the-part-types-are-unknown"></a><span data-ttu-id="b4c21-146">パート型のすべての不明な数の部分と処理マルチパート メッセージは不明</span><span class="sxs-lookup"><span data-stu-id="b4c21-146">Processing multi part messages with an unknown number of parts and all of the part types are unknown</span></span>  
 <span data-ttu-id="b4c21-147">かどうか、オーケストレーションで部分の数が不明なマルチパート メッセージを受信し、1 つの部分で、マルチパート メッセージを宣言することができます、 **XmlDocument**メッセージを受信するオーケストレーションの種類。</span><span class="sxs-lookup"><span data-stu-id="b4c21-147">If your orchestration is receiving a multi part message with an unknown number of parts then you can declare a multi part message with a single part of the **XmlDocument** type in the orchestration to receive the message.</span></span> <span data-ttu-id="b4c21-148">宣言された部分の数よりも大きい値を含むマルチパート メッセージを受信した場合数の部分がありますが、メッセージでは、オーケストレーション エンジンの読み取りの部分で宣言されたメッセージ部分の数に一致する適切なパートの型を構築します型と、コンストラクト**XmlDocument**パーツの残りの部分。</span><span class="sxs-lookup"><span data-stu-id="b4c21-148">If a multi part message that contains greater than the number of declared parts is received, the orchestration engine reads how many parts there are in the message, then constructs the proper part types for the parts that match the number of parts in the declared message type and then constructs **XmlDocument** parts for the remaining parts.</span></span>