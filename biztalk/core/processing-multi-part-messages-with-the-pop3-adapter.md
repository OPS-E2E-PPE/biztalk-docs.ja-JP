---
title: POP3 アダプターでメッセージの処理のマルチパート |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 56ad041f-f155-4c1c-ab87-1405c80d9b68
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 68c02f7a5bded3ccffa60ae7327297342ffdc0d6
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65396973"
---
# <a name="processing-multi-part-messages-with-the-pop3-adapter"></a>POP3 アダプターでのマルチパート メッセージの処理
POP3 アダプターに記載された IETF 標準に準拠する MIME でエンコードされたメッセージを処理できる[RFC 2045](http://go.microsoft.com/fwlink/?LinkId=58810)、 [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=58811)、および[RFC 2047](http://go.microsoft.com/fwlink/?LinkId=58812)します。 MIME エンコード メッセージからさまざまなコンテンツ タイプの多くの部分に 1 つ持つことができます。 このトピックでは、説明、POP3 アダプタがマルチパート MIME エンコード メッセージを処理します。  
  
## <a name="receiving-multi-part-messages-with-the-pop3-adapter"></a>POP3 アダプターでマルチパート メッセージの受信  
 POP3 アダプターを使用する受信場所がいるかどうか、 **MIME デコードの適用**オプションに設定されて**True** POP3 アダプターが MIME でエンコードされたメッセージを受信するときに、次の操作を実行してから。  
  
1.  受信した MIME エンコード メッセージの部分からマルチパート BizTalk メッセージを作成します。 このマルチパート メッセージでは、1 から多くの部分に含めることができが受信した MIME エンコード メッセージと同じ数部分にはが含まれます。  
  
2.  MIME エンコード メッセージのヘッダーをスキャンします。 すべてのヘッダーかどうかは、トピックに記載されているプロパティの一覧と一致[POP3 アダプター プロパティ スキーマおよびプロパティ](../core/pop3-adapter-property-schema-and-properties.md)し、これらのヘッダーは、コンテキスト プロパティとしてマルチパート BizTalk メッセージに昇格されます。  
  
3.  構成可能なアルゴリズムを使用して、MIME エンコード メッセージの部分の 1 つの BizTalk メッセージのボディ部として指定します。 BizTalk メッセージのボディ部にどのメッセージ部分を決定するために使用するアルゴリズムは、以下のセクションで説明されて**POP3 アダプターによって使用本文部分選択アルゴリズム**します。  
  
4.  メッセージ ボックスに、マルチパート BizTalk メッセージを発行します。  
  
## <a name="body-part-selection-algorithm-used-by-the-pop3-adapter"></a>POP3 アダプターによって使用されるボディ部の選択アルゴリズム  
 POP3 アダプターは、受信した MIME エンコード メッセージの部分からマルチパート BizTalk メッセージを作成するとき、メッセージ部分の 1 つを BizTalk メッセージのボディ部として選択します。 BizTalk メッセージのボディ部は、メッセージの検証、マッピング、プロパティの昇格、フラット ファイル アセンブリおよびその他の操作などの BizTalk Server によって使用されます。 マルチパート BizTalk メッセージのサブスクライバーは、すべてのメッセージ部分を受け取りますが、オーケストレーション、カスタム パイプライン、またはマルチパート メッセージを理解できるアダプターを使用していない場合のみ、指定された BizTalk メッセージのボディ部が使用されます。 たとえば、; マルチパート メッセージのすべての部分を読み取るオーケストレーションを構成できます。SMTP アダプタは、マルチパート メッセージの部分を読み取ることができ、カスタム パイプラインは、MIME/SMIME エンコーダー パイプライン コンポーネントを使用するように構成できます。 オーケストレーションを使用して、マルチパート メッセージを使用する方法の詳細については、以下のセクションを参照してください。**マルチパート メッセージの処理オーケストレーションで**します。  
  
 POP3 アダプターの指定された値に基づいて使用可能なボディ部から BizTalk メッセージのボディ部の選択、**ボディ部のインデックス**と**ボディ部のコンテンツの種類**します。  
  
> [!NOTE]
>  POP3 アダプターがで定義されているボディ パーツのコンテンツ型を認識するように設計[RFC 2046](http://go.microsoft.com/fwlink/?LinkId=119569)します。  
  
 電子メールの BizTalk メッセージのボディ部の選択に使用されるアルゴリズムは、次に示します。  
  
1.  場合、**ボディ部のインデックス**0 に設定されていると、**ボディ部のコンテンツの種類**空白であることを BizTalk メッセージのボディ部を選択します。 次のアルゴリズムが使用されます。  
  
    -   Content-description ヘッダーが"body"を設定するのには、最初の MIME 部分を使用します。  
  
    -   それ以外の場合、"text/xml"に設定するコンテンツ タイプ ヘッダーと最初の MIME 部分を使用します。  
  
    -   それ以外の場合"text/plain"に設定するコンテンツ タイプ ヘッダーと最初の MIME 部分を使用します。  
  
    -   それ以外の場合、最初の MIME 部分を Content-type ヘッダーに設定を使用"text/"。  
  
    -   それ以外の場合、最初の MIME 部分を使用します。  
  
2.  それ以外の場合、**ボディ部のインデックス**0 に設定されている、**ボディ部のコンテンツの種類**セットし、指定された一致する受信メッセージの最初のボディ部が**ボディ部のコンテンツの種類**が BizTalk メッセージのボディ部として選択されています。 コンテンツの種類が一致する部分がない場合は、メッセージは中断されます。  
  
3.  それ以外の場合、**ボディ部のインデックス**0 より大きい値に設定されて、**ボディ部のコンテンツの種類**は、BizTalk メッセージのボディ部として指定したインデックスのボディ部を選択し、空白、します。 指定したインデックスがボディ部の数より大きい場合は、メッセージは中断します。  
  
4.  それ以外の場合、**ボディ部のインデックス**0 より大きい値に設定されて、**ボディ部のコンテンツの種類**が設定されている、**ボディ部のインデックス**のみに適用に本文のパーツを指定された一致**ボディ部のコンテンツの種類**対応するボディ部が BizTalk メッセージのボディ部として選択されます。 指定したインデックスが、コンテンツの種類が一致する部分の数より大きい場合は、メッセージは中断します。 コンテンツの種類が一致する部分がない場合は、メッセージは中断されます。  
  
5.  BizTalk メッセージのボディ部が、マルチパート BizTalk メッセージのメッセージ ボックスに公開されている最初の部分が選択されている部分、メッセージの残りの部分では、元の MIME でエンコードされたメッセージの順序を維持します。  
  
## <a name="processing-multi-part-messages-in-orchestrations"></a>オーケストレーションでマルチパート メッセージの処理  
 POP3 アダプターは、受信した MIME エンコード メッセージからマルチパート BizTalk メッセージを作成するときは、1 つの部分のみが BizTalk メッセージのボディ部として指定された場合でも、メッセージ ボックス データベースに発行すべての部分されます。 これらの部分は、その後、マルチパート メッセージをサブスクライブするオーケストレーションによって使用できます。 このセクションは、オーケストレーションでマルチパート メッセージを処理するときに、いくつかの考慮事項を説明します。  
  
### <a name="processing-multi-part-messages-with-a-known-number-of-parts-and-known-part-types"></a>既知のパーツと既知の部分の種類の数とマルチパート メッセージの処理  
 オーケストレーションが既知の数の部分と既知のパーツの種類、マルチパート メッセージを受信している場合ことができます、オーケストレーションでマルチパート メッセージを宣言し、デザイン時にパーツと部分の種類の数を設定します。  
  
### <a name="processing-multi-part-messages-with-unknown-part-types"></a>不明な部分の種類とマルチパート メッセージの処理  
 オーケストレーションが不明な部分の種類とマルチパート メッセージを受信し、使用して、オーケストレーションでマルチパート メッセージを宣言するかどうか、 **XmlDocument**の各部分を型が既知の型。  
  
### <a name="processing-multi-part-messages-with-an-unknown-number-of-parts-and-all-of-the-part-types-are-unknown"></a>パート型のすべての不明な数の部分と処理マルチパート メッセージは不明  
 かどうか、オーケストレーションで部分の数が不明なマルチパート メッセージを受信し、1 つの部分で、マルチパート メッセージを宣言することができます、 **XmlDocument**メッセージを受信するオーケストレーションの種類。 宣言された部分の数よりも大きい値を含むマルチパート メッセージを受信した場合数の部分がありますが、メッセージでは、オーケストレーション エンジンの読み取りの部分で宣言されたメッセージ部分の数に一致する適切なパートの型を構築します型と、コンストラクト**XmlDocument**パーツの残りの部分。