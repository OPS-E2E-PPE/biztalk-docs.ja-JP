---
title: UpdateEx メソッド |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- UpdateEx method
ms.assetid: 2fa9c9cc-fd01-4765-8c31-facac188a19d
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5ac317a9c91f13dce2dadf74b3027ebf4d33390f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65398641"
---
# <a name="updateex-method"></a><span data-ttu-id="74334-102">UpdateEx メソッド</span><span class="sxs-lookup"><span data-stu-id="74334-102">UpdateEx Method</span></span>
<span data-ttu-id="74334-103">入力キー パラメーター (key1、key2、... に基づいてプロパティを更新するために使用</span><span class="sxs-lookup"><span data-stu-id="74334-103">Used to update properties based on the input key parameters (key1, key2, …</span></span> <span data-ttu-id="74334-104">keyn)。</span><span class="sxs-lookup"><span data-stu-id="74334-104">keyn).</span></span> <span data-ttu-id="74334-105">使用する場合`UpdateEx`コレクション内の項目を削除することはできません。</span><span class="sxs-lookup"><span data-stu-id="74334-105">When using `UpdateEx`, you cannot delete items in a collection.</span></span> <span data-ttu-id="74334-106">別のメソッドには、削除が容易になります。</span><span class="sxs-lookup"><span data-stu-id="74334-106">A separate method facilitates deletion.</span></span> <span data-ttu-id="74334-107">詳細については、次を参照してください。 [DeleteOnly メソッド](../core/deleteonly-method.md)します。</span><span class="sxs-lookup"><span data-stu-id="74334-107">For more information, see [DeleteOnly Method](../core/deleteonly-method.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="74334-108">構文</span><span class="sxs-lookup"><span data-stu-id="74334-108">Syntax</span></span>  
  
```  
UpdateEx (key1, key2, ... keyn, correctionMode, interactiveMode,  
    properties)  
```  
  
## <a name="parameters"></a><span data-ttu-id="74334-109">パラメーター</span><span class="sxs-lookup"><span data-stu-id="74334-109">Parameters</span></span>  
  
|<span data-ttu-id="74334-110">パラメーター</span><span class="sxs-lookup"><span data-stu-id="74334-110">Parameter</span></span>|<span data-ttu-id="74334-111">説明</span><span class="sxs-lookup"><span data-stu-id="74334-111">Description</span></span>|  
|---------------|-----------------|  
|`key`|<span data-ttu-id="74334-112">サーバーのデータベース、またはエラーに存在する必要がありますパラメーターのセットが発生します。</span><span class="sxs-lookup"><span data-stu-id="74334-112">A set of parameters that must exist in the server database, or an error occurs.</span></span> <span data-ttu-id="74334-113">これらのキーは、特定のコンポーネント インターフェイスに対して定義されている一連の Get キーに対応します。</span><span class="sxs-lookup"><span data-stu-id="74334-113">These keys correspond to the set of Get Keys as defined for the particular component interface.</span></span>|  
|`correctionMode`|<span data-ttu-id="74334-114">ブール型のフラグ。</span><span class="sxs-lookup"><span data-stu-id="74334-114">A Boolean flag.</span></span> <span data-ttu-id="74334-115">True の場合をフィールドの値を更新するか、新しい項目をコレクションに挿入することで、effective-dated 項目とのコンポーネント インターフェイスの変更を可能に設定するとします。</span><span class="sxs-lookup"><span data-stu-id="74334-115">When set to true, allows modifications to component interfaces with effective-dated items either by updating the field values, or by inserting new items into a collection.</span></span> <span data-ttu-id="74334-116">具体的には、EFFDT が現在有効な日付より前にある項目を変更することができます。</span><span class="sxs-lookup"><span data-stu-id="74334-116">Specifically, it allows modification to items that have EFFDT prior to the current effective date.</span></span> <span data-ttu-id="74334-117">なしこのフラグを TRUE に設定すると、これらの項目を変更しても結果 PeopleSoft サーバーから返されるエラー。</span><span class="sxs-lookup"><span data-stu-id="74334-117">Without this flag set to TRUE, any modification to these items results in an error returned from PeopleSoft server.</span></span><br /><br /> <span data-ttu-id="74334-118">`correctionMode`引数は、effective-dated 項目を含むコンポーネント インターフェイスに対してのみ公開されます。</span><span class="sxs-lookup"><span data-stu-id="74334-118">The `correctionMode` argument is only exposed for those component interfaces that contain effective-dated items.</span></span> <span data-ttu-id="74334-119">それ以外の場合、引数の一部としては表示されません。</span><span class="sxs-lookup"><span data-stu-id="74334-119">Otherwise, it is not shown as part of the argument.</span></span><br /><br /> <span data-ttu-id="74334-120">設定はしないで`correctionMode`を運用環境で TRUE にします。</span><span class="sxs-lookup"><span data-stu-id="74334-120">You should avoid setting `correctionMode` to TRUE in a production environment.</span></span> <span data-ttu-id="74334-121">(これも、推奨事項は PeopleSoft から。)過去の EFFDT キーによって既に発生しているイベントを変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="74334-121">(This is also the recommendation from PeopleSoft.) Events that have already occurred as determined by the past EFFDT key should not be modified.</span></span> <span data-ttu-id="74334-122">これは、ため、監査証跡を作成できます。</span><span class="sxs-lookup"><span data-stu-id="74334-122">This allows for the creation of an audit trail.</span></span> <span data-ttu-id="74334-123">`correctionMode`フラグ`UpdateEx`この安全性のメカニズムは行われませんでした。</span><span class="sxs-lookup"><span data-stu-id="74334-123">The `correctionMode` flag in `UpdateEx` allows this safety mechanism to be bypassed.</span></span> <span data-ttu-id="74334-124">推奨される方法は過去のイベントの項目、フィールドを設定し、(削除) ではなく追加で非アクティブになる更新された項目。</span><span class="sxs-lookup"><span data-stu-id="74334-124">The recommended practice is for past events to be deactivated by setting a field in the item, and adding (instead of deleting) the updated item.</span></span>|  
|`interactiveMode`|<span data-ttu-id="74334-125">エラー処理に使用されるフラグ。</span><span class="sxs-lookup"><span data-stu-id="74334-125">A flag used for error handling.</span></span><br /><br /> <span data-ttu-id="74334-126">BizTalk Adapter for PeopleSoft Enterprise ではコンポーネント インターフェイスで個々 のフィールドを読み書きする PeopleSoft が提供する Api を使用してコンポーネント インターフェイスでプロパティにアクセスするときただし、これらの変更は、一度に 1 つずつ PeopleSoft サーバーに反映されませんが。</span><span class="sxs-lookup"><span data-stu-id="74334-126">When accessing properties in a component interface, BizTalk Adapter for PeopleSoft Enterprise uses PeopleSoft-provided APIs that read and write individual fields in the component interface; however, these changes are not propagated to the PeopleSoft server one at a time.</span></span> <span data-ttu-id="74334-127">代わりに、psjoa.jar (BizTalk Adapter for PeopleSoft Enterprise と連携する) では、すべての変更をパッケージ化し、1 つのパッケージ内のサーバーに変更を送信します。</span><span class="sxs-lookup"><span data-stu-id="74334-127">Instead, the psjoa.jar (with which BizTalk Adapter for PeopleSoft Enterprise interacts) packages all the changes and sends the changes to the server in one package.</span></span> <span data-ttu-id="74334-128">個々 の更新プログラムのいずれかが失敗した場合、汎用的なエラーが返されますが、実際のエラーを特定していません。</span><span class="sxs-lookup"><span data-stu-id="74334-128">If any of the individual updates fail, a generic error is returned, which does not pinpoint the actual error.</span></span> <span data-ttu-id="74334-129">対話モードを TRUE に設定、すべてのフィールドの更新プログラムは、サーバーに個別に送信されます。</span><span class="sxs-lookup"><span data-stu-id="74334-129">With the interactive mode set to TRUE, every field update is sent to the server individually.</span></span> <span data-ttu-id="74334-130">これは、パフォーマンスに大きな影響がありますが (たとえば、フィールドを設定するために無効な値が使用されます) 場合、更新が失敗した場合は、特定のエラー情報は提供します。</span><span class="sxs-lookup"><span data-stu-id="74334-130">This has a substantial impact on performance, but it does provide specific error information if the update fails (for example, if an invalid value is used for setting a field).</span></span><br /><br /> <span data-ttu-id="74334-131">`interactiveMode`最大のパフォーマンスを提供し、エラー、フィールド更新レベルでレポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="74334-131">The `interactiveMode` provides maximum performance and provides error reporting at the field update level.</span></span> <span data-ttu-id="74334-132">この機能を正しく使用するをお勧めして通常の呼び出しを行った`interactiveMode`を FALSE に設定します。</span><span class="sxs-lookup"><span data-stu-id="74334-132">To use this feature properly, it is recommended that you make normal calls with `interactiveMode` set to FALSE.</span></span> <span data-ttu-id="74334-133">あるは影響はないパフォーマンスにします。</span><span class="sxs-lookup"><span data-stu-id="74334-133">There should be no impact on performance.</span></span> <span data-ttu-id="74334-134">同じ呼び出しを再試行することができます、エラーが返された場合、`interactiveMode`フラグを TRUE に設定します。</span><span class="sxs-lookup"><span data-stu-id="74334-134">If an error is returned, the same call can be retried with the `interactiveMode` flag set to TRUE.</span></span> <span data-ttu-id="74334-135">呼び出しが失敗したときに、サーバーより正確なエラー メッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="74334-135">When the call fails, the server returns a more precise error message.</span></span>|  
  
### <a name="remarks"></a><span data-ttu-id="74334-136">コメント</span><span class="sxs-lookup"><span data-stu-id="74334-136">Remarks</span></span>  
 <span data-ttu-id="74334-137">この関数を呼び出すときにそのキーに対応するレコードのプロパティと、入力パラメーターのプロパティが置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="74334-137">When you call this function, the properties of the record corresponding to the keys are replaced by the input parameter properties.</span></span> <span data-ttu-id="74334-138">元のレコードを含むすべてのコレクションが削除され、入力パラメーターで置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="74334-138">All collections with the original records are deleted and replaced by those in the input parameter.</span></span> <span data-ttu-id="74334-139">これらのコレクションのサイズはありません一致内でプロシージャ`UpdateEx`は既存のすべてのコレクション アイテムを削除し、指定したものを挿入します。</span><span class="sxs-lookup"><span data-stu-id="74334-139">The sizes of these collections do not have to matchbecause the procedure within `UpdateEx` is to delete all existing collection items and then insert the given ones.</span></span>  
  
 <span data-ttu-id="74334-140">コンポーネント インターフェイスのプロパティに有効日が指定された項目が含まれている場合、プロパティのパラメーターは、元のリストが置き換えられるために未来の有効日が指定された項目を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="74334-140">If the properties of the component interface contain effective dated items, the properties parameter must contain all future effective-dated items because the original list is replaced.</span></span> <span data-ttu-id="74334-141">これを追加すると、将来の発効項目を削除する、メカニズムが提供します。ただし、過去の発効項目プロパティを含めることも、エラーが返されますので、過去の発効項目を変更することはできません。</span><span class="sxs-lookup"><span data-stu-id="74334-141">This provides the mechanism for adding and deleting future effective-dated items; however, if the properties also contain past effective-dated items, an error is returned because past effective-dated items cannot be modified.</span></span> <span data-ttu-id="74334-142">現在の発効項目も含まれています、無視されます。</span><span class="sxs-lookup"><span data-stu-id="74334-142">If the current effective-dated item is also included, it is ignored.</span></span> <span data-ttu-id="74334-143">これによって、クライアントを呼び出す`Get()`で、`getHistoryItems`パラメーターを False に設定し、将来の発効項目を変更または新しい将来の発効の項目を追加および構造体をパラメーターとして渡す、`UpdateEx()`関数。</span><span class="sxs-lookup"><span data-stu-id="74334-143">This permits the client to call `Get()` with the `getHistoryItems` parameter set to False, and modify any future effective-dated items or add new future effective-dated items, and pass in the structure as parameter for the `UpdateEx()` function.</span></span>  
  
 <span data-ttu-id="74334-144">コンポーネント インターフェイスが 1 つだけのインスタンスが存在できるケースのように、キーを持たない場合、`UpdateEx()`メソッドの形式。</span><span class="sxs-lookup"><span data-stu-id="74334-144">If the component interface does not have a key, as in the case where only one instance can exist, the `UpdateEx()` method has the form:</span></span>  
  
```  
UpdateEx(correctionMode, interactiveMode, properties)  
```  
  
> [!NOTE]
>  <span data-ttu-id="74334-145">BizTalk Adapter for PeopleSoft Enterprise`UpdateEx()`メソッドが提供される場合、PeopleSoft`Get`と`Save`コンポーネント インターフェイスでの機能が有効にします。</span><span class="sxs-lookup"><span data-stu-id="74334-145">The BizTalk Adapter for PeopleSoft Enterprise `UpdateEx()` method is provided if the PeopleSoft `Get` and `Save` functions in the component interface are enabled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="74334-146">参照</span><span class="sxs-lookup"><span data-stu-id="74334-146">See Also</span></span>  
 [<span data-ttu-id="74334-147">付録 a:コンポーネント インターフェイス メソッド</span><span class="sxs-lookup"><span data-stu-id="74334-147">Appendix A: Component Interface Methods</span></span>](../core/appendix-a-component-interface-methods.md)