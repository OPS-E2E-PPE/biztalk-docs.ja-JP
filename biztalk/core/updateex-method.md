---
title: UpdateEx メソッド |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- UpdateEx method
ms.assetid: 2fa9c9cc-fd01-4765-8c31-facac188a19d
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7a6a64c6709eb9806612518c551372ba45d1a454
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22287426"
---
# <a name="updateex-method"></a><span data-ttu-id="f7de3-102">UpdateEx メソッド</span><span class="sxs-lookup"><span data-stu-id="f7de3-102">UpdateEx Method</span></span>
<span data-ttu-id="f7de3-103">入力キー パラメーター (key1、key2、... に基づいてプロパティを更新するために使用</span><span class="sxs-lookup"><span data-stu-id="f7de3-103">Used to update properties based on the input key parameters (key1, key2, …</span></span> <span data-ttu-id="f7de3-104">keyn)。</span><span class="sxs-lookup"><span data-stu-id="f7de3-104">keyn).</span></span> <span data-ttu-id="f7de3-105">`UpdateEx` を使用する場合は、コレクション内のアイテムを削除できません。</span><span class="sxs-lookup"><span data-stu-id="f7de3-105">When using `UpdateEx`, you cannot delete items in a collection.</span></span> <span data-ttu-id="f7de3-106">削除には別のメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="f7de3-106">A separate method facilitates deletion.</span></span> <span data-ttu-id="f7de3-107">詳細については、次を参照してください。 [DeleteOnly メソッド](../core/deleteonly-method.md)です。</span><span class="sxs-lookup"><span data-stu-id="f7de3-107">For more information, see [DeleteOnly Method](../core/deleteonly-method.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="f7de3-108">構文</span><span class="sxs-lookup"><span data-stu-id="f7de3-108">Syntax</span></span>  
  
```  
UpdateEx (key1, key2, ... keyn, correctionMode, interactiveMode,  
    properties)  
```  
  
## <a name="parameters"></a><span data-ttu-id="f7de3-109">パラメーター</span><span class="sxs-lookup"><span data-stu-id="f7de3-109">Parameters</span></span>  
  
|<span data-ttu-id="f7de3-110">パラメーター</span><span class="sxs-lookup"><span data-stu-id="f7de3-110">Parameter</span></span>|<span data-ttu-id="f7de3-111">Description</span><span class="sxs-lookup"><span data-stu-id="f7de3-111">Description</span></span>|  
|---------------|-----------------|  
|`key`|<span data-ttu-id="f7de3-112">サーバー データベースに存在している必要があるパラメーターのセット。存在していない場合、エラーが発生します。</span><span class="sxs-lookup"><span data-stu-id="f7de3-112">A set of parameters that must exist in the server database, or an error occurs.</span></span> <span data-ttu-id="f7de3-113">これらのキーは、特定のコンポーネント インターフェイスに定義された一連の Get キーに対応します。</span><span class="sxs-lookup"><span data-stu-id="f7de3-113">These keys correspond to the set of Get Keys as defined for the particular component interface.</span></span>|  
|`correctionMode`|<span data-ttu-id="f7de3-114">ブール型のフラグ。</span><span class="sxs-lookup"><span data-stu-id="f7de3-114">A Boolean flag.</span></span> <span data-ttu-id="f7de3-115">True に設定すると、フィールド値を更新するか、コレクションに新しいアイテムを挿入することによって、有効日が指定されたアイテムを含むコンポーネント インターフェイスへの変更が許可されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-115">When set to true, allows modifications to component interfaces with effective-dated items either by updating the field values, or by inserting new items into a collection.</span></span> <span data-ttu-id="f7de3-116">具体的には、EFFDT が現在の有効日よりも前のアイテムに対する変更が許可されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-116">Specifically, it allows modification to items that have EFFDT prior to the current effective date.</span></span> <span data-ttu-id="f7de3-117">このフラグを TRUE に設定しない場合、これらの項目への変更により、PeopleSoft サーバーからエラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-117">Without this flag set to TRUE, any modification to these items results in an error returned from PeopleSoft server.</span></span><br /><br /> <span data-ttu-id="f7de3-118">`correctionMode` 引数は、effective-dated 項目を含むコンポーネント インターフェイスに対してのみ公開されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-118">The `correctionMode` argument is only exposed for those component interfaces that contain effective-dated items.</span></span> <span data-ttu-id="f7de3-119">それ以外の場合は、引数の一部として表示されません。</span><span class="sxs-lookup"><span data-stu-id="f7de3-119">Otherwise, it is not shown as part of the argument.</span></span><br /><br /> <span data-ttu-id="f7de3-120">設定を避ける必要があります`correctionMode`を運用環境で TRUE にします。</span><span class="sxs-lookup"><span data-stu-id="f7de3-120">You should avoid setting `correctionMode` to TRUE in a production environment.</span></span> <span data-ttu-id="f7de3-121">(これはまた PeopleSoft からの勧告です。)過去の EFFDT キーで判別されるような、既に発生したイベントは変更しないでください。</span><span class="sxs-lookup"><span data-stu-id="f7de3-121">(This is also the recommendation from PeopleSoft.) Events that have already occurred as determined by the past EFFDT key should not be modified.</span></span> <span data-ttu-id="f7de3-122">これによって監査記録を作成できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f7de3-122">This allows for the creation of an audit trail.</span></span> <span data-ttu-id="f7de3-123">`UpdateEx` の `correctionMode` フラグを使用すると、この安全性のメカニズムを迂回することが可能になります。</span><span class="sxs-lookup"><span data-stu-id="f7de3-123">The `correctionMode` flag in `UpdateEx` allows this safety mechanism to be bypassed.</span></span> <span data-ttu-id="f7de3-124">アイテム内のフィールドを設定し、更新されたアイテムを (削除ではなく) 追加することによって、過去のイベントを非アクティブにすることをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="f7de3-124">The recommended practice is for past events to be deactivated by setting a field in the item, and adding (instead of deleting) the updated item.</span></span>|  
|`interactiveMode`|<span data-ttu-id="f7de3-125">エラー処理に使用されるフラグ。</span><span class="sxs-lookup"><span data-stu-id="f7de3-125">A flag used for error handling.</span></span><br /><br /> <span data-ttu-id="f7de3-126">BizTalk Adapter for PeopleSoft Enterprise が、コンポーネント インターフェイスに個々 のフィールドを読み書きする PeopleSoft が提供の Api を使用してコンポーネント インターフェイスでプロパティにアクセスするときにただし、これらの変更は、一度に 1 つずつ PeopleSoft サーバーに反映されませんされます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-126">When accessing properties in a component interface, BizTalk Adapter for PeopleSoft Enterprise uses PeopleSoft-provided APIs that read and write individual fields in the component interface; however, these changes are not propagated to the PeopleSoft server one at a time.</span></span> <span data-ttu-id="f7de3-127">代わりに、psjoa.jar (BizTalk Adapter for PeopleSoft Enterprise が操作する) がすべての変更をパッケージ化し、1 つのパッケージで変更をサーバーに送信します。</span><span class="sxs-lookup"><span data-stu-id="f7de3-127">Instead, the psjoa.jar (with which BizTalk Adapter for PeopleSoft Enterprise interacts) packages all the changes and sends the changes to the server in one package.</span></span> <span data-ttu-id="f7de3-128">個別の更新が失敗した場合、汎用エラーが返されます。このエラーは、実際のエラーを特定しません。</span><span class="sxs-lookup"><span data-stu-id="f7de3-128">If any of the individual updates fail, a generic error is returned, which does not pinpoint the actual error.</span></span> <span data-ttu-id="f7de3-129">対話モードを TRUE に設定することで、すべてのフィールド更新がサーバーに個別に送信されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-129">With the interactive mode set to TRUE, every field update is sent to the server individually.</span></span> <span data-ttu-id="f7de3-130">これによってパフォーマンスに大きな影響が及びますが、更新が失敗した場合 (たとえば、フィールドの設定に無効な値が使用された場合) には、具体的なエラー情報が提供されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-130">This has a substantial impact on performance, but it does provide specific error information if the update fails (for example, if an invalid value is used for setting a field).</span></span><br /><br /> <span data-ttu-id="f7de3-131">`interactiveMode` は最大のパフォーマンスを発揮し、フィールド更新レベルでエラーを報告します。</span><span class="sxs-lookup"><span data-stu-id="f7de3-131">The `interactiveMode` provides maximum performance and provides error reporting at the field update level.</span></span> <span data-ttu-id="f7de3-132">この機能を適切に使用するには、`interactiveMode` を FALSE に設定して通常の呼び出しを行うことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="f7de3-132">To use this feature properly, it is recommended that you make normal calls with `interactiveMode` set to FALSE.</span></span> <span data-ttu-id="f7de3-133">パフォーマンスへの影響はありません。</span><span class="sxs-lookup"><span data-stu-id="f7de3-133">There should be no impact on performance.</span></span> <span data-ttu-id="f7de3-134">エラーが返された場合は、`interactiveMode` フラグを TRUE に設定して、同じ呼び出しを再試行できます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-134">If an error is returned, the same call can be retried with the `interactiveMode` flag set to TRUE.</span></span> <span data-ttu-id="f7de3-135">呼び出しが失敗した場合、サーバーはより正確なエラー メッセージを返します。</span><span class="sxs-lookup"><span data-stu-id="f7de3-135">When the call fails, the server returns a more precise error message.</span></span>|  
  
### <a name="remarks"></a><span data-ttu-id="f7de3-136">解説</span><span class="sxs-lookup"><span data-stu-id="f7de3-136">Remarks</span></span>  
 <span data-ttu-id="f7de3-137">この関数を呼び出す場合、キーに対応するレコードのプロパティが、入力パラメーターのプロパティに置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-137">When you call this function, the properties of the record corresponding to the keys are replaced by the input parameter properties.</span></span> <span data-ttu-id="f7de3-138">元のレコードを含むすべてのコレクションは削除され、入力パラメーターで指定されたものに置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-138">All collections with the original records are deleted and replaced by those in the input parameter.</span></span> <span data-ttu-id="f7de3-139">これらのコレクションのサイズは一致している必要はありません。`UpdateEx` 内での手順が、既存のコレクション アイテムをすべて削除した後、指定されたコレクション アイテムを挿入するという手順であるからです。</span><span class="sxs-lookup"><span data-stu-id="f7de3-139">The sizes of these collections do not have to matchbecause the procedure within `UpdateEx` is to delete all existing collection items and then insert the given ones.</span></span>  
  
 <span data-ttu-id="f7de3-140">コンポーネント インターフェイスのプロパティに有効日が指定されたアイテムが含まれている場合、元のリストは置き換えられるので、プロパティ パラメーターにすべての将来の有効日が指定されたアイテムが含まれている必要があります。</span><span class="sxs-lookup"><span data-stu-id="f7de3-140">If the properties of the component interface contain effective dated items, the properties parameter must contain all future effective-dated items because the original list is replaced.</span></span> <span data-ttu-id="f7de3-141">これによって、有効日が指定されたアイテムの追加と削除のメカニズムが提供されますが、プロパティに過去の有効日が指定されたアイテムも含まれている場合、過去の有効日が指定されたアイテムは変更できないのでエラーが返されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-141">This provides the mechanism for adding and deleting future effective-dated items; however, if the properties also contain past effective-dated items, an error is returned because past effective-dated items cannot be modified.</span></span> <span data-ttu-id="f7de3-142">現在の有効日が指定されたアイテムも含まれている場合、そのアイテムは無視されます。</span><span class="sxs-lookup"><span data-stu-id="f7de3-142">If the current effective-dated item is also included, it is ignored.</span></span> <span data-ttu-id="f7de3-143">これにより、クライアントが呼び出すため`Get()`で、`getHistoryItems`パラメーターを False に設定し、将来の発効項目を変更または新しい将来の発効、項目を追加し、構造内のパラメーターとして渡す、`UpdateEx()`関数。</span><span class="sxs-lookup"><span data-stu-id="f7de3-143">This permits the client to call `Get()` with the `getHistoryItems` parameter set to False, and modify any future effective-dated items or add new future effective-dated items, and pass in the structure as parameter for the `UpdateEx()` function.</span></span>  
  
 <span data-ttu-id="f7de3-144">コンポーネント インターフェイスにキーがない場合、たとえば、インスタンスが 1 つしか存在できないような場合、`UpdateEx()` メソッドは次のような形式になります。</span><span class="sxs-lookup"><span data-stu-id="f7de3-144">If the component interface does not have a key, as in the case where only one instance can exist, the `UpdateEx()` method has the form:</span></span>  
  
```  
UpdateEx(correctionMode, interactiveMode, properties)  
```  
  
> [!NOTE]
>  <span data-ttu-id="f7de3-145">BizTalk Adapter for PeopleSoft Enterprise の `UpdateEx()` メソッドが提供されるのは、コンポーネント インターフェイスで PeopleSoft の `Get` および `Save` 関数が有効になっている場合です。</span><span class="sxs-lookup"><span data-stu-id="f7de3-145">The BizTalk Adapter for PeopleSoft Enterprise `UpdateEx()` method is provided if the PeopleSoft `Get` and `Save` functions in the component interface are enabled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7de3-146">参照</span><span class="sxs-lookup"><span data-stu-id="f7de3-146">See Also</span></span>  
 [<span data-ttu-id="f7de3-147">付録 a: コンポーネント インターフェイス メソッド</span><span class="sxs-lookup"><span data-stu-id="f7de3-147">Appendix A: Component Interface Methods</span></span>](../core/appendix-a-component-interface-methods.md)