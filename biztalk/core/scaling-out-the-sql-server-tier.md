---
title: SQL Server 層のスケール アウト |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- scaling, MessageBox database
- scaling, scaling out
- SQL Server, scaling
- MessageBox database, scaling
- scaling, strategies
ms.assetid: d5b2ebba-401e-4fde-8818-407fa626043a
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8c49a6bd83b6647170574106dd06825e2e5aba75
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65309029"
---
# <a name="scaling-out-the-sql-server-tier"></a>SQL Server 層のスケール アウト
、BizTalk グループごとに 1 つのマスター メッセージ ボックス データベースを追加します。 追加するすべての後続のメッセージ ボックス データベースは、セカンダリ メッセージ ボックスと呼ばれます。 マスター メッセージ ボックスは、すべてのサブスクリプションとメッセージのルーティングを処理します。 メッセージを公開することもできます。 セカンダリ メッセージ ボックス データベースにのみ、そのためには具体的には構成されている場合、メッセージが発行されます。  
  
## <a name="how-to-add-a-secondary-messagebox-database"></a>セカンダリ メッセージ ボックス データベースを追加する方法  
 セカンダリ メッセージ ボックス データベースを追加する 2 つの方法はあります。  
  
- 同じ物理サーバー上には、セカンダリ メッセージ ボックス データベースを追加します。  
  
   既存のメッセージ ボックス物理サーバーに十分な CPU と I/O リソースがあるし、ロックの競合によってボトルネックがのみの場合は、これを実行します。 別の IO ドライブ上には、セカンダリ メッセージ ボックス データベースを作成します。  
  
   利点:  
  
  -   余分な CPU ヘッドルームを他のメッセージ ボックスで利用できます。  
  
  -   以下の SQL server ライセンスが必要です。  
  
  -   ネットワーク ホップがなくなります。  
  
- セカンダリ メッセージ ボックス データベースを別の物理サーバーの追加します。  
  
   ここでは、余分なメッセージ ボックス データベースとして固有の IO で専用の物理サーバーを使用します。  
  
  次の図は、シナリオ、SQL 層はスケール アウトされた 1 つのメッセージ ボックス データベースから 3 つのメッセージ ボックス データベースにします。  
  
  ![MSGBOX のスケール アウト](../core/media/scaleoutmsgbox.gif "ScaleOutMSGBOX")  
  
## <a name="when-to-scale-out-the-messagebox-database"></a>メッセージ ボックス データベースをスケール アウトするタイミング  
  
-   メッセージ ボックス データベースがボトルネックになります。 ボトルネックが考えられます。  
  
    -   **CPU** 、非常に高価で複雑なオーケストレーション シナリオが発生した場合、メッセージ ボックス データベースが大量の CPU リソースを消費します。 別の発行を追加するメッセージ ボックス データベース スループットが向上します。  
  
    -   **ロックの競合**複雑なシナリオでは、複数のホスト インスタンスやオーケストレーションがメッセージ ボックス データベースでロックの競合を作成する傾向があります。 ここでも、別の公開メッセージ ボックス データベースを追加するには、スループットを向上させる必要があります。  
  
-   ボトルネックを解消するには、スケール アップします。 たとえば、マスター メッセージ ボックス データベースがバインドされているロックの競合の場合は、スケール アウトは、唯一のオプションです。  
  
-   スケール アップはコストが高すぎます。 たとえば、8 ウェイ サーバーへの既存のクアッド プロセッサ サーバーが別のクアッド プロセッサを追加するよりも高価な場合は、スケール アウトがより適切なオプションです。  
  
## <a name="when-you-cant-scale-out-the-sql-tier"></a>SQL 層をスケール アウトすることはできません。  
 理論上は、無期限に限り、マスター メッセージ ボックス データベースがボトルネックにならない、SQL 層をスケールする必要があります。 これを実現するには、ルーティング専用にするために、マスター メッセージ ボックス データベースを非公開データベースを作成を検討します。 ただし、マスターのロックの競合によってボトルネックになって後をスケール アウトできない SQL 層 ―。  
  
## <a name="scale-out-strategies-and-considerations"></a>スケール アウト戦略と考慮事項  
  
-   まずマスター メッセージ ボックス データベースをスケール アップし、スケール アウトします。  
  
-   スケール アウト 1 から 1 ~ 2 ではなく 3 つの SQL メッセージ ボックス データベースにします。 「4 つの BizTalk Server, 1 SQL Server トポロジでは、」というタイトルの上の図に示す 1 の SQL サーバー トポロジを検討して、SQL server は CPU バインド、つまり、ボトルネックは、CPU の処理を仮定します。 このトポロジに 1 つだけのメッセージ ボックス データベースを追加する場合は、マスター メッセージ ボックスでは、CPU バインドすることができ、使用率が低いセカンダリ メッセージ ボックス データベースになります。 そのため、スケール ファクターはほぼ 1 です。 マスター メッセージ ボックス データベースでパブリッシングを無効にして、専用のルーティング専用に、マスター メッセージ ボックス データベース場合、セカンダリ メッセージ ボックス データベースには公開が行われます。 効果がないため、セカンダリ メッセージ ボックス データベースはやはりボトルネックとなって、唯一のパブリッシャーが全体的なスループットが向上します。 そのため、2 つのセカンダリ メッセージ ボックス データベースを追加して、マスター メッセージ ボックス データベースでパブリッシングを無効にするは推奨される方法をこのシナリオではスケール アウトします。  
  
-   マスター メッセージ ボックス データベースがボトルネックとなる最終的になります。 そのため、マスター メッセージ ボックス データベースをホストする物理コンピューターには、高速で大容量があります。  
  
-   ネットワーク (および関連する DTC オーバーヘッド) 経由でデータの送信を最小限に抑える、専用のドライブと同じ物理コンピューターに複数のメッセージ ボックス データベースを配置することを検討してください。 同時に、リソースが複数のメッセージ ボックス データベースによって共有されているように、これら複数のデータベースを保持しているコンピューターがボトルネックいないを確認します。  
  
-   すべてのセカンダリ メッセージ ボックス データベースは、作業が公開メッセージ ボックス データベース間で均等に分散しているために、同等のハードウェアを使用してください。  
  
-   マスター メッセージ ボックス データベースがボトルネックとならない限り、セカンダリ メッセージ ボックス データベースをスケールすることができます、ために、セカンダリ メッセージ ボックス データベースは、CPU リソースが少なく、マスター メッセージ ボックス データベース サーバーに必要なコンピューターで実行できます。  
  
## <a name="see-also"></a>参照  
 [BizTalk Server 層のスケール アウト](../core/scaling-out-the-biztalk-server-tier.md)   
 [BizTalk Server 層のスケール アップ](../core/scaling-up-the-biztalk-server-tier.md)   
 [SQL Server 層のスケール アップ](../core/scaling-up-the-sql-server-tier.md)   
 [受信ホスト スケール アウト](../core/scaled-out-receiving-hosts.md)   
 [スケール アウトされた処理ホスト](../core/scaled-out-processing-hosts.md)   
 [スケール アウトされた送信ホスト](../core/scaled-out-sending-hosts.md)   
 [Windows Server クラスターを使用して BizTalk Server Hosts2 の高可用性を実現するには](../core/use-windows-cluster-to-provide-high-availability-for-biztalk-hosts.md)   
 [スケール アウト データベース](../core/scaled-out-databases.md)   
 [BizTalk Server データベースのクラスタリング](../core/clustering-the-biztalk-server-databases1.md)