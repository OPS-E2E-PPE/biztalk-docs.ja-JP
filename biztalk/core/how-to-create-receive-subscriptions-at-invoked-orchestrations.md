---
title: 作成する方法について呼び出されたオーケストレーションに受信サブスクリプション |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3423309a-cb5a-40a5-9582-6ee3ac82b538
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a3ccb4743b2054a02d492b053de21a32a27badaf
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37010307"
---
# <a name="how-to-create-receive-subscriptions-at-invoked-orchestrations"></a>呼び出されたオーケストレーションに受信サブスクリプションを作成する方法
メッセージをパラメーターとして渡すことができますが、**オーケストレーションの開始**図形の後に呼び出されたオーケストレーションに呼び出し元オーケストレーションからメッセージを送信する一部のシナリオで、オーケストレーションを開始すると、呼び出し。 たとえば、渡すべきメッセージが呼び出しの時点で判明していない場合や、呼び出されたオーケストレーションに他のオーケストレーションから動的にメッセージを送信する場合などです。  
  
 呼び出し先オーケストレーションにメッセージを送信するには、関連付けを渡します。呼び出し先オーケストレーションはこの関連付けに基づいてサブスクリプションを作成し、さらにそのサブスクリプションを使用してメッセージを受信します。 ただし、呼び出し先オーケストレーションに関連付けを渡すだけでは、関連付けに基づくサブスクリプションは作成されず、サブスクリプションのメッセージも受信されません。 アプローチを使用する場合、エラーは、「、パブリッシュされたメッセージがルーティングでしたサブスクライバーが見つからなかったためです」呼び出し元オーケストレーションから呼び出されたオーケストレーションに送信するメッセージが発生します。 これは、次の理由によりします。  
  
- 呼び出し先のオーケストレーションに競合状態が存在する  
  
- 呼び出し先オーケストレーションがメッセージ ボックス データベースへサブスクリプションを送信するためのコミット ポイントが存在しないので、ルーティングされたメッセージを受け取ることができない。  
  
  この問題を解決する方法、次の手順を実行することです。  
  
1. 呼び出し先オーケストレーションで、メッセージを受信するアクティブ化受信を作成します。 経由の直接バインド ポートを受信する、自己関連付けと呼び出し先オーケストレーションでメッセージが表示される、関連付けセットを初期化、および関連付けセットを渡して、**オーケストレーションの開始**図形。 渡したポートが、呼び出し先オーケストレーションの送信ポートになります。このポートを使用してメッセージを返し、呼び出し元オーケストレーションと同期します。  
  
2. 呼び出し先オーケストレーションで、自己関連付けポートを通じて、呼び出し元オーケストレーションにメッセージを返します。 これで呼び出し元オーケストレーションと同期をとれるので、競合状態を回避し、コミット ポイントを設けることができます。また、呼び出し先オーケストレーションでは、メッセージ ボックスへの受信サブスクリプションを作成し、メッセージがルーティングされるようにします。  
  
3. 呼び出し元オーケストレーションは、自己関連付けポートを通じてメッセージを受信し、呼び出し先オーケストレーションと同期します。 自己関連付けポートの受信には、フォロー関連付けが必要ありません。 これで、呼び出し元オーケストレーションからのメッセージを、呼び出し先オーケストレーションへ安全に送信できるようになりました。呼び出し先オーケストレーションは、関連付けに基づいてメッセージを受信します。  
  
   前の方法でも目的を達成できますが、より良い方法として、受信に使用する関連付けを初期化するメッセージを渡す方法があります。 自己関連付けポートを通じて、呼び出し元オーケストレーションと呼び出し先オーケストレーションを同期するときは、関連付けの初期化に必要なメッセージを渡すことをお勧めします。 次の手順は、信頼性とパフォーマンスが最も高い方法です。  
  
4. 呼び出し先オーケストレーションで、メッセージを受信するアクティブ化受信を作成します。 メッセージを渡すし、を介して直接バインド ポートを受信する、自己関連付けメッセージが表示されたら、**オーケストレーションの開始**図形。 呼び出し先オーケストレーションでは、ここで渡したメッセージを使用して関連付けが初期化されます。 渡したポートが、呼び出し先オーケストレーションの送信ポートになります。このポートを使用してメッセージを返し、呼び出し元オーケストレーションと同期します。  
  
5. 呼び出し先オーケストレーションでは、関連付けを初期化して、呼び出し元オーケストレーションにメッセージを返します。 これで呼び出し元オーケストレーションと同期をとれるので、競合状態を回避し、コミット ポイントを設けることができます。また、呼び出し先オーケストレーションでは、メッセージ ボックスへの受信サブスクリプションを作成し、メッセージがルーティングされるようにします。  
  
6. 呼び出し元オーケストレーションは、自己関連付けポートを通じてメッセージを受信し、呼び出し先オーケストレーションと同期します。 注、自己関連付けポートを受信するには、フォロー関連付けは必要ありません。 これで、呼び出し元オーケストレーションからのメッセージを、呼び出し先オーケストレーションへ安全に送信できるようになりました。呼び出し先オーケストレーションは、関連付けに基づいてメッセージを受信します。  
  
## <a name="see-also"></a>参照  
 [オーケストレーションでの相関関係の使用](../core/using-correlations-in-orchestrations.md)   
 [自己関連付けを行う Direct を使用する方法のポートのバインド](../core/how-to-use-self-correlating-direct-bound-ports.md)