---
title: EDI セグメントの構造体要素 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 1f474a3d-004a-4981-b155-b0a5775918ba
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5b05d7a793fe515b8d0254d63b9b96994ddb35d9
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22242218"
---
# <a name="edi-segment-structural-element"></a><span data-ttu-id="04b05-102">EDI セグメントの構造要素</span><span class="sxs-lookup"><span data-stu-id="04b05-102">EDI Segment Structural Element</span></span>
<span data-ttu-id="04b05-103">セグメントは、メッセージの情報の中間単位であり、1 つ以上のデータ要素を含んでいます。</span><span class="sxs-lookup"><span data-stu-id="04b05-103">The segment contains one or more data elements, and is an intermediate unit of information in the message.</span></span> <span data-ttu-id="04b05-104">各セグメントは、3 文字のデータ セグメント識別子で始まり、セグメント終端記号 (既定ではアポストロフィ (')) で終わります。</span><span class="sxs-lookup"><span data-stu-id="04b05-104">Each segment starts with a three-character data segment identifier, and ends with a segment terminator (by default the apostrophe (')).</span></span> <span data-ttu-id="04b05-105">セグメント内のデータ要素は、データ要素区切り記号で区切られます。</span><span class="sxs-lookup"><span data-stu-id="04b05-105">The data elements within the segment are separated by data element separators.</span></span> <span data-ttu-id="04b05-106">既定のデータ要素区切り記号は正符号 (+) です。</span><span class="sxs-lookup"><span data-stu-id="04b05-106">The data element separator is by default the plus sign (+).</span></span> <span data-ttu-id="04b05-107">セグメントは、必須セグメントまたは省略可能なセグメントに分類されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-107">A segment is classified as Mandatory or Optional.</span></span> <span data-ttu-id="04b05-108">送信インターチェンジの区切り記号は、2 つの取引先間のアグリーメントで設定するか、フォールバック取引先アグリーメントの一部として設定することができます。</span><span class="sxs-lookup"><span data-stu-id="04b05-108">Separators for outgoing interchanges can be set in the agreements between two trading partners or as part of fallback trading partner agreement.</span></span>  
  
## <a name="nesting"></a><span data-ttu-id="04b05-109">入れ子</span><span class="sxs-lookup"><span data-stu-id="04b05-109">Nesting</span></span>  
 <span data-ttu-id="04b05-110">セグメントと呼ばれる階層関係でグループ化する**入れ子**です。</span><span class="sxs-lookup"><span data-stu-id="04b05-110">Segments may be grouped in a hierarchical relationship called **nesting**.</span></span> <span data-ttu-id="04b05-111">入れ子の 2 つの別個の型がある: 明示的および暗黙的なです。</span><span class="sxs-lookup"><span data-stu-id="04b05-111">There are two distinct type of nesting: explicit and implicit.</span></span> <span data-ttu-id="04b05-112">1 つのインターチェンジでは、1 つの種類の入れ子のみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="04b05-112">Within any one interchange only one type of nesting can be used.</span></span>  
  
-   <span data-ttu-id="04b05-113">明示的な入れ子では、ループが入れ子にされることが明示的に示されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-113">Explicit nesting uses an explicit indication that the loop is nested.</span></span> <span data-ttu-id="04b05-114">明示的な入れ子が使用される場合、セグメント タグ内の最初のコンポーネント データ要素はセグメント コードになります。</span><span class="sxs-lookup"><span data-stu-id="04b05-114">When explicit nesting is used, the first component data element in the segment tag will be the segment code.</span></span> <span data-ttu-id="04b05-115">次に、セグメントの繰り返しのレベルと発生頻度を示す条件コンポーネント データ要素が続きます。</span><span class="sxs-lookup"><span data-stu-id="04b05-115">It will be followed by conditional component data elements indicating both the level and the incidence of repetition of the segment.</span></span> <span data-ttu-id="04b05-116">この目的で使用されるコンポーネント データ要素の数は、メッセージの構造においてセグメントが表示される階層レベルによって決まります。</span><span class="sxs-lookup"><span data-stu-id="04b05-116">The number of component data elements used for this purpose depends upon the hierarchical level in which the segment appears in the message structure.</span></span> <span data-ttu-id="04b05-117">セグメントがレベル 1 に表示される場合は、セグメント コードの直後のコンポーネント データ要素が使用されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-117">If the segment is to appear at level one, the component data element immediately following the segment code will be used.</span></span> <span data-ttu-id="04b05-118">セグメントがレベル 2 に表示される場合は、セグメント コードの直後のコンポーネント データ要素とその次のコンポーネント データ要素が使用されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-118">If the segment is to appear at level two, the component data element immediately following the segment code and the next component data element will both be used.</span></span> <span data-ttu-id="04b05-119">セグメントがレベル 3 に表示される場合は、セグメント コードの直後にある 3 つのコンポーネント データ要素が使用されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-119">If the segment is to appear at level three, the three component data elements following the segment code will be used.</span></span> <span data-ttu-id="04b05-120">パイプラインでは、データを階層と比較して構造的な検証を行うことができません。</span><span class="sxs-lookup"><span data-stu-id="04b05-120">Pipelines cannot perform structural verification comparing data to hierarchy.</span></span>  
  
-   <span data-ttu-id="04b05-121">暗黙的な入れ子では、メッセージ構造で指定されたセグメントの順序が厳密に守られます。</span><span class="sxs-lookup"><span data-stu-id="04b05-121">In Implicit nesting, the order of the segments specified in the message structure is strictly followed.</span></span> <span data-ttu-id="04b05-122">セグメント間の入れ子関係は暗黙的に明らかであり、処理の実行のために入れ子関係を明示的に示す必要はありません。</span><span class="sxs-lookup"><span data-stu-id="04b05-122">The nesting relationship between the segments is implicitly evident and no further indication is required for processing.</span></span>  
  
## <a name="loops"></a><span data-ttu-id="04b05-123">ループ</span><span class="sxs-lookup"><span data-stu-id="04b05-123">Loops</span></span>  
 <span data-ttu-id="04b05-124">1 つまたは複数のセグメントとして繰り返すことができます、**ループ**トランザクション内に設定します。</span><span class="sxs-lookup"><span data-stu-id="04b05-124">One or more segment can repeat as a **loop** inside a transaction set.</span></span> <span data-ttu-id="04b05-125">ループの 2 つの種類があります: 制限および制限します。</span><span class="sxs-lookup"><span data-stu-id="04b05-125">There are two distinct types of loops: unbounded and bounded.</span></span>  
  
### <a name="unbounded-loops"></a><span data-ttu-id="04b05-126">境界のないループ</span><span class="sxs-lookup"><span data-stu-id="04b05-126">Unbounded Loops</span></span>  
 <span data-ttu-id="04b05-127">境界のないループには、ループの開始と終了を示す一意の識別セグメントがありません。</span><span class="sxs-lookup"><span data-stu-id="04b05-127">An unbounded loop does not have a unique identifying segment to mark the beginning and end of the loop.</span></span> <span data-ttu-id="04b05-128">境界のないループは、カウントに従って繰り返されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-128">An unbounded loop repeats according to a count.</span></span> <span data-ttu-id="04b05-129">カウントの値が設定されていない場合、ループは 2 回繰り返されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-129">If the count does not have a value, the loop will repeat twice.</span></span> <span data-ttu-id="04b05-130">ループ内の各セグメントは、指定された順序で 1 回だけ出現できます。</span><span class="sxs-lookup"><span data-stu-id="04b05-130">Each segment in the loop can occur only once in a specified order.</span></span>  
  
 <span data-ttu-id="04b05-131">境界のないループの開始は、一意である最初のデータ要素によって設定されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-131">The start of an unbounded loop is established by a first data element that is unique.</span></span> <span data-ttu-id="04b05-132">最初の要素は、各発生箇所で 1 回だけ出現できます。</span><span class="sxs-lookup"><span data-stu-id="04b05-132">The first element can appear once and only once in each occurrence.</span></span> <span data-ttu-id="04b05-133">境界のないループは、ループ内に入れ子にできます。入れ子にした場合、内側の境界のないループは、外側のループと同じ序数位置で開始できず、外側のループと同じセグメント ID で開始できません。</span><span class="sxs-lookup"><span data-stu-id="04b05-133">Unbounded loops can be nested within loops; if so, the inner unbounded loop cannot start at the same ordinal position as any outer loop and cannot start with the same segment ID as any outer loop.</span></span> <span data-ttu-id="04b05-134">入れ子になったループは、同じ入れ子構造で外側のループの開始セグメントであるセグメントを含むことができません。</span><span class="sxs-lookup"><span data-stu-id="04b05-134">The nested loop cannot contain a segment that is also the beginning segment of any outer loop in the same nesting structure.</span></span>  
  
### <a name="bounded-loops"></a><span data-ttu-id="04b05-135">境界のあるループ</span><span class="sxs-lookup"><span data-stu-id="04b05-135">Bounded Loops</span></span>  
 <span data-ttu-id="04b05-136">境界のあるループは、定義済みセグメントの LS (ループ開始) で始まり、定義済みセグメントの LE (ループ終了) で終わります。</span><span class="sxs-lookup"><span data-stu-id="04b05-136">A bounded loop starts with the predefined segment LS (Loop Start) and ends with the predefined segment LE (Loop End).</span></span> <span data-ttu-id="04b05-137">LS セグメントが省略可能かどうかの指定は、ループ内の最初のセグメントと一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="04b05-137">The optionality of the LS segment must match that of the first segment in the loop.</span></span> <span data-ttu-id="04b05-138">境界のあるループは、別の境界のあるループを含むことができます。</span><span class="sxs-lookup"><span data-stu-id="04b05-138">A bounded loop can contain another bounded loop.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="04b05-139">X12 における境界のあるループと EDIFACT における明示的なループは同じものを指します。</span><span class="sxs-lookup"><span data-stu-id="04b05-139">A bounded loop in X12 and an explicit loop in EDIFACT are equivalent.</span></span>  
  
 <span data-ttu-id="04b05-140">ループでは、あいまいさを解決するのにバインドが使用されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-140">Binding is used in a loop to resolve ambiguity.</span></span> <span data-ttu-id="04b05-141">LS/LE セグメントの要件指定子は、ループの最初のセグメントの要件指定子と一致します。</span><span class="sxs-lookup"><span data-stu-id="04b05-141">The requirement designator on the LS/LE segments matches the requirement designator of the first segment of the loop.</span></span> <span data-ttu-id="04b05-142">バインドによって、よく繰り返される特定のセグメントの使用に課せられる構造的な制約が緩和されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-142">Binding loosens structural restrictions imposed on the usage of certain commonly repeating segments.</span></span> <span data-ttu-id="04b05-143">境界のあるループには、開始セグメント ID についての制約がありません。</span><span class="sxs-lookup"><span data-stu-id="04b05-143">Bounded segments have no restrictions with respect to the beginning segment ID.</span></span> <span data-ttu-id="04b05-144">これにより、次の例のように、同じセグメントを、境界のあるループの開始で使用すると同時に、ループの外側でも使用することができます。</span><span class="sxs-lookup"><span data-stu-id="04b05-144">This enables the same segment to start a bounded loop and be used outside of the loop, as in the following example:</span></span>  
  
```  
AA  
LS  
BB  
CC  
LE  
BB  
```  
  
 <span data-ttu-id="04b05-145">下位のループ (ループ内のループ) を使用できます。</span><span class="sxs-lookup"><span data-stu-id="04b05-145">Subordinate loops (loops within loops) are allowed.</span></span> <span data-ttu-id="04b05-146">境界のあるループがループ内で入れ子にされている場合、内側のループは外側のループと同じ序数位置で開始できません。</span><span class="sxs-lookup"><span data-stu-id="04b05-146">If bounded loops are nested within loops, the inner loop cannot start at the same ordinal position as any outer loop.</span></span> <span data-ttu-id="04b05-147">内側の境界のあるループは、そのすぐ外側のループより前に終了する必要があります。</span><span class="sxs-lookup"><span data-stu-id="04b05-147">The inner bounded loop must end before the immediate outer loop.</span></span>  
  
 <span data-ttu-id="04b05-148">トランザクション セット内の境界のあるループにそれぞれ 1 ～ 4 文字の大文字または数字から成る一意の <loop_id> 値を割り当てる必要があります。</span><span class="sxs-lookup"><span data-stu-id="04b05-148">Each bounded loop within a transaction set must have a uniquely defined <loop_id> value of one to four uppercase letters or numeric digits.</span></span> <span data-ttu-id="04b05-149">対応する LS セグメントと LE セグメントの <loop_id> 値に同じ一意の値を割り当てることを推奨します。</span><span class="sxs-lookup"><span data-stu-id="04b05-149">It is recommended that the corresponding LS and LE segments contain the same unique <loop_id> value.</span></span> <span data-ttu-id="04b05-150">< Loop_id > データ要素は、データ型、最小/最大長、フィールドなどの検証し、「標準」のデータ要素として処理されます。(LS および LE) 経由でクロス セグメント検証は行われません。BizTalk Server は、LS および LE セグメントが存在するかどうかのみに基づいてあいまいさの解決を検証します。</span><span class="sxs-lookup"><span data-stu-id="04b05-150">The <loop_id> data element will be processed as a “regular” data element and validated for data type, min/max length, optionality, etc. Cross-segment validation (across LS and LE) will not be carried out. BizTalk Server will verify ambiguity resolution via the presence of the LS and LE segment and nothing else.</span></span> <span data-ttu-id="04b05-151">データ要素の規則に違反する場合、トランザクション セットはエラーありで受理され、BizTalk Server からの ACK では AK501=E および該当する評価が AK2/AK3 で返されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-151">In the case of data-element rule violation, the transaction set is accepted with errors, and BizTalk Server returns AK501=E and the appropriate valuation in AK2/AK3 in the ACK.</span></span>  
  
 <span data-ttu-id="04b05-152">LS/LE セグメントの組み合わせを強制することも必要です。</span><span class="sxs-lookup"><span data-stu-id="04b05-152">It is also required that pairing of LS/LE segments is enforced.</span></span> <span data-ttu-id="04b05-153">一致しない場合、トランザクション セットは内在するあいまいさ解決の問題が理由で拒否され、イベント ビューアーおよび 997 ACK では AK501 = E と AK502 = 5 が返されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-153">In case of a mismatch, the transaction set is rejected due to an inherent ambiguity resolution issue, and AK501 = E and AK502 = 5 are returned in the Event Viewer and the 997 ACK.</span></span> <span data-ttu-id="04b05-154">LS/LE セグメントのどちらか一方または両方がなく、トランザクション セットがあいまいでない場合、トランザクション セットはエラーありで受理され、AK501 = E と AK502 = 5 が返されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-154">When  either or both LS/LE segments are missing, but the transaction set is not ambiguous, the transaction set will be accepted with errors, and AK501=E and AK502 = 5 returned.</span></span>  
  
 <span data-ttu-id="04b05-155">LS/LE の組み合わせは、省略可能または必須にできます。</span><span class="sxs-lookup"><span data-stu-id="04b05-155">An LS/LE pair can be optional or mandatory.</span></span> <span data-ttu-id="04b05-156">ただし、この組み合わせは、繰り返し可能な上位のループに含まれていない場合は繰り返し可能ではありません。</span><span class="sxs-lookup"><span data-stu-id="04b05-156">However, unless the pair is contained in a parent loop that is repeatable, the pair can never be repeatable.</span></span> <span data-ttu-id="04b05-157">どちらの場合も、LS/LE の組み合わせの MaxOccurs は両方とも 1 にできますが、1 より大きくすることはできません。これは、スキーマの検証で強制されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-157">In either case, both MaxOccurs for an LS/LE pair can be 1, but not greater than 1.This is enforced in schema validation.</span></span>  
  
 <span data-ttu-id="04b05-158">LS および LE セグメントは、EDI 逆アセンブラーと EDI アセンブラーで処理されます。</span><span class="sxs-lookup"><span data-stu-id="04b05-158">The EDI Disassembler and EDI Assembler handle LS and LE segments.</span></span> <span data-ttu-id="04b05-159">解析中、逆アセンブラーは LS および LE セグメントの XML ノードを作成し、これらのセグメントを検証します。</span><span class="sxs-lookup"><span data-stu-id="04b05-159">During parsing, the Disassembler created XML nodes for the LS and LE segments, and validates the segments.</span></span> <span data-ttu-id="04b05-160">シリアル化中、アセンブラーは XML ノードから LS および LE セグメントを作成し、これらのセグメントを検証します。</span><span class="sxs-lookup"><span data-stu-id="04b05-160">During serializing, the Assembler creates the LS and LE segments from XML nodes, and validates them.</span></span> <span data-ttu-id="04b05-161">必要な ls または LE セグメントが不足している場合、トランザクション セットは AK501 で中断/拒否 = E と AK502 = 5。</span><span class="sxs-lookup"><span data-stu-id="04b05-161">If an expected LS or LE segment is missing, the transaction set is suspended/rejected with an AK501 = E and AK502 = 5.</span></span> <span data-ttu-id="04b05-162">LS/LE セグメントが存在せず、対応するデータ要素と、EDI 検証が有効になっている、トランザクション セットは受け入れられますエラーと、AK501 = E と AK502 = 5 は、イベント ビューアーおよび 997 で報告される確認</span><span class="sxs-lookup"><span data-stu-id="04b05-162">If LS/LE segments are present without corresponding data element, and EDI validation is enabled, the transaction set is accepted with errors and AK501 = E and AK502 = 5 are reported in the Event Viewer and the 997 ACK.</span></span>