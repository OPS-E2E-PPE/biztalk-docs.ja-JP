---
title: プログラムによって、ファイルを作成する受信場所または送信ポート |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 558a414c-60bc-4f62-9397-a023ed4937fb
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: af6365c640cbc51053d02822141915cbd4cad828
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2017
ms.locfileid: "25973006"
---
# <a name="programmatically-create-the-file-receive-location-or-send-port"></a><span data-ttu-id="9f508-102">プログラムによって、ファイルを作成する受信場所または送信ポート</span><span class="sxs-lookup"><span data-stu-id="9f508-102">Programmatically create the File receive location or send port</span></span>
<span data-ttu-id="9f508-103">ファイルを作成する方法は、受信ポートと、プログラムでポートを送信します。</span><span class="sxs-lookup"><span data-stu-id="9f508-103">How to create a File receive port and send port programmatically.</span></span> <span data-ttu-id="9f508-104">使用する、[!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)]に進み、[ファイル アダプターを構成する](../core/configure-the-file-adapter.md)です。</span><span class="sxs-lookup"><span data-stu-id="9f508-104">To use the [!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)], go to [Configure the File adapter](../core/configure-the-file-adapter.md).</span></span>

<span data-ttu-id="9f508-105">ファイル アダプターは、その構成情報を SSO データベースに格納します。</span><span class="sxs-lookup"><span data-stu-id="9f508-105">The File adapter stores its configuration information in the SSO database.</span></span> <span data-ttu-id="9f508-106">受信場所を構成し、オブジェクト モデルを BizTalk エクスプ ローラーを使用してプログラムからのポートに送信できます。</span><span class="sxs-lookup"><span data-stu-id="9f508-106">You can configure the receive locations and send ports programmatically using the BizTalk Explorer object model.</span></span> 
 
## <a name="create-the-receive-location"></a><span data-ttu-id="9f508-107">受信場所を作成します。</span><span class="sxs-lookup"><span data-stu-id="9f508-107">Create the receive location</span></span>

<span data-ttu-id="9f508-108">BizTalk エクスプ ローラー オブジェクト モデルは、公開、**という**構成インターフェイスを含む、 **TransportTypeData**読み取り/書き込みプロパティです。</span><span class="sxs-lookup"><span data-stu-id="9f508-108">The BizTalk Explorer object model exposes the **IReceiveLocation** configuration interface that contains the **TransportTypeData** read/write property.</span></span> <span data-ttu-id="9f508-109">このプロパティでは、名前と値の組の XML 文字列の形式で、ファイルの受信場所の構成プロパティ バッグを指定できます。</span><span class="sxs-lookup"><span data-stu-id="9f508-109">This property accepts the File receive location configuration property bag in the form of a name/value pair XML string.</span></span>  
  
<span data-ttu-id="9f508-110">**TransportTypeData**のプロパティ、**という**インターフェイスを設定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="9f508-110">The **TransportTypeData** property of the **IReceiveLocation** interface does not have to be set.</span></span> <span data-ttu-id="9f508-111">このプロパティを設定しない場合、ファイルの受信場所の構成の既定値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-111">If it is not set, default values for the File receive location configuration are used.</span></span>  
  
 <span data-ttu-id="9f508-112">次の表に、ファイルの受信場所をプログラムから設定できる構成プロパティを示します。</span><span class="sxs-lookup"><span data-stu-id="9f508-112">The following table lists the configuration properties that you can set programmatically for the File receive location.</span></span>  
  
|<span data-ttu-id="9f508-113">プロパティ名</span><span class="sxs-lookup"><span data-stu-id="9f508-113">Property name</span></span>|<span data-ttu-id="9f508-114">型</span><span class="sxs-lookup"><span data-stu-id="9f508-114">Type</span></span>|<span data-ttu-id="9f508-115">Description</span><span class="sxs-lookup"><span data-stu-id="9f508-115">Description</span></span>|<span data-ttu-id="9f508-116">制限</span><span class="sxs-lookup"><span data-stu-id="9f508-116">Restrictions</span></span>|<span data-ttu-id="9f508-117">コメント</span><span class="sxs-lookup"><span data-stu-id="9f508-117">Comments</span></span>|  
|-------------------|----------|-----------------|------------------|--------------|  
|<span data-ttu-id="9f508-118">**FileNetFailRetryCount**</span><span class="sxs-lookup"><span data-stu-id="9f508-118">**FileNetFailRetryCount**</span></span>|<span data-ttu-id="9f508-119">Long</span><span class="sxs-lookup"><span data-stu-id="9f508-119">Long</span></span>|<span data-ttu-id="9f508-120">ネットワーク共有上の受信場所が一時的に使用できない場合に、アクセスを試行する回数。</span><span class="sxs-lookup"><span data-stu-id="9f508-120">The number of attempts to access the receive location on the network share if it is temporarily unavailable.</span></span>|<span data-ttu-id="9f508-121">Integer</span><span class="sxs-lookup"><span data-stu-id="9f508-121">Integer</span></span><br /><br /> <span data-ttu-id="9f508-122">最小値: 0</span><span class="sxs-lookup"><span data-stu-id="9f508-122">Minimum value: 0</span></span><br /><br /> <span data-ttu-id="9f508-123">最大値: MAX_LONG</span><span class="sxs-lookup"><span data-stu-id="9f508-123">Maximum value: MAX_LONG</span></span>|<span data-ttu-id="9f508-124">値を指定しない場合は、既定値 5 回が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-124">If not specified, the default value is set to 5 times.</span></span>|  
|<span data-ttu-id="9f508-125">**FileNetFailRetryInterval**</span><span class="sxs-lookup"><span data-stu-id="9f508-125">**FileNetFailRetryInterval**</span></span>|<span data-ttu-id="9f508-126">Long</span><span class="sxs-lookup"><span data-stu-id="9f508-126">Long</span></span>|<span data-ttu-id="9f508-127">ネットワーク共有上の受信場所が一時的に使用できない場合に、アクセスを再試行する分単位の時間間隔。</span><span class="sxs-lookup"><span data-stu-id="9f508-127">The retry interval in minutes between attempts to access the receive location on the network share if it is temporarily unavailable.</span></span>|<span data-ttu-id="9f508-128">Integer</span><span class="sxs-lookup"><span data-stu-id="9f508-128">Integer</span></span><br /><br /> <span data-ttu-id="9f508-129">Minimumvalue: 0</span><span class="sxs-lookup"><span data-stu-id="9f508-129">Minimumvalue: 0</span></span><br /><br /> <span data-ttu-id="9f508-130">最大値: MAX_LONG</span><span class="sxs-lookup"><span data-stu-id="9f508-130">Maximum value: MAX_LONG</span></span>|<span data-ttu-id="9f508-131">値を指定しない場合は、既定値 5 分が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-131">If not specified, the default value is set to 5 minutes.</span></span>|  
|<span data-ttu-id="9f508-132">**BatchSize**</span><span class="sxs-lookup"><span data-stu-id="9f508-132">**BatchSize**</span></span>|<span data-ttu-id="9f508-133">Long</span><span class="sxs-lookup"><span data-stu-id="9f508-133">Long</span></span>|<span data-ttu-id="9f508-134">この受信場所がサーバーに一度に送信できるファイルの数。</span><span class="sxs-lookup"><span data-stu-id="9f508-134">The number of files this receive location can submit to the server at one time.</span></span>|<span data-ttu-id="9f508-135">Integer</span><span class="sxs-lookup"><span data-stu-id="9f508-135">Integer</span></span><br /><br /> <span data-ttu-id="9f508-136">最小値: 1</span><span class="sxs-lookup"><span data-stu-id="9f508-136">Minimum value: 1</span></span><br /><br /> <span data-ttu-id="9f508-137">最大値: 256</span><span class="sxs-lookup"><span data-stu-id="9f508-137">Maximum value: 256</span></span>|<span data-ttu-id="9f508-138">値を指定しない場合は、既定値 20 ファイルが使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-138">If not specified, the default value is set to 20 files.</span></span>|  
|<span data-ttu-id="9f508-139">**FileMask**</span><span class="sxs-lookup"><span data-stu-id="9f508-139">**FileMask**</span></span>|<span data-ttu-id="9f508-140">文字列</span><span class="sxs-lookup"><span data-stu-id="9f508-140">String</span></span>|<span data-ttu-id="9f508-141">受信場所で使用するファイル マスク。</span><span class="sxs-lookup"><span data-stu-id="9f508-141">The file mask used by the receive location.</span></span>|<span data-ttu-id="9f508-142">文字列</span><span class="sxs-lookup"><span data-stu-id="9f508-142">String</span></span><br /><br /> <span data-ttu-id="9f508-143">FilePath と FileMask を組み合わせた長さは 256 文字以下にしてください。</span><span class="sxs-lookup"><span data-stu-id="9f508-143">The length of the FilePath and FileMask combined cannot exceed 256 characters.</span></span>|<span data-ttu-id="9f508-144">値を指定しない場合は、既定値 \*.xml が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-144">If not specified, the default value is set to \*.xml.</span></span>|  
|<span data-ttu-id="9f508-145">**FilePath**</span><span class="sxs-lookup"><span data-stu-id="9f508-145">**FilePath**</span></span>|<span data-ttu-id="9f508-146">文字列</span><span class="sxs-lookup"><span data-stu-id="9f508-146">String</span></span>|<span data-ttu-id="9f508-147">受信場所で監視するフォルダーのパス。</span><span class="sxs-lookup"><span data-stu-id="9f508-147">The path of the folder monitored by the receive location.</span></span>|<span data-ttu-id="9f508-148">文字列</span><span class="sxs-lookup"><span data-stu-id="9f508-148">String</span></span><br /><br /> <span data-ttu-id="9f508-149">必須</span><span class="sxs-lookup"><span data-stu-id="9f508-149">Required</span></span><br /><br /> <span data-ttu-id="9f508-150">FilePath と FileMask を組み合わせた長さは 256 文字以下にしてください。</span><span class="sxs-lookup"><span data-stu-id="9f508-150">The length of the FilePath and FileMask combined cannot exceed 256 characters.</span></span>|<span data-ttu-id="9f508-151">指定する必要があります**重要:** ファイル フォルダーを作成した受信場所は、受信場所で構成された受信ハンドラー資格情報の書き込みアクセス許可を持っていなければなりません。</span><span class="sxs-lookup"><span data-stu-id="9f508-151">Must be specified **Important:**  The file folder created for the receive location must have write permission for the receive handler credentials configured on the receive location.</span></span>|  
|<span data-ttu-id="9f508-152">**ユーザー名**</span><span class="sxs-lookup"><span data-stu-id="9f508-152">**Username**</span></span>|<span data-ttu-id="9f508-153">文字列</span><span class="sxs-lookup"><span data-stu-id="9f508-153">String</span></span>|<span data-ttu-id="9f508-154">フォルダーへのアクセスに使用するアカウントのユーザー名。</span><span class="sxs-lookup"><span data-stu-id="9f508-154">User name for account used to access folder.</span></span>|<span data-ttu-id="9f508-155">最小の長さ: 0</span><span class="sxs-lookup"><span data-stu-id="9f508-155">Min length: 0</span></span><br /><br /> <span data-ttu-id="9f508-156">最大長: 256</span><span class="sxs-lookup"><span data-stu-id="9f508-156">Max length: 256</span></span>|<span data-ttu-id="9f508-157">ユーザー名とパスワードをどちらも指定しない場合、ホストの資格情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-157">If neither username or password are specified, host credentials are used.</span></span><br /><br /> <span data-ttu-id="9f508-158">Null (vt="1") の場合、構成データベースに格納された値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-158">If null (vt=”1”) then the value stored in configuration database is used.</span></span>|  
|<span data-ttu-id="9f508-159">**Password**</span><span class="sxs-lookup"><span data-stu-id="9f508-159">**Password**</span></span>|<span data-ttu-id="9f508-160">文字列</span><span class="sxs-lookup"><span data-stu-id="9f508-160">String</span></span>|<span data-ttu-id="9f508-161">フォルダーへのアクセスに使用するアカウントのパスワード。</span><span class="sxs-lookup"><span data-stu-id="9f508-161">Password for account used to access folder.</span></span>|<span data-ttu-id="9f508-162">最小の長さ: 0</span><span class="sxs-lookup"><span data-stu-id="9f508-162">Min length: 0</span></span><br /><br /> <span data-ttu-id="9f508-163">最大長: 256</span><span class="sxs-lookup"><span data-stu-id="9f508-163">Max length: 256</span></span>|<span data-ttu-id="9f508-164">ユーザー名とパスワードをどちらも指定しない場合、ホストの資格情報が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-164">If neither username or password are specified, host credentials are used.</span></span><br /><br /> <span data-ttu-id="9f508-165">Null (vt="1") の場合、構成データベースに格納された値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-165">If null (vt=”1”) then the value stored in configuration database is used.</span></span>|  
  
 <span data-ttu-id="9f508-166">次のコード例は、プロパティの設定に使用する XML 文字列の形式を示しています。</span><span class="sxs-lookup"><span data-stu-id="9f508-166">The following code shows the format of the XML string you use to set the properties:</span></span>  
  
```  
<CustomProps>  
   <FilePath vt="8">C:\Temp</FilePath>  
   <BatchSize vt="19">20</BatchSize>  
   <FileMask vt="8">*.xml</FileMask>  
   <FileNetFailRetryCount vt="19">5</FileNetFailRetryCount>  
   <FileNetFailRetryInterval vt="19">5</FileNetFailRetryInterval>  
   <Username vt=”8”>MyDomain\MyUsername</Username>  
   <Password vt=”8”>PASSWORD</Password>  
</CustomProps>  
  
```  

## <a name="create-the-send-port"></a><span data-ttu-id="9f508-167">送信ポートを作成します。</span><span class="sxs-lookup"><span data-stu-id="9f508-167">Create the send port</span></span>

<span data-ttu-id="9f508-168">構成情報はカスタム XML プロパティ バッグに保存されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-168">Configuration information is stored in a custom XML property bag.</span></span> <span data-ttu-id="9f508-169">`bts_file_properties.xsd`ファイル送信ハンドラのプロパティ スキーマは、ファイル アダプターに固有のプロパティを定義します。</span><span class="sxs-lookup"><span data-stu-id="9f508-169">The `bts_file_properties.xsd` File send handler property schema defines the File adapter-specific properties.</span></span> <span data-ttu-id="9f508-170">これらのプロパティは、サーバー内のアダプタ固有の情報を渡すためだけでなく、ファイル送信ポートを構成する場合にも使用します。</span><span class="sxs-lookup"><span data-stu-id="9f508-170">You use these properties to configure the File send ports, as well as for passing adapter-specific information within the server.</span></span>  
  
<span data-ttu-id="9f508-171">BizTalk エクスプ ローラー オブジェクト モデルは、公開、 **ITransportInfo**が含まれているファイル送信ポートのアダプターの構成インターフェイス、 **TransportTypeData**読み取り/書き込みプロパティです。</span><span class="sxs-lookup"><span data-stu-id="9f508-171">The BizTalk Explorer object model exposes the **ITransportInfo** adapter configuration interface for File send ports, which contains the **TransportTypeData** read/write property.</span></span> <span data-ttu-id="9f508-172">このプロパティでは、名前と値の組の XML 文字列の形式でファイル送信ハンドラの構成プロパティ バッグを指定できます。</span><span class="sxs-lookup"><span data-stu-id="9f508-172">This property accepts the File send handler configuration property bag as a name/value pair XML string.</span></span>  
  
 <span data-ttu-id="9f508-173">設定、 **TransportTypeData**のプロパティ、 **ITransportInfo**インターフェイスは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="9f508-173">Setting the **TransportTypeData** property of the **ITransportInfo** interface is not required.</span></span> <span data-ttu-id="9f508-174">このプロパティを設定しない場合、ファイル送信ハンドラの構成の既定値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-174">If it is not set, the default values for the File send handler configuration are used.</span></span>  
  
 <span data-ttu-id="9f508-175">次の表に、BizTalk エクスプローラ オブジェクト モデルでファイル送信ハンドラの場所をプログラムから設定できる構成プロパティを示します。</span><span class="sxs-lookup"><span data-stu-id="9f508-175">The following table lists the configuration properties you can set programmatically in the BizTalk Explorer object model for the File send handler location.</span></span>  
  
|<span data-ttu-id="9f508-176">プロパティ名</span><span class="sxs-lookup"><span data-stu-id="9f508-176">Property name</span></span>|<span data-ttu-id="9f508-177">型</span><span class="sxs-lookup"><span data-stu-id="9f508-177">Type</span></span>|<span data-ttu-id="9f508-178">Description</span><span class="sxs-lookup"><span data-stu-id="9f508-178">Description</span></span>|  
|-------------------|----------|-----------------|  
|<span data-ttu-id="9f508-179">**CopyMode**</span><span class="sxs-lookup"><span data-stu-id="9f508-179">**CopyMode**</span></span>|<span data-ttu-id="9f508-180">Long</span><span class="sxs-lookup"><span data-stu-id="9f508-180">Long</span></span>|<span data-ttu-id="9f508-181">ファイルにメッセージを書き込むときに使用するコピー モードを定義します。</span><span class="sxs-lookup"><span data-stu-id="9f508-181">Define the copy mode to use when writing a message to a file.</span></span> <span data-ttu-id="9f508-182">有効な値は、</span><span class="sxs-lookup"><span data-stu-id="9f508-182">Valid values are:</span></span><br /><br /> <span data-ttu-id="9f508-183">**(0) を追加します。**</span><span class="sxs-lookup"><span data-stu-id="9f508-183">**Append (0).**</span></span> <span data-ttu-id="9f508-184">ファイルが存在する場合は、ファイル送信ハンドラがファイルを開き、ファイルの末尾にメッセージを追加します。</span><span class="sxs-lookup"><span data-stu-id="9f508-184">The File send handler opens a file if it exists and appends a message to the end of the file.</span></span> <span data-ttu-id="9f508-185">ファイルが存在しない場合は、ファイル送信ハンドラが新しいファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="9f508-185">If the file does not exist, the File send handler creates a new file.</span></span><br /><br /> <span data-ttu-id="9f508-186">**新しい (1) を作成します。**</span><span class="sxs-lookup"><span data-stu-id="9f508-186">**Create new (1).**</span></span> <span data-ttu-id="9f508-187">: ファイルが存在しない場合は、ファイル送信ハンドラが新しいファイルを作成し、そのファイルにメッセージを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="9f508-187">If the file does not exist, the File send handler creates a new file and writes to it.</span></span> <span data-ttu-id="9f508-188">ファイルが存在する場合は、ファイル送信ハンドラがエラーを報告し、送信ポートの通常のアダプタ再試行ロジックに従ってメッセージを処理します。</span><span class="sxs-lookup"><span data-stu-id="9f508-188">If the file already exists, the File send handler reports an error and then follows common adapter retry logic for send ports.</span></span> <span data-ttu-id="9f508-189">これはファイル送信ハンドラの既定のコピー モードです。</span><span class="sxs-lookup"><span data-stu-id="9f508-189">This is a default copy mode for the File send handler.</span></span><br /><br /> <span data-ttu-id="9f508-190">**(2) を上書きします。**</span><span class="sxs-lookup"><span data-stu-id="9f508-190">**Overwrite (2).**</span></span> <span data-ttu-id="9f508-191">ファイルが存在する場合は、ファイル送信ハンドラがファイルを開き、ファイルの内容を上書きします。</span><span class="sxs-lookup"><span data-stu-id="9f508-191">The File send handler opens a file if it exists and overwrites its content.</span></span> <span data-ttu-id="9f508-192">ファイルが存在しない場合は、ファイル送信ハンドラが新しいファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="9f508-192">If the file does not exist, the File send handler creates a new file.</span></span>|  
|<span data-ttu-id="9f508-193">**AllowCacheOnWrite**</span><span class="sxs-lookup"><span data-stu-id="9f508-193">**AllowCacheOnWrite**</span></span>|<span data-ttu-id="9f508-194">ブール値</span><span class="sxs-lookup"><span data-stu-id="9f508-194">Boolean</span></span>|<span data-ttu-id="9f508-195">ファイルにメッセージを書き込む際にファイル アダプタでファイル システム キャッシュを使用するかどうかを定義します。</span><span class="sxs-lookup"><span data-stu-id="9f508-195">Defines whether the File adapter uses file system caching when writing messages to a file.</span></span><br /><br /> <span data-ttu-id="9f508-196">有効な値は、</span><span class="sxs-lookup"><span data-stu-id="9f508-196">Valid values are:</span></span><br /><br /> <span data-ttu-id="9f508-197">**True (-1)** : ファイル アダプタは、出力ファイルに書き込む際にファイル システム キャッシュを使用します。</span><span class="sxs-lookup"><span data-stu-id="9f508-197">**True (-1)** The File adapter uses file system caching when writing the output file.</span></span><br /><br /> <span data-ttu-id="9f508-198">**False (0)** ファイル送信ハンドラは出力ファイルに書き込む際にファイル システム キャッシュを使用していません。</span><span class="sxs-lookup"><span data-stu-id="9f508-198">**False (0)** The File send handler does not use file system caching when writing the output file.</span></span>|  
|<span data-ttu-id="9f508-199">**書き込み中に一時ファイルを使用します。**</span><span class="sxs-lookup"><span data-stu-id="9f508-199">**Use temporary file while writing**</span></span>|<span data-ttu-id="9f508-200">ブール値</span><span class="sxs-lookup"><span data-stu-id="9f508-200">Boolean</span></span>|<span data-ttu-id="9f508-201">最初に一時ファイルに出力ファイルの書き込みし、書き込み操作が完了し、ファイルの名前かどうかを定義します。</span><span class="sxs-lookup"><span data-stu-id="9f508-201">Defines whether to write the output file to a temporary file first and then rename the file once the write operation has completed.</span></span> <span data-ttu-id="9f508-202">このオプションが有効になっているかどうかは、拡張子を持つ一時ファイルを作成、 **BTS-WIP**です。</span><span class="sxs-lookup"><span data-stu-id="9f508-202">If this option is enabled then the temporary file will be created with the extension **BTS-WIP**.</span></span><br /><br /> <span data-ttu-id="9f508-203">有効な値は、</span><span class="sxs-lookup"><span data-stu-id="9f508-203">Valid values are:</span></span><br /><br /> <span data-ttu-id="9f508-204">**True (-1)** : ファイル アダプタはターゲット フォルダに書き込むときに一時ファイルを作成します。</span><span class="sxs-lookup"><span data-stu-id="9f508-204">**True (-1)** The File adapter creates a temporary file when writing to the target folder.</span></span><br /><br /> <span data-ttu-id="9f508-205">**False (0)** : ファイル アダプタはターゲット フォルダに書き込むときに一時ファイルを作成できません。</span><span class="sxs-lookup"><span data-stu-id="9f508-205">**False (0)** The File adapter does not create a temporary file when writing to the target folder.</span></span> <span data-ttu-id="9f508-206">**注:** ときにこのオプションは利用できるのみ、 **CopyMode**の値に設定されて**新しい (1) を作成する**です。</span><span class="sxs-lookup"><span data-stu-id="9f508-206">**Note:**  This option is only available when the **CopyMode** property is set to a value of **Create new (1)**.</span></span>|  
  
 <span data-ttu-id="9f508-207">いずれの構成プロパティもメッセージ コンテキストに値がない場合は、ファイル送信ハンドラでは、既定値が使用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-207">If any of the configuration properties do not have a value on the message context, the File send handler uses its default value.</span></span>  
  
 <span data-ttu-id="9f508-208">構成プロパティは、メッセージ コンテキストでプログラムによって設定できます。</span><span class="sxs-lookup"><span data-stu-id="9f508-208">You can set configuration properties programmatically on a message context.</span></span> <span data-ttu-id="9f508-209">これらのプロパティは、オーケストレーションまたはカスタム パイプライン コンポーネントで設定できます。</span><span class="sxs-lookup"><span data-stu-id="9f508-209">You can set these properties in an orchestration or in a custom pipeline component.</span></span> <span data-ttu-id="9f508-210">プロパティを使用するときは、次の規則が適用されます。</span><span class="sxs-lookup"><span data-stu-id="9f508-210">The following rules apply when using these properties:</span></span>  
  
-   <span data-ttu-id="9f508-211">構成プロパティがオーケストレーション、または受信パイプラインのカスタム パイプライン コンポーネントで設定されているとき</span><span class="sxs-lookup"><span data-stu-id="9f508-211">If the configuration property is set in an orchestration or in a custom pipeline component in a receive pipeline, then:</span></span>  
  
    -   <span data-ttu-id="9f508-212">メッセージが送信された場合は、静的な送信ポート、プロパティの値は、その送信ポート用に構成された値で上書きされます。</span><span class="sxs-lookup"><span data-stu-id="9f508-212">If a message is sent to a static send port, the property value will be overwritten with the value configured for that send port.</span></span>  
  
    -   <span data-ttu-id="9f508-213">動的送信ポートにメッセージを送信する場合、プロパティの値は上書きされません。</span><span class="sxs-lookup"><span data-stu-id="9f508-213">If a message is sent to a dynamic send port, the property value will not be overwritten.</span></span>  
  
-   <span data-ttu-id="9f508-214">構成プロパティが設定されている場合、送信パイプラインのカスタム パイプライン コンポーネントでし。</span><span class="sxs-lookup"><span data-stu-id="9f508-214">If a configuration property is set in a custom pipeline component in a send pipeline, then:</span></span>  
  
    -   <span data-ttu-id="9f508-215">メッセージを送信する送信ポートが静的か動的かにかかわらず、プロパティ値は上書きされません。</span><span class="sxs-lookup"><span data-stu-id="9f508-215">The value will not be overwritten regardless of whether the message is sent to a static or dynamic send port.</span></span>  
  
 <span data-ttu-id="9f508-216">次のコード例は、プロパティの設定に使用できる XML 文字列の形式を示しています。</span><span class="sxs-lookup"><span data-stu-id="9f508-216">The following code shows the format of the XML string you can use to set the properties:</span></span>  
  
```  
<CustomProps>  
   <CopyMode vt="19">0</CopyMode>  
   <AllowCacheOnWrite vt="11">-1</AllowCacheOnWrite>  
   <UseTempFileOnWrite vt="11">-1</UseTempFileOnWrite>  
</CustomProps>  
```  


