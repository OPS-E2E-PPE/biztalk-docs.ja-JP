---
title: ファイルをプログラムで作成する受信場所または送信ポート |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 558a414c-60bc-4f62-9397-a023ed4937fb
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c582cbd94f12855acfed963aa70c972cef811b7f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65255122"
---
# <a name="programmatically-create-the-file-receive-location-or-send-port"></a>ファイルをプログラムで作成する受信場所または送信ポート
ファイルを作成する方法は、受信ポートと送信ポートをプログラムを使用します。 使用する、[!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)]に移動して、[ファイル アダプターを構成する](../core/configure-the-file-adapter.md)します。

ファイル アダプターは、SSO データベース内の構成情報を格納します。 受信場所を構成し、オブジェクト モデルをプログラムで、BizTalk エクスプ ローラーを使用してポートに送信できます。 
 
## <a name="create-the-receive-location"></a>受信場所を作成します。

BizTalk エクスプローラ オブジェクト モデルを公開、**という**構成インターフェイスを含む、 **TransportTypeData**読み取り/書き込みプロパティ。 このプロパティでは、ファイルの名前/値ペアの XML 文字列形式での受信場所の構成プロパティ バッグ。  
  
**TransportTypeData**のプロパティ、**という**インターフェイスを設定する必要はありません。 設定されていないと、既定値、ファイルの受信場所の構成が使用されます。  
  
 次の表の一覧ファイルのプログラムで設定できる構成プロパティは受信場所です。  
  
|プロパティ名|型|説明|制限|コメント|  
|-------------------|----------|-----------------|------------------|--------------|  
|**FileNetFailRetryCount**|Long|一時的に利用でない場合、ネットワーク共有上の受信場所のアクセス試行の数。|Integer<br /><br /> 最小値:0<br /><br /> 最大値:MAX_LONG です。|指定しない場合、既定値は 5 回に設定されます。|  
|**FileNetFailRetryInterval**|Long|再試行の間隔が一時的に使用しない場合、ネットワーク共有上の受信場所のアクセス試行間隔 (分)。|Integer<br /><br /> Minimumvalue:0<br /><br /> 最大値:MAX_LONG です。|指定しない場合、既定値は 5 分に設定します。|  
|**BatchSize**|Long|数のファイルをこの受信場所を送信できますサーバーに一度に 1 つ。|Integer<br /><br /> 最小値:1<br /><br /> 最大値:256|指定しない場合、既定値は 20 個のファイルに設定されます。|  
|**FileMask**|String|受信場所で使用するファイル マスク。|String<br /><br /> FilePath と FileMask を組み合わせた長さは 256 文字を超えることはできません。|指定しない場合、既定値は *.xml に設定されます。|  
|**FilePath**|String|受信場所で監視するフォルダーのパス。|String<br /><br /> 必須<br /><br /> FilePath と FileMask を組み合わせた長さは 256 文字を超えることはできません。|指定する必要があります**重要。** 受信場所用に作成されたファイルのフォルダー、受信場所で構成された受信ハンドラー資格情報の書き込みアクセス許可が必要です。|  
|**ユーザー名**|String|フォルダーへのアクセスに使用するアカウントのユーザー名。|最小の長さ:0<br /><br /> 最大長:256|ユーザー名またはパスワードのどちらが指定されている場合は、ホストの資格情報が使用されます。<br /><br /> Null の場合 (vt =「1」) の構成データベースに格納されている値が使用されます。|  
|**Password**|String|フォルダーにアクセスするために使用するアカウントのパスワード。|最小の長さ:0<br /><br /> 最大長:256|ユーザー名またはパスワードのどちらが指定されている場合は、ホストの資格情報が使用されます。<br /><br /> Null の場合 (vt =「1」) の構成データベースに格納されている値が使用されます。|  
  
 次のコードでは、プロパティの設定に使用する XML 文字列の形式を示します。  
  
```  
<CustomProps>  
   <FilePath vt="8">C:\Temp</FilePath>  
   <BatchSize vt="19">20</BatchSize>  
   <FileMask vt="8">*.xml</FileMask>  
   <FileNetFailRetryCount vt="19">5</FileNetFailRetryCount>  
   <FileNetFailRetryInterval vt="19">5</FileNetFailRetryInterval>  
   <Username vt=”8”>MyDomain\MyUsername</Username>  
   <Password vt=”8”>PASSWORD</Password>  
</CustomProps>  
  
```  

## <a name="create-the-send-port"></a>送信ポートを作成します。

構成情報はカスタム XML プロパティ バッグに保存されます。 `bts_file_properties.xsd`ファイル送信ハンドラのプロパティ スキーマ ファイル アダプターに固有のプロパティを定義します。 これらのプロパティを使用して、ファイル送信を構成するポートも、サーバー内でアダプターに固有の情報を渡すことです。  
  
BizTalk エクスプローラ オブジェクト モデルを公開、 **ITransportInfo**が含まれているファイル送信ポートのアダプターの構成インターフェイス、 **TransportTypeData**読み取り/書き込みプロパティ。 このプロパティは、名前/値ペアの XML 文字列として、ファイル送信ハンドラーの構成プロパティ バッグを指定できます。  
  
 設定、 **TransportTypeData**のプロパティ、 **ITransportInfo**インターフェイスは必要ありません。 設定されていない場合に、ファイルの既定値が送信ハンドラーの構成が使用されます。  
  
 次の表に示しますファイル用、BizTalk エクスプローラ オブジェクト モデルにプログラムで設定できる構成プロパティは、ハンドラーの場所を送信します。  
  
|プロパティ名|型|説明|  
|-------------------|----------|-----------------|  
|**CopyMode**|Long|ファイルにメッセージを書き込むときに使用するコピー モードを定義します。 有効な値は、<br /><br /> **(0) を追加します。** ファイルが存在する場合は、ファイル送信ハンドラがファイルを開き、ファイルの末尾にメッセージを追加します。 ファイルが存在しない場合は、ファイル送信ハンドラが新しいファイルを作成します。<br /><br /> **新しい (1) を作成します。** ファイルが存在しない場合、ファイル送信ハンドラは新しいファイルを作成し、それに書き込みます。 ファイルが存在する場合は、ファイル送信ハンドラがエラーを報告し、送信ポートの通常のアダプタ再試行ロジックに従ってメッセージを処理します。 これはファイル送信ハンドラの既定のコピー モードです。<br /><br /> **(2) を上書きします。** ファイルが存在する場合は、ファイル送信ハンドラがファイルを開き、ファイルの内容を上書きします。 ファイルが存在しない場合は、ファイル送信ハンドラが新しいファイルを作成します。|  
|**AllowCacheOnWrite**|ブール値|ファイル システム キャッシュをファイルにメッセージを書き込むときに、ファイル アダプタが使用するかどうかを定義します。<br /><br /> 有効な値は、<br /><br /> **True (-1)** : ファイル アダプタは、出力ファイルに書き込むときにファイル システムのキャッシュを使用します。<br /><br /> **False (0)** ファイル送信ハンドラは出力ファイルに書き込むときにファイル システムのキャッシュを使用していません。|  
|**書き込み中に一時ファイルの使用**|ブール値|最初に一時ファイルに出力ファイルの書き込みし、書き込み操作が完了したらファイルを変更するかどうかを定義します。 このオプションが有効になっているかどうかは、一時ファイルは、拡張機能の作成は**BTS-WIP**します。<br /><br /> 有効な値は、<br /><br /> **True (-1)** : ファイル アダプタはターゲット フォルダに書き込むときに一時ファイルを作成します。<br /><br /> **False (0)** : ファイル アダプタはターゲット フォルダに書き込むときに一時ファイルを作成できません。 **注:** ときにこのオプションは使用可能なのみ、 **CopyMode**の値に設定されて**新しい (1) を作成する**します。|  
  
 構成プロパティのいずれかの操作によって、メッセージ コンテキストの値はなくても、ファイルは、既定値をハンドラーが使用に送信します。  
  
 構成プロパティは、メッセージ コンテキストでプログラムによって設定できます。 オーケストレーションまたはカスタム パイプライン コンポーネントでは、これらのプロパティを設定できます。 プロパティを使用するときは、次の規則が適用されます。  
  
- 構成プロパティは、し、オーケストレーションまたはカスタム パイプライン コンポーネントで受信パイプラインでは、設定が: 場合  
  
  -   メッセージを送信する場合は、静的な送信ポート、プロパティの値は、その送信ポート用に構成された値で上書きされます。  
  
  -   動的送信ポートにメッセージを送信する場合、プロパティの値は上書きされません。  
  
- 構成プロパティは、送信パイプラインでカスタム パイプライン コンポーネントで設定されます。 場合、  
  
  -   メッセージを送信する送信ポートが静的か動的かにかかわらず、プロパティ値は上書きされません。  
  
  次のコードでは、プロパティを設定する際、XML 文字列の形式を示します。  
  
```  
<CustomProps>  
   <CopyMode vt="19">0</CopyMode>  
   <AllowCacheOnWrite vt="11">-1</AllowCacheOnWrite>  
   <UseTempFileOnWrite vt="11">-1</UseTempFileOnWrite>  
</CustomProps>  
```  


