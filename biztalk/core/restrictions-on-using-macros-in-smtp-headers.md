---
title: "SMTP ヘッダーにマクロの使用に関する制限事項 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- configuring [SMTP adapters], restrictions
- macros, SMTP headers [SMTP adapters]
- SMTP adapters, macros
- SMTP adapters, restrictions
- configuring [SMTP adapters], SMTP headers
- SMTP adapters, SMTP headers
- configuring [SMTP adapters], macros
- SMTP headers
ms.assetid: ceab0917-cb3c-423b-a15f-63747ab1d8da
caps.latest.revision: "8"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a5bf13f97d3cee4bf5930c448c3444aead898624
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="restrictions-on-using-macros-in-smtp-headers"></a><span data-ttu-id="f7fb7-102">SMTP ヘッダーにマクロの使用に関する制限事項</span><span class="sxs-lookup"><span data-stu-id="f7fb7-102">Restrictions on Using Macros in SMTP Headers</span></span>
<span data-ttu-id="f7fb7-103">定義済みのマクロを使用して、SMTP メッセージ ヘッダーの **Subject**、 **To**、 **From**、および **CC** プロパティを動的に形成できます。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-103">You can form the **Subject**, **To**, **From**, and **CC** properties on an SMTP message header dynamically by using a predefined set of macros.</span></span> <span data-ttu-id="f7fb7-104">メッセージを送信する前に、SMTP 送信ハンドラーによってヘッダー内のすべてのマクロが値に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-104">Before sending a message, the SMTP send handler substitutes all the macros in headers with their values.</span></span> <span data-ttu-id="f7fb7-105">1 つのヘッダーを形成するときに、複数の異なるマクロを使用できます。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-105">You can use several different macros when forming one header.</span></span>  
  
 <span data-ttu-id="f7fb7-106">次のいずれかの条件に当てはまる場合、 **To**、 **From**、または **CC** ヘッダー内のマクロは SMTP 送信ハンドラーによって置き換えられません。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-106">The SMTP send handler does not substitute macros in the **To**, **From**, or **CC** header if any of the following are true:</span></span>  
  
-   <span data-ttu-id="f7fb7-107">対応するシステム プロパティが設定されていない場合</span><span class="sxs-lookup"><span data-stu-id="f7fb7-107">The corresponding system property is not set.</span></span>  
  
-   <span data-ttu-id="f7fb7-108">マクロのスペルが間違っている場合</span><span class="sxs-lookup"><span data-stu-id="f7fb7-108">The macro is misspelled.</span></span>  
  
-   <span data-ttu-id="f7fb7-109">マクロの値に、SMTP ヘッダーには無効な記号が含まれている場合</span><span class="sxs-lookup"><span data-stu-id="f7fb7-109">The value for the macro contains symbols that are not valid for the SMTP headers.</span></span>  
  
 <span data-ttu-id="f7fb7-110">以下の条件が満たされた場合、SMTP 送信ハンドラーのまま、マクロは、たとえば、 **%sourceparty%@somedomain.com** または**from %sourceparty% メッセージ**です。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-110">If any of these conditions are met, the SMTP send handler leaves the macros as they are, for example, **%SourceParty%@somedomain.com** or **Message from %SourceParty%**.</span></span>  
  
 <span data-ttu-id="f7fb7-111">次の表に、 **To**、 **CC**、および **Subject** ヘッダーの形成に使用できるマクロを示します。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-111">The following table lists the macros you can use to build the **To**, **CC**, and **Subject** headers.</span></span>  
  
|<span data-ttu-id="f7fb7-112">マクロ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-112">Macro</span></span>|<span data-ttu-id="f7fb7-113">説明</span><span class="sxs-lookup"><span data-stu-id="f7fb7-113">Description</span></span>|<span data-ttu-id="f7fb7-114">To での使用</span><span class="sxs-lookup"><span data-stu-id="f7fb7-114">For use with To</span></span>|<span data-ttu-id="f7fb7-115">CC での使用</span><span class="sxs-lookup"><span data-stu-id="f7fb7-115">For use with CC</span></span>|<span data-ttu-id="f7fb7-116">Subject での使用</span><span class="sxs-lookup"><span data-stu-id="f7fb7-116">For use with Subject</span></span>|  
|-----------|-----------------|---------------------|---------------------|--------------------------|  
|<span data-ttu-id="f7fb7-117">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-117">%MessageID%</span></span>|<span data-ttu-id="f7fb7-118">BizTalk Server 内のメッセージのグローバル一意識別子 (GUID)。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-118">Globally unique identifier (GUID) of the message in BizTalk Server.</span></span> <span data-ttu-id="f7fb7-119">この値は、メッセージ コンテキスト プロパティ **BTS.MessageID**から取得されます。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-119">The value comes from the message context property **BTS.MessageID**.</span></span>|<span data-ttu-id="f7fb7-120">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-120">No</span></span>|<span data-ttu-id="f7fb7-121">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-121">No</span></span>|<span data-ttu-id="f7fb7-122">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-122">Yes</span></span>|  
|<span data-ttu-id="f7fb7-123">%datetime_bts2000%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-123">%datetime_bts2000%</span></span>|<span data-ttu-id="f7fb7-124">YYYYMMDDhhmmsss 形式の UTC 日時。sss は秒およびミリ秒を表します (たとえば、199707121035234 は 1997 年 7 月 12 日 10 時 35 分 23 秒 400 ミリ秒を表します)。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-124">UTC date time in the format YYYYMMDDhhmmsss, where sss means seconds and milliseconds (for example, 199707121035234 means 1997/07/12, 10:35:23 and 400 milliseconds).</span></span>|<span data-ttu-id="f7fb7-125">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-125">No</span></span>|<span data-ttu-id="f7fb7-126">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-126">No</span></span>|<span data-ttu-id="f7fb7-127">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-127">Yes</span></span>|  
|<span data-ttu-id="f7fb7-128">%datetime%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-128">%datetime%</span></span>|<span data-ttu-id="f7fb7-129">YYYY-MM-DDThhmmss 形式の UTC の日時 (例、1997-07-12T103508)。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-129">UTC date time in the format YYYY-MM-DDThhmmss (for example, 1997-07-12T103508).</span></span>|<span data-ttu-id="f7fb7-130">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-130">No</span></span>|<span data-ttu-id="f7fb7-131">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-131">No</span></span>|<span data-ttu-id="f7fb7-132">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-132">Yes</span></span>|  
|<span data-ttu-id="f7fb7-133">%datetime.tz%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-133">%datetime.tz%</span></span>|<span data-ttu-id="f7fb7-134">ローカルの日時に GMT のタイム ゾーンを加えた YYYY-MM-DDThhmmssTZD 形式の日時 (例、1997-07-12T103508+800)。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-134">Local date time plus time zone from GMT in the format YYYY-MM-DDThhmmssTZD, (for example, 1997-07-12T103508+800).</span></span>|<span data-ttu-id="f7fb7-135">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-135">No</span></span>|<span data-ttu-id="f7fb7-136">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-136">No</span></span>|<span data-ttu-id="f7fb7-137">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-137">Yes</span></span>|  
|<span data-ttu-id="f7fb7-138">%time%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-138">%time%</span></span>|<span data-ttu-id="f7fb7-139">hhmmss 形式の UTC 時刻。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-139">UTC time in the format hhmmss.</span></span>|<span data-ttu-id="f7fb7-140">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-140">No</span></span>|<span data-ttu-id="f7fb7-141">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-141">No</span></span>|<span data-ttu-id="f7fb7-142">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-142">Yes</span></span>|  
|<span data-ttu-id="f7fb7-143">%time.tz%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-143">%time.tz%</span></span>|<span data-ttu-id="f7fb7-144">ローカルの日付に GMT のタイム ゾーンを加えた hhmmssTZD 形式の日付 (例、124525+530)。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-144">Local time plus time zone from GMT in the format hhmmssTZD (for example, 124525+530).</span></span>|<span data-ttu-id="f7fb7-145">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-145">No</span></span>|<span data-ttu-id="f7fb7-146">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-146">No</span></span>|<span data-ttu-id="f7fb7-147">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-147">Yes</span></span>|  
|<span data-ttu-id="f7fb7-148">%SourceParty%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-148">%SourceParty%</span></span>|<span data-ttu-id="f7fb7-149">ファイル アダプタが受信したメッセージの受信元パーティの名前。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-149">Name of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="f7fb7-150">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-150">No</span></span>|<span data-ttu-id="f7fb7-151">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-151">No</span></span>|<span data-ttu-id="f7fb7-152">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-152">Yes</span></span>|  
|<span data-ttu-id="f7fb7-153">%SourcePartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-153">%SourcePartyQualifier%</span></span>|<span data-ttu-id="f7fb7-154">ファイル アダプタが受信したメッセージの受信元パーティの修飾子。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-154">Qualifier of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="f7fb7-155">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-155">No</span></span>|<span data-ttu-id="f7fb7-156">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-156">No</span></span>|<span data-ttu-id="f7fb7-157">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-157">Yes</span></span>|  
|<span data-ttu-id="f7fb7-158">%DestinationParty%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-158">%DestinationParty%</span></span>|<span data-ttu-id="f7fb7-159">送信先パーティの名前。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-159">Name of the destination party.</span></span> <span data-ttu-id="f7fb7-160">この値は、メッセージ コンテキスト プロパティ **BTS.DestinationParty**から取得されます。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-160">The value comes from the message context property **BTS.DestinationParty**.</span></span>|<span data-ttu-id="f7fb7-161">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-161">Yes</span></span>|<span data-ttu-id="f7fb7-162">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-162">Yes</span></span>|<span data-ttu-id="f7fb7-163">可</span><span class="sxs-lookup"><span data-stu-id="f7fb7-163">Yes</span></span>|  
|<span data-ttu-id="f7fb7-164">%DestinationPartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="f7fb7-164">%DestinationPartyQualifier%</span></span>|<span data-ttu-id="f7fb7-165">送信先パーティの修飾子。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-165">Qualifier of the destination party.</span></span> <span data-ttu-id="f7fb7-166">この値は、メッセージ コンテキスト プロパティ **BTS.DestinationPartyQualifier**から取得されます。</span><span class="sxs-lookup"><span data-stu-id="f7fb7-166">The value comes from the message context property **BTS.DestinationPartyQualifier**.</span></span>|<span data-ttu-id="f7fb7-167">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-167">No</span></span>|<span data-ttu-id="f7fb7-168">いいえ</span><span class="sxs-lookup"><span data-stu-id="f7fb7-168">No</span></span>|<span data-ttu-id="f7fb7-169">はい</span><span class="sxs-lookup"><span data-stu-id="f7fb7-169">Yes</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="f7fb7-170">参照</span><span class="sxs-lookup"><span data-stu-id="f7fb7-170">See Also</span></span>  
 [<span data-ttu-id="f7fb7-171">SMTP アダプタの構成時の制限事項</span><span class="sxs-lookup"><span data-stu-id="f7fb7-171">Restrictions When Configuring the SMTP Adapter</span></span>](../core/restrictions-when-configuring-the-smtp-adapter.md)