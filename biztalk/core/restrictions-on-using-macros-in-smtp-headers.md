---
title: SMTP ヘッダーでのマクロの使用に関する制限事項 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- configuring [SMTP adapters], restrictions
- macros, SMTP headers [SMTP adapters]
- SMTP adapters, macros
- SMTP adapters, restrictions
- configuring [SMTP adapters], SMTP headers
- SMTP adapters, SMTP headers
- configuring [SMTP adapters], macros
- SMTP headers
ms.assetid: ceab0917-cb3c-423b-a15f-63747ab1d8da
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5162de289f9c9e7798e5a24aa75fa9305763b401
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36977979"
---
# <a name="restrictions-on-using-macros-in-smtp-headers"></a><span data-ttu-id="ccdc4-102">SMTP ヘッダーでのマクロの使用に関する制限事項</span><span class="sxs-lookup"><span data-stu-id="ccdc4-102">Restrictions on Using Macros in SMTP Headers</span></span>
<span data-ttu-id="ccdc4-103">定義済みのマクロを使用して、SMTP メッセージ ヘッダーの **Subject**、 **To**、 **From**、および **CC** プロパティを動的に形成できます。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-103">You can form the **Subject**, **To**, **From**, and **CC** properties on an SMTP message header dynamically by using a predefined set of macros.</span></span> <span data-ttu-id="ccdc4-104">メッセージを送信する前に、SMTP 送信ハンドラーによってヘッダー内のすべてのマクロが値に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-104">Before sending a message, the SMTP send handler substitutes all the macros in headers with their values.</span></span> <span data-ttu-id="ccdc4-105">1 つのヘッダーを形成するときに、複数の異なるマクロを使用できます。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-105">You can use several different macros when forming one header.</span></span>  
  
 <span data-ttu-id="ccdc4-106">次のいずれかの条件に当てはまる場合、 **To**、 **From**、または **CC** ヘッダー内のマクロは SMTP 送信ハンドラーによって置き換えられません。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-106">The SMTP send handler does not substitute macros in the **To**, **From**, or **CC** header if any of the following are true:</span></span>  
  
- <span data-ttu-id="ccdc4-107">対応するシステム プロパティが設定されていない場合</span><span class="sxs-lookup"><span data-stu-id="ccdc4-107">The corresponding system property is not set.</span></span>  
  
- <span data-ttu-id="ccdc4-108">マクロのスペルが間違っている場合</span><span class="sxs-lookup"><span data-stu-id="ccdc4-108">The macro is misspelled.</span></span>  
  
- <span data-ttu-id="ccdc4-109">マクロの値に、SMTP ヘッダーには無効な記号が含まれている場合</span><span class="sxs-lookup"><span data-stu-id="ccdc4-109">The value for the macro contains symbols that are not valid for the SMTP headers.</span></span>  
  
  <span data-ttu-id="ccdc4-110">これらの条件が満たされた場合、SMTP 送信ハンドラーのリーフ マクロなどは<strong>%sourceparty%@somedomain.com</strong> または**from %sourceparty% メッセージ**します。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-110">If any of these conditions are met, the SMTP send handler leaves the macros as they are, for example, <strong>%SourceParty%@somedomain.com</strong> or **Message from %SourceParty%**.</span></span>  
  
  <span data-ttu-id="ccdc4-111">次の表に、 **To**、 **CC**、および **Subject** ヘッダーの形成に使用できるマクロを示します。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-111">The following table lists the macros you can use to build the **To**, **CC**, and **Subject** headers.</span></span>  
  
|<span data-ttu-id="ccdc4-112">マクロ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-112">Macro</span></span>|<span data-ttu-id="ccdc4-113">説明</span><span class="sxs-lookup"><span data-stu-id="ccdc4-113">Description</span></span>|<span data-ttu-id="ccdc4-114">To での使用</span><span class="sxs-lookup"><span data-stu-id="ccdc4-114">For use with To</span></span>|<span data-ttu-id="ccdc4-115">CC での使用</span><span class="sxs-lookup"><span data-stu-id="ccdc4-115">For use with CC</span></span>|<span data-ttu-id="ccdc4-116">Subject での使用</span><span class="sxs-lookup"><span data-stu-id="ccdc4-116">For use with Subject</span></span>|  
|-----------|-----------------|---------------------|---------------------|--------------------------|  
|<span data-ttu-id="ccdc4-117">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-117">%MessageID%</span></span>|<span data-ttu-id="ccdc4-118">BizTalk Server 内のメッセージのグローバル一意識別子 (GUID)。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-118">Globally unique identifier (GUID) of the message in BizTalk Server.</span></span> <span data-ttu-id="ccdc4-119">この値は、メッセージ コンテキスト プロパティ **BTS.MessageID**から取得されます。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-119">The value comes from the message context property **BTS.MessageID**.</span></span>|<span data-ttu-id="ccdc4-120">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-120">No</span></span>|<span data-ttu-id="ccdc4-121">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-121">No</span></span>|<span data-ttu-id="ccdc4-122">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-122">Yes</span></span>|  
|<span data-ttu-id="ccdc4-123">%datetime_bts2000%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-123">%datetime_bts2000%</span></span>|<span data-ttu-id="ccdc4-124">YYYYMMDDhhmmsss 形式の UTC 日時。sss は秒およびミリ秒を表します (たとえば、199707121035234 は 1997 年 7 月 12 日 10 時 35 分 23 秒 400 ミリ秒を表します)。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-124">UTC date time in the format YYYYMMDDhhmmsss, where sss means seconds and milliseconds (for example, 199707121035234 means 1997/07/12, 10:35:23 and 400 milliseconds).</span></span>|<span data-ttu-id="ccdc4-125">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-125">No</span></span>|<span data-ttu-id="ccdc4-126">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-126">No</span></span>|<span data-ttu-id="ccdc4-127">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-127">Yes</span></span>|  
|<span data-ttu-id="ccdc4-128">%datetime%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-128">%datetime%</span></span>|<span data-ttu-id="ccdc4-129">YYYY-MM-DDThhmmss 形式の UTC の日時 (例、1997-07-12T103508)。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-129">UTC date time in the format YYYY-MM-DDThhmmss (for example, 1997-07-12T103508).</span></span>|<span data-ttu-id="ccdc4-130">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-130">No</span></span>|<span data-ttu-id="ccdc4-131">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-131">No</span></span>|<span data-ttu-id="ccdc4-132">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-132">Yes</span></span>|  
|<span data-ttu-id="ccdc4-133">%datetime.tz%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-133">%datetime.tz%</span></span>|<span data-ttu-id="ccdc4-134">ローカルの日時に GMT のタイム ゾーンを加えた YYYY-MM-DDThhmmssTZD 形式の日時 (例、1997-07-12T103508+800)。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-134">Local date time plus time zone from GMT in the format YYYY-MM-DDThhmmssTZD, (for example, 1997-07-12T103508+800).</span></span>|<span data-ttu-id="ccdc4-135">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-135">No</span></span>|<span data-ttu-id="ccdc4-136">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-136">No</span></span>|<span data-ttu-id="ccdc4-137">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-137">Yes</span></span>|  
|<span data-ttu-id="ccdc4-138">%time%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-138">%time%</span></span>|<span data-ttu-id="ccdc4-139">hhmmss 形式の UTC 時刻。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-139">UTC time in the format hhmmss.</span></span>|<span data-ttu-id="ccdc4-140">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-140">No</span></span>|<span data-ttu-id="ccdc4-141">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-141">No</span></span>|<span data-ttu-id="ccdc4-142">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-142">Yes</span></span>|  
|<span data-ttu-id="ccdc4-143">%time.tz%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-143">%time.tz%</span></span>|<span data-ttu-id="ccdc4-144">ローカルの日付に GMT のタイム ゾーンを加えた hhmmssTZD 形式の日付 (例、124525+530)。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-144">Local time plus time zone from GMT in the format hhmmssTZD (for example, 124525+530).</span></span>|<span data-ttu-id="ccdc4-145">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-145">No</span></span>|<span data-ttu-id="ccdc4-146">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-146">No</span></span>|<span data-ttu-id="ccdc4-147">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-147">Yes</span></span>|  
|<span data-ttu-id="ccdc4-148">%SourceParty%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-148">%SourceParty%</span></span>|<span data-ttu-id="ccdc4-149">ファイル アダプタが受信したメッセージの受信元パーティの名前。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-149">Name of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="ccdc4-150">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-150">No</span></span>|<span data-ttu-id="ccdc4-151">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-151">No</span></span>|<span data-ttu-id="ccdc4-152">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-152">Yes</span></span>|  
|<span data-ttu-id="ccdc4-153">%SourcePartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-153">%SourcePartyQualifier%</span></span>|<span data-ttu-id="ccdc4-154">ファイル アダプタが受信したメッセージの受信元パーティの修飾子。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-154">Qualifier of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="ccdc4-155">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-155">No</span></span>|<span data-ttu-id="ccdc4-156">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-156">No</span></span>|<span data-ttu-id="ccdc4-157">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-157">Yes</span></span>|  
|<span data-ttu-id="ccdc4-158">%DestinationParty%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-158">%DestinationParty%</span></span>|<span data-ttu-id="ccdc4-159">送信先パーティの名前。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-159">Name of the destination party.</span></span> <span data-ttu-id="ccdc4-160">この値は、メッセージ コンテキスト プロパティ **BTS.DestinationParty**から取得されます。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-160">The value comes from the message context property **BTS.DestinationParty**.</span></span>|<span data-ttu-id="ccdc4-161">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-161">Yes</span></span>|<span data-ttu-id="ccdc4-162">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-162">Yes</span></span>|<span data-ttu-id="ccdc4-163">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-163">Yes</span></span>|  
|<span data-ttu-id="ccdc4-164">%DestinationPartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="ccdc4-164">%DestinationPartyQualifier%</span></span>|<span data-ttu-id="ccdc4-165">送信先パーティの修飾子。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-165">Qualifier of the destination party.</span></span> <span data-ttu-id="ccdc4-166">この値は、メッセージ コンテキスト プロパティ **BTS.DestinationPartyQualifier**から取得されます。</span><span class="sxs-lookup"><span data-stu-id="ccdc4-166">The value comes from the message context property **BTS.DestinationPartyQualifier**.</span></span>|<span data-ttu-id="ccdc4-167">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-167">No</span></span>|<span data-ttu-id="ccdc4-168">いいえ</span><span class="sxs-lookup"><span data-stu-id="ccdc4-168">No</span></span>|<span data-ttu-id="ccdc4-169">はい</span><span class="sxs-lookup"><span data-stu-id="ccdc4-169">Yes</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ccdc4-170">参照</span><span class="sxs-lookup"><span data-stu-id="ccdc4-170">See Also</span></span>  
 [<span data-ttu-id="ccdc4-171">SMTP アダプター構成時の制限事項</span><span class="sxs-lookup"><span data-stu-id="ccdc4-171">Restrictions When Configuring the SMTP Adapter</span></span>](../core/restrictions-when-configuring-the-smtp-adapter.md)