---
title: "チュートリアル: カスタム メッセージを Wcf-nettcp アダプターを使用した処理 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: b56b7492-2ea0-4c63-8f1b-430eb277517d
caps.latest.revision: "32"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 3afe5ac97ba8b794e2c13f552f00cd3ba2b38572
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="walkthrough-custom-message-processing-with-the-wcf-nettcp-adapter"></a><span data-ttu-id="f9379-102">チュートリアル: カスタム メッセージを Wcf-nettcp アダプターを使用した処理</span><span class="sxs-lookup"><span data-stu-id="f9379-102">Walkthrough: Custom Message Processing with the WCF-NetTcp Adapter</span></span>
<span data-ttu-id="f9379-103">このチュートリアルでは、WCF-NetTcp アダプターを使用して、[!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] クライアントから BizTalk 受信場所に、バイナリ JPEG イメージ データが埋め込まれた [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] メッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="f9379-103">In this walkthrough a [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] client submits a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message containing embedded binary JPEG image data to a BizTalk receive location using the WCF-NetTcp adapter.</span></span> <span data-ttu-id="f9379-104">による、XPath ステートメント (Base64 ノード エンコード) を使用して、バイナリでエンコードされた JPEG イメージが抽出されます、**受信メッセージ本文**アダプターの構成で設定します。</span><span class="sxs-lookup"><span data-stu-id="f9379-104">The binary encoded JPEG image gets extracted by using an XPath statement (with Base64 Node encoding) through the **Inbound Message Body** settings in the adapter’s configuration.</span></span> <span data-ttu-id="f9379-105">XPath 処理は、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] で受信メッセージの処理に使用される既定の方法とは異なります。</span><span class="sxs-lookup"><span data-stu-id="f9379-105">XPath processing differs from the default method that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses to handle incoming messages.</span></span> <span data-ttu-id="f9379-106">アダプターがの内容全体を取得する既定の方法で、**本文**の要素、[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]メッセージ、および BizTalk メッセージ ボックス データベースに送信します。</span><span class="sxs-lookup"><span data-stu-id="f9379-106">In the default method, the adapter obtains the entire contents of the **Body** element of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message, and then submits it to the BizTalk MessageBox database.</span></span> <span data-ttu-id="f9379-107">XPath メッセージ処理では、受信 [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] メッセージの特定の部分が抽出されてカスタム BizTalk メッセージが作成されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-107">XPath message processing extracts specific parts of an incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message to create a custom BizTalk message.</span></span> <span data-ttu-id="f9379-108">このサンプルでは、XPath 処理がという名前の XML 要素を検索し**SendPicture**では、着信[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]メッセージ (XML 形式で)。</span><span class="sxs-lookup"><span data-stu-id="f9379-108">In this sample XPath processing locates an XML element named **SendPicture** in the incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message (which is in XML format).</span></span> <span data-ttu-id="f9379-109">この要素が検出されると、Base64 エンコードされたバイナリ オブジェクトとしての要素の値が抽出され、そのバイナリ値が BizTalk メッセージに配置されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-109">After finding that element, XPath extracts the element's value as a binary Base64 encoded object, and places that binary value into a BizTalk message.</span></span> <span data-ttu-id="f9379-110">このメッセージはメッセージ ボックス データベースに発行された後、送信ポート フィルター サブスクリプションを使用して FILE 送信ポートに出力されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-110">The message is published to the MessageBox database, then output to a FILE send port with the help of a send port filter subscription.</span></span> <span data-ttu-id="f9379-111">このサンプルでオーケストレーションは使用されず、すべての処理は XPath を使用して BizTalk メッセージング経由で行われます。</span><span class="sxs-lookup"><span data-stu-id="f9379-111">No orchestrations are used in this sample, and all the processing is done through BizTalk messaging using XPath.</span></span>  
  
 <span data-ttu-id="f9379-112">[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] アダプターは、[!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] クライアントと [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] の [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] リモート サービスの通信に使用されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-112">A [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapter is used to communicate with [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] clients and [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] remote services from [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  <span data-ttu-id="f9379-113">これによりオーケストレーションおよびスキーマを [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] サービスとして公開することが可能になります。また、オーケストレーションで外部 WCF サービスを使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f9379-113">It allows orchestrations and schemas to be published as [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] services, and also provides the ability for an orchestration to consume external WCF services.</span></span> <span data-ttu-id="f9379-114">Wcf-nettcp アダプターを使用して、 **NetTcpBinding**バインディングで、最適化されたバイナリ メッセージ エンコーディングを使用して、TCP トランスポートを意味します。</span><span class="sxs-lookup"><span data-stu-id="f9379-114">The WCF-NetTcp adapter uses the **NetTcpBinding** binding, which means the TCP transport using an optimized binary message encoding.</span></span> <span data-ttu-id="f9379-115">WCF-NetTcp アダプターは、送信アダプターと受信アダプターの 2 つで構成されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-115">The WCF-NetTcp adapter consists of both a send adapter and a receive adapter.</span></span> <span data-ttu-id="f9379-116">このアダプタからは、SOAP セキュリティ、信頼性、およびトランザクションの各機能にフル アクセスできます。</span><span class="sxs-lookup"><span data-stu-id="f9379-116">It provides full access to SOAP security, reliability, and transaction features.</span></span>  
  
 <span data-ttu-id="f9379-117">このチュートリアルを完了すると、次のタスクを実行できるようになります。</span><span class="sxs-lookup"><span data-stu-id="f9379-117">After completing this walkthrough, you will understand how to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="f9379-118">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理コンソールを使用して MSI ファイルをインポートし、送信ポート、受信ポート、および受信場所を作成する。</span><span class="sxs-lookup"><span data-stu-id="f9379-118">By using the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, import an MSI file to create a send port, a receive port, and a receive location.</span></span>  
  
-   <span data-ttu-id="f9379-119">使用して、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールで、構成、[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]受信場所からデータを抽出する XPath ステートメントを実行する、 **SendPicture**の要素、[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]メッセージ。</span><span class="sxs-lookup"><span data-stu-id="f9379-119">By using the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, configure a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] receive location to run an XPath statement to extract data from the **SendPicture** element of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f9379-120">**Hosttrusted**要素は、受信ハンドラーに関連付けられているホストが信頼されているかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="f9379-120">The **hosttrusted** element specifies whether the host associated with the receive handler is trusted.</span></span> <span data-ttu-id="f9379-121">bindings.xml ファイルでは、この要素は既定の `false` に設定されています。これは、このサンプルでは [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] エンタープライズ シングル サインオン サービス (SSO) を使用しないためです。</span><span class="sxs-lookup"><span data-stu-id="f9379-121">In the bindings.xml file, it is set to its default setting of `false` because in this sample we don't care about the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Enterprise Single Sign-On service (SSO).</span></span> <span data-ttu-id="f9379-122">SSO を使用すると、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] でユーザー資格情報を渡してサードパーティのアプリケーションを [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] と統合することができます。</span><span class="sxs-lookup"><span data-stu-id="f9379-122">SSO allows the passing of user credentials through [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to integrate third-party applications with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="f9379-123">`false` に設定されている場合、BizTalk サービスの SSO 処理の一環として BizTalk メッセージが渡されることはありません。</span><span class="sxs-lookup"><span data-stu-id="f9379-123">A `false` setting prevents a BizTalk message from passing through the BizTalk service as part of the SSO processing.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="f9379-124">前提条件</span><span class="sxs-lookup"><span data-stu-id="f9379-124">Prerequisites</span></span>  
 <span data-ttu-id="f9379-125">このサンプルでは、手順を実行するには、環境に次の前提条件がインストールされることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f9379-125">To perform the steps in this sample ensure that your environment installs the following prerequisites;</span></span>  
  
-   <span data-ttu-id="f9379-126">サンプルを実行するコンピューターと、アセンブリをビルドおよび展開プロセスを実行するコンピューターの両方の必要な Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]、Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)]、および Microsoft[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]です。</span><span class="sxs-lookup"><span data-stu-id="f9379-126">Both the computer that builds the assemblies and runs the deployment process, and the computer that runs the sample, require Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)], Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)], and Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)].</span></span>  
  
-   <span data-ttu-id="f9379-127">アセンブリのビルドと展開プロセスの実行に使用するコンピューターには、Microsoft [!INCLUDE[vs2010](../includes/vs2010-md.md)] が必要です。</span><span class="sxs-lookup"><span data-stu-id="f9379-127">The computer used to build the assemblies and run the deployment process requires Microsoft [!INCLUDE[vs2010](../includes/vs2010-md.md)].</span></span>  
  
-   <span data-ttu-id="f9379-128">サンプルを実行するコンピューターには、[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] アダプターと [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] 管理ツールが必要です。</span><span class="sxs-lookup"><span data-stu-id="f9379-128">The computer that runs the sample requires the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapters and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Administration Tools.</span></span> <span data-ttu-id="f9379-129">これらは、Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] のセットアップ時にインストールするオプションです。</span><span class="sxs-lookup"><span data-stu-id="f9379-129">These are options to install during setup of Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)].</span></span>  
  
-   <span data-ttu-id="f9379-130">管理タスクの実行に使用するコンピューターで、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理コンソール内の [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] アプリケーション設定を構成するには、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理者グループのメンバーであるユーザー アカウントとして実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f9379-130">On the computers that you use to perform administrative tasks, you must run as a user account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group to configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application settings within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="f9379-131">また、アプリケーションの展開、ホスト インスタンスの管理、およびその他の必要なタスクを実行するには、このユーザー アカウントはローカル管理者グループのメンバーである必要もあります。</span><span class="sxs-lookup"><span data-stu-id="f9379-131">This user account must also be a member of the local Administrators group for application deployment, managing host instances, and other tasks that may be required.</span></span>  
  
-   <span data-ttu-id="f9379-132">必要とする任意のコンピューターで[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]、機能の 1 回限りのセットアップの手順を完了、[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]ではサンプル[http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510)です。</span><span class="sxs-lookup"><span data-stu-id="f9379-132">On any computer that requires [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] capability, complete the one-time setup procedure for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] samples at [http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510).</span></span>  
  
-   <span data-ttu-id="f9379-133">サンプルを実行して .msi ファイルを [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] にインポートするコンピューターで、ホストが信頼されたホストではないことを確認します。信頼されているホストの場合、インポートは失敗します。</span><span class="sxs-lookup"><span data-stu-id="f9379-133">On the computer that runs the sample and imports an .msi file into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], ensure the host is not a trusted host or the import will fail.</span></span>  
  
-   <span data-ttu-id="f9379-134">チュートリアルのコードをダウンロードし、コンピューターに展開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f9379-134">You must download the walkthrough code and extract it to your computer.</span></span>  <span data-ttu-id="f9379-135">このチュートリアルでは、全体の一部[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]アダプター チュートリアル パッケージです。</span><span class="sxs-lookup"><span data-stu-id="f9379-135">This walkthrough is a part of the entire [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapter Walkthrough package.</span></span> <span data-ttu-id="f9379-136">ファイルをダウンロードする**WCFAdapterWalkthroughs.exe**から、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]デベロッパー センター [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140)です。</span><span class="sxs-lookup"><span data-stu-id="f9379-136">You can download the file **WCFAdapterWalkthroughs.exe** from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Developer Center at [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140).</span></span>  
  
### <a name="configure-the-wcfcustommessageprocessing-application-and-artifacts"></a><span data-ttu-id="f9379-137">WCFCustomMessageProcessing アプリケーションとアイテムを構成する</span><span class="sxs-lookup"><span data-stu-id="f9379-137">Configure the WCFCustomMessageProcessing application and artifacts</span></span>  
  
1.  <span data-ttu-id="f9379-138">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールを右クリックして**アプリケーション****インポート**、し、 **MSI ファイル**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-138">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **Applications**, select **Import**, and then select **MSI file**.</span></span> <span data-ttu-id="f9379-139">移動して、 **C:\WCFCustomMessageProcessing\WCFCustomMessageProcessing.msi**ファイルを開き、をクリックして**開く**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-139">Go to the **C:\WCFCustomMessageProcessing\WCFCustomMessageProcessing.msi** file, and then click **Open**.</span></span> <span data-ttu-id="f9379-140">これにより、このアプリケーションに次のアイテムが作成されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-140">This creates the following artifacts for this application:</span></span>  
  
    -   <span data-ttu-id="f9379-141">**FileSP**送信ポート: のローカル ファイル システム上の場所**C:\WCFCustomMessageProcessing\Out**によって JPEG イメージ データの送信先[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]サンプル処理の最終的な出力と同じです。</span><span class="sxs-lookup"><span data-stu-id="f9379-141">**FileSP** send port: The location on the local file system of **C:\WCFCustomMessageProcessing\Out** where the JPEG image data is sent by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] as the final output of the sample processing.</span></span> <span data-ttu-id="f9379-142">送信ポート フィルターを表示する**BTS です。RecievePortName = NetTcpRP**で構成されている、 **FileSP プロパティ**ダイアログ ボックスで **フィルター**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-142">You can view the send port filter of **BTS.RecievePortName = NetTcpRP** configured in the **FileSP Properties** dialog box under **Filters**.</span></span> <span data-ttu-id="f9379-143">このフィルターは、NetTcp 受信ポートに関連付けられています。</span><span class="sxs-lookup"><span data-stu-id="f9379-143">The filter is associated with the NetTcp receive port.</span></span> <span data-ttu-id="f9379-144">FileSP 送信される受信ポート、NetTcpRP 受け取ったメッセージを送信ポートの出力場所**C:\WCFCustomMessageProcessing\Out**後、受信場所は、XPath、メッセージの処理を実行します。</span><span class="sxs-lookup"><span data-stu-id="f9379-144">Any messages accepted on the NetTcpRP receive port will be sent to the FileSP send port output location of **C:\WCFCustomMessageProcessing\Out** after the receive location executes the XPath processing on the message.</span></span>  
  
    -   <span data-ttu-id="f9379-145">**NetTcpRP**受信ポート: を論理的に含むポート、 **NetTcpRL**受信場所。</span><span class="sxs-lookup"><span data-stu-id="f9379-145">**NetTcpRP** receive port: The port that logically contains the **NetTcpRL** receive location.</span></span>  
  
    -   <span data-ttu-id="f9379-146">**NetTcpRL**受信場所: 既定値を使用してこの**PassThroughTransmit**イメージから受信したデータのパイプラインと Wcf-nettcp アダプターを jpeg に XPath ステートメントを実行する[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]メッセージ。</span><span class="sxs-lookup"><span data-stu-id="f9379-146">**NetTcpRL** receive location: This uses the default **PassThroughTransmit** pipeline and the WCF-NetTcp adapter to run an XPath statement to pull the JPEG image data out of the incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message.</span></span>  
  
### <a name="alternative-steps-to-configure-the-wcfcustommessageprocessing-application"></a><span data-ttu-id="f9379-147">WCFCustomMessageProcessing アプリケーションを構成する別の手順</span><span class="sxs-lookup"><span data-stu-id="f9379-147">Alternative steps to configure the WCFCustomMessageProcessing application</span></span>  
  
-   <span data-ttu-id="f9379-148">ここでは、手動の手順を使用せず、アプリケーションを構成する、 **C:\WCFCustomMessageProcessing\bindings.xml**ファイル。</span><span class="sxs-lookup"><span data-stu-id="f9379-148">Alternatively, here are the manual steps to configure the application without using the **C:\WCFCustomMessageProcessing\bindings.xml** file.</span></span> <span data-ttu-id="f9379-149">前のバインド ファイル インポート プロセスが正しく機能する場合はこれを実行する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f9379-149">You do not need to do this if the previous binding file import process works correctly.</span></span>  <span data-ttu-id="f9379-150">しかし、目をとおしておくことで、MSI ファイルの役割について理解を深めることができます。</span><span class="sxs-lookup"><span data-stu-id="f9379-150">But, reading it may increase your knowledge of what is going on with the MSI file.</span></span>  
  
-   <span data-ttu-id="f9379-151">一方向の受信ポートの作成 (**NetTcpRP**) と受信場所 (**NetTcpRL**)。</span><span class="sxs-lookup"><span data-stu-id="f9379-151">Create a one-way receive port (**NetTcpRP**) and a receive location (**NetTcpRL**).</span></span>  
  
    1.  <span data-ttu-id="f9379-152">展開、 **WCFCustomMessageProcessing**アプリケーションを右クリックして**受信ポート****新規**を選択し、**一方向の受信ポート**.</span><span class="sxs-lookup"><span data-stu-id="f9379-152">Expand the **WCFCustomMessageProcessing** application, right-click **Receive Ports**, select **New**, and select **One-way Receive Port**.</span></span> <span data-ttu-id="f9379-153">**受信ポートのプロパティ** ダイアログ ボックスに、入力`NetTcpRP`の**名前**、 をクリック**OK**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-153">In the **Receive Port Properties** dialog box, enter `NetTcpRP` for **Name**, and click **OK**.</span></span>  
  
    2.  <span data-ttu-id="f9379-154">右クリックし、 **NetTcpRP**受信ポートで、選択**新規**を選択して**受信場所の**します。</span><span class="sxs-lookup"><span data-stu-id="f9379-154">Right-click the **NetTcpRP** receive port, select **New**, and select **Receive Location**.</span></span> <span data-ttu-id="f9379-155">**受信場所のプロパティ** ダイアログ ボックスで、入力`NetTcRL`の**名前**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-155">In the **Receive Location Properties** dialog box, enter `NetTcRL` for **Name**.</span></span> <span data-ttu-id="f9379-156">**トランスポート**セクションで、をクリックして、**型**ドロップダウン リスト ボックスで、 **Wcf-nettcp**クリックしてドロップダウン リストから**構成**.</span><span class="sxs-lookup"><span data-stu-id="f9379-156">In the **Transport** section, click the **Type** drop-down list box, select **WCF-NetTcp** from the drop-down list, and then click **Configure**.</span></span>  
  
    3.  <span data-ttu-id="f9379-157">**全般** タブで、入力**アドレス**で、**アドレス**フィールドです。</span><span class="sxs-lookup"><span data-stu-id="f9379-157">On the **General** tab, enter **net.tcp://localhost/NetTcpRL/Image** in the **Address(URI)** field.</span></span>  
  
    4.  <span data-ttu-id="f9379-158">**セキュリティ** タブで、設定、**セキュリティ モード**に**なし。**</span><span class="sxs-lookup"><span data-stu-id="f9379-158">On the **Security** tab, set the **Security mode** to **None.**</span></span>  
  
    5.  <span data-ttu-id="f9379-159">**メッセージ**] タブで、[、**パス**オプションを**受信 BizTalk メッセージ本文**、入力と`/*[local-name()="SendPicture" and namespace-uri()='http://tempuri.org/']/*[local-name()="stream"]`ボディ パス式のです。</span><span class="sxs-lookup"><span data-stu-id="f9379-159">On the **Message** tab, select the **Path** option for the **Inbound BizTalk message body**, and enter `/*[local-name()="SendPicture" and namespace-uri()='http://tempuri.org/']/*[local-name()="stream"]` for the body path expression.</span></span> <span data-ttu-id="f9379-160">選択**Base64**として、**ノード エンコード**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-160">Select **Base64** as the **Node Encoding**.</span></span> <span data-ttu-id="f9379-161">**パス**オプションが値に設定されているための本文、[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]メッセージが[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]受信は、次の形式で:   **\<SendPicture xmlns ="http://tempuri.org/">\<ストリーム >*でエンコードされたバイナリの画像データを実際の base 64*\<ストリーム/>\</SendPicture > * *</span><span class="sxs-lookup"><span data-stu-id="f9379-161">The **Path** option is set to value because the body of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives is in the following format: **\<SendPicture xmlns="http://tempuri.org/">\<stream>*actual base 64 encoded binary image data*\</stream>\</SendPicture>**</span></span>  
  
    6.  <span data-ttu-id="f9379-162">**受信場所のプロパティ**ダイアログ ボックスで、をクリックして**OK**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-162">In the **Receive Location Properties** dialog box, click **OK**.</span></span>  
  
-   <span data-ttu-id="f9379-163">NetTcpRP 受信ポートをサブスクライブする一方向のファイル送信ポート (FileSP) を作成します。</span><span class="sxs-lookup"><span data-stu-id="f9379-163">Create a one-way file send port (FileSP) subscribed to the NetTcpRP receive port.</span></span>  
  
    1.  <span data-ttu-id="f9379-164">右クリック**送信ポート****新規**を選択して**一方向の受信ポート**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-164">Right-click **Send Ports**, select **New**, and select **One-way Receive Port**.</span></span> <span data-ttu-id="f9379-165">選択**静的な一方向ポート**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-165">Select **Static One-way Port**.</span></span> <span data-ttu-id="f9379-166">入力`FileSP`の**名前**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-166">Enter `FileSP` for **Name**.</span></span>  
  
    2.  <span data-ttu-id="f9379-167">**トランスポート**セクションで、をクリックして、**型**ドロップダウン リスト ボックスで、**ファイル**クリックしてドロップダウン リストから**構成**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-167">In the **Transport** section, click the **Type** drop-down list box, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  
  
    3.  <span data-ttu-id="f9379-168">[**コピー先フォルダー**入力`C:\WCFCustomMessageProcessing\Out`、] をクリック**[ok]**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-168">Under **Destination Folder** enter `C:\WCFCustomMessageProcessing\Out`, and click **OK**.</span></span>  
  
    4.  <span data-ttu-id="f9379-169">をクリックして**フィルター** `BTS.ReceivePortName == NetTcpRP`、順にクリック**ok です。**</span><span class="sxs-lookup"><span data-stu-id="f9379-169">Click **Filters**, select `BTS.ReceivePortName == NetTcpRP`, and then click **OK.**</span></span>  
  
### <a name="configure-the-send-port-and-run-the-application"></a><span data-ttu-id="f9379-170">送信ポートを構成してアプリケーションを実行する</span><span class="sxs-lookup"><span data-stu-id="f9379-170">Configure the send port and run the application</span></span>  
  
1.  <span data-ttu-id="f9379-171">右クリックし、 **WCFCustomMessageProcessing**アプリケーションである select**開始**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-171">Right-click the **WCFCustomMessageProcessing** application and select **Start**.</span></span> <span data-ttu-id="f9379-172">これにより、NetTcpRL 受信場所が有効になり、FileSP 送信ポートが開始されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-172">That will enlist the NetTcpRL receive location and start the FileSP send port.</span></span>  
  
2.  <span data-ttu-id="f9379-173">[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]を開き、`Client.sln`ファイルから、 **C:WCFCustomMessageProcessing\Client**フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="f9379-173">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], open up the `Client.sln` file from the **C:WCFCustomMessageProcessing\Client** folder.</span></span> <span data-ttu-id="f9379-174">ソリューション エクスプ ローラーで右クリックし、**クライアント**プロジェクトし、選択**ビルド**です。</span><span class="sxs-lookup"><span data-stu-id="f9379-174">In Solution Explorer, right-click the **Client** project and select **Build**.</span></span>  
  
3.  <span data-ttu-id="f9379-175">[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] **デバッグ**、し、 **デバッグなしで開始**Client.exe アプリケーションを実行します。</span><span class="sxs-lookup"><span data-stu-id="f9379-175">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], select **Debug**, and then select **Start Without Debugging** to run the Client.exe application.</span></span> <span data-ttu-id="f9379-176">イメージが [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] に送信されたというメッセージがコマンド プロンプトに表示されます。</span><span class="sxs-lookup"><span data-stu-id="f9379-176">A command prompt will appear saying the image was submitted to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
4.  <span data-ttu-id="f9379-177">正常な {GUID} .jpg ファイルへの出力を送信ポート ファイル フォルダーの観察**C:\WCFCustomMessageProcessing\Out**です。これは、JPEG ファイルを抽出して FILE 送信ポートに書き込むというアプリケーションの処理が正常に終了したことを示しています。</span><span class="sxs-lookup"><span data-stu-id="f9379-177">Observe the successful {GUID}.jpg file output to the send port file folder of **C:\WCFCustomMessageProcessing\Out**. This shows that the application processing to extract the JPEG file and write it out to a FILE send port completed successfully.</span></span>