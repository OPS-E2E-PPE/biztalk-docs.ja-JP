---
title: メッセージの処理 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- processing
- messages, pipelines
- routing, about routing
- adapters, about adapters
- routing, message types
- processing, messages
- messages, processing
- routing
- messages, routing
- pipelines, about pipelines
- message types
- messages, message types
- messages, adapters
ms.assetid: e6d1f969-20c9-41f6-85cb-46cf92656348
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 49329e23127f051a593596955f808cc879dd76f6
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36987787"
---
# <a name="processing-the-message"></a><span data-ttu-id="a1957-102">メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="a1957-102">Processing the Message</span></span>
<span data-ttu-id="a1957-103">これまで説明したコンポーネントはすべて、メッセージが BizTalk Server を通過する過程で行われる処理にそれぞれの役割を果たしています。</span><span class="sxs-lookup"><span data-stu-id="a1957-103">All of the components described so far play a part in the processing of messages as they flow through BizTalk Server.</span></span> <span data-ttu-id="a1957-104">このセクションでは、これらのコンポーネントが機能的にどのように連携するかについて説明します。最初にメッセージの受信について説明します。</span><span class="sxs-lookup"><span data-stu-id="a1957-104">This section provides more detail about how these components interact functionally, beginning with receiving a message.</span></span> <span data-ttu-id="a1957-105">受信ポートの作成と受信プロセスにおけるメッセージ フローを、次の図に示します。</span><span class="sxs-lookup"><span data-stu-id="a1957-105">The following figure shows the make-up of a receive port and the flow of a message through the receive process.</span></span>  
  
 <span data-ttu-id="a1957-106">*受信ポート* は、1 つ以上の受信場所と 0 個以上のマップで構成されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-106">A *receive port* consists of one or more receive locations and zero or more maps.</span></span> <span data-ttu-id="a1957-107">マップは、XML メッセージの構造または形式を変換するときに使用する XSLT (Extensible Stylesheet Language Transformations) スタイル シートであり、受信プロセスでメッセージを内部形式に正規化するときによく使用されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-107">Maps are Extensible Stylesheet Language Transformations (XSLT) style sheets used to transform XML messages from one structure or format to another and are often used in the receive process to normalize messages into an internal format.</span></span> <span data-ttu-id="a1957-108">受信場所は、メッセージを受信するエンドポイントを制御します。</span><span class="sxs-lookup"><span data-stu-id="a1957-108">Receive locations control the endpoints that receive the messages.</span></span> <span data-ttu-id="a1957-109">受信場所は、受信アダプターに対して構成したエンドポイントと受信パイプラインで構成されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-109">A receive location consists of the configuration of an endpoint for a receive adapter, and a receive pipeline.</span></span>  
  
 <span data-ttu-id="a1957-110">![受信ポートの構造と処理](../core/media/arch-message-processing.gif "arch_message_processing")</span><span class="sxs-lookup"><span data-stu-id="a1957-110">![Receive port structure and processing](../core/media/arch-message-processing.gif "arch_message_processing")</span></span>  
  
## <a name="the-role-of-the-adapter"></a><span data-ttu-id="a1957-111">アダプターの役割</span><span class="sxs-lookup"><span data-stu-id="a1957-111">The Role of the Adapter</span></span>  
 <span data-ttu-id="a1957-112">受信アダプターは、データ ストリームを読み取りメッセージを作成することによって、メッセージの受信プロセスを開始します。</span><span class="sxs-lookup"><span data-stu-id="a1957-112">The receive adapter initiates the process of receiving messages by reading a stream of data and creating a message.</span></span> <span data-ttu-id="a1957-113">たとえば、ファイル アダプターは、ファイルが構成された場所に配置されたことを検出すると、そのファイルをストリームに読み取ります。</span><span class="sxs-lookup"><span data-stu-id="a1957-113">For example, the file adapter sees that a file has been placed in its configured location and reads that file in a stream.</span></span> <span data-ttu-id="a1957-114">アダプターは、メッセージを作成し (Microsoft.BizTalk.Message.Interop.IBaseMessage インターフェイスの実装)、このメッセージに要素を追加し (Microsoft.BizTalk.Message.Interop.IBasePart インターフェイスの実装)、その要素の内容としてデータ ストリームを提供します。</span><span class="sxs-lookup"><span data-stu-id="a1957-114">The adapter creates a message (an implementation of the Microsoft.BizTalk.Message.Interop.IBaseMessage interface), adds a part to it (an implementation of the Microsoft.BizTalk.Message.Interop.IBasePart interface), and provides the stream of data as the part content.</span></span>  
  
 <span data-ttu-id="a1957-115">また、アダプターは書き込みを行って、場所、アダプターの種類、およびアダプターに関するその他の項目に関連するメッセージ コンテキスト プロパティに昇格させます。</span><span class="sxs-lookup"><span data-stu-id="a1957-115">In addition, the adapter writes and promotes into the message context properties related to the location, adapter type, and others related to the adapter.</span></span> <span data-ttu-id="a1957-116">メッセージとコンテキストが作成されると、アダプターはメッセージをエンドポイント マネージャーに渡します。</span><span class="sxs-lookup"><span data-stu-id="a1957-116">After the message and its context have been created, the adapter passes the message to the Endpoint Manager.</span></span> <span data-ttu-id="a1957-117">メッセージは、受信場所に対して構成された受信パイプラインを経由して処理されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-117">The message is then processed through the receive pipeline, which has been configured for the receive location.</span></span> <span data-ttu-id="a1957-118">メッセージがパイプラインによって処理されると、エンドポイント マネージャーがメッセージ エージェントを使用してメッセージを公開する前に、マップを使用してメッセージを目的の形式に変換できます。</span><span class="sxs-lookup"><span data-stu-id="a1957-118">After the message has been processed by the pipeline, a map may be used to transform the message into the format desired before the Endpoint Manager publishes the message with the Message Agent.</span></span>  
  
## <a name="the-role-of-the-pipeline"></a><span data-ttu-id="a1957-119">パイプラインの役割</span><span class="sxs-lookup"><span data-stu-id="a1957-119">The Role of the Pipeline</span></span>  
 <span data-ttu-id="a1957-120">最初のメッセージがアダプターによって作成されると、受信メッセージで発生する処理の大部分が受信パイプラインで行われます。</span><span class="sxs-lookup"><span data-stu-id="a1957-120">While it is the adapter that creates the initial message, most of the processing that occurs on a received message happens in the receive pipeline.</span></span> <span data-ttu-id="a1957-121">パイプラインでは、メッセージの内容だけでなくメッセージのコンテキストも処理します。</span><span class="sxs-lookup"><span data-stu-id="a1957-121">Pipeline processing deals with message content as well as message context.</span></span> <span data-ttu-id="a1957-122">メッセージの内容は通常デコード、逆アセンブル、および検証の各ステージで処理されますが、メッセージのコンテキストはすべてのステージで処理することができます。</span><span class="sxs-lookup"><span data-stu-id="a1957-122">Message content is generally handled in the decoding, disassembling, and validating stages, while message context can be handled in all stages.</span></span> <span data-ttu-id="a1957-123">ただし、パイプラインでは内容もコンテキストも処理されるとは限りません。</span><span class="sxs-lookup"><span data-stu-id="a1957-123">A pipeline, however, does not necessarily act on either the content or the context.</span></span> <span data-ttu-id="a1957-124">たとえば、既定のパススルー パイプラインではコンポーネントが構成されておらず、メッセージの内容またはコンテキストに対する処理を行いません。</span><span class="sxs-lookup"><span data-stu-id="a1957-124">For example, the default pass-through pipeline has no components configured and performs no processing on the message content or context.</span></span> <span data-ttu-id="a1957-125">説明を簡単にするために、このドキュメントでは、一般にメッセージのルーティングに影響を与える逆アセンブラー コンポーネントについて説明します。</span><span class="sxs-lookup"><span data-stu-id="a1957-125">For simplicity, this document focuses on the disassembling components as they generally have the greatest impact on message routing.</span></span>  
  
 <span data-ttu-id="a1957-126">*逆アセンブラー* では、アダプターから受信したメッセージを処理して、複数のメッセージに逆アセンブルし、メッセージ データを解析します。</span><span class="sxs-lookup"><span data-stu-id="a1957-126">The job of the *disassembler* is to process an incoming message from an adapter and to disassemble it into many messages, and parse the message data.</span></span> <span data-ttu-id="a1957-127">受信メッセージに多数のより小さいメッセージが含まれている場合、これは *インターチェンジ*と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="a1957-127">When an incoming message has many smaller messages, this is known as an *interchange*.</span></span> <span data-ttu-id="a1957-128">開発者が、前後のコンテンツに関する情報 (つまり、フラット ファイル逆アセンブラーのヘッダーと末尾のスキーマ、および XML 逆アセンブラーのエンベロープ スキーマ) および (繰り返される可能性もある) 本文のコンテンツに関する情報を構成することによって、フラット ファイル逆アセンブラーおよび XML 逆アセンブラーでのインターチェンジ処理が可能になります。</span><span class="sxs-lookup"><span data-stu-id="a1957-128">Both the flat file disassembler and the XML disassembler handle interchanges by enabling a developer to configure information about the wrapping content (that is, a header and trailing schema for the flat file disassembler and an envelope schema for the XML disassembler) and the (potentially repeating) body content.</span></span> <span data-ttu-id="a1957-129">また、これらの逆アセンブラーでは元のメッセージから XML コンテンツへの解析が行われます。</span><span class="sxs-lookup"><span data-stu-id="a1957-129">In addition, both of these disassemblers parse the original message into XML content.</span></span> <span data-ttu-id="a1957-130">ただし、カスタムの逆アセンブラーでは、BizTalk Server で XML に対するそれ以上の処理を行う必要がない場合、コンテンツの XML への解析を行わないこともあります。</span><span class="sxs-lookup"><span data-stu-id="a1957-130">A custom disassembler does not necessarily parse the content into XML if further XML processing in BizTalk Server is not required.</span></span> <span data-ttu-id="a1957-131">たとえば、単純なルーティングのシナリオで、ある受信場所で受信したメッセージが指定の送信ポートに送信され、マッピングや他の XML ベースの処理を特に要しない場合などがこれにあたります。</span><span class="sxs-lookup"><span data-stu-id="a1957-131">An example scenario might include a simple routing situation in which messages entering the system at a particular receive location are sent to a specific send port with no mapping or other XML-based processing.</span></span>  
  
## <a name="routing-with-the-message-type"></a><span data-ttu-id="a1957-132">メッセージの種類を使用したルーティング</span><span class="sxs-lookup"><span data-stu-id="a1957-132">Routing with the Message Type</span></span>  
 <span data-ttu-id="a1957-133">ルーティングに使用する最も一般的なメッセージ プロパティの 1 つは、メッセージの種類です。</span><span class="sxs-lookup"><span data-stu-id="a1957-133">One of the most common message properties used in routing is the message type.</span></span> <span data-ttu-id="a1957-134">開発者がメッセージの構造を定義するためのスキーマを作成すると、このスキーマによってメッセージの種類が定義されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-134">When a developer creates a schema to define the structure of messages, this schema defines the message type for that message.</span></span> <span data-ttu-id="a1957-135">種類は、スキーマ定義のルート ノードと名前空間によって決められます。</span><span class="sxs-lookup"><span data-stu-id="a1957-135">The type is determined by the root node and namespace in the schema definition.</span></span> <span data-ttu-id="a1957-136">たとえば、次のような XML ドキュメントはメッセージの種類があります。 http://tempuri.org/samples/MessageType#Message</span><span class="sxs-lookup"><span data-stu-id="a1957-136">For example, an XML document that looks like the following would have a message type of http://tempuri.org/samples/MessageType#Message</span></span>  
  
```  
<Message xmlns=http://tempuri.org/samples/MessageType>  
<SomeOtherElement type="sample"/>  
</Message>  
```  
  
 <span data-ttu-id="a1957-137">メッセージの種類をルーティングに使用するには、メッセージの種類をコンテキストに昇格させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1957-137">To use message type in routing, it must be promoted into the context.</span></span> <span data-ttu-id="a1957-138">メッセージ構造に精通している場合は、逆アセンブラーを使用して、この値をメッセージ コンテキストだけでなくパイプライン コンポーネントに昇格させます。</span><span class="sxs-lookup"><span data-stu-id="a1957-138">Disassemblers are used to promote this value into the message context as well as the pipeline components with the most specific knowledge of message structure.</span></span> <span data-ttu-id="a1957-139">XML 逆アセンブラーとフラット ファイル逆アセンブラーではメッセージを処理するときにメッセージの種類を昇格させます。カスタム逆アセンブラーでも、ルーティングを適切に行うには、このプロパティを昇格させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1957-139">The XML and Flat File disassemblers promote the message type as they are processing messages, and any custom disassembler should also promote this property to ensure proper routing.</span></span>  
  
 <span data-ttu-id="a1957-140">メッセージの種類は必ずしも必要ではないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="a1957-140">It is important to note that a message is not required to have a type.</span></span> <span data-ttu-id="a1957-141">前述したように、メッセージの各部はバイナリ データにすることができ、その構造を定義するスキーマを含める必要はありません。</span><span class="sxs-lookup"><span data-stu-id="a1957-141">As mentioned previously, the parts of a message can be any binary data and need not have a schema that defines their structure.</span></span> <span data-ttu-id="a1957-142">このようなメッセージ部分は、通常 BizTalk Server 自体による処理がほとんど行われずに BizTalk Server から渡されます。ただし、オーケストレーションから呼び出されたカスタムのパイプライン コンポーネント、アダプター、コードでは、これらの部分とやりとりする場合もあります。</span><span class="sxs-lookup"><span data-stu-id="a1957-142">This type of message part is generally passed through BizTalk Server without much, if any, processing done on it by BizTalk Server itself, though custom pipeline components, adapters, or code called from orchestrations may interact with these parts.</span></span>  
  
 <span data-ttu-id="a1957-143">また、パイプライン コンポーネントでも、アダプター同様、プロパティの書き込みおよびメッセージ コンテキストへの昇格を行います。</span><span class="sxs-lookup"><span data-stu-id="a1957-143">Pipeline components, like adapters, also write and promote properties into the message context.</span></span> <span data-ttu-id="a1957-144">実際、パイプライン コンポーネントは最も一般的なメカニズムであり、ほとんどの開発者がプロパティをメッセージ コンテキストに昇格させるために使用します。</span><span class="sxs-lookup"><span data-stu-id="a1957-144">In fact, pipeline components are the most common mechanism most developers use to get properties into the message context.</span></span> <span data-ttu-id="a1957-145">開発者はスキーマを作成し、スキーマのプロパティを昇格させることができます。</span><span class="sxs-lookup"><span data-stu-id="a1957-145">Developers create schemas and can promote properties in the schema.</span></span> <span data-ttu-id="a1957-146">この情報を注釈としてスキーマに保存すると、パイプライン コンポーネントで使用できます。</span><span class="sxs-lookup"><span data-stu-id="a1957-146">This information is stored in the schema as annotations which can then be used by pipeline components.</span></span> <span data-ttu-id="a1957-147">すべての組み込み逆アセンブラーおよびアセンブラー コンポーネント (FlatFile、XML、および BizTalk Framework) はドキュメント スキーマを使用して、昇格させるプロパティに関する情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="a1957-147">All of the built-in disassembler and assembler components - FlatFile, XML, and BizTalk Framework - use the document schema to retrieve information about the properties that are to be promoted.</span></span> <span data-ttu-id="a1957-148">コメントから XML Path Language (XPath) ステートメントを使用して、逆アセンブラーは、昇格する要素のドキュメントの場所を認識します。</span><span class="sxs-lookup"><span data-stu-id="a1957-148">Using the XML Path Language (XPath) statement from the annotations, the disassembler knows the location in the document of elements to be promoted.</span></span> <span data-ttu-id="a1957-149">逆アセンブラーは、ドキュメント全体のストリーミング処理時に、いずれかの XPath ステートメントに一致する要素を検出し、必要に応じてその値のコンテキストへの昇格または書き込みを行います。</span><span class="sxs-lookup"><span data-stu-id="a1957-149">During the process of streaming through the document, the disassembler finds those elements that match one of the XPath statements and promotes or writes the value into the context as appropriate.</span></span>  
  
 <span data-ttu-id="a1957-150">カスタム パイプライン コンポーネントでは、送受信メッセージの任意のデータのプロパティをコンテキストに昇格させることができます。</span><span class="sxs-lookup"><span data-stu-id="a1957-150">Custom pipeline components can also be written to handle getting properties into the context for arbitrary data in a received or sent message.</span></span> <span data-ttu-id="a1957-151">プロパティをコンテキストに昇格させてルーティングに使用するには (おそらくはそのために値を昇格させるわけです)、プロパティを定義したプロパティ スキーマを作成して BizTalk Server に展開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1957-151">In order to promote a property into the context and have it be useful for routing, which is presumably why the value is being promoted, a property schema with a definition for the property should be created and deployed to BizTalk Server.</span></span> <span data-ttu-id="a1957-152">カスタム コンポーネントで使用するプロパティ スキーマを定義する前に、昇格させたさまざまなプロパティの種類を理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a1957-152">Before you define a property schema to be used by custom components, you should understand the different types of promoted properties.</span></span> <span data-ttu-id="a1957-153">プロパティ スキーマで定義される昇格させたプロパティの基本型は、次のいずれかです。</span><span class="sxs-lookup"><span data-stu-id="a1957-153">Promoted properties defined in a property schema can have one of two base types:</span></span>  
  
- <span data-ttu-id="a1957-154">[Microsoft.XLANGs.BaseTypes.MessageContextPropertyBase](http://msdn.microsoft.com/library/microsoft.xlangs.basetypes.messagecontextpropertybase.aspx) または</span><span class="sxs-lookup"><span data-stu-id="a1957-154">[Microsoft.XLANGs.BaseTypes.MessageContextPropertyBase](http://msdn.microsoft.com/library/microsoft.xlangs.basetypes.messagecontextpropertybase.aspx) or</span></span>  
  
- [<span data-ttu-id="a1957-155">Microsoft.XLANGs.BaseTypes.MessageDataPropertyBase</span><span class="sxs-lookup"><span data-stu-id="a1957-155">Microsoft.XLANGs.BaseTypes.MessageDataPropertyBase</span></span>](http://msdn.microsoft.com/library/microsoft.xlangs.basetypes.messagedatapropertybase.messagedatapropertybase.aspx)  
  
  <span data-ttu-id="a1957-156">MessageDataPropertyBase という基本型を持つプロパティは、このプロパティの値がメッセージの内容に由来することを示します。</span><span class="sxs-lookup"><span data-stu-id="a1957-156">A property with a base type of MessageDataPropertyBase indicates that the value for this property comes from the content of the message.</span></span> <span data-ttu-id="a1957-157">これは、プロパティ スキーマで定義されたプロパティの既定値として通常使用されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-157">This is the default value for properties defined in a property schema and is the most common usage.</span></span> <span data-ttu-id="a1957-158">MessageContextPropertyBase で表現されるプロパティは、メッセージ コンテキストに含まれますが、直接メッセージ データに由来するとは限りません。</span><span class="sxs-lookup"><span data-stu-id="a1957-158">MessageContextPropertyBase indicates a property that is intended to be part of the message context but does not necessarily come from the message data directly.</span></span> <span data-ttu-id="a1957-159">基本型が MessageContextPropertyBase のプロパティは、しばしばアダプターと逆アセンブラーによって昇格され、メッセージやアダプターの種類など共通のプロパティを含んでいます。</span><span class="sxs-lookup"><span data-stu-id="a1957-159">Properties with MessageContextPropertyBase as their base type are often promoted by adapters and disassemblers and include common properties such as message type and adapter type.</span></span>  
  
  <span data-ttu-id="a1957-160">プロパティを定義する際には、型の相違を理解して、正しく使用することが大切です。</span><span class="sxs-lookup"><span data-stu-id="a1957-160">It is important to understand the different types and use them appropriately when defining properties.</span></span> <span data-ttu-id="a1957-161">このことは、オーケストレーション内でメッセージのコンテキスト プロパティにアクセスする場合に大きな意味を持ちます。</span><span class="sxs-lookup"><span data-stu-id="a1957-161">One of the most significant implications occurs when accessing context properties for a message in an orchestration.</span></span> <span data-ttu-id="a1957-162">プロパティが MessageDataPropertyBase として識別された場合、オーケストレーション デザイナーは受信中のメッセージ スキーマを調べて、一致する昇格させたプロパティが定義されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="a1957-162">If a property is identified as a MessageDataPropertyBase, the Orchestration Designer examines the schema of the message being received and ensures that it defines a matching promoted property.</span></span> <span data-ttu-id="a1957-163">アクセス中の昇格させたプロパティに関連付けられたスキーマにプロパティがない場合、オーケストレーション デザイナーでプロパティにアクセスすることはできません。</span><span class="sxs-lookup"><span data-stu-id="a1957-163">If no property is found in the schema tied to the promoted property being accessed, then the Designer does not allow you to access it.</span></span> <span data-ttu-id="a1957-164">一方、プロパティが MessageContextPropertyBase として定義されていれば、メッセージの種類にかかわらずプロパティにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="a1957-164">On the other hand, if the property is defined as being a MessageContextPropertyBase, the message type does not matter and the property can be accessed.</span></span>  
  
  <span data-ttu-id="a1957-165">カスタム パイプラインで、コンテキストにプロパティを昇格させるメカニズムと書き込むメカニズムはよく似ています。</span><span class="sxs-lookup"><span data-stu-id="a1957-165">In custom pipelines, the mechanism for promoting or writing properties to the context is very similar.</span></span> <span data-ttu-id="a1957-166">プロパティを書き込む場合は、IBaseMessageContext.Write メソッドを呼び出して値をコンテキスト内に配置します。</span><span class="sxs-lookup"><span data-stu-id="a1957-166">For writing properties, you use a call to the IBaseMessageContext Write method to place the value in the context.</span></span> <span data-ttu-id="a1957-167">プロパティを昇格させる場合は、代わりに IBaseMessageContext.Promote メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="a1957-167">For promoted properties, you simply use the IBaseMessageContext Promote method instead.</span></span> <span data-ttu-id="a1957-168">いずれのメソッドでもプロパティ名、名前空間、および値が必要です。</span><span class="sxs-lookup"><span data-stu-id="a1957-168">Each of these methods takes a property name, a namespace, and value.</span></span> <span data-ttu-id="a1957-169">昇格させたプロパティの名前と名前空間は、プロパティ スキーマに定義されており、プロパティ スキーマ アセンブリを参照し、プロパティ用に作成したクラスでプロパティを使用して、簡単にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="a1957-169">For the promoted properties, the name and namespace are those of the property defined in the property schema and are most easily accessed by referencing the property schema assembly and using the properties on the class created for the property.</span></span> <span data-ttu-id="a1957-170">識別フィールドが共通の名前空間を使用して http://schemas.microsoft.com/BizTalk/2003/btsDistinguishedFields、し、値を取得するために使用する XPath 式は通常名として使用します。</span><span class="sxs-lookup"><span data-stu-id="a1957-170">Distinguished fields use a common namespace, http://schemas.microsoft.com/BizTalk/2003/btsDistinguishedFields, and the XPath expression used to retrieve the value is usually used as the name.</span></span>  
  
  <span data-ttu-id="a1957-171">コンテキストにプロパティを昇格させる場合と書き込む場合のコードの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="a1957-171">The code below shows an example of both promoting and writing properties into the context.</span></span> <span data-ttu-id="a1957-172">この例では、識別フィールドがコンテキストに書き込まれます</span><span class="sxs-lookup"><span data-stu-id="a1957-172">Note that in this example, a distinguished field is being written into the context.</span></span> <span data-ttu-id="a1957-173">この例は、オーケストレーション デザイナーがフィールドを認識できるようにメッセージ スキーマで識別フィールドを識別しているオーケストレーションにのみ有効です。</span><span class="sxs-lookup"><span data-stu-id="a1957-173">This is only useful for orchestrations in which the message schema identifies the distinguished field so that the Orchestration Designer knows about the field.</span></span> <span data-ttu-id="a1957-174">コンテキストにプロパティを書き込んで、送信側または受信側の他のパイプライン コンポーネントで使用できるようにすると便利です。</span><span class="sxs-lookup"><span data-stu-id="a1957-174">It may be useful to write properties into the context for use by other pipeline components on the receiving or sending side.</span></span>  
  
```  
//create an instance of the property to be promoted  
SOAP.MethodName methodName = new SOAP.MethodName();  
  
//call the promote method on the context using the property class for name   
//and namespace  
pInMsg.Context.Promote(methodName.Name.Name, methodName.Name.Namespace,   
"theSOAPMethodName");  
  
//write a distinguished field to the context  
pInMsg.Context.Write("theDistinguishedProperty",   
"http://schemas.microsoft.com/BizTalk/2003/btsDistinguishedFields",   
"theDistinguishedValue");  
```  
  
 <span data-ttu-id="a1957-175">値をコンテキストに昇格させる、または書き込む際は、以下の点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="a1957-175">Keep the following facts in mind when writing or promoting values into the context:</span></span>  
  
- <span data-ttu-id="a1957-176">以前にプロパティを昇格させたときと同じ名前および名前空間を使用してコンテキストに値を書き込むと、プロパティは昇格されなくなります。</span><span class="sxs-lookup"><span data-stu-id="a1957-176">Writing a value into the context with the same name and namespace that were used previously to promote the property causes that property to no longer be promoted.</span></span> <span data-ttu-id="a1957-177">書き込みによって、基本的に昇格は上書きされます。</span><span class="sxs-lookup"><span data-stu-id="a1957-177">The write essentially overwrites the promotion.</span></span>  
  
- <span data-ttu-id="a1957-178">NULL 値のプロパティは使用できないので、コンテキストに NULL 値を書き込んだ場合は、値が削除されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-178">Writing a value of null into the context deletes the value, because null-valued properties are not permitted.</span></span>  
  
- <span data-ttu-id="a1957-179">昇格させたプロパティの長さは 256 文字までに制限されますが、書き込みプロパティには長さの制限がありません。</span><span class="sxs-lookup"><span data-stu-id="a1957-179">Promoted properties are limited to 256 characters in length while written properties have no length limitation.</span></span>  
  
  <span data-ttu-id="a1957-180">昇格させたプロパティはメッセージ ルーティングに使用されるので、比較と保存を効率よく行うためにサイズが制限されます。</span><span class="sxs-lookup"><span data-stu-id="a1957-180">Promoted properties are used in message routing and are limited in size for reasons of efficiency in comparison and storage.</span></span> <span data-ttu-id="a1957-181">書き込みプロパティにはサイズの制限がありませんが、コンテキストに大きな値を使用すると、値を処理してメッセージと共に渡す必要があるため、パフォーマンスに影響します</span><span class="sxs-lookup"><span data-stu-id="a1957-181">While written properties have no hard limits on size, using excessively large values in the context will have an impact on performance, because those values must still be processed and passed with the message.</span></span>  
  
  <span data-ttu-id="a1957-182">BizTalk Server からメッセージを送信する準備が整うと、送信ポートで予備処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="a1957-182">When a message is ready to be sent from BizTalk Server, it undergoes a complementary process in the send port.</span></span> <span data-ttu-id="a1957-183">送信パイプラインが実行される前にマップがメッセージに適用されて、パイプラインで処理されアダプター経由で送信される前にメッセージを顧客またはアプリケーション固有の形式に変換できるようになります。</span><span class="sxs-lookup"><span data-stu-id="a1957-183">Maps are applied to messages before the send pipeline is executed, allowing a message to be transformed to a customer or application-specific format before being processed by the pipeline and sent through the adapter.</span></span> <span data-ttu-id="a1957-184">送信パイプラインでは、プロパティをメッセージ コンテキストに昇格させる代わりに、プロパティをコンテキストからメッセージに降格させます。</span><span class="sxs-lookup"><span data-stu-id="a1957-184">In the send pipeline, instead of promoting properties into the message context, properties are demoted from the context into the message.</span></span>  
  
  <span data-ttu-id="a1957-185">![送信ポートと送信パイプライン処理](../core/media/arch-message-processing-2.gif "arch_message_processing-2")</span><span class="sxs-lookup"><span data-stu-id="a1957-185">![Send port, and send pipeline process](../core/media/arch-message-processing-2.gif "arch_message_processing-2")</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a1957-186">参照</span><span class="sxs-lookup"><span data-stu-id="a1957-186">See Also</span></span>  
 <span data-ttu-id="a1957-187">[ランタイム アーキテクチャ](../core/runtime-architecture.md) </span><span class="sxs-lookup"><span data-stu-id="a1957-187">[Runtime Architecture](../core/runtime-architecture.md) </span></span>  
 [<span data-ttu-id="a1957-188">BizTalk Server がサイズの大きなメッセージを処理する方法</span><span class="sxs-lookup"><span data-stu-id="a1957-188">How BizTalk Server Processes Large Messages</span></span>](../core/how-biztalk-server-processes-large-messages.md)