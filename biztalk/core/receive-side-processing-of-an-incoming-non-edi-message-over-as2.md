---
title: 受信側 AS2 経由で受信した非 EDI メッセージの処理 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: fee10cba-8b1a-4d2c-b9d9-efbb74c3f461
caps.latest.revision: 31
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c9d37479d66001eb073cb29a47b1fb8f56b0af8f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65398191"
---
# <a name="receive-side-processing-of-an-incoming-non-edi-message-over-as2"></a><span data-ttu-id="8b8b0-102">AS2 経由で受信した非 EDI メッセージの受信側の処理</span><span class="sxs-lookup"><span data-stu-id="8b8b0-102">Receive-Side Processing of an Incoming Non-EDI Message over AS2</span></span>
<span data-ttu-id="8b8b0-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] に付属の AS2 パイプラインを使用すると、AS2 トランスポート経由の EDI メッセージまたは非 EDI メッセージを処理できます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-103">The AS2 pipelines shipped with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] can be used to process an EDI message or a non-EDI message over AS2 transport.</span></span> <span data-ttu-id="8b8b0-104">この 2 つの種類のペイロードで使用されるパイプラインは異なります。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-104">Different pipelines are used for the two different types of payloads.</span></span> <span data-ttu-id="8b8b0-105">AS2 経由の受信 EDI メッセージの処理には、AS2EdiReceive パイプラインを使用し、関連する MDN (有効になっている場合) を返すときには AS2Send パイプラインを使用します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-105">You use the AS2EdiReceive pipeline to process an incoming EDI message over AS2, and the AS2Send pipeline to return the associated MDN (if enabled).</span></span> <span data-ttu-id="8b8b0-106">AS2 経由で受信した非 EDI メッセージの処理には、AS2Receive パイプラインを使用し、関連する MDN (有効になっている場合) を返すときには AS2Send パイプラインを使用します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-106">You use the AS2Receive pipeline to process an incoming non-EDI message over AS2, and the AS2Send pipeline to return the associated MDN (if enabled).</span></span> <span data-ttu-id="8b8b0-107">非 EDI メッセージは、任意のバイナリ ペイロードです。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-107">The non-EDI message can be any binary payload.</span></span>  
  
 <span data-ttu-id="8b8b0-108">AS2Receive 受信パイプラインは、AS2 メッセージをデコードした後、AS2 メッセージの逆アセンブルを実行します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-108">The AS2Receive receive pipeline decodes the AS2 message, and then performs disassembly on the AS2 message.</span></span> <span data-ttu-id="8b8b0-109">AS2Send 送信パイプラインは、MDN をエンコードします。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-109">An AS2Send send pipeline encodes the MDN.</span></span> <span data-ttu-id="8b8b0-110">AS2Receive パイプラインと AS2Send パイプラインは、双方向の送信請求 - 応答の HTTP 送信ポート (MDN が同期の場合) か、一方向の HTTP 送信ポートと一方向の HTTP 受信ポート (MDN が非同期の場合) に含めることができます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-110">You can include the AS2Receive and AS2Send pipelines in an HTTP two-way solicit response send port (if the MDN is synchronous), or in a one-way HTTP send port and a one-way HTTP receive port (if the MDN is asynchronous).</span></span> <span data-ttu-id="8b8b0-111">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では 1 つの受信パイプラインで実行できる逆アセンブルは 1 つだけであるため、非 EDI ペイロードの逆アセンブルを実行する必要がある場合、この処理は別のパイプラインで行うことが必要になります。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-111">If you need to perform disassembly of a non-EDI payload, you will have to do that in another receive pipeline, because [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] only allows one disassembler in a receive pipeline.</span></span> <span data-ttu-id="8b8b0-112">ループバック送信ポートを必要とされ、受信場所 (を参照してください、[受信した非 EDI ペイロードの処理](../core/receive-side-processing-of-an-incoming-non-edi-message-over-as2.md#BKMK_NonEDI)以下のセクション)。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-112">This will require a loopback send port and receive location (see the [Processing the Received Non-EDI Payload](../core/receive-side-processing-of-an-incoming-non-edi-message-over-as2.md#BKMK_NonEDI) section below).</span></span>  
  
 <span data-ttu-id="8b8b0-113">AS2 経由で非 EDI インターチェンジを受信するために、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-113">To receive a non-EDI interchange over AS2, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will perform the following steps:</span></span>  
  
-   <span data-ttu-id="8b8b0-114">受信した AS2 メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="8b8b0-114">Processing the received AS2 message</span></span>  
  
-   <span data-ttu-id="8b8b0-115">MDN の送信</span><span class="sxs-lookup"><span data-stu-id="8b8b0-115">Sending an MDN</span></span>  
  
-   <span data-ttu-id="8b8b0-116">受信した非 EDI ペイロードの処理</span><span class="sxs-lookup"><span data-stu-id="8b8b0-116">Processing the received non-EDI payload</span></span>  
  
## <a name="processing-the-received-as2-message"></a><span data-ttu-id="8b8b0-117">受信した AS2 メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="8b8b0-117">Processing the Received AS2 message</span></span>  
 <span data-ttu-id="8b8b0-118">AS2Receive 受信パイプラインの AS2 デコーダーは、受信 AS2 メッセージを処理します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-118">The AS2 Decoder in the AS2Receive receive pipeline processes an incoming AS2 message.</span></span> <span data-ttu-id="8b8b0-119">この処理は、HTTP アダプターが AS2 メッセージの HTTP ヘッダーから作成する、`InboundHTTPHeaders` コンテキスト プロパティを使用して行われます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-119">It does so using the `InboundHTTPHeaders` context property, which the HTTP adapter creates from the HTTP headers in the AS2 message.</span></span> <span data-ttu-id="8b8b0-120">これらのヘッダーには、次の AS2 ヘッダーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-120">These headers include the following AS2 headers:</span></span>  
  
- <span data-ttu-id="8b8b0-121">AS2-To</span><span class="sxs-lookup"><span data-stu-id="8b8b0-121">AS2-To</span></span>  
  
- <span data-ttu-id="8b8b0-122">AS2-From</span><span class="sxs-lookup"><span data-stu-id="8b8b0-122">AS2-From</span></span>  
  
- <span data-ttu-id="8b8b0-123">AS2-Version</span><span class="sxs-lookup"><span data-stu-id="8b8b0-123">AS2-Version</span></span>  
  
- <span data-ttu-id="8b8b0-124">MessageID</span><span class="sxs-lookup"><span data-stu-id="8b8b0-124">MessageID</span></span>  
  
- <span data-ttu-id="8b8b0-125">OriginalMessageID (MDN のみ)</span><span class="sxs-lookup"><span data-stu-id="8b8b0-125">OriginalMessageID (for MDNs only)</span></span>  
  
- <span data-ttu-id="8b8b0-126">Disposition-Notification-To (MDN が要求されている場合)</span><span class="sxs-lookup"><span data-stu-id="8b8b0-126">Disposition-Notification-To (if an MDN is requested)</span></span>  
  
- <span data-ttu-id="8b8b0-127">Receipt-Delivery-Option (MDN が要求されている場合)</span><span class="sxs-lookup"><span data-stu-id="8b8b0-127">Receipt-Delivery-Option (if an MDN is requested)</span></span>  
  
- <span data-ttu-id="8b8b0-128">Signed-Receipt-MICalg (MDN が要求されている場合)</span><span class="sxs-lookup"><span data-stu-id="8b8b0-128">Signed-Receipt-MICalg (if an MDN is requested)</span></span>  
  
  <span data-ttu-id="8b8b0-129">AS2 デコーダーは、これらのヘッダーをメッセージのコンテキストに昇格させます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-129">The AS2 Decoder will promote these headers to the context of the message.</span></span> <span data-ttu-id="8b8b0-130">これは、後は、次の:</span><span class="sxs-lookup"><span data-stu-id="8b8b0-130">It then does the following:</span></span>  
  
- <span data-ttu-id="8b8b0-131">アグリーメントの解決を実行して、受信メッセージの処理に使用するパーティのプロパティを特定します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-131">Performs agreement resolution to determine the properties to be used to process the incoming message.</span></span> <span data-ttu-id="8b8b0-132">詳細については、次を参照してください。[受信 AS2 メッセージのアグリーメントの解決](../core/agreement-resolution-for-incoming-as2-messages.md)します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-132">For more information, see [Agreement Resolution for Incoming AS2 Messages](../core/agreement-resolution-for-incoming-as2-messages.md).</span></span>  
  
- <span data-ttu-id="8b8b0-133">AS2-From プロパティと AS2-To プロパティを使用して送信者を認証します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-133">Authenticates the sender using the AS2-From and AS2-To properties.</span></span>  
  
  > [!NOTE]
  >  <span data-ttu-id="8b8b0-134">AS2 受信パイプライン処理の詳細については、受信 AS2 メッセージに対して実行しを参照してください[受信 AS2 メッセージの処理](../core/processing-an-incoming-as2-message.md)します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-134">For more information about the processing that the AS2 receive pipelines perform on incoming AS2 messages, see [Processing an Incoming AS2 Message](../core/processing-an-incoming-as2-message.md).</span></span>  
  
## <a name="sending-an-mdn"></a><span data-ttu-id="8b8b0-135">MDN の送信</span><span class="sxs-lookup"><span data-stu-id="8b8b0-135">Sending an MDN</span></span>  
 <span data-ttu-id="8b8b0-136">MDN が有効にされている場合、AS2Receive パイプラインは MDN を生成し、メッセージボックスにドロップします。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-136">If an MDN was enabled, the AS2Receive pipeline generates an MDN and drops it into the MessageBox.</span></span> <span data-ttu-id="8b8b0-137">最初のメッセージの送信者に MDN が返される方法は、AS2 トランスポートが同期であるか非同期であるかによって異なります。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-137">How the MDN is returned to the sender of the original message depends upon whether the AS2 transport is synchronous or asynchronous.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8b8b0-138">AS2 受信パイプライン処理の詳細については、送信 Mdn に対して実行しを参照してください[送信 MDN の生成](../core/generating-an-outgoing-mdn.md)します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-138">For more information about the processing that the AS2 receive pipelines perform on outgoing MDNs, see [Generating an Outgoing MDN](../core/generating-an-outgoing-mdn.md).</span></span>  
  
 <span data-ttu-id="8b8b0-139">**同期モード**</span><span class="sxs-lookup"><span data-stu-id="8b8b0-139">**Synchronous Mode**</span></span>  
  
 <span data-ttu-id="8b8b0-140">非 EDI メッセージが AS2 経由で同期モードで送信される場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] はその同期接続を経由して MDN を返し、接続を閉じます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-140">If a non-EDI message is sent over AS2 in synchronous mode, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will return the MDN over that synchronous connection and then close the connection.</span></span> <span data-ttu-id="8b8b0-141">MDN は AS2Receive パイプラインによって生成され、メッセージ ボックスにルーティングされた後、要求 - 応答の受信ポートの一部である AS2Send パイプラインによって自動的に取得されます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-141">The MDN will be generated by the AS2Receive pipeline, routed by that pipeline to the MessageBox, and then automatically picked up by the AS2Send pipeline that is part of the request response receive port.</span></span>  
  
 <span data-ttu-id="8b8b0-142">**非同期モード**</span><span class="sxs-lookup"><span data-stu-id="8b8b0-142">**Asynchronous Mode**</span></span>  
  
 <span data-ttu-id="8b8b0-143">非 EDI メッセージが HTTP/HTTPS トランスポート経由で非同期モードで送信される場合は、MDN を個別に返すための送信ポートを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-143">If a non-EDI message is sent over HTTP/HTTPS transport in asynchronous mode, you must create a send port to return the MDN separately.</span></span> <span data-ttu-id="8b8b0-144">これが動的送信ポートである場合は、メッセージのヘッダーの Receipt-Delivery-Notification 行にあるアドレスを使用してメッセージを取引先にルーティングします。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-144">If it is a dynamic send port, it will use the address in the Receipt-Delivery-Notification line in the header of the message to route the message to the trading partner.</span></span> <span data-ttu-id="8b8b0-145">静的送信ポートである場合は、ポート プロパティで定義されたアドレスを使用します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-145">If it is a static send port, it will use the address defined in port properties.</span></span> <span data-ttu-id="8b8b0-146">この送信ポートは、`EdiIntAS.IsAS2AsynchronousMDN==True` フィルター式を使用して非同期 MDN をサブスクライブします。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-146">This send port subscribes to the asynchronous MDN by using an `EdiIntAS.IsAS2AsynchronousMDN==True` filter expression.</span></span> <span data-ttu-id="8b8b0-147">非同期処理では、AS2Receive パイプラインが MDN だけでなく HTTP 応答も生成します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-147">In asynchronous processing, the AS2Receive pipeline will generate an HTTP response in addition to the MDN.</span></span> <span data-ttu-id="8b8b0-148">受信ポートは、受信ポートと送信パーティ間の HTTP 接続を経由して元の送信者に HTTP 応答を返し、元の送信者がその接続を閉じます。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-148">The receive port returns the HTTP response to the original sender over the HTTP connection between the receive port and the sending party, which closes that connection.</span></span> <span data-ttu-id="8b8b0-149">これが必要なのは、同期接続が MDN によって閉じられないためです。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-149">This is necessary because the synchronous connection is not closed by the MDN.</span></span>  
  
##  <a name="BKMK_NonEDI"></a> <span data-ttu-id="8b8b0-150">受信した非 EDI ペイロードの処理</span><span class="sxs-lookup"><span data-stu-id="8b8b0-150">Processing the Received Non-EDI Payload</span></span>  
 <span data-ttu-id="8b8b0-151">EDI エンコードでないメッセージを AS2 経由で受信し、ペイロードの逆アセンブルを実行する必要がある場合、その処理は AS2Receive パイプライン以外の受信パイプラインで行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-151">When a message that is not encoded in EDI is received over AS2, and you need to perform disassembly on the payload, you will have to do that in a different receive pipeline than the AS2Receive pipeline.</span></span> <span data-ttu-id="8b8b0-152">これは、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では 1 つの受信パイプラインで実行できる逆アセンブルは 1 つだけであるためです。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-152">This is required because [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] only allows one disassembler in a receive pipeline.</span></span> <span data-ttu-id="8b8b0-153">このシナリオでは、送信ポートと受信場所を使用するループバック メカニズムが必要になります。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-153">This scenario will require a loopback mechanism using a send port and receive location.</span></span> <span data-ttu-id="8b8b0-154">最初の受け渡しでは、EDIReceive パイプラインは AS2 メッセージを処理し、メッセージをネイティブ形式でメッセージ ボックスに送信します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-154">In the first pass, the EDIReceive pipeline processes the AS2 message and sends the message in its native format to the MessageBox.</span></span> <span data-ttu-id="8b8b0-155">2 番目の受け渡しでは、受信パイプラインはメッセージのネイティブ形式から XML を生成します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-155">In the second pass, a receive pipeline generates XML from the message's native format.</span></span>  
  
 <span data-ttu-id="8b8b0-156">BizTalk Server は、AS2 BizTalk Server 経由で受け取った非 EDI メッセージに対して、次のような受信側の処理を実行します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-156">BizTalk Server will perform the following receive-side processing on a non-EDI message over AS2 BizTalk Server:</span></span>  
  
-   <span data-ttu-id="8b8b0-157">要求 - 応答の双方向の受信場所に関連付けられている AS2Receive 受信パイプラインは、非 EDI メッセージの AS2 ヘッダーを解析し、このメッセージを BizTalk メッセージ ボックスにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-157">The AS2Receive receive pipeline associated with the two-way request response receive location parses the AS2 headers from the non-EDI message, and then routes the non-EDI message to the BizTalk MessageBox.</span></span>  
  
-   <span data-ttu-id="8b8b0-158">BizTalk のプロパティで `IsAS2PayloadMessage == True` が設定されているため、ループバック送信ポート (FILE または MSMQ) はメッセージ ボックスからこの非 EDI メッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-158">A loopback send port (either FILE or MSMQ) picks the non-EDI message up from the MessageBox, because it filters on the BizTalk property `IsAS2PayloadMessage == True`.</span></span> <span data-ttu-id="8b8b0-159">この送信ポートに関連付けられている PassThruTransmit 送信パイプラインは、フォルダーまたは MSMQ キューにメッセージをルーティングするときに、メッセージを非 EDI 形式で渡します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-159">The PassThruTransmit send pipeline associated with this send port passes the message through in its non-EDI format, routing the message to either a folder or an MSMQ queue.</span></span>  
  
-   <span data-ttu-id="8b8b0-160">ループバック受信場所がメッセージを取得します。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-160">A loopback receive location picks up the message.</span></span> <span data-ttu-id="8b8b0-161">ループバック受信場所に関連付けられている受信パイプラインは、非 EDI メッセージから XML メッセージを生成し、それをメッセージ ボックスにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-161">The receive pipeline associated with the loopback receive location generates an XML message from the non-EDI message, and routes it to the MessageBox.</span></span>  
  
-   <span data-ttu-id="8b8b0-162">メッセージをバックエンド アプリケーションにルーティングする必要がある場合は、送信ポートが XML メッセージを取得してアプリケーションにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="8b8b0-162">If the message is to be routed to a back-end application, a send port picks up the XML message and routes it to the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8b8b0-163">参照</span><span class="sxs-lookup"><span data-stu-id="8b8b0-163">See Also</span></span>  
 <span data-ttu-id="8b8b0-164">[BizTalk Server が AS2 メッセージを受信する方法](../core/how-biztalk-server-receives-as2-messages.md) </span><span class="sxs-lookup"><span data-stu-id="8b8b0-164">[How BizTalk Server Receives AS2 Messages](../core/how-biztalk-server-receives-as2-messages.md) </span></span>  
 [<span data-ttu-id="8b8b0-165">AS2 経由での送信 EDI メッセージの送信側の処理</span><span class="sxs-lookup"><span data-stu-id="8b8b0-165">Send-Side Processing of an Outgoing EDI Message over AS2</span></span>](../core/send-side-processing-of-an-outgoing-edi-message-over-as2.md)