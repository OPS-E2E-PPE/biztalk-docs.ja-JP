---
title: エンタープライズ シングル サインオンの高可用性 |Microsoft Docs
ms.custom: ''
ms.date: 2016-02-29
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Master Secret server, availability
- high availability, SSO
- Master Secret server, high availability
- SSO, high availability
ms.assetid: 6c631b5c-7147-4cc0-b58a-6749e83df9d3
caps.latest.revision: 27
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 9acc933df7b958ea6ae0f0651fd66ba14daad913
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37019246"
---
# <a name="high-availability-for-enterprise-single-sign-on"></a><span data-ttu-id="6d4c8-102">エンタープライズ シングル サインオンの高可用性</span><span class="sxs-lookup"><span data-stu-id="6d4c8-102">High Availability for Enterprise Single Sign-On</span></span>
<span data-ttu-id="6d4c8-103">資格情報のマッピングやシングル サインオンにエンタープライズ シングル サインオン (SSO) 機能を使用していない場合でも、Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の全体的なインフラストラクチャの中で SSO はきわめて重要な役割を果たしています。これは BizTalk Server で、受信場所に対する情報のセキュリティを確保するために、SSO が使用されているためです。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-103">Even if you do not use the Enterprise Single-Sign-On (SSO) functionality for mapping credentials and single sign-on, SSO is a critical part of the overall Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] infrastructure, because BizTalk Server uses SSO to help secure information for the receive locations.</span></span>  
  
 <span data-ttu-id="6d4c8-104">SSO サービスをインストールする 1 台目のコンピューターは、マスター シークレット サーバーとして構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-104">You must configure the first computer where you install the SSO service as the master secret server.</span></span> <span data-ttu-id="6d4c8-105">マスター シークレット サーバーは、マスター シークレット (暗号化キー) を格納する SSO サーバーです。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-105">The master secret server is the SSO server that stores the master secret (encryption key).</span></span> <span data-ttu-id="6d4c8-106">マスター シークレットとは、SSO システムが、SSO データベースに格納したデータの暗号化および復号化に使用する暗号化キーのことです。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-106">The master secret is the encryption key that the SSO system uses to encrypt and decrypt the data it stores in the SSO database.</span></span>  
  
 <span data-ttu-id="6d4c8-107">SSO サーバーに障害が発生しても、同じホスト インスタンスを実行する他の BizTalk Server コンピューター (SSO サーバー) が用意されていれば、その SSO サーバーが処理を引き継ぎます。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-107">If an SSO server fails, and if you have other BizTalk Server computers (and therefore SSO servers) running the same host instance, the other SSO servers continue doing their work.</span></span> <span data-ttu-id="6d4c8-108">つまり、マスター シークレット サーバーの機能は失われることなく、BizTalk Server が処理を続行できます。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-108">This means that the master secret server still functions correctly, and therefore the BizTalk Server processing continues.</span></span>  
  
 <span data-ttu-id="6d4c8-109">マスター シークレット サーバーで障害が発生した場合も、それ以前に実行されていた処理は、資格情報の復号化を含めてすべて正常に続行されます。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-109">If the master secret server fails, all run-time operations that were running before it failed, including decryption of credentials, continue successfully.</span></span> <span data-ttu-id="6d4c8-110">ただし、それ以降、新たに資格情報を暗号化することはできなくなります。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-110">However, you cannot encrypt new credentials.</span></span> <span data-ttu-id="6d4c8-111">BizTalk Server 環境は、可用性の点でマスター シークレット サーバー対する依存関係があります。この概念を示したものが次の図です。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-111">Therefore, the BizTalk Server environment has a dependency on the availability of the master secret server, as shown in the following figure.</span></span>  
  
 <span data-ttu-id="6d4c8-112">![障害点](../core/media/tdi-highava-pointsfailure-mss.gif "TDI_HighAva_PointsFailure_MSS")</span><span class="sxs-lookup"><span data-stu-id="6d4c8-112">![Points of Failure](../core/media/tdi-highava-pointsfailure-mss.gif "TDI_HighAva_PointsFailure_MSS")</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6d4c8-113">マスター シークレット サーバーが利用できなくなっても、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ホスト インスタンスは以下の状態になるまで、メモリ内にキャッシュされたマスター シークレットのコピーを使用することでそのままランタイム操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-113">If the master secret server becomes unavailable, then [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host instances can still perform run-time operations by using the in-memory cached copy of the master secret until:</span></span>  
> 
> - <span data-ttu-id="6d4c8-114">ホスト インスタンスが再起動する。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-114">The host instances are restarted.</span></span>  
>   -   <span data-ttu-id="6d4c8-115">BizTalk ホスト インスタンスを実行するコンピューター上の SSO サービスが再起動する。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-115">The SSO service on the computer running the BizTalk host instances is restarted.</span></span>  
>   -   <span data-ttu-id="6d4c8-116">SSO マスター シークレットが変更される。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-116">The SSO master secret is changed.</span></span>  
> 
>   <span data-ttu-id="6d4c8-117">SSO サービスが [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] コンピューター上で再起動した場合、または SSO マスター シークレットが変更された場合、キャッシュされたマスター シークレットのコピーがメモリから解放され、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] はマスター シークレットの別のコピーを取得するため、マスター シークレット サーバーと通信できなければなりません。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-117">If the SSO service is restarted on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computers or if the SSO master secret is changed, then the cached copy of the master secret is released from memory and the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must be able to contact the master secret server to obtain another copy of the master secret.</span></span> <span data-ttu-id="6d4c8-118">マスター シークレット サーバーが利用できない場合、暗号化のためにマスター シークレット サーバーへのアクセスを必要とする管理操作は失敗します。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-118">If the master secret server is unavailable then any administrative operations that require access to the master secret server for purposes of encryption will fail.</span></span>  
  
## <a name="making-the-master-secret-server-available"></a><span data-ttu-id="6d4c8-119">マスター シークレット サーバーの可用性を確保する方法</span><span class="sxs-lookup"><span data-stu-id="6d4c8-119">Making the Master Secret Server Available</span></span>  
 <span data-ttu-id="6d4c8-120">SSO システムの可用性、ひいては、BizTalk Server 環境の可用性を確保するためには、マスター シークレットが生成された時点で速やかにバックアップすることが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-120">For availability of the SSO system, and therefore of the BizTalk Server environment, it is critical that you back up the master secret as soon as it is generated.</span></span> <span data-ttu-id="6d4c8-121">マスター シークレットを失うことは、SSO システムがそのマスター シークレットを使って暗号化したデータを失うことを意味します。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-121">If you lose it, you lose the data that the SSO system encrypted by using that master secret.</span></span> <span data-ttu-id="6d4c8-122">マスター シークレットのバックアップの詳細については、[バックアップ マスター シークレットを方法](../core/how-to-back-up-the-master-secret.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-122">For more information about backing up the master secret, see [How to Back Up the Master Secret](../core/how-to-back-up-the-master-secret.md).</span></span>  
  
 <span data-ttu-id="6d4c8-123">マスター シークレット サーバーの可用性は、次の 2 とおりの方法で確保することができます。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-123">You can make the master secret server available in two ways:</span></span>  
  
-   <span data-ttu-id="6d4c8-124">**使用できますが、高可用性ではありません。**</span><span class="sxs-lookup"><span data-stu-id="6d4c8-124">**Available, but not highly available.**</span></span> <span data-ttu-id="6d4c8-125">マスター シークレットは、すべての SSO サーバーのメモリ内にキャッシュされるため、マスター シークレット サーバーに障害が発生してもランタイムの操作は続行します。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-125">All the SSO servers have the master secret cached in memory, and run-time operations will continue even if the master secret server fails.</span></span> <span data-ttu-id="6d4c8-126">ただし、ポート構成または SSO 構成を変更することはできなくなります。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-126">However, you will not be able to change the configuration of ports or the SSO configuration.</span></span> <span data-ttu-id="6d4c8-127">BizTalk Server ランタイムは問題なく処理を続行しますが、設計上の変更を加えることは一切できません。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-127">The BizTalk Server runtime will continue working without problems, but you cannot make any design changes.</span></span>  
  
     <span data-ttu-id="6d4c8-128">決して高い水準の可用性を実現することはできませんが、ほとんどの場合、この構成でも一定水準の可用性を確保することはできます。また、受信ホスト、送信ホスト、および処理ホストをスケールアウトすることもできます。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-128">Even if this configuration is not highly available, it can be satisfactory for most scenarios and it is consistent with scaling out the receiving, sending, and processing hosts.</span></span>  
  
-   <span data-ttu-id="6d4c8-129">**高可用性。**</span><span class="sxs-lookup"><span data-stu-id="6d4c8-129">**Highly available.**</span></span> <span data-ttu-id="6d4c8-130">マスター シークレット サーバーの冗長性を確保するには、Windows クラスタリングを使用して別にマスター シークレット サーバーをクラスター化するか、マスター シークレット サーバーを既存のデータベース クラスター上に構成します。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-130">To provide redundancy for the master secret server, use Windows Clustering on a separate master secret server cluster, or configure the master secret server on an existing database cluster.</span></span> <span data-ttu-id="6d4c8-131">マスター シークレット サーバーによって提供されるサービスは、それほど多くのリソースを消費しません。データベース クラスターにインストールしたとしても、データベースの機能やパフォーマンスに影響を与えることはありません。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-131">The services provided by the master secret server do not consume many resources, and typically do not affect database functionality or performance when installed on a database cluster.</span></span> <span data-ttu-id="6d4c8-132">次の図は、マスター シークレット サーバーに高水準の可用性を確保する方法を示したものです。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-132">The following figure shows how you can make the master secret server highly available.</span></span>  
  
     <span data-ttu-id="6d4c8-133">![高可用性のマスター シークレット サーバー](../core/media/tdi-highava-msscluster.gif "TDI_HighAva_MSSCluster")</span><span class="sxs-lookup"><span data-stu-id="6d4c8-133">![Highly Available Master Secret Server](../core/media/tdi-highava-msscluster.gif "TDI_HighAva_MSSCluster")</span></span>  
  
     <span data-ttu-id="6d4c8-134">この構成では高い可用性が実現される反面、追加のハードウェア リソースが必要になります。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-134">While this configuration is highly available, it requires additional hardware resources.</span></span> <span data-ttu-id="6d4c8-135">SSO の高可用性インストール オプションの詳細については、[高可用性 SSO インストール オプション](../core/high-availability-sso-installation-options.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-135">For more information about high availability installation options for SSO, see [High-Availability SSO Installation Options](../core/high-availability-sso-installation-options.md).</span></span> <span data-ttu-id="6d4c8-136">このセクションでは、Windows Server クラスターにおける SSO マスター シークレット サーバーの高可用性クラスター リソースとしての構成について詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-136">This section includes detailed information about configuring the SSO master secret server as a highly available cluster resource on a Windows Server cluster.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="6d4c8-137">高水準の可用性を実現するソリューションで、ハードウェア リソースをできるだけ抑えるためには、マスター シークレット サーバーを SQL Server クラスターのクラスター リソースとして追加します。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-137">To reduce the hardware resources for a highly available solution, you can add the master secret server as a cluster resource in your SQL Server cluster.</span></span> <span data-ttu-id="6d4c8-138">別のコンピューターで、SSO サービスをインストールする追加の BizTalk Server のライセンスを購入する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="6d4c8-138">You do not need to purchase additional BizTalk Server licenses to install the SSO service on another computer.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6d4c8-139">参照</span><span class="sxs-lookup"><span data-stu-id="6d4c8-139">See Also</span></span>  
 <span data-ttu-id="6d4c8-140">[BizTalk Server データベースをクラスタ リング](../core/clustering-the-biztalk-server-databases1.md) </span><span class="sxs-lookup"><span data-stu-id="6d4c8-140">[Clustering the BizTalk Server Databases](../core/clustering-the-biztalk-server-databases1.md) </span></span>  
 <span data-ttu-id="6d4c8-141">[高可用性 BizTalk Server 環境を作成します。](../core/creating-a-highly-available-biztalk-server-environment.md) </span><span class="sxs-lookup"><span data-stu-id="6d4c8-141">[Creating a Highly Available BizTalk Server Environment](../core/creating-a-highly-available-biztalk-server-environment.md) </span></span>  
 [<span data-ttu-id="6d4c8-142">マスター シークレット サーバーをクラスター化する方法</span><span class="sxs-lookup"><span data-stu-id="6d4c8-142">How to Cluster the Master Secret Server</span></span>](../core/how-to-cluster-the-master-secret-server1.md)