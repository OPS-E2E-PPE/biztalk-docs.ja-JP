---
title: 'チュートリアル 4: BizTalk Server 2013 を使用してハイブリッド アプリケーションを作成する |Microsoft Docs'
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3a9de95f-7d2c-437d-be5b-0062592f32c6
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4dca1edae471c7d0bb588c4d9dc45168a4f66a2c
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37007987"
---
# <a name="tutorial-4-creating-a-hybrid-application-using-biztalk-server-2013"></a><span data-ttu-id="1ed52-102">チュートリアル 4: BizTalk Server 2013 を使用してハイブリッド アプリケーションを作成します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-102">Tutorial 4: Creating a Hybrid Application Using BizTalk Server 2013</span></span>
<span data-ttu-id="1ed52-103">ここでは、[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] と [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] が関連するハイブリッド アプリケーションを作成する方法の手順について説明します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-103">This section provides a step-by-step walkthrough on how to create a hybrid application involving [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  

## <a name="business-scenario"></a><span data-ttu-id="1ed52-104">ビジネス シナリオ</span><span class="sxs-lookup"><span data-stu-id="1ed52-104">Business Scenario</span></span>  
 <span data-ttu-id="1ed52-105">Northwind は取引先からフラット ファイル EDI メッセージの形式で販売注文を受けている企業であり、取引先の 1 社が Contoso です。</span><span class="sxs-lookup"><span data-stu-id="1ed52-105">Northwind is an enterprise that receives sales orders from its partners, one of them being Contoso, in the form of a flat-file EDI message.</span></span> <span data-ttu-id="1ed52-106">Northwind は、次のことを行うエンド ツー エンドのアプリケーションをセットアップしたいと考えています。</span><span class="sxs-lookup"><span data-stu-id="1ed52-106">Northwind wants to set up an end-to-end application that does the following:</span></span>  

- <span data-ttu-id="1ed52-107">**EDI メッセージの処理を管理**– アプリケーションのこのモジュールでは、Contoso から受信したメッセージを標準の EDI メッセージ形式に準拠していることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ed52-107">**Manage the EDI message processing** – This module of the application must verify that the message received from Contoso conforms to the standard EDI message formats.</span></span> <span data-ttu-id="1ed52-108">また、メッセージが正常に処理されたことを検証するために必要なすべての確認を生成する必要もあります。</span><span class="sxs-lookup"><span data-stu-id="1ed52-108">This module must also generate all the required acknowledgements to verify that the message is successfully processed.</span></span>  

- <span data-ttu-id="1ed52-109">**データを処理するビジネス ロジックを使用して**– EDI メッセージは正常に検証され、処理、Northwind がさらに処理するためのビジネス ロジックに対してメッセージを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ed52-109">**Use business logic to process the data** – Once the EDI message is successfully verified and processed, Northwind must run the message against business logic for further processing.</span></span> <span data-ttu-id="1ed52-110">たとえば、受信メッセージの注文数量が特定の数量を超えている場合、データは SQL Server データベースに格納され、</span><span class="sxs-lookup"><span data-stu-id="1ed52-110">For example, if the order quantity in the received message is more than a given amount, the data is stored in a SQL Server database.</span></span> <span data-ttu-id="1ed52-111">それ以外の場合は共有ファイルの場所に送信されるなどです。</span><span class="sxs-lookup"><span data-stu-id="1ed52-111">Otherwise, the data is sent to a shared file location.</span></span>  

  <span data-ttu-id="1ed52-112">Northwind は、このシナリオを実現するため、EDI メッセージ処理がクラウド上で実行され、ビジネス ロジックによるデータ処理が社内で実行されるようにするハイブリッド アプリケーションをセットアップすることに決定しました。</span><span class="sxs-lookup"><span data-stu-id="1ed52-112">To achieve this scenario, Northwind decides to set up a hybrid application where the EDI message processing is done on the cloud while the business-logic-driven data processing is done within the premises.</span></span> <span data-ttu-id="1ed52-113">Northwind は、このハイブリッド アプリケーションをセットアップするために、次のものを使用します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-113">To set up this hybrid application Northwind uses the following:</span></span>  

- <span data-ttu-id="1ed52-114">**[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)]**  – Azure BizTalk ポータルで使用可能な[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)]で取引先パートナーとの EDI 契約を構成できるように[!INCLUDE[winazure](../includes/winazure-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-114">**[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)]**  – The Azure BizTalk Portal available with [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] enables customers to configure trading partners and EDI agreements on [!INCLUDE[winazure](../includes/winazure-md.md)].</span></span> <span data-ttu-id="1ed52-115">Northwind は 2012 年 4 月リリースの [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] を使用して、受信 EDI メッセージを処理し、X12 840 販売注文スキーマに対してメッセージを検証し、Northwind で必要なスキーマに変換してから Service Bus キューに送信するアグリーメントを作成して展開します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-115">Northwind uses the [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] – April 2012 release to create and deploy an agreement that processes the incoming EDI message, validates it against the X12 840 sales order schema, transforms the message to a schema required by Northwind, and then sends the message to a Service Bus Queue.</span></span> <span data-ttu-id="1ed52-116">したがって、ハイブリッド アプリケーションを開発するため、データは Service Bus キューから社内アプリケーションに送信される必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ed52-116">So, to develop a hybrid application, the data should be sent from the Service Bus Queue to an on-premises application.</span></span>  

- <span data-ttu-id="1ed52-117">**[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]**  – Service Bus の新しいアダプター (**Sb-messaging**) で使用可能な[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]により、アプリケーションは、という具合にキュー、トピックなどの Service Bus エンティティからメッセージを受信する[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-117">**[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]**  – The new adapter for Service Bus (**SB-Messaging**) available with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] enables applications to receive messages from Service Bus entities like Queues, Topics, and so on into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="1ed52-118">一部として、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Northwind 使用して、アプリケーション、オーケストレーションに受信した販売注文の数量が 100 より大きいかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-118">As part of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application, Northwind uses an orchestration to decide whether the quantity requested in the received sales order is more than 100.</span></span> <span data-ttu-id="1ed52-119">メッセージがという名前の SQL Server データベース テーブルに挿入された数量が 100 を超える場合、 **SalesOrder**します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-119">If the quantity is more than 100, the message is inserted into a SQL Server database table called **SalesOrder**.</span></span> <span data-ttu-id="1ed52-120">この数量が 100 以下の場合、メッセージは共有ファイルの場所に送信されます。</span><span class="sxs-lookup"><span data-stu-id="1ed52-120">If the quantity is less than 100, the message is sent to a shared file location.</span></span>  

   <span data-ttu-id="1ed52-121">Northwind は、メッセージを SQL Server データベース テーブルに挿入するために、[!INCLUDE[adaptersql](../includes/adaptersql-md.md)] の一部として利用可能な [!INCLUDE[adapterpacknoversion](../includes/adapterpacknoversion-md.md)] を使用します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-121">To insert the message into a SQL Server database table, Northwind uses the [!INCLUDE[adaptersql](../includes/adaptersql-md.md)] available as part of the [!INCLUDE[adapterpacknoversion](../includes/adapterpacknoversion-md.md)].</span></span>  

### <a name="end-to-end-message-flow"></a><span data-ttu-id="1ed52-122">エンド ツー エンドのメッセージ フロー</span><span class="sxs-lookup"><span data-stu-id="1ed52-122">End-to-end Message Flow</span></span>  
 <span data-ttu-id="1ed52-123">ハイブリッド アプリケーションでのメッセージのフローは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="1ed52-123">This is how the message flows through the hybrid application:</span></span>  

1. <span data-ttu-id="1ed52-124">Contoso は X12 販売注文メッセージをエンドポイントに送信します。エンドポイントでは、クラウド上に EDI アグリーメントが展開されています。</span><span class="sxs-lookup"><span data-stu-id="1ed52-124">Contoso sends an X12 sales order message to the endpoint where the EDI agreement is deployed on the cloud.</span></span>  

2. <span data-ttu-id="1ed52-125">メッセージが正しく EDI アグリーメントを通じて処理されると、Service Bus キューに送信されます。</span><span class="sxs-lookup"><span data-stu-id="1ed52-125">After the message is successfully processed through the EDI agreement, it is sent to the Service Bus Queue.</span></span>  

3. <span data-ttu-id="1ed52-126">SB-Messaging 受信アダプターは Service Bus キューからのメッセージを処理し、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] に展開されているオーケストレーションをインスタンス化して、注文数量に基づいて異なる送信先にメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-126">SB-Messaging receive adapter consumes the message from the Service Bus Queue and instantiates the orchestration deployed in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to send the message to different destinations based on the order quantity.</span></span>  

4. <span data-ttu-id="1ed52-127">注文数量が 100 より大きい、オーケストレーションがメッセージを挿入、 **SalesOrder**テーブル。</span><span class="sxs-lookup"><span data-stu-id="1ed52-127">If the quantity ordered is greater than 100, the orchestration inserts the message to a **SalesOrder** table.</span></span> <span data-ttu-id="1ed52-128">注文数量が 100 以下の場合、メッセージは共有ファイルの場所に書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="1ed52-128">If the quantity ordered is less than or equal to 100, the message is written to a shared file location.</span></span>  

## <a name="set-up-your-computer"></a><span data-ttu-id="1ed52-129">コンピューターのセットアップ</span><span class="sxs-lookup"><span data-stu-id="1ed52-129">Set up Your Computer</span></span>  
 <span data-ttu-id="1ed52-130">このチュートリアルでは、4 つの広範なアクティビティを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1ed52-130">This tutorial requires you to perform four broad activities.</span></span> <span data-ttu-id="1ed52-131">次の表に、各アクティビティとそのソフトウェア要件を示します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-131">The following table lists the activities and the software requirements for each activity:</span></span>  


|                                                            <span data-ttu-id="1ed52-132">アクティビティ</span><span class="sxs-lookup"><span data-stu-id="1ed52-132">Activity</span></span>                                                             |                                                                                                                                              <span data-ttu-id="1ed52-133">必要なソフトウェア</span><span class="sxs-lookup"><span data-stu-id="1ed52-133">Required software</span></span>                                                                                                                                               |
|---------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                     <span data-ttu-id="1ed52-134">EDI アグリーメントに必要な EDI アイテムを作成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-134">Create the EDI artifacts required for the EDI agreement</span></span>                                     | <span data-ttu-id="1ed52-135">このチュートリアルは、2012 年 4 月リリースの [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] と、X12 840 販売注文スキーマを使用して作成されました。</span><span class="sxs-lookup"><span data-stu-id="1ed52-135">This tutorial was created with the [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] – April 2012 release as well as the X12 840 sales order schema.</span></span> <span data-ttu-id="1ed52-136">これらからダウンロードできます。 [ http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057)します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-136">These can be downloaded from [http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057).</span></span> |
|                                               <span data-ttu-id="1ed52-137">EDI アグリーメントを作成して展開する</span><span class="sxs-lookup"><span data-stu-id="1ed52-137">Create and deploy the EDI agreement</span></span>                                               |                                                                                 <span data-ttu-id="1ed52-138">EDI アグリーメントは Azure で展開されるので、Azure BizTalk Portal にログインするために必要なものは Web ブラウザー (Internet Explorer など) のみです。</span><span class="sxs-lookup"><span data-stu-id="1ed52-138">Because the EDI agreement is deployed on Azure, you only need a Web browser (e.g. Internet Explorer) to log in to the Azure BizTalk Portal.</span></span>                                                                                  |
| <span data-ttu-id="1ed52-139">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] アプリケーションを作成、展開、および構成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-139">Build, deploy, and configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application</span></span> |              <span data-ttu-id="1ed52-140">プロビジョニングする場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]にある指示に従って、Azure VM 上のコンピューター [ http://msdn.microsoft.com/library/azure/jj248689.aspx](http://msdn.microsoft.com/library/azure/jj248689.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-140">If you want to provision a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer on an Azure VM, follow the instructions at [http://msdn.microsoft.com/library/azure/jj248689.aspx](http://msdn.microsoft.com/library/azure/jj248689.aspx).</span></span>               |
|                                        <span data-ttu-id="1ed52-141">EDI アグリーメント エンドポイントにテスト メッセージを送信する</span><span class="sxs-lookup"><span data-stu-id="1ed52-141">Send a test message to the EDI agreement endpoint</span></span>                                        |   <span data-ttu-id="1ed52-142">[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] に同梱のサンプル パッケージにある MessageSender ツールを使用できます。</span><span class="sxs-lookup"><span data-stu-id="1ed52-142">You can use the MessageSender tool available in the samples package shipped with [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)].</span></span> <span data-ttu-id="1ed52-143">サンプル パッケージをダウンロードする[ http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057)します。</span><span class="sxs-lookup"><span data-stu-id="1ed52-143">You can download the samples package from [http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057).</span></span>   |

 <span data-ttu-id="1ed52-144">これらはすべて同じコンピューターにインストールすることも、別のコンピューターにインストールすることもできます。</span><span class="sxs-lookup"><span data-stu-id="1ed52-144">You can opt to install all these on the same computer or on different computers.</span></span>  

## <a name="in-this-section"></a><span data-ttu-id="1ed52-145">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="1ed52-145">In This Section</span></span>  

-   [<span data-ttu-id="1ed52-146">手順 1 (Azure 用): EDI プロジェクトを作成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-146">Step 1 (For Azure): Create the EDI Project</span></span>](../core/step-1-for-azure-create-the-edi-project.md)  

-   [<span data-ttu-id="1ed52-147">手順 2 (Azure 用): EDI アグリーメントを作成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-147">Step 2 (For Azure): Create an EDI Agreement</span></span>](../core/step-2-for-azure-create-an-edi-agreement.md)  

-   [<span data-ttu-id="1ed52-148">手順 3 (Azure 用): Service Bus キューを作成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-148">Step 3 (For Azure): Create a Service Bus Queue</span></span>](../core/step-3-for-azure-create-a-service-bus-queue.md)  

-   [<span data-ttu-id="1ed52-149">手順 4 (オンプレミス): SQL Server テーブルを作成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-149">Step 4 (On Premises): Create the SQL Server Table</span></span>](../core/step-4-on-premises-create-the-sql-server-table.md)  

-   [<span data-ttu-id="1ed52-150">手順 5 (オンプレミス): SalesOrder テーブルにメッセージを挿入するためのスキーマを生成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-150">Step 5 (On Premises): Generate the Schema for Inserting a Message inito SalesOrder Table</span></span>](../core/step-5-generate-the-schema-for-inserting-a-message-into-salesorder-table.md)  

-   [<span data-ttu-id="1ed52-151">手順 6 (オンプレミス): キューから Insert スキーマにメッセージをマップする変換を作成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-151">Step 6 (On Premises): Create a Transform to Map the Message from the Queue to the Insert Schema</span></span>](../core/step-6-map-the-message-from-the-queue-to-the-insert-schema.md)  

-   [<span data-ttu-id="1ed52-152">手順 7 (オンプレミス): オーケストレーションを作成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-152">Step 7 (On Premises): Create an Orchestration</span></span>](../core/step-7-on-premises-create-an-orchestration.md)  

-   [<span data-ttu-id="1ed52-153">手順 8 (オンプレミス): BizTalk Server アプリケーションを構成する</span><span class="sxs-lookup"><span data-stu-id="1ed52-153">Step 8 (On Premises): Configure the BizTalk Server Application</span></span>](../core/step-8-on-premises-configure-the-biztalk-server-application.md)  

-   [<span data-ttu-id="1ed52-154">手順 9: ソリューションのテスト</span><span class="sxs-lookup"><span data-stu-id="1ed52-154">Step 9: Test the Solution</span></span>](../core/step-9-test-the-solution.md)