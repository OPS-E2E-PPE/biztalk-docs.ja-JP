---
title: コンボイ シナリオの |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 1028ab37-7ead-41a6-a186-53e5344d1a28
caps.latest.revision: 19
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e3eb1e6656b6aa725cbc110030257df77657b631
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65258527"
---
# <a name="working-with-convoy-scenarios"></a>コンボイ シナリオの
A*コンボイ*必要な結果を実現するために複数の単一メッセージを関連付ける必要があります、必ず存在します。 コンボイの 2 つの主な種類があります: シーケンシャルおよび並列です。  
  
 特定の状況では、オーケストレーション インスタンスは、すべて同時に関連付けられたメッセージのグループを受信する可能性があります。 このような状況で、競合状態が発生するを相関関係が、他のメッセージがオーケストレーション インスタンスに関連付ける前に、オーケストレーション インスタンスで設定を初期化、グループ内のメッセージのいずれかの必要があります。  
  
 同じオーケストレーション インスタンスによって受信されるすべてのメッセージを相関させるは、BizTalk Server は、このような競合状態が発生する可能性を検出しをコンボイとして処理します。 、参加時に、ランタイムは、一般的なサブスクリプションを作成し、なコンボイの一部として識別します。 このサブスクリプションの入力後は、メッセージング エンジンは、定義済みの関連付けのプロパティの値に基づいて一時サブスクリプションを作成します。 この一時サブスクリプションと呼ばれる、*コンボイ セット*します。 コンボイ セットは、なコンボイで使用される関連付けセットのグループです。 全般サブスクリプションに一致するすべての後続のメッセージが、コンボイ セットに対して評価されと一致するものは、既存のポートにルーティングされます。  
  
## <a name="using-convoys-with-business-processes"></a>ビジネス プロセスでコンボイの使用  
 ビジネス プロセスでコンボイ処理を使用する場合は、次を考慮してください。  
  
-   A*関連付けセット*特定のビジネス プロセスにメッセージをルーティングを使用する特定の値を持つプロパティの一覧を示します。 関連付けセットで使用される、**受信**図形で関連付けに使用される 4 つ以上のプロパティを含めることはできません。 これらの値が識別され、最大 3 つのパラメーターをサポートするデータベース レベルで格納されているためにです。  
  
-   並列および順次のコンボイは、同じビジネス プロセスで共存させることができますが、相互関連付けセットを共有することはできません。 各関連付けセットを 1 つだけのコンボイに所属できるためです。  
  
-   コンボイ処理を使用する場合は、BizTalk Server でサポートされません、**オーケストレーションの開始**渡すよう初期化済みの関連付けセットに新しいオーケストレーションに図形。 これは、コンボイ セットが既に実行中のオーケストレーション インスタンスの独立したデータベース レベルで処理されるためです。  
  
-   1 つを使用することはできません**受信**図形を別々 のコンボイで使用される 2 つ以上の関連付けセットを初期化します。 たとえば、受信するとします r1 初期化関連付けセット c1 と c2 最初のコンボイ用は 2 番目のコンボイ用の c1 に r2 を受信して、3 番目のコンボイ用の次のように c2 に r3 を受信します。 2 番目のコンボイ用のコンボイ セットは c1、r2 と 3 番目のコンボイ用のコンボイ セットは c2 および r3 はすべて r1 によって初期化されます。 この場合、オーケストレーション エンジンでは、これらをコンボイとして処理はしません。 R2 と r3 の両方が c1 と c2 の両方に従う場合、この例は有効なコンボイ シナリオ (c1、r2、r3、および c2、r2、r3)、どちらも次の c1 のみ (c1、r2、r3)、または次 c2 のみ (c2、r2、r3) の両方。  
  
## <a name="zombies"></a>ゾンビ  
 ゾンビと呼ばれる「失われた」メッセージのコンボイの使用は可能性があります。 非アクティブな受信時に実行中のオーケストレーション内のサブスクリプション、メッセージ ボックス データベース内のメッセージに一致し、メッセージ ボックスは、オーケストレーションにメッセージを配信します。 メッセージ ボックスに、オーケストレーション内のビジネス ロジックを把握していないため、単にオーケストレーションに配信するサブスクリプションに一致するすべてのメッセージ。 オーケストレーションの実行フローがメッセージを処理する受信サブスクリプションを渡されるときにこれらのメッセージが配信される場合、このようなメッセージはゾンビ状態になります。  
  
 ゾンビを作成する状況の例は、17 回、反復処理するループ内での受信が 18 のメッセージが配信される、ループに受信サブスクリプションに一致します。 (メッセージ ボックスを認識しませんオーケストレーション ロジックは 17 個のメッセージのみが処理される。)実行フローには、ループが既に終了しているので、18 のメッセージが配信されるは、オーケストレーションによって処理されませんが。 破棄されたメッセージ (ゾンビ) は、オーケストレーション インスタンスが既に完了したため、再開可能なオーケストレーションが完了しました。  
  
 ゾンビを管理するには、「中断 (再開不可)」状態を使用して、インスタンスのクエリを実行する Windows Management Instrumentation (WMI) スクリプトを使用します。 「完了メッセージを破棄して」、イベントにはさらに、ログ、メッセージング エンジンは、エラー メッセージを書き込みます。  
  
 さらに、実行時間の長いトランザクションのスコープを持つシーケンシャルなコンボイがあり、スコープはタイムアウトに設定されている場合一部のオーケストレーション インスタンスを「中断 (再開不可)」状態終了可能性があります。 出力メッセージの数と「中断 (再開不可)」インスタンスの数が入力メッセージの数より少なくすることもあります。 この動作は仕様による結果です。 タイムアウト例外が発生したときに、コードは、例外ハンドラーに移動します。 BizTalk Server では、ゾンビの処理を含む、例外を処理できるようにする例外ハンドラーを呼び出します。 例外ハンドラーで送信ポートを使用して、ゾンビをこれ以上のレビューと処理のための変換先に送信することができます。  
  
 コンボイ以外のシナリオでもゾンビを生成できます。 たとえば、何らかの理由で一致する 2 つのサブスクリプションの応答メッセージを受信、オーケストレーション インスタンスが、ビジネス プロセスの 1 つの応答メッセージを指定してください。 この場合、2 番目の応答メッセージはゾンビになります。 別の例は、ある場合、**リッスン**図形の**受信**1 つの分岐に図形と**遅延**他の分岐にある図形です。 同時に、タイムアウトが発生するメッセージが到着すると、メッセージはゾンビになります。  
  
 ゾンビを管理する方法の詳細については、次を参照してください。**中断サービス インスタンスを削除する**[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]します。
  
## <a name="next-steps"></a>次のステップ
 [シーケンシャルなコンボイ](../core/sequential-convoys.md)  
  
 [パラレルなコンボイ](../core/parallel-convoys.md)  
  
## <a name="see-also"></a>参照  
 [オーケストレーションでの関連付けの使用](../core/using-correlations-in-orchestrations.md)