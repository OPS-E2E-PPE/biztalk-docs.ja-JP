---
title: MDN メッセージ |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 16ac6253-0be5-4636-b102-bf5af8956261
caps.latest.revision: 20
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c2ac015986c78f97082321171ca2fcd01a4854e6
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65380012"
---
# <a name="mdn-messages"></a><span data-ttu-id="82ac2-102">MDN メッセージ</span><span class="sxs-lookup"><span data-stu-id="82ac2-102">MDN Messages</span></span>
<span data-ttu-id="82ac2-103">Message Disposition Notification (MDN) は、AS2 メッセージに対する応答として送信される受信確認です。</span><span class="sxs-lookup"><span data-stu-id="82ac2-103">The Message Disposition Notification (MDN) is the acknowledgment sent in response to an AS2 message.</span></span> <span data-ttu-id="82ac2-104">MDN を有効にすると、MDN の受信と検証が完了するまで、AS2 による送信は完了しません。</span><span class="sxs-lookup"><span data-stu-id="82ac2-104">If an MDN is enabled, the AS2 transmission is not complete until the MDN has been received and verified.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="82ac2-105">常に、AS2 メッセージの処理で、エラーが発生した場合でも、メッセージ処理のステータスを示す MDN の返信を試みます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-105">will always attempt to return an MDN to indicate the status of message processing, even if an error occurred in processing the AS2 message.</span></span>  
  
 <span data-ttu-id="82ac2-106">MDN により、以下のことを検証できます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-106">The MDN provides verification of the following:</span></span>  
  
-   <span data-ttu-id="82ac2-107">**受信側のパーティによって受信された元のメッセージが正常が**します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-107">**That the original message was successfully received by the receiving party**.</span></span> <span data-ttu-id="82ac2-108">元のメッセージの送信者は、送信メッセージの MessageID と、受信者が MDN に格納した original-message-id フィールドを比較することによって、これを検証します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-108">The sender of the original message verifies this by comparing the MessageID of the original sent message with the original-message-id field that the receiver included in the MDN.</span></span>  
  
-   <span data-ttu-id="82ac2-109">**交換されるデータの整合性が受信者によって検証されたこと**します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-109">**That the integrity of the data exchanged was verified by the receiving partner**.</span></span> <span data-ttu-id="82ac2-110">元のメッセージの送信者は、送信メッセージ ペイロードから算出した MIC と、受信者が受信メッセージ ペイロードを基に算出し、MDN の Received-content-MIC フィールドに格納した MIC を比較することによって、これを検証します (署名付き MDN の場合)。</span><span class="sxs-lookup"><span data-stu-id="82ac2-110">The sender of the original message verifies this by comparing the MIC that was calculated from the original sent message payload, with the MIC that the receiver calculated on the received message payload and included in the Received-content-MIC field of the MDN (if signed).</span></span>  
  
-   <span data-ttu-id="82ac2-111">**確認メッセージの非否認が**します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-111">**That there is a non-repudiation of receipt**.</span></span> <span data-ttu-id="82ac2-112">送信者は、受信者の公開キーを使用して署名付きの MDN を検証し、MDN 内の返された MIC の値が、否認不可データベースに格納された元のメッセージ ペイロードの MIC と同じであることを確認することによって、これを検証します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-112">The sender does this by verifying the signed MDN with the receiving partner's public key, and by verifying that the returned MIC value in the MDN is the same as the MIC for the original message payload stored in the non-repudiation database.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="82ac2-113">同期 MDN は、HTTP 応答 ("200 OK" など) としても機能します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-113">A synchronous MDN serves as an HTTP Response, e.g., 200 OK.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="82ac2-114">Mdn の受信側の処理の詳細については、次を参照してください。[受信 MDN の処理](../core/processing-an-incoming-mdn.md)します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-114">For more information about receive-side processing of MDNs, see [Processing an Incoming MDN](../core/processing-an-incoming-mdn.md).</span></span> <span data-ttu-id="82ac2-115">Mdn の送信側の処理の詳細については、次を参照してください。[送信 MDN の送信](../core/sending-an-outgoing-mdn.md)します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-115">For more information about send-side processing of MDNs, see [Sending an Outgoing MDN](../core/sending-an-outgoing-mdn.md).</span></span>  
  
## <a name="properties-used-to-generate-the-mdn"></a><span data-ttu-id="82ac2-116">MDN の生成に使用されるプロパティ</span><span class="sxs-lookup"><span data-stu-id="82ac2-116">Properties Used to Generate the MDN</span></span>  
 <span data-ttu-id="82ac2-117">AS2Receive 受信パイプラインは、パーティの AS2 アグリーメントのプロパティを使用する場合、MDN を生成、**検証および MDN に対してメッセージ ヘッダーの代わりにアグリーメントの設定を使用して**で一方向アグリーメントタブでプロパティが選択されています。**アグリーメントのプロパティ** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="82ac2-117">The AS2Receive receive pipeline will generate an MDN using a party's AS2 agreement properties if the **Use agreement settings for validation and MDN instead of message header** property is selected on the one-way agreement tab in the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="82ac2-118">この場合、MDN の生成時にメッセージ ヘッダーの AS2-From プロパティが使用されますが、他のプロパティはパーティの AS2 アグリーメント設定から取得されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-118">In this instance, the AS2-From property in the message header will be used in generating the MDN, but other properties will be taken from the party's AS2 agreement settings.</span></span>  
  
 <span data-ttu-id="82ac2-119">AS2 プロパティをオーバーライドするオプションが選択されていない場合や、パーティの AS2 プロパティが使用可能な場合は、受信パイプラインは受信メッセージの AS2 ヘッダー タグを使用して MDN を生成します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-119">If the option to override AS2 property is not selected, or the party’s AS2 agreement is available, the receive pipeline will generate the MDN using the AS2 header tags in the incoming message.</span></span>  
  
 <span data-ttu-id="82ac2-120">MDN には署名を付加できますが、MDN を暗号化または圧縮することはできません。</span><span class="sxs-lookup"><span data-stu-id="82ac2-120">An MDN can be signed, but it cannot be encrypted or compressed.</span></span>  
  
## <a name="mdn-context-properties"></a><span data-ttu-id="82ac2-121">MDN のコンテキスト プロパティ</span><span class="sxs-lookup"><span data-stu-id="82ac2-121">MDN Context Properties</span></span>  
 <span data-ttu-id="82ac2-122">MDN メッセージの処理に使用されるコンテキスト プロパティには、昇格できるプロパティや非公開のプロパティが含まれますが、これらのプロパティは中断されたメッセージや追跡メッセージで表示できます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-122">Context properties used in processing MDN messages include properties that can be promoted as well as properties that are not publicly exposed, but can be viewed in suspended and tracked messages.</span></span> <span data-ttu-id="82ac2-123">これらのコンテキスト プロパティの一覧は、次を参照してください。 [AS2 コンテキスト プロパティ](../core/as2-context-properties.md)します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-123">For a list of these context properties, see [AS2 Context Properties](../core/as2-context-properties.md).</span></span>  
  
 <span data-ttu-id="82ac2-124">MDN を生成するには、DispositionMode および DispositionType の両コンテキスト プロパティを昇格させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="82ac2-124">Both the DispositionMode and DispositionType context properties must be promoted in order for an MDN to be generated.</span></span> <span data-ttu-id="82ac2-125">AS2 または EDI ペイロードでエラーが発生すると、DispositionType プロパティによってエラーが通知されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-125">If an error occurs in the AS2 or EDI payload, the DispositionType property will indicate the error.</span></span> <span data-ttu-id="82ac2-126">このプロパティを表示、**メッセージの詳細**で中断されたサービス インスタンスから (サービスの詳細 ダイアログ ボックス) を使用して表示されるダイアログ ボックス、**グループ ハブ**のページ、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソール。</span><span class="sxs-lookup"><span data-stu-id="82ac2-126">You can see this property in the **Message Details** dialog box that is displayed (via the Service Details dialog box) from the Suspended service instances in the **Group Hub** page of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console.</span></span> <span data-ttu-id="82ac2-127">ヘッダーでエラーが発生すると、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は DispositionType プロパティによってエラーを通知し、MDN の送信を試みますが、エラーによっては MDN を送信できない場合があります。</span><span class="sxs-lookup"><span data-stu-id="82ac2-127">If an error occurs in the header, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will indicate the error in the DispositionType property, and will attempt to send the MDN, but depending on the error, may not be able to do so.</span></span>  
  
## <a name="mdn-headers"></a><span data-ttu-id="82ac2-128">MDN のヘッダー</span><span class="sxs-lookup"><span data-stu-id="82ac2-128">MDN Headers</span></span>  
 <span data-ttu-id="82ac2-129">MDN には次のヘッダーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-129">The MDN contains the following headers:</span></span>  
  
- <span data-ttu-id="82ac2-130">**Http/as2 ヘッダー**します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-130">**HTTP/AS2 headers**.</span></span> <span data-ttu-id="82ac2-131">詳細については、次を参照してください。 [AS2 メッセージ](../core/as2-messages.md)します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-131">For more information, see [AS2 Messages](../core/as2-messages.md).</span></span>  
  
- <span data-ttu-id="82ac2-132">**転送層**します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-132">**Transfer Layer**.</span></span> <span data-ttu-id="82ac2-133">これには、Content-Type ヘッダー ("signed multipart message" を含む)、MIC のアルゴリズム、署名の書式設定プロトコル、および最も外側のマルチパート境界サブヘッダーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-133">This includes the Content-Type header that includes the signed multipart message, the algorithm for the MIC, the signature formatting protocol, and the outermost multipart boundary sub-headers.</span></span>  
  
- <span data-ttu-id="82ac2-134">**第 1 部**します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-134">**First Part**.</span></span> <span data-ttu-id="82ac2-135">マルチパートの署名付きメッセージの第 1 部は、添付された MDN です。</span><span class="sxs-lookup"><span data-stu-id="82ac2-135">The first part of the multipart signed message is the embedded MDN.</span></span> <span data-ttu-id="82ac2-136">これは人間が判読できます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-136">It is human readable.</span></span>  
  
- <span data-ttu-id="82ac2-137">**2 番目の部分**します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-137">**Second Part**.</span></span> <span data-ttu-id="82ac2-138">マルチパートの署名付きメッセージの第 2 部は、デジタル署名、元のメッセージへの参照、配置の種類と状態、および MIC の値で構成されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-138">The second part of the multipart signed message contains the digital signature, a reference to the original message, the disposition type and status, and the MIC value.</span></span> <span data-ttu-id="82ac2-139">これはコンピューターによる処理が可能な形式です。</span><span class="sxs-lookup"><span data-stu-id="82ac2-139">It is machine readable.</span></span>  
  
  <span data-ttu-id="82ac2-140">AS2-From ヘッダー、AS2-To ヘッダー、および MessageID コンテキスト プロパティは、MDN を応答対象の AS2 メッセージに関連付けるために使用されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-140">The AS2-From header, AS2-To header, and MessageID context property are used to correlate an MDN to the AS2 message that it is responding to.</span></span> <span data-ttu-id="82ac2-141">MDN の Original-Message-ID ヘッダーは、MDN の応答対象である AS2 メッセージの Message-ID ヘッダーから取得されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-141">The Original-Message-ID header in an MDN comes from the Message-ID header of the AS2 message that the MDN is responding to.</span></span>  
  
## <a name="mic"></a><span data-ttu-id="82ac2-142">MIC</span><span class="sxs-lookup"><span data-stu-id="82ac2-142">MIC</span></span>  
 <span data-ttu-id="82ac2-143">メッセージ整合性チェック (MIC) は、MDN が元の送信メッセージ ペイロードに関連付けられていることを検証するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-143">The Message Integrity Check (MIC) is used to verify that an MDN correlates to the original sent message payload.</span></span> <span data-ttu-id="82ac2-144">MIC ダイジェストは、マルチパートの署名付き MDN メッセージの第 2 部にある Received-Content-MIC 拡張フィールドに格納されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-144">The MIC digest is included in the Received-Content-MIC extension field in the second part of the multipart signed MDN message.</span></span>  
  
 <span data-ttu-id="82ac2-145">MDN を有効にすると、AS2 送信パイプラインは、送信メッセージの処理時にメッセージ ペイロードから MICHashValue を計算します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-145">If an MDN is enabled, when the AS2 send pipeline processes an outbound message, it computes a MICHashValue from the message payload.</span></span> <span data-ttu-id="82ac2-146">送信パイプラインは、このハッシュ値を BizTalkMsgBoxDb データベースの EdiInt_Mic テーブルに保存します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-146">The send pipeline saves the hash value in the EdiInt_Mic table of the BizTalkMsgBoxDb database.</span></span> <span data-ttu-id="82ac2-147">AS2 メッセージの追跡はこのテーブルで行われ、AS2From、AS2To、および MessageID の各値と、テーブル内の MICHashValue 列によって一意に識別されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-147">AS2 messages are tracked in this table, identified uniquely by the AS2From, AS2To, and MessageID values, with an accompanying MICHashValue column.</span></span> <span data-ttu-id="82ac2-148">メッセージの受信者は、メッセージ ペイロードの処理時に MIC ハッシュ値を計算し、返信する MDN にそのハッシュ値を格納します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-148">The receiver of the message calculates the MIC hash value when it processes the message payload, and includes the hash value in the MDN that it returns.</span></span> <span data-ttu-id="82ac2-149">元のメッセージの送信者は、受信した MDN 内の MIC ハッシュ値と、保存されているハッシュ値を比較します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-149">The sender of the original message will compare the MIC hash value in the MDN that it receives with the hash value that it saved.</span></span> <span data-ttu-id="82ac2-150">両者が一致すると、元のメッセージの送信者は MDN を廃棄し、EdiInt_Mic テーブル内のエントリを削除します。これで送信が完了します。</span><span class="sxs-lookup"><span data-stu-id="82ac2-150">If they match, it disposes of the MDN, deletes the entry in the EdiInt_Mic table, and the transmission is complete.</span></span>  
  
 <span data-ttu-id="82ac2-151">MIC は base64 でエンコードされます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-151">The MIC is base64 encoded.</span></span> <span data-ttu-id="82ac2-152">MIC に適用されるアルゴリズムは、SHA1 または MD5 です。</span><span class="sxs-lookup"><span data-stu-id="82ac2-152">The algorithm to be applied for the MIC can be SHA1 or MD5.</span></span> <span data-ttu-id="82ac2-153">決定されます、**署名アルゴリズム**ドロップダウン (場合に有効**署名付き MDN を要求**プロパティがチェックされます) で、**送信者の MDN 設定**一方向のアグリーメントのページタブで、**アグリーメントのプロパティ** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="82ac2-153">It is determined from the **Signing Algorithm** drop-down (enabled if **Request Signed MDN** property is checked) in the **Sender MDN Settings** page of the one-way agreement tab in the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="82ac2-154">また、元のメッセージの Signed-Receipt-MICalg AS2 ヘッダーからも決定されます。</span><span class="sxs-lookup"><span data-stu-id="82ac2-154">It is also determined from the Signed-Receipt-MICalg AS2 header of the original message.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="82ac2-155">参照</span><span class="sxs-lookup"><span data-stu-id="82ac2-155">See Also</span></span>  
 <span data-ttu-id="82ac2-156">[AS2 メッセージ](../core/as2-messages.md) </span><span class="sxs-lookup"><span data-stu-id="82ac2-156">[AS2 Messages](../core/as2-messages.md) </span></span>  
 <span data-ttu-id="82ac2-157">[受信 MDN の処理](../core/processing-an-incoming-mdn.md) </span><span class="sxs-lookup"><span data-stu-id="82ac2-157">[Processing an Incoming MDN](../core/processing-an-incoming-mdn.md) </span></span>  
 [<span data-ttu-id="82ac2-158">送信 MDN の送信</span><span class="sxs-lookup"><span data-stu-id="82ac2-158">Sending an Outgoing MDN</span></span>](../core/sending-an-outgoing-mdn.md)