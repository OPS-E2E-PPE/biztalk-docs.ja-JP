---
title: "送信アダプタの WCF での WCF サービスを使用する際の考慮事項 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- consuming, WCF services
- best practices, WCF services
- WCF services, best practices
- consuming, best practices
- WCF services, consuming
ms.assetid: 8bbcfd99-3495-458d-bd7a-6d170a29dde2
caps.latest.revision: "17"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b2bb1e512b8a13c3d91b87bbfc410c3d21f334fb
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="considerations-when-consuming-wcf-services-with-the-wcf-send-adapters"></a><span data-ttu-id="e4a4f-102">WCF サービスを WCF 送信アダプタと共に使用する場合の考慮事項</span><span class="sxs-lookup"><span data-stu-id="e4a4f-102">Considerations When Consuming WCF Services with the WCF Send Adapters</span></span>
<span data-ttu-id="e4a4f-103">このトピックでは、WCF サービスを WCF アダプタと共に使用する際に考慮する必要がある情報を示します。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-103">This topic provides information that you should take into consideration when consuming WCF services with the WCF adapters.</span></span>  
  
## <a name="use-the-template----content-specified-by-template-option-when-sending-non-xml-content-as-solicit-messages"></a><span data-ttu-id="e4a4f-104">XML 以外のコンテンツを送信請求メッセージとして送信する場合は、[テンプレート -- テンプレートで指定されたコンテンツ] オプションを使用する</span><span class="sxs-lookup"><span data-stu-id="e4a4f-104">Use the "Template -- content specified by template" option when sending non-XML content as solicit messages</span></span>  
 <span data-ttu-id="e4a4f-105">WCF アダプターで**ボディ--BizTalk 応答メッセージ本文**(既定値) オプション文字データやビットマップ イメージなどの XML 以外のメッセージを送信することはできます。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-105">The WCF adapters with **Body -- BizTalk response message body** (the default value) option do not allow sending non-XML message such as character data and bitmap images.</span></span> <span data-ttu-id="e4a4f-106">使用することができます、**テンプレート--テンプレートで指定されたコンテンツ**WCF アダプターでは XML 以外のメッセージを送信するためのオプションです。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-106">You can use the **Template -- content specified by template** option for the WCF adapters to send non-XML messages.</span></span> <span data-ttu-id="e4a4f-107">テンプレートを使用する方法の詳細については、次を参照してください。[に関する考慮事項と WCF サービスを公開、WCF 受信アダプタ](../core/considerations-when-publishing-wcf-services-with-the-wcf-receive-adapters.md)です。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-107">For more information about how to use the template, see [Considerations When Publishing WCF Services with the WCF Receive Adapters](../core/considerations-when-publishing-wcf-services-with-the-wcf-receive-adapters.md).</span></span>  
  
## <a name="the-wcf-basichttp-and-wcf-wshttp-send-ports-always-ignore-the-proxy-if-the-service-address-begins-with-httplocalhost"></a><span data-ttu-id="e4a4f-108">サービスのアドレスが http://localhost で始まる場合、WCF-BasicHttp と WCF-WSHttp の送信ポートはプロキシを常に無視する</span><span class="sxs-lookup"><span data-stu-id="e4a4f-108">The WCF-BasicHttp and WCF-WSHttp send ports always ignore the proxy if the service address begins with http://localhost</span></span>  
 <span data-ttu-id="e4a4f-109">Wcf-basichttp と Wcf-wshttp の送信ポートはプロキシを常に無視でプロキシが構成されているかどうかに、サービス アドレスが http://localhost で始まる場合、**プロキシ**の送信ポート タブまたは**プロキシ** タブイベントの送信ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-109">The WCF-BasicHttp and WCF-WSHttp send ports always ignore the proxy if the service address begins with http://localhost whether the proxy is configured on the **Proxy** tab of the send port or the **Proxy** tab of the send handler.</span></span> <span data-ttu-id="e4a4f-110">クライアントが同じコンピュータ上のサービスと対話するときにプロキシを通過するようにするには、(localhost ではなく) ホスト名を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-110">You should use the host name (rather than localhost) if you want clients to go through a proxy when talking to services on the same computer.</span></span>  
  
## <a name="the-wcf-basichttp-and-wcf-wshttp-send-adapters-suspend-the-messages-if-the-proxy-setting-is-not-correctly-configured"></a><span data-ttu-id="e4a4f-111">プロキシ設定が正しく指定されていない場合、WCF-BasicHttp と WCF-WSHttp の送信アダプタはメッセージを保留する</span><span class="sxs-lookup"><span data-stu-id="e4a4f-111">The WCF-BasicHttp and WCF-WSHttp send adapters suspend the messages if the proxy setting is not correctly configured</span></span>  
 <span data-ttu-id="e4a4f-112">Wcf-basichttp と Wcf-wshttp 送信アダプタの設定、プロキシを指定することができます、**プロキシ**の送信ポート タブまたは**プロキシ**の送信ハンドラー タブ。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-112">You can specify the proxy setting for the WCF-BasicHttp and WCF-WSHttp send adapters on the **Proxy** tab of the send port or the **Proxy** tab of the send handler.</span></span> <span data-ttu-id="e4a4f-113">このプロキシ設定が正しく指定されていない場合は、WCF アダプタによってメッセージが保留され、「メッセージを受信できるアドレスでリッスンしているエンドポイントがありませんでした」という内容のエラー メッセージがイベント ログに返されます。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-113">If this proxy setting is not correctly configured, the WCF adapters suspend the messages, and you receive the "There was no endpoint listening that could accept the message" error message in the event log.</span></span>  
  
## <a name="setting-up-the-permissions-for-a-wcf-send-port-with-the-wcf-netmsmq-adapter"></a><span data-ttu-id="e4a4f-114">WCF-NetMsmq アダプタの WCF 送信ポートに対してアクセス許可を設定する</span><span class="sxs-lookup"><span data-stu-id="e4a4f-114">Setting up the permissions for a WCF send port with the WCF-NetMsmq adapter</span></span>  
 <span data-ttu-id="e4a4f-115">WCF-NetMsmq アダプタの WCF 送信ポートは、NetMsmqBinding によって公開された Web サービスにメッセージを送信する場合、サービスのキュー マネージャによって管理されている対象キューにこのメッセージの宛先を指定します。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-115">When a WCF send port with the WCF-NetMsmq adapter sends a message to a WCF service published with the NetMsmqBinding, it addresses the message to the target queue, which is the queue managed by the service's queue manager.</span></span> <span data-ttu-id="e4a4f-116">クライアント上のキュー マネージャーは、メッセージを転送 (または送信) キューに送ります。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-116">The queue manager on the client sends the message to a transmission (or outgoing) queue.</span></span> <span data-ttu-id="e4a4f-117">転送キューは、対象キューに転送するためのメッセージを格納する、クライアント側キュー マネージャー上のキューです。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-117">The transmission queue is a queue on the client-side queue manager that stores messages for transmission to the target queue.</span></span>  
  
 <span data-ttu-id="e4a4f-118">サービスのキュー マネージャーは、それが所有する対象キューに宛先指定されたメッセージを受け入れて、格納します。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-118">The service's queue manager accepts messages addressed to the target queues it owns and stores the messages.</span></span> <span data-ttu-id="e4a4f-119">次に、サービスが対象キューからの読み取り要求を行い、キュー マネージャーがメッセージをサービスに配布します。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-119">Then, the service makes requests to read from the target queue, and the queue manager delivers the messages to the service.</span></span> <span data-ttu-id="e4a4f-120">そのため、送信ポートをホストする BizTalk ホスト インスタンスのサービス アカウントには、転送キューに書き込むためのアクセス許可を与える必要があります。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-120">For this reason, the service account for the BizTalk host instance hosting the send port should have the permissions to write on the transmission queue.</span></span>  
  
## <a name="use-an-empty-xpath-expression-to-receive-a-soap-message-with-character-data-in-the-content-of-the-soap-body-element"></a><span data-ttu-id="e4a4f-121">SOAP Body 要素のコンテンツに文字データが含まれた SOAP メッセージを受信するには、空の XPath 式を使用する</span><span class="sxs-lookup"><span data-stu-id="e4a4f-121">Use an empty XPath expression to receive a SOAP message with character data in the content of the SOAP Body element</span></span>  
 <span data-ttu-id="e4a4f-122">送信請求 - 応答の WCF 送信ポートは、WCF メッセージを応答メッセージとして受信できます。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-122">The solicit-response WCF send port can receive a WCF message as a response message.</span></span> <span data-ttu-id="e4a4f-123">SOAP のコンテンツに文字データの受信応答メッセージから BizTalk メッセージを作成する**本文**要素の次の例に示すように、おく必要があります、 **XPath 式**テキスト ボックス空の**メッセージ**WCF アダプター トランスポートのプロパティ ダイアログ ボックスのタブです。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-123">To create a BizTalk message from an incoming response message with character data in the content of the SOAP **Body** element as shown in the following example, you should leave the **XPath expression** text box empty on the **Message** tab in the WCF adapter transport properties dialog box.</span></span>  
  
```  
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing">  
    <s:Header>  
      ...  
    </s:Header>  
    <s:Body>Contoso</s:Body>  
</s:Envelope>  
```  
  
 <span data-ttu-id="e4a4f-124">選択した場合、**エンベロープ**または**本文**オプション、アダプターは作成されません、BizTalk メッセージの受信メッセージからです。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-124">If you select the **Envelope** or **Body** option, the adapter does not create the BizTalk message from the incoming message.</span></span> <span data-ttu-id="e4a4f-125">受信 SOAP マーシャリング プロセスでエラーとなったメッセージは保留されないので、このメッセージは保留されません。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-125">The message is not suspended because messages that fail in the inbound SOAP marshaling processing are not suspended.</span></span> <span data-ttu-id="e4a4f-126">XPath 式を使用する方法について、**メッセージ** タブを参照してください[WCF アダプタのメッセージの本文を指定する](../core/specifying-the-message-body-for-the-wcf-adapters.md)です。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-126">For more information about how to use the XPath expression on the **Message** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e4a4f-127">BTSNTSvc.exe.config ファイルを構成すると、Windows SDK の TraceViewer ツール (SvcTraceViewer.exe) を使用できます。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-127">You can use the TraceViewer tool (SvcTraceViewer.exe) in the Windows SDK by configuring the BTSNTSvc.exe.config.file.</span></span> <span data-ttu-id="e4a4f-128">Windows SDK の詳細についてを参照してください「の Windows SDK は」で[http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219)です。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-128">For more information about the Windows SDK, see "What's New in the Windows SDK" at [http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219).</span></span> <span data-ttu-id="e4a4f-129">TraceViewer ツールの詳細についてで「TraceViewer ツール (SvcTraceViewer.exe)」を参照してください。 [http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218)です。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-129">For more information about the TraceViewer tool, see "TraceViewer Tool (SvcTraceViewer.exe)" at [http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218).</span></span>  
  
## <a name="biztalk-server-does-not-use-multi-part-message-types-and-root-elements-describing-custom-soap-headers"></a><span data-ttu-id="e4a4f-130">BizTalk Server は、カスタム SOAP ヘッダーを表すルート要素とマルチパート メッセージの種類を使用しない</span><span class="sxs-lookup"><span data-stu-id="e4a4f-130">BizTalk Server does not use multi-part message types and root elements describing custom SOAP headers</span></span>  
 <span data-ttu-id="e4a4f-131">カスタム SOAP ヘッダーが定義されたメタデータに対して BizTalk WCF サービス使用ウィザードを実行した場合、生成後のスキーマには、カスタム SOAP ヘッダーを表すルート要素が生成されます。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-131">If you run the BizTalk WCF service Consuming Wizard against metadata where custom SOAP headers are defined, the wizard generates root elements in the generated schemas to represent the custom SOAP headers.</span></span> <span data-ttu-id="e4a4f-132">また、カスタム SOAP ヘッダーのオーケストレーション内に、マルチパート メッセージの種類も作成されます。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-132">The wizard also creates multi-part message types in orchestrations for the custom SOAP headers.</span></span> <span data-ttu-id="e4a4f-133">BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-133">BizTalk Server.</span></span> <span data-ttu-id="e4a4f-134">ただし、BizTalk Server は、カスタム SOAP ヘッダーを処理するために、マルチパート メッセージの種類とルート要素を使用しません。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-134">However, BizTalk Server does not use multi-part message types and root elements to handle the custom SOAP headers.</span></span>  
  
 <span data-ttu-id="e4a4f-135">カスタム SOAP ヘッダーにアクセスする必要がありますを使用する、 **InboundHeaders**プロパティです。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-135">To access custom SOAP headers, you should use the **InboundHeaders** property.</span></span> <span data-ttu-id="e4a4f-136">カスタム SOAP ヘッダーの受信の詳細については、次を参照してください。[公開された WCF サービスでの SOAP ヘッダー](../core/soap-headers-with-published-wcf-services.md)です。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-136">For more information about receiving custom SOAP headers, see [SOAP Headers with Published WCF Services](../core/soap-headers-with-published-wcf-services.md).</span></span> <span data-ttu-id="e4a4f-137">カスタム SOAP ヘッダーを使用するには、使用する必要があります、 **OutboundCustomHeaders**プロパティです。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-137">To use custom SOAP headers, you should use the **OutboundCustomHeaders** property.</span></span> <span data-ttu-id="e4a4f-138">カスタム SOAP ヘッダーを送信する方法の詳細については、次を参照してください。[消費される WCF サービスでの SOAP ヘッダー](../core/soap-headers-with-consumed-wcf-services.md)です。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-138">For more information about sending custom SOAP headers, see [SOAP Headers with Consumed WCF Services](../core/soap-headers-with-consumed-wcf-services.md).</span></span>  
  
## <a name="create-separate-host-instances-for-send-ports-that-use-different-proxy-addresses-andor-proxy-credentials"></a><span data-ttu-id="e4a4f-139">プロキシ アドレス/プロキシ資格情報が異なる送信ポートごとに別のホスト インスタンスを作成する</span><span class="sxs-lookup"><span data-stu-id="e4a4f-139">Create separate host instances for send ports that use different proxy addresses and/or proxy credentials</span></span>  
 <span data-ttu-id="e4a4f-140">WCF 送信アダプタのパフォーマンスを最大化するには、使用するプロキシ アドレス/プロキシ資格情報が異なる送信ポートごとに別のホスト インスタンスを作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-140">To achieve the best possible performance for WCF send adapters, we recommend that you create separate host instances for send ports that use different proxy addresses and/or proxy credentials.</span></span> <span data-ttu-id="e4a4f-141">これにより、プロキシ設定の競合を防ぐことができます。</span><span class="sxs-lookup"><span data-stu-id="e4a4f-141">This avoids contention on proxy settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e4a4f-142">参照</span><span class="sxs-lookup"><span data-stu-id="e4a4f-142">See Also</span></span>  
 [<span data-ttu-id="e4a4f-143">BTSNTSvc.exe.config ファイル</span><span class="sxs-lookup"><span data-stu-id="e4a4f-143">BTSNTSvc.exe.config File</span></span>](../core/btsntsvc-exe-config-file.md)