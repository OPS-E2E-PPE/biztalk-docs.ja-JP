---
title: オーケストレーションをアップグレードする方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: ef3f032f-28a1-4d52-9d85-d5748c9e9682
caps.latest.revision: 21
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 96d3b340d796d2cf3a63e206a74b0faa43acafa6
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65333642"
---
# <a name="how-to-upgrade-an-orchestration"></a><span data-ttu-id="43f1e-102">オーケストレーションをアップグレードする方法</span><span class="sxs-lookup"><span data-stu-id="43f1e-102">How to Upgrade an Orchestration</span></span>
<span data-ttu-id="43f1e-103">オーケストレーションの実行時間の長いトランザクションを処理またはが送信請求-応答ポートからの応答を待機しているときに、運用環境で実行されているオーケストレーションを更新する方法。</span><span class="sxs-lookup"><span data-stu-id="43f1e-103">How to update an orchestration that is running in a production environment when the orchestration handles long-running transactions or is waiting for a response from a solicit-response port.</span></span>

## <a name="overview"></a><span data-ttu-id="43f1e-104">概要</span><span class="sxs-lookup"><span data-stu-id="43f1e-104">Overview</span></span>
 <span data-ttu-id="43f1e-105">オーケストレーションは、実行時間の長いトランザクションを処理できない、更新する」の説明に従って[チェックリスト。BizTalk アプリケーション内のアイテムの更新](../core/checklist-update-the-artifacts-in-a-biztalk-application.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-105">When an orchestration does not handle long-running transactions, you can update it as described in [Checklist: Update the Artifacts in a BizTalk Application](../core/checklist-update-the-artifacts-in-a-biztalk-application.md).</span></span> <span data-ttu-id="43f1e-106">オーケストレーションでは、実行時間の長いトランザクションを処理するときにただし、切り替えることはできません、オーケストレーションの更新されたバージョンにすぐにします。</span><span class="sxs-lookup"><span data-stu-id="43f1e-106">When an orchestration handles long-running transactions, however, you cannot cut over to the updated version of the orchestration immediately.</span></span> <span data-ttu-id="43f1e-107">メッセージの処理を完了する元のバージョンを許可するが失われないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="43f1e-107">You must allow the original version to finish processing its messages, so that they are not lost.</span></span> <span data-ttu-id="43f1e-108">これを行うには、元の 1 つとして、同じアプリケーションに更新されたオーケストレーションを展開します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-108">To accomplish this, you deploy the updated orchestration into the same application as the original one.</span></span> <span data-ttu-id="43f1e-109">元のバージョンを停止し、以前のバージョンがインフライト メッセージの処理を続行中には、すべての新しいメッセージを受信するように、更新されたバージョンを開始します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-109">You then stop the original version and start the updated version so that it receives all new messages while the previous version continues to process any in-flight messages.</span></span> <span data-ttu-id="43f1e-110">元のオーケストレーションは、そのすべてのメッセージの処理が終了したらが展開された BizTalk アプリケーションから解除します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-110">After the original orchestration has finished processing all of its messages, you undeploy it from the BizTalk application in which it was deployed.</span></span>  
  
 <span data-ttu-id="43f1e-111">このシナリオの詳細については、次を参照してください。[シナリオ。アプリケーション アイテムの更新](../core/scenario-updating-application-artifacts.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-111">For more information about this scenario, see [Scenario: Updating Application Artifacts](../core/scenario-updating-application-artifacts.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="43f1e-112">1 つ以上のオーケストレーションがバインドされている場合、同じ受信ポート、および各オーケストレーションを開始または参加している、システムに重複するメッセージが発生します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-112">If more than one orchestration is bound to the same receive port, and each orchestration is started or enlisted, you will introduce duplicate messages into the system.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="43f1e-113">新しいオーケストレーションにアップグレードするときに一部のオーケストレーション インスタンスできますになる中断 (再開可能) 負荷が高い新旧のオーケストレーションと、アップグレード中に新しいオーケストレーション間の競合状態が原因です。</span><span class="sxs-lookup"><span data-stu-id="43f1e-113">When upgrading to a new orchestration, some orchestration instances can become Suspended (resumable) under high stress because of the race condition between the old orchestration and the new orchestration during the upgrade.</span></span> <span data-ttu-id="43f1e-114">これらのオーケストレーション インスタンスを手動で再開するを参照してください。[中断したオーケストレーション インスタンスの再開方法](../core/how-to-resume-suspended-orchestration-instances.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-114">To manually resume these orchestration instances, see [How to Resume Suspended Orchestration Instances](../core/how-to-resume-suspended-orchestration-instances.md).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="43f1e-115">前提条件</span><span class="sxs-lookup"><span data-stu-id="43f1e-115">Prerequisites</span></span>  
<span data-ttu-id="43f1e-116">メンバーであるアカウントでサインイン、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理者グループ。</span><span class="sxs-lookup"><span data-stu-id="43f1e-116">Sign in with an account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group.</span></span> <span data-ttu-id="43f1e-117">自分のアカウントも、ローカル ファイル システムおよびグローバル アセンブリ キャッシュに対する読み取り/書き込みアクセス許可が必要です。</span><span class="sxs-lookup"><span data-stu-id="43f1e-117">Your account also must have Read/Write permission on the local file system, and the global assembly cache.</span></span> <span data-ttu-id="43f1e-118">ローカル コンピューターの管理者アカウントには、このアクセス許可があります。</span><span class="sxs-lookup"><span data-stu-id="43f1e-118">The Administrators account on the local computer has this permission.</span></span>  

<span data-ttu-id="43f1e-119">詳細なアクセス許可についてを参照してください。[を展開すると、BizTalk アプリケーションの管理に必要なアクセス許可](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md)、および[最低限のセキュリティ権限](https://social.technet.microsoft.com/wiki/contents/articles/24590.minimum-security-rights-for-biztalk-server-2006-to-2016.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-119">For more detailed information about permissions, see [Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md), and [Minimum Security Rights ](https://social.technet.microsoft.com/wiki/contents/articles/24590.minimum-security-rights-for-biztalk-server-2006-to-2016.aspx).</span></span> 
 
## <a name="update-an-orchestration"></a><span data-ttu-id="43f1e-120">オーケストレーションを更新します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-120">Update an orchestration</span></span>  
  
1.  <span data-ttu-id="43f1e-121">オーケストレーションに必要な変更を行います。</span><span class="sxs-lookup"><span data-stu-id="43f1e-121">Make the necessary changes to the orchestration.</span></span>  
  
2.  <span data-ttu-id="43f1e-122">次のように、アセンブリのバージョン番号を増やします。</span><span class="sxs-lookup"><span data-stu-id="43f1e-122">Increment the assembly version number, as follows:</span></span>  
  
    1.  <span data-ttu-id="43f1e-123">ソリューション エクスプ ローラーで BizTalk プロジェクトを右クリックし をクリックし、**プロパティ**をプロジェクトのプロジェクト デザイナーを起動します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-123">In Solution Explorer, right-click the BizTalk project, and then click **Properties** to launch the Project Designer for the project.</span></span>  
  
    2.  <span data-ttu-id="43f1e-124">をクリックして、**アプリケーション** タブがアクティブでない場合、クリックして**アセンブリ情報**します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-124">Click the **Application** tab if it is not already active, and then click **Assembly Information**.</span></span>  
  
    3.  <span data-ttu-id="43f1e-125">右側のウィンドウで、アセンブリのバージョン番号を増やします。</span><span class="sxs-lookup"><span data-stu-id="43f1e-125">In the right pane, increase the assembly version number.</span></span> <span data-ttu-id="43f1e-126">メジャーまたはマイナー バージョン番号のみを増やす必要があります。</span><span class="sxs-lookup"><span data-stu-id="43f1e-126">You should increase only the major or minor version number.</span></span> <span data-ttu-id="43f1e-127">メジャー バージョン番号は、シーケンスの最初の桁 (**0**.0.0.0); マイナー バージョン番号は、シーケンス内の 2 番目の数字 (0 **。0**.0.0) です。</span><span class="sxs-lookup"><span data-stu-id="43f1e-127">The major version number is the first digit in the sequence (**0**.0.0.0); the minor version number is the second digit in the sequence (0.**0**.0.0).</span></span> <span data-ttu-id="43f1e-128">BizTalk Server では、0.0 などのシーケンスの後のバージョン番号の変更は認識されません。**0**.0 や 0.0.0 **。0**します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-128">BizTalk Server will not recognize a version number change that is later in the sequence, such as 0.0.**0**.0 or 0.0.0.**0**.</span></span>  
  
    4.  <span data-ttu-id="43f1e-129">をクリックして**OK**を閉じる、**アセンブリ情報** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="43f1e-129">Click **OK** to close the **Assembly Information** dialog box.</span></span>  
  
    5.  <span data-ttu-id="43f1e-130">プロジェクトを保存します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-130">Save the project.</span></span>  
  
3.  <span data-ttu-id="43f1e-131">Visual Studio から BizTalk アプリケーションにアセンブリを展開します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-131">Deploy the assembly from Visual Studio into a BizTalk application.</span></span> <span data-ttu-id="43f1e-132">手順については、次を参照してください。 [BizTalk アプリケーションに Visual Studio から BizTalk アセンブリを展開する](../core/deploying-biztalk-assemblies-from-visual-studio-into-a-biztalk-application.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-132">For instructions, see [Deploying BizTalk Assemblies from Visual Studio into a BizTalk Application](../core/deploying-biztalk-assemblies-from-visual-studio-into-a-biztalk-application.md).</span></span> <span data-ttu-id="43f1e-133">GAC にアセンブリをインストールする展開オプションを選択することを確認します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-133">Make sure you select the deployment option to install the assembly in the GAC.</span></span>  
  
4.  <span data-ttu-id="43f1e-134">オーケストレーションを含むアセンブリをテストします。</span><span class="sxs-lookup"><span data-stu-id="43f1e-134">Test the assembly containing the orchestration.</span></span>  
  
5.  <span data-ttu-id="43f1e-135">」の説明に従って、.msi ファイルに、テスト環境でのアプリケーションからアセンブリをエクスポート[BizTalk アプリケーションのエクスポート方法](../core/how-to-export-a-biztalk-application.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-135">Export the assembly from the application in your test environment into an .msi file, as described in [How to Export a BizTalk Application](../core/how-to-export-a-biztalk-application.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="43f1e-136">次の手順を使用するには、運用環境に展開すると、アセンブリをテストします。</span><span class="sxs-lookup"><span data-stu-id="43f1e-136">You can use the following steps for testing the assembly as well as deploying it into your production environment.</span></span> <span data-ttu-id="43f1e-137">開発、テスト、ステージング、および運用環境でアプリケーション展開作業の詳細については、次を参照してください。[アプリケーション展開作業](../core/application-deployment-tasks.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-137">For more information about application deployment tasks in development, test, staging, and production, see [Application Deployment Tasks](../core/application-deployment-tasks.md).</span></span>  
  
6.  <span data-ttu-id="43f1e-138">」の説明に従って、更新するオーケストレーションを含む実稼働環境で BizTalk アプリケーションに .msi ファイルをインポート[BizTalk アプリケーションをインポートする方法](../core/how-to-import-a-biztalk-application.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-138">Import the .msi file into the BizTalk application in your production environment that contains the orchestration that you want to update, as described in [How to Import a BizTalk Application](../core/how-to-import-a-biztalk-application.md).</span></span>  
  
7.  <span data-ttu-id="43f1e-139">」の説明に従って、元のオーケストレーションとして同じバインディングを使用して、更新されたオーケストレーションをバインド[オーケストレーションのバインドを構成する方法](../core/how-to-configure-bindings-for-an-orchestration.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-139">Bind the updated orchestration using the same bindings as the original orchestration, as described in [How to Configure Bindings for an Orchestration](../core/how-to-configure-bindings-for-an-orchestration.md).</span></span>  
  
8.  <span data-ttu-id="43f1e-140">元のオーケストレーションの参加を解除し、更新されたオーケストレーションを開始します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-140">Unenlist the original orchestration, and then start the updated orchestration.</span></span> <span data-ttu-id="43f1e-141">メッセージの消失を回避する必要がありますこれを行う」の説明に従って、プログラムで[展開とプログラム、オーケストレーションの新しいバージョンを開始](../core/deploying-and-starting-a-new-version-of-an-orchestration-programmatically.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-141">To avoid any dropped messages, you should do this programmatically, as described in [Deploying and Starting a New Version of an Orchestration Programmatically](../core/deploying-and-starting-a-new-version-of-an-orchestration-programmatically.md).</span></span> <span data-ttu-id="43f1e-142">」の説明に従って、手動でこれらの手順を実行する代わりに、[オーケストレーションを参加解除する方法](../core/how-to-unenlist-an-orchestration.md)、[オーケストレーションを参加させる方法](../core/how-to-enlist-an-orchestration.md)、および[オーケストレーションを開始する方法](../core/how-to-start-an-orchestration.md).</span><span class="sxs-lookup"><span data-stu-id="43f1e-142">Alternatively, you can perform these steps manually, as described in [How to Unenlist an Orchestration](../core/how-to-unenlist-an-orchestration.md), [How to Enlist an Orchestration](../core/how-to-enlist-an-orchestration.md), and [How to Start an Orchestration](../core/how-to-start-an-orchestration.md).</span></span>  
  
9. <span data-ttu-id="43f1e-143">システムの監視」の説明に従って、グループのハブを使用して元のオーケストレーションのバージョンのインスタンスがクエリのビューをページ[オーケストレーションのインスタンス情報を表示する方法](../core/how-to-view-instance-information-for-an-orchestration.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-143">Monitor the system for instances of the original orchestration version using the Group Hub page query view, as described in [How to View Instance Information for an Orchestration](../core/how-to-view-instance-information-for-an-orchestration.md).</span></span>  
  
10. <span data-ttu-id="43f1e-144">説明されているように、アプリケーションから元のオーケストレーションを展開解除、すべてのアクティブ、退避済み、および中断されたインスタンスが完了したら、[オーケストレーションをアプリケーションから削除する方法](../core/how-to-remove-an-orchestration-from-an-application.md)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-144">When all of its active, dehydrated, and suspended instances are complete, undeploy the original orchestration from the application, as described in [How to Remove an Orchestration from an Application](../core/how-to-remove-an-orchestration-from-an-application.md).</span></span>  
  
11. <span data-ttu-id="43f1e-145">必要に応じて」の説明に従って、アプリケーションを実行している各コンピューターの GAC から元のアセンブリ バージョンをアンインストール[GAC からアセンブリをアンインストールする方法](http://msdn.microsoft.com/library/464706a8-f902-4d05-a724-19169facd2b4)します。</span><span class="sxs-lookup"><span data-stu-id="43f1e-145">Optionally uninstall the original assembly version from the GAC on each computer running the application, as described in [How to Uninstall an Assembly from the GAC](http://msdn.microsoft.com/library/464706a8-f902-4d05-a724-19169facd2b4).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="43f1e-146">参照</span><span class="sxs-lookup"><span data-stu-id="43f1e-146">See Also</span></span>  
 <span data-ttu-id="43f1e-147">[BizTalk アプリケーションの更新](../core/updating-biztalk-applications.md) </span><span class="sxs-lookup"><span data-stu-id="43f1e-147">[Updating BizTalk Applications](../core/updating-biztalk-applications.md) </span></span>  
 [<span data-ttu-id="43f1e-148">オーケストレーションの管理</span><span class="sxs-lookup"><span data-stu-id="43f1e-148">Managing Orchestrations</span></span>](../core/managing-orchestrations.md)