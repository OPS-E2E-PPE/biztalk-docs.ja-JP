---
title: ボトルネックを回避するためのガイドライン |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 640ab399-b22d-4f71-b41d-ea8d778e064a
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 45071b7990d8fd4a926efa56b9e98cbd633553ac
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37017810"
---
# <a name="guidelines-for-avoiding-bottlenecks"></a><span data-ttu-id="4377d-102">ボトルネックを回避するためのガイドライン</span><span class="sxs-lookup"><span data-stu-id="4377d-102">Guidelines for Avoiding Bottlenecks</span></span>
<span data-ttu-id="4377d-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の既定の設定は、多くのハードウェアやソフトウェアの構成に最適なパフォーマンスを提供しますが、シナリオによっては、設定や展開構成を変更すると効果的な場合があります。</span><span class="sxs-lookup"><span data-stu-id="4377d-103">While the default settings in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provide optimal performance for many hardware and software configurations, in some scenarios it may be beneficial to modify the settings or deployment configuration.</span></span> <span data-ttu-id="4377d-104">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] を構成するときは、次のパフォーマンス ガイドラインを考慮してください。</span><span class="sxs-lookup"><span data-stu-id="4377d-104">When configuring [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], consider the following performance guidelines:</span></span>  

-   <span data-ttu-id="4377d-105">リソース競合を回避するには、受信、オーケストレーション、および送信を、個別のホストに分離します。</span><span class="sxs-lookup"><span data-stu-id="4377d-105">To prevent resource contention, isolate receiving, orchestration, and sending onto separate hosts.</span></span> <span data-ttu-id="4377d-106">競合をさらに最小限に抑えるには、追跡サービスを他のホストから分離します。</span><span class="sxs-lookup"><span data-stu-id="4377d-106">To further minimize contention, isolate the tracking service from other hosts.</span></span>  

-   <span data-ttu-id="4377d-107">BizTalk Server 上の CPU 処理がボトルネックである場合は、CPU を追加するか、より高速の CPU にアップグレードして、BizTalk Server をスケール アップします。</span><span class="sxs-lookup"><span data-stu-id="4377d-107">If CPU processing on the BizTalk Server is the bottleneck, scale up BizTalk Server by including additional CPUs or upgrading to faster CPUs.</span></span>  

## <a name="sql-server-guidelines"></a><span data-ttu-id="4377d-108">SQL Server のガイドライン</span><span class="sxs-lookup"><span data-stu-id="4377d-108">SQL Server Guidelines</span></span>  
 <span data-ttu-id="4377d-109">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] で Microsoft SQL Server を構成するときは、次のパフォーマンス ガイドラインを考慮してください。</span><span class="sxs-lookup"><span data-stu-id="4377d-109">Consider the following performance guidelines when configuring Microsoft SQL Server with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  

- [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="4377d-110"> データベースは、できるだけ専用の SQL Server インスタンスで実行するよう構成してください。</span><span class="sxs-lookup"><span data-stu-id="4377d-110"> databases should be configured to run on a dedicated SQL Server instance whenever possible.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="4377d-111"> は、データベース中心のアプリケーションです。そのため、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] コンピューターと、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] データベースを格納する SQL Server コンピューターとを分離することでパフォーマンスが向上します。これは、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 運用環境のベスト プラクティスといえます。</span><span class="sxs-lookup"><span data-stu-id="4377d-111"> is a databases intensive application, so separation of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer(s) and the SQL Server computer(s) that house the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases will improve performance and should be considered a best practice in a production [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span>  

- <span data-ttu-id="4377d-112">可能であれば、高速なディスク サブシステムを SQL Server で使用するようにします。</span><span class="sxs-lookup"><span data-stu-id="4377d-112">Whenever possible, use a fast disk subsystem with SQL Server.</span></span> <span data-ttu-id="4377d-113">RAID5/10 (Redundant Array of Independent Disks type 5) またはストレージ エリア ネットワーク (SAN) を、バックアップの電源装置と共に使用します。</span><span class="sxs-lookup"><span data-stu-id="4377d-113">Use a redundant array of independent disks type 5 (RAID5/10) or a storage area network (SAN) with backup power supply.</span></span>  

- <span data-ttu-id="4377d-114">SQL Server のディザスター リカバリー プロセスを使用して、データベースを定期的にバックアップします。</span><span class="sxs-lookup"><span data-stu-id="4377d-114">Use the SQL Server disaster recovery process to back up your databases regularly.</span></span> <span data-ttu-id="4377d-115">BizTalk Server サービスは、SQL Server の接続障害から自動的に復旧します。</span><span class="sxs-lookup"><span data-stu-id="4377d-115">The BizTalk Server service automatically recovers from SQL Server connection malfunctions.</span></span>  

- <span data-ttu-id="4377d-116">BizTalk 追跡データベース (BizTalkDTADb) から各メッセージ ボックスを個別のサーバーに分離します。</span><span class="sxs-lookup"><span data-stu-id="4377d-116">Isolate each message box onto a separate server from the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="4377d-117">小規模な展開で CPU リソースが使用可能であれば、BizTalkDTADb データベースからメッセージ ボックスを個別の物理ディスクに分離するだけで十分な場合もあります。</span><span class="sxs-lookup"><span data-stu-id="4377d-117">For smaller deployments if CPU resources are available, isolating the message box onto a separate physical disk from the BizTalkDTADb database might be sufficient.</span></span>  

- <span data-ttu-id="4377d-118">プライマリ メッセージ ボックスは、CPU プロセッサの飽和やディスク操作からの待機時間 (Average Disk Queue Length) が原因でボトルネックとなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="4377d-118">The primary MessageBox could be the bottleneck due to CPU processor saturation or latency from disk operations (average disk queue length).</span></span> <span data-ttu-id="4377d-119">CPU 処理がボトルネックである場合は、プライマリ メッセージ ボックスに CPU プロセッサを追加します。</span><span class="sxs-lookup"><span data-stu-id="4377d-119">If CPU processing is the bottleneck, add CPU processors to the primary message box.</span></span> <span data-ttu-id="4377d-120">指定しない場合、この方法がマスター メッセージ ボックスが、他のメッセージ ボックス データベースにメッセージのルーティングを処理できるより効率的にマスター メッセージ ボックスでのパブリッシングを無効にしてください。</span><span class="sxs-lookup"><span data-stu-id="4377d-120">If not try disabling publishing on the Master MessageBox, this way the Master MessageBox can more efficiently handle routing of messages to the other MessageBox databases.</span></span>  

- <span data-ttu-id="4377d-121">ディスク操作がボトルネックである場合は、BizTalkDTADb データベースを専用の SQL Server コンピューターまたは専用のディスクに移動します。</span><span class="sxs-lookup"><span data-stu-id="4377d-121">If disk operations are the bottleneck, move the BizTalkDTADb database to a dedicated SQL Server computer and/or dedicated disk.</span></span> <span data-ttu-id="4377d-122">プライマリ メッセージ ボックスの CPU 処理もディスク操作もボトルネックでない場合は、既存のハードウェアを利用して、同じ SQL Server コンピューター上に新しいメッセージ ボックス データベースを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4377d-122">If CPU processing and disk operations on the primary message box are not the bottleneck, you can create new MessageBox databases on the same SQL Server computer to leverage your existing hardware.</span></span>  

- <span data-ttu-id="4377d-123">SQL Server のベスト プラクティスに従って、MessageBox データベースと BizTalkDTADb データベースのトランザクションおよびデータ ログ ファイルを、個別の物理ディスクに分離します。</span><span class="sxs-lookup"><span data-stu-id="4377d-123">Follow SQL Server best practices to isolate the transaction and data log files for the MessageBox and BizTalkDTADb databases onto separate physical disks.</span></span>  

- <span data-ttu-id="4377d-124">データ ファイルとログ ファイルには十分な記憶域を割り当てるようにします。そうしないと、ログ ファイルが格納されているディスク上の使用可能な全容量が、SQL Server によって自動的に消費されます。</span><span class="sxs-lookup"><span data-stu-id="4377d-124">Allocate sufficient storage space for the data and log files; otherwise SQL Server will automatically consume all of the available space on the disks that the log files are kept.</span></span> <span data-ttu-id="4377d-125">ログ ファイルの初期サイズは、特定のシナリオにおける個別の要件によって異なります。</span><span class="sxs-lookup"><span data-stu-id="4377d-125">Initial size of the log files will depend on the specific requirements in your particular scenario.</span></span> <span data-ttu-id="4377d-126">テスト結果に基づいて展開の平均ファイル サイズを見積もり、ソリューションの実装前に記憶域を拡張します。</span><span class="sxs-lookup"><span data-stu-id="4377d-126">Estimate the average file size in your deployment based on testing results, and expand the storage space before implementing your solution.</span></span>  

- <span data-ttu-id="4377d-127">メッセージ ボックス データベース、追跡データベース、ビジネス アクティビティ監視 (BAM) データベースなど、ディスク使用率の高いデータベースに十分な記憶域を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="4377d-127">Allocate sufficient storage space for high-disk-usage databases, such as the MessageBox, Tracking, and Business Activity Monitoring (BAM) databases.</span></span> <span data-ttu-id="4377d-128">ソリューションで BizTalk Framework メッセージング プロトコルを使用する場合は、BizTalk 構成データベース (BizTalkMgmtDb) に十分な記憶域を割り当てます。</span><span class="sxs-lookup"><span data-stu-id="4377d-128">If your solution uses the BizTalk Framework messaging protocol, allocate sufficient storage space for the BizTalk Configuration database (BizTalkMgmtDb).</span></span>  

- <span data-ttu-id="4377d-129">特定のシナリオにおけるビジネス ニーズ [データの保有期間] および処理対象データの量に応じて、追跡データベースの Archive/Purge ジョブを構成して、BizTalkDTADb データベースが大きくなりすぎないようにします。</span><span class="sxs-lookup"><span data-stu-id="4377d-129">Depending on business needs [data retention periods] and the volume of data processed in your particular scenario, configure the Archive/Purge jobs on the Tracking database such that the BizTalkDTADb database does not grow too large.</span></span> <span data-ttu-id="4377d-130">このデータベースが大きくなると、パフォーマンスが悪影響を受ける可能性があります (特に 1 つの BizTalkDTADb データベースで複数のメッセージ ボックスをサポートする場合)。データベース容量の上限に達すると、データ挿入率が制限されるためです。</span><span class="sxs-lookup"><span data-stu-id="4377d-130">The growth of this database can degrade performance (especially when one BizTalkDTADb database supports multiple message boxes) because reaching the full capacity of the database imposes a limit on the rate of data insertion.</span></span>  

- <span data-ttu-id="4377d-131">メッセージ ボックス データベースおよび BizTalkDTADb データベースをホストするサーバーがボトルネックである場合は、これらのサーバーをスケール アップします。</span><span class="sxs-lookup"><span data-stu-id="4377d-131">Scale up the servers hosting the MessageBox and BizTalkDTADb databases if they are the bottleneck.</span></span> <span data-ttu-id="4377d-132">CPU の追加、メモリの追加、高速な CPU へのアップグレード、および高速な専用ディスクの使用によって、ハードウェアをスケール アップできます。</span><span class="sxs-lookup"><span data-stu-id="4377d-132">You can scale up the hardware by adding CPUs, adding memory, upgrading to faster CPUs and using high-speed dedicated disks.</span></span>
