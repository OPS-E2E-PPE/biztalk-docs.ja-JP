---
title: BizTalk Server メッセージ |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- messages, properties
- messages, about messages
ms.assetid: 6048c191-b495-4fdc-b547-e3e322340a49
caps.latest.revision: 17
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 3d59978b4c54e4245b79fb04cbb02546af8ad795
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36997619"
---
# <a name="the-biztalk-server-message"></a><span data-ttu-id="d27a9-102">BizTalk Server メッセージ</span><span class="sxs-lookup"><span data-stu-id="d27a9-102">The BizTalk Server Message</span></span>
<span data-ttu-id="d27a9-103">基本的に、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は、メッセージ処理エンジンです。</span><span class="sxs-lookup"><span data-stu-id="d27a9-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is, at its core, a message-handling engine.</span></span> <span data-ttu-id="d27a9-104">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の詳細を理解するには、メッセージと BizTalk Server によるメッセージの表示、保存、および処理の方法を理解することが重要です。</span><span class="sxs-lookup"><span data-stu-id="d27a9-104">To understand the details of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], it is important to understand messages and how they are represented, stored, and processed by BizTalk Server.</span></span> <span data-ttu-id="d27a9-105">メッセージの概要を理解すると、BizTalk Server でのメッセージ処理の詳細が理解しやすくなります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-105">The details of how BizTalk Server works with messages become easier to understand after you have gained an understanding of what a message is.</span></span>  
  
 <span data-ttu-id="d27a9-106">BizTalk Server の各メッセージは、マルチパート メッセージと見なされ、0 個以上の部分で構成されます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-106">Each message in BizTalk Server is considered a multi-part message and is made up of zero or more parts.</span></span> <span data-ttu-id="d27a9-107">1 つ以上の部分で構成される各メッセージには、ボディ部として認識される部分があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-107">Each message with one or more parts has one of these parts identified as the body part.</span></span> <span data-ttu-id="d27a9-108">各部分は、バイナリ データで構成され、XML ドキュメント、フラット ファイル、シリアル化された .NET クラス、または他のバイナリ ストリームのデータを表すことができます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-108">Each part consists of a binary chunk of data which can represent an XML document, a flat file, a serialized .NET class, or other binary stream of data.</span></span> <span data-ttu-id="d27a9-109">メッセージのボディ部を使用して、ルーティングに使用できるメッセージの種類を確認します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-109">You use the body part of the message to identify the type of the message that can be used for routing.</span></span>  
  
 <span data-ttu-id="d27a9-110">非常に重要な概念として、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] のメッセージはすべて変更不可であることを理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-110">A very important concept to understand is that all messages are immutable in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="d27a9-111">つまり、いったん構築したメッセージは、変更することができません。</span><span class="sxs-lookup"><span data-stu-id="d27a9-111">This means that after a message is constructed, it cannot be changed.</span></span> <span data-ttu-id="d27a9-112">メッセージがメッセージ ボックス データベースに格納されると、メッセージは構築されたと見なされます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-112">A message is considered constructed after it is placed into the MessageBox database.</span></span> <span data-ttu-id="d27a9-113">メッセージを変更するには、新しいメッセージを作成して、使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-113">Any changes to the message require that a new message is created and used from that point forward.</span></span> <span data-ttu-id="d27a9-114">これは、オーケストレーション デザイナーで特に明白です。オーケストレーション デザイナーでは、コンパイル ルールを使用して、メッセージを使用する前にメッセージの構築に関する厳密なガイドラインに従います。また、構築ブロックの外部でのメッセージの変更を許可しません。</span><span class="sxs-lookup"><span data-stu-id="d27a9-114">This is especially clear in the Orchestration Designer, where compilation rules force you to follow strict guidelines about constructing a message before using it, and do not allow the message to be altered outside of its construction block.</span></span> <span data-ttu-id="d27a9-115">メッセージを変更する必要がある場合、同じ種類のメッセージを作成する新しい構築ブロックを作成し、元のメッセージを新しいメッセージにコピーし、構築ブロックから出る前に新しいメッセージに変更を加える必要があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-115">If you need to change the message, you must create a new construction block that creates a message of the same type, copy the original message to the new message, and then make any changes to the new message before leaving the construction block.</span></span>  
  
## <a name="message-properties"></a><span data-ttu-id="d27a9-116">メッセージ プロパティ</span><span class="sxs-lookup"><span data-stu-id="d27a9-116">Message Properties</span></span>  
 <span data-ttu-id="d27a9-117">システム内の各メッセージだけでなく、メッセージを構成する部品と呼ばれるものに付随するプロパティのセットがあります、*メッセージ コンテキスト*します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-117">In addition to the parts that make up a message, each message in the system has a set of properties that go along with it in what is known as the *message context*.</span></span> <span data-ttu-id="d27a9-118">これらのプロパティは、メッセージから抽出される値またはメッセージに関連する値です。</span><span class="sxs-lookup"><span data-stu-id="d27a9-118">These properties can be values extracted from or related to the message itself.</span></span> <span data-ttu-id="d27a9-119">たとえば、アダプターは、メッセージを受信した場所やメッセージの受信に使用したアダプターの種類などのメッセージの受信に関連するコンテキストにプロパティを配置します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-119">For example, adapters put properties into the context related to the receiving of a message, such as the location at which the message was received, and the type of adapter that was used to receive the message.</span></span> <span data-ttu-id="d27a9-120">プロパティは、コンテキストに書き込むかできますまたは*昇格*コンテキストにします。</span><span class="sxs-lookup"><span data-stu-id="d27a9-120">Properties can either be written to the context, or *promoted* into the context.</span></span> <span data-ttu-id="d27a9-121">この 2 つのオプションの違いは、メッセージのルーティングの条件として、昇格したプロパティを使用できることです。書き込まれたプロパティは使用できません。</span><span class="sxs-lookup"><span data-stu-id="d27a9-121">The difference between these two options is that promoted properties can be used as criteria in message routing while written properties cannot.</span></span>  
  
 <span data-ttu-id="d27a9-122">コンテキストへの値の書き込みまたは昇格というこの概念は、BizTalk エディターのプロパティの昇格に関連しています。ただし、同じではありません。</span><span class="sxs-lookup"><span data-stu-id="d27a9-122">This concept of writing or promoting values to the context is related to, but not the same as, promoting properties in the BizTalk Editor.</span></span> <span data-ttu-id="d27a9-123">BizTalk エディターで、スキーマの要素または属性は、昇格させたプロパティまたは識別フィールドとしてフラグを付けることができます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-123">In the BizTalk Editor, an element or attribute in a schema can be flagged as a promoted property or a distinguished field.</span></span> <span data-ttu-id="d27a9-124">メッセージ スキーマ内のプロパティ フィールドの注釈が付いたアイテムは、コンテキスト内の昇格させたプロパティを設定するパイプラインの逆アセンブラーになります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-124">Items that are marked with PropertyField annotations in your message schema will lead to the pipeline disassembler putting a Promoted property in the context.</span></span> <span data-ttu-id="d27a9-125">メッセージ スキーマ内の識別フィールドの注釈が付いたアイテムは、コンテキストに書き込まれたプロパティを設定するパイプラインの逆アセンブラーになります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-125">Items that are marked with DistinguishedField annotations in your message schema will lead to the pipeline disassembler putting a Written property into the context.</span></span>  
  
 <span data-ttu-id="d27a9-126">昇格させたプロパティのデザインのデザインの使用を開始*メッセージの相関関係*: 既に実行中のオーケストレーション インスタンスに受信されるメッセージに関連する機能。</span><span class="sxs-lookup"><span data-stu-id="d27a9-126">The design for promoted properties started with the design of *message correlation*: the ability to relate a message being received to an already running orchestration instance.</span></span> <span data-ttu-id="d27a9-127">関連付けを行う場合、オーケストレーションのメッセージ間のリンクを提供するプロパティまたはプロパティ セットを定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-127">For correlation, there is a need to define a property or set of properties that provide the link between messages in the orchestration.</span></span> <span data-ttu-id="d27a9-128">たとえば、購入処理の場合、PurchaseOrderID に基づいてメッセージを関連付ける必要があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-128">For example, in a purchasing process, you need to correlate messages based on the PurchaseOrderID.</span></span> <span data-ttu-id="d27a9-129">ただし、多くのビジネス ケースで、メッセージの特定のフィールドまたは属性の名前が一致しない場合があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-129">However, in many business cases, the name of the particular field or attribute in the messages may not match.</span></span> <span data-ttu-id="d27a9-130">たとえば、注文書のスキーマに POId という要素が含まれ、それと対になる請求書のスキーマに OrderID という要素が含まれる場合があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-130">A purchase order schema might have an element named POId, while the companion invoice schema may have an element named OrderID.</span></span> <span data-ttu-id="d27a9-131">この状況で PurchaseOrderID などの名前付きプロパティにメッセージを関連付けるには、開発者は、関連付けるプロパティの名前を値のソースから抽出する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-131">To correlate messages on a named property such as PurchaseOrderID in this situation, the developer must be able to abstract the name of the property to be correlated on from the source of the value.</span></span> <span data-ttu-id="d27a9-132">プロパティ スキーマは、この抽出をサポートしています。</span><span class="sxs-lookup"><span data-stu-id="d27a9-132">Property schemas support this abstraction.</span></span>  
  
 <span data-ttu-id="d27a9-133">A*プロパティ スキーマ*を共通の場所で昇格させたプロパティを定義し、他のスキーマで参照できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-133">A *property schema* enables you to define promoted properties in a common location and have them referenced by other schemas.</span></span> <span data-ttu-id="d27a9-134">他のスキーマと同様に、プロパティ スキーマには名前空間があります。他のスキーマと異なるのは、定義された要素しか使用できないことです (つまり、レコードや属性は使用できません)。</span><span class="sxs-lookup"><span data-stu-id="d27a9-134">Like other schemas, a property schema has a namespace, but unlike other schemas, it can only have defined elements (that is, not records or attributes).</span></span> <span data-ttu-id="d27a9-135">プロパティ スキーマに定義される各要素には、名前と型があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-135">Each element that is defined in the property schema has a name and type.</span></span> <span data-ttu-id="d27a9-136">プロパティ スキーマは複数のスキーマから参照される可能性があるので、プロパティ スキーマの情報を実行時にコンポーネントが使用できるようにするため、他のすべてのスキーマと同様に BizTalk Server にプロパティ スキーマを展開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-136">Because the property schema may need to be referenced by more than one schema, and because the information in the property schema must be available to components at runtime, the property schema must get deployed to BizTalk Server like all other schemas.</span></span> <span data-ttu-id="d27a9-137">通常のスキーマ展開の手順以外に、昇格させたプロパティに関する情報が抽出され、管理データベースの bts_documentSpec テーブルに保存されます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-137">In addition to the normal schema deployment steps, information about the promoted properties is extracted and stored in the bts_documentSpec table in the Management database.</span></span>  
  
 <span data-ttu-id="d27a9-138">プロパティ スキーマが作成されたら、要素と属性を同じ入力 (たとえばします。</span><span class="sxs-lookup"><span data-stu-id="d27a9-138">After a property schema has been created, elements and attributes with the same type (for example.</span></span> <span data-ttu-id="d27a9-139">整数型) は、プロパティ スキーマの名前付きプロパティの 1 つとして昇格できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-139">integer) can be promoted as one of the named properties in the property schema.</span></span>  
  
 <span data-ttu-id="d27a9-140">**上記の例を完了するには、開発者は、関連付けに必要な共有のプロパティを定義する次の手順を実行します。**</span><span class="sxs-lookup"><span data-stu-id="d27a9-140">**To complete the example case from above, a developer would perform the following steps to define the shared property needed for correlation.**</span></span>  
  
1. <span data-ttu-id="d27a9-141">プロパティ スキーマを作成し、PurchaseOrderId という xs:int 型の要素を定義します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-141">Create a property schema and define an element of type xs:int named PurchaseOrderId.</span></span>  
  
2. <span data-ttu-id="d27a9-142">PurchaseOrder スキーマを作成し、POId という xs:int 型の要素または属性を追加します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-142">Create a PurchaseOrder schema and add an element or attribute of type xs:int named POId.</span></span>  
  
3. <span data-ttu-id="d27a9-143">開発者は、BizTalk エディターの昇格の表示コマンドを使用して、昇格させたプロパティの一覧に POId フィールドを追加し、一覧から PurchaseOrderId 名前付きプロパティを選択して、プロパティ スキーマで定義された PurchaseOrderId プロパティとして昇格することを示します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-143">Using the show promotions command in the BizTalk Editor, the developer adds the POId field to the list of promoted properties and indicates that it should be promoted as the PurchaseOrderId property defined in the property schema by selecting the PurchaseOrderId named property from the list.</span></span>  
  
4. <span data-ttu-id="d27a9-144">Invoice スキーマを作成し、OrderId という xs:int 型の要素または属性を追加します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-144">Create an Invoice schema and add an element or attribute of type xs:int named OrderId.</span></span>  
  
5. <span data-ttu-id="d27a9-145">開発者は、BizTalk エディターの昇格の表示コマンドを使用して、OrderId フィールドを昇格させたプロパティの一覧に追加し、一覧から PurchaseOrderId 名前付きプロパティを選択して、プロパティ スキーマで定義された PurchaseOrderId プロパティとして昇格することを示します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-145">Using the show promotions command in the BizTalk Editor, the developer adds the OrderId field to the list of promoted properties and indicates that it should be promoted as the PurchaseOrderId property defined in the property schema by selecting the PurchaseOrderId named property from the list.</span></span>  
  
   <span data-ttu-id="d27a9-146">この定義がドキュメント スキーマに存在するので、パイプライン コンポーネントは、名前付きプロパティ PurchaseOrderID として OrderId と POId を正しく昇格できます。これにより、ルーティングおよび関連付けにこれらのプロパティを使用できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-146">Now that this definition exists in the document schemas, pipeline components can properly promote OrderId and POId as the named property PurchaseOrderID so that it can be used for routing and correlation.</span></span> <span data-ttu-id="d27a9-147">昇格プロセスの詳細については、このドキュメントの「メッセージ処理」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="d27a9-147">For more details on this promotion process, see the topic "Message Processing" in this document.</span></span>  
  
   <span data-ttu-id="d27a9-148">昇格させたプロパティには、昇格させた要素の値をメッセージのコンテキストで使用できる利点があります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-148">One of the benefits of promoted properties is that the value of the element that is promoted is available in the context of the message.</span></span> <span data-ttu-id="d27a9-149">つまり、メッセージの XPath ステートメントを実行するためにメッセージをメモリに読み込む必要がないので、この値を取得する負担が少なくなります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-149">This means that retrieving that value is inexpensive, as it does not require loading the message into memory to execute an XPath statement on the message.</span></span> <span data-ttu-id="d27a9-150">代わりに、値を取得するため、キーと一緒に単純なプロパティ バッグを使用できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-150">Instead, a simple property bag can be used along with a key to get the value.</span></span> <span data-ttu-id="d27a9-151">このような動作は、メッセージのルーティング以外の状況に適しています。また、識別フィールドを作成する理由にもなります。</span><span class="sxs-lookup"><span data-stu-id="d27a9-151">This type of behavior is desirable in situations other than message routing and is the reason for creating distinguished fields.</span></span> <span data-ttu-id="d27a9-152">昇格させたプロパティをメッセージ コンテキストに昇格すると、識別フィールドがメッセージ コンテキストに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-152">While promoted properties are promoted into the message context, distinguished fields are written into the message context.</span></span> <span data-ttu-id="d27a9-153">ただし、昇格させたプロパティと異なり、識別フィールドにプロパティ スキーマはありません。</span><span class="sxs-lookup"><span data-stu-id="d27a9-153">Unlike promoted properties however, there is no property schema for distinguished fields.</span></span> <span data-ttu-id="d27a9-154">このため、識別フィールドはルーティングで使用できないので、送信ポートまたはオーケストレーションの受信図形のフィルター条件として使用できません。</span><span class="sxs-lookup"><span data-stu-id="d27a9-154">This is why distinguished fields cannot be used for routing and are therefore not available as filter criteria in a send port or orchestration receive shape.</span></span> <span data-ttu-id="d27a9-155">ただし、メモリにメッセージを読み込んで値を抽出する代わりにメッセージ コンテキストで値の読み込みまたは書き込みを行うため、識別フィールドはオーケストレーションで使用できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-155">Distinguished fields can, however, be used in orchestrations to read or write values from the message context instead of having to load the message into memory and extract the value.</span></span>  
  
   <span data-ttu-id="d27a9-156">プロパティをメッセージ コンテキストに昇格させるまたは書き込む以外に、メッセージの述語もコンテキストに追加できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-156">In addition to promoting or writing properties into the message context, message predicates can also be added to the context.</span></span> <span data-ttu-id="d27a9-157">メッセージの述語は、BizTalk Server のセキュリティ対策として使用されます。また、メッセージをルーティングするホストに指定された値と一致させる必要のあるメッセージに関するコンテキスト情報を提供します。</span><span class="sxs-lookup"><span data-stu-id="d27a9-157">Message predicates are used as a security measure in BizTalk Server and provide contextual information about the message, which must match values specified for any host that the message is to be routed to.</span></span> <span data-ttu-id="d27a9-158">このセキュリティ対策を使用すると、特定のメッセージの受信および処理を行えるホストを限定して、BizTalk Server 環境を構成できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-158">This security measure allows you to configure your BizTalk Server environment in such a way as to allow specific hosts to be the only hosts that can receive and process particular messages.</span></span> <span data-ttu-id="d27a9-159">例として、BizTalk Server 管理コンソールで、メッセージのデコードおよび解読を行うために使用される証明書の拇印を使用して、ホストを構成できます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-159">As an example, in the BizTalk Server Administration Console, a host can be configured with the thumbprint of a certificate to use for message decoding and decryption.</span></span> <span data-ttu-id="d27a9-160">このプロパティを構成すると、メッセージ ボックス データベースにこのホストのアプリケーション プロパティが作成されます。</span><span class="sxs-lookup"><span data-stu-id="d27a9-160">Configuring this property creates an application property for that host in the MessageBox.</span></span> <span data-ttu-id="d27a9-161">この拇印で受信および解読されるセキュリティで保護されたメッセージでは、この拇印で構成されたホストに対して、ルーティングのみ行います。</span><span class="sxs-lookup"><span data-stu-id="d27a9-161">Secure messages that are received and decrypted using this thumbprint are then only routed to the hosts with the thumbprint configured.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d27a9-162">参照</span><span class="sxs-lookup"><span data-stu-id="d27a9-162">See Also</span></span>  
 [<span data-ttu-id="d27a9-163">ランタイム アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="d27a9-163">Runtime Architecture</span></span>](../core/runtime-architecture.md)