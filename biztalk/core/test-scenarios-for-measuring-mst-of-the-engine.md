---
title: エンジンの MST を測定するためのテスト シナリオ |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e54667b9-7262-43c8-a013-9242eb062daf
caps.latest.revision: 28
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4fe9fd977563553e62d10675ee35caa673cf0c8e
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36998923"
---
# <a name="test-scenarios-for-measuring-mst-of-the-engine"></a>エンジンの MST を測定するためのテスト シナリオ
このセクションでは、BizTalk システムを次の 3 つの負荷レベルで起動したときの効率性を測定するために実装したテスト シナリオについて説明します。  
  
- [維持可能なロード テスト](../core/sustainable-load-test.md)します。 維持可能なロードは、トピックに記載されているこれらのテストのために、[維持可能なパフォーマンスとは何ですか?](../core/what-is-sustainable-performance.md)します。  
  
- [ロード テストをオーバー ドライブ](../core/overdrive-load-test.md)します。 オーバー ドライブ ロードは、MST を上回るを一貫性のある負荷として定義されます。  
  
- [フラッド ゲート ロード テスト](../core/floodgate-load-test.md)します。 フラッド ゲート ロードは、断続的なピーク負荷の MST を超える負荷が低いとして定義されます。  
  
  このトピックでは、テスト ハードウェアの構成、テスト シナリオ、および各テスト結果について説明します。  
  
> [!IMPORTANT]
>  読者は、このセクションに含まれる情報が発行日の時点で扱われた問題に関するマイクロソフトの現在の見解を示していることに注意する必要があります。 市場の状況とテクノロジの変化に対応する必要があるため、マイクロソフトでは、発行日以降に示された情報の正確性は保証できません。  
  
## <a name="test-system-configuration"></a>テスト システム構成  
 このテスト シナリオで使用するハードウェアを次に示します。  
  
- **6 つの BizTalk Server**します。 それぞれデュアル 3 GHz プロセッサおよび 2 GB RAM を搭載。 各サーバーはローカル ディスクを使用しています。 2 台の BizTalk Servers に受信ホストのインスタンス、2 台に送信ホストのインスタンス、2 台にオーケストレーションの処理に使用するホストのインスタンスを構成します。  
  
- **マスター メッセージ ボックス データベースと非メッセージ ボックス データベースの 1 つの SQL Server**します。 8 個の 2 GHz プロセッサと 4 GB RAM を搭載。 このサーバーはファイバー経由で高速 SAN ディスク サブシステムに接続されています。 メッセージの公開は無効にしてあります。  
  
- **次の 3 つの SQL Server のメッセージ ボックス データベースに公開される**します。 4 個の 2 GHz プロセッサと 4 GB RAM を搭載。 これらのサーバーは、それぞれファイバー経由で高速 SAN ディスク サブシステムに接続されています。 メッセージ ボックス データベースのデータおよびトランザクション ログ ファイルは、独立したストレージ エリア ネットワーク (SAN) に論理単位数 (LUN) として格納されています。  
  
- **ロード ドライバー クライアント コンピューター**します。 デュアル 3 GHz プロセッサおよび 2 GB RAM を搭載。 このサーバーは、BizTalk システムをテストするための負荷を生成するときに使用します。  
  
  ロード テストで使用するトポロジを次の図に示します。  
  
  **ロード テストに使用されるトポロジ**  
  
  ![BizTalk Server のロード テストのハードウェア トポロジ](../core/media/bts06-msttopology.gif "BTS06_MSTTopology")  
  
## <a name="the-test-scenario"></a>テスト シナリオ  
 テスト シナリオは非常に単純です。 負荷生成ツール LoadGen 2007 をロード ドライバー サーバーにインストールし、ファイル アダプターによって監視される共有に、ファイルのコピーを送信します。 負荷生成ツールにより、入力ファイル インスタンスのコピーがファイル共有に均等に配布されます。  
  
> [!NOTE]
>  ダウンロード[LoadGen](https://www.microsoft.com/download/details.aspx?id=14925)します。 このツールの以前のバージョン、BizTalk Server 2004 負荷生成ツールがダウンロードできる[ http://go.microsoft.com/fwlink/?linkid=108999](http://go.microsoft.com/fwlink/?linkid=108999)します。 MSMQ アダプターでの LoadGen の使用方法の詳細については、次を参照してください。 [MSMQ での LoadGen 2007 を使用して](../core/using-loadgen-2007-with-msmq.md)します。  
  
 BizTalk ファイル アダプターは、ファイル共有を監視してメッセージをメッセージ ボックスに公開するように構成されています。 受信図形と送信図形のみを含んでいる簡単なオーケストレーションで、公開されたメッセージをサブスクライブします。 オーケストレーションによってメッセージ ボックスに公開されたメッセージは、ファイル送信ポートで取得されて共通の共有に送信され、SAN で定義されます。 出力 SAN 共有に到着したファイルは、テストの実行中にファイルがこの共有に蓄積されるのを回避するために、直ちに削除されます。  
  
 シナリオには、受信場所、オーケストレーション、送信ポート、および追跡用にそれぞれ 1 つずつ合計 4 つのホストが定義されました。 エンジン バックログの動作を観察するために、テストの実行中は追跡をすべて無効にします。 追跡は既定でパイプラインとオーケストレーションでのみ有効になっているため、BizTalk 管理では使用するオーケストレーションとパイプラインに対して追跡を明示的に無効にします。  
  
 これらのテストでは、追跡を無効にして主要なメッセージ ボックスの動作を分離するため、追跡ホストのインスタンスは作成されません。  
  
 使用するスキーマは単純で、テストに使用したインスタンス ファイルのサイズはすべて 10 KB です。 受信ドキュメントには XMLReceive パイプラインを使用しています。テスト シナリオを単純にし、メッセージ ボックスの動作の観察に重点を置くため、マッピング コンポーネントや送信コンポーネントを使用していません。  
  
## <a name="parameters-measured-in-the-test"></a>テストで測定するパラメーター  
 このテストで測定するパラメーターは次のとおりです。  
  
 **測定するプライマリ テスト パラメーター**  
  
 以下のパラメーターは、MST を測定するときに使用するプライマリ インジケーターです。  
  
- メッセージ ボックス バックログによって測定される、**スプール サイズ**カウンターで利用できる、 **Counters**パフォーマンス オブジェクトです。 メッセージ ボックス バックログは持続性を示す重要なインジケーターです。 メッセージ ボックス バックログが無限に増え続けると、必ず問題が発生します。 そのため、メッセージ ボックス データベース バックログの深さを長期間監視して、持続性を評価します。  
  
   という名前のメッセージ ボックス テーブル**スプール**システムで各メッセージのレコードが含まれています (アクティブかまたは収集ガベージを待機しています)。 このテーブル内の行数や 1 秒間に受信されるメッセージ数を監視しながら、システム負荷を増やすと簡単に維持可能な最大スループットを測定できます。 この測定値と呼ばれることも、**テーブルの深さのスプール**または**スプールの深さ**します。  
  
- 測定した 1 秒あたりに受信されたドキュメントの数、**受信/秒をドキュメント**カウンターで利用できる、 **BizTalk: メッセージング**パフォーマンス オブジェクトです。  
  
  **測定するセカンダリ テスト パラメーター**  
  
  次のパラメーターは、MST を測定するときに評価されるセカンダリ インジケーターです。 これらのパラメーターは、スプールの深さや 1 秒あたりの受信ドキュメント数というプライマリ インジケーターに影響を与える場合があります。  
  
- 物理ディスクのアイドル状態、メッセージ ボックス データとトランザクションのファイル ディスクによって測定される時間、 **% アイドル時間**カウンターで使用可能な**LogicalDisk**パフォーマンス オブジェクトです。  
  
- によって測定されるメッセージ ボックス サーバーの CPU 使用率 (%)、 **% Processor Time**カウンターで使用可能な**プロセッサ**パフォーマンス オブジェクトです。  
  
- メッセージ ボックス データベースで 1 秒あたりのロック タイムアウトはデータベースによって測定される、 **Lock timeouts/sec**カウンターで使用可能な**SQLServer:Locks**パフォーマンス オブジェクトです。  
  
- 削除されたメッセージに関連付けられたメッセージ ボックス テーブルをクリーンアップする SQL エージェント ジョブの直前のジョブ実行時間 (秒単位)。 計測されるかによって、 **MsgBox Msg Cleanup(Purge Jobs)** カウンターで使用可能な**Counters**パフォーマンス オブジェクトです。  
  
- 削除されたメッセージ部分に関連付けられたメッセージ ボックス テーブルをクリーンアップする SQL エージェント ジョブの直前のジョブ実行時間 (秒単位)。 計測されるかによって、 **MsgBox パーツ Cleanup(Purge Jobs)** カウンターで使用可能な**Counters**パフォーマンス オブジェクトです。  
  
  維持可能な最大スループットを特定するテストを行う最には、スプール テーブルが無制限に拡大し始める時点まで入力負荷を増やします。  
  
> [!NOTE]
>  負荷をいくら生成してもスプール テーブルが無制限に拡大しない場合、システムで最も低速な部分は処理/送信側ではなく、受信側であるということになります。  
  

## <a name="next"></a>Next
  
-   [Microsoft BizTalk LoadGen 2007 ツールを使用](../core/using-the-microsoft-biztalk-loadgen-2007-tool.md)  
  
-   [維持可能なロード テスト](../core/sustainable-load-test.md)  
  
-   [オーバードライブ ロード テスト](../core/overdrive-load-test.md)  
  
-   [フラッドゲート ロード テスト](../core/floodgate-load-test.md)