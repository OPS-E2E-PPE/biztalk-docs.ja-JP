---
title: MSMQT アダプターから MSMQ アダプターへの移行 |Microsoft Docs
ms.custom: ''
ms.date: 12/07/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 97126f70-0be5-4a2f-bcba-173fd932b6de
caps.latest.revision: 30
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 345247a39a3226d3e51b7c73f12be177adf01a3d
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65324831"
---
# <a name="migrate-from-the-msmqt-adapter-to-the-msmq-adapter"></a><span data-ttu-id="af845-102">MSMQT アダプターから MSMQ アダプターへの移行します。</span><span class="sxs-lookup"><span data-stu-id="af845-102">Migrate from the MSMQT Adapter to the MSMQ Adapter</span></span>
<span data-ttu-id="af845-103">このトピックでは、エンド ツー エンドの順次配送、に関して考慮すべき点を説明トランザクションの一貫性、高可用性、およびスケーラビリティを移行する前に、メッセージ キュー (MSMQ) アダプタを BizTalk メッセージ キュー (MSMQT) アダプターからのソリューションです。</span><span class="sxs-lookup"><span data-stu-id="af845-103">This topic discusses points to consider regarding end-to-end ordered delivery, transactional consistency, high availability, and scalability before migrating solutions from the BizTalk Message Queuing (MSMQT) adapter to the Message Queuing (MSMQ) adapter.</span></span> <span data-ttu-id="af845-104">このトピックでは順次配送のために、トランザクションの一貫性、高可用性、およびスケーラビリティように定義します。</span><span class="sxs-lookup"><span data-stu-id="af845-104">For purposes of this topic ordered delivery, transactional consistency, high availability, and scalability are defined as follows:</span></span>  
  
-   <span data-ttu-id="af845-105">**順次配送します。**</span><span class="sxs-lookup"><span data-stu-id="af845-105">**Ordered delivery.**</span></span> <span data-ttu-id="af845-106">受信した順序と同じ順序でメッセージを BizTalk server が送信されることを保証します。</span><span class="sxs-lookup"><span data-stu-id="af845-106">Guarantee that messages are sent out of BizTalk Server in the same order that they are received.</span></span>  
  
-   <span data-ttu-id="af845-107">**トランザクションの一貫性。**</span><span class="sxs-lookup"><span data-stu-id="af845-107">**Transactional consistency.**</span></span> <span data-ttu-id="af845-108">メッセージが処理中には保証の消失やハードウェア、ソフトウェア、またはネットワーク障害により重複します。</span><span class="sxs-lookup"><span data-stu-id="af845-108">Guarantee that messages being processed are not lost or duplicated due to hardware, software, or network failure.</span></span>  
  
-   <span data-ttu-id="af845-109">**高可用性。**</span><span class="sxs-lookup"><span data-stu-id="af845-109">**High availability.**</span></span> <span data-ttu-id="af845-110">処理可能な常にメッセージを処理するために使用するサービスを保証します。</span><span class="sxs-lookup"><span data-stu-id="af845-110">Guarantee that services used to process messages are always available for processing.</span></span>  
  
-   <span data-ttu-id="af845-111">**スケーラビリティです。**</span><span class="sxs-lookup"><span data-stu-id="af845-111">**Scalability.**</span></span> <span data-ttu-id="af845-112">既存のメッセージ処理能力を向上する機能。</span><span class="sxs-lookup"><span data-stu-id="af845-112">Ability to increase existing message-processing capacity.</span></span>  
  
## <a name="end-to-end-ordered-delivery"></a><span data-ttu-id="af845-113">エンド ツー エンドの順次配送</span><span class="sxs-lookup"><span data-stu-id="af845-113">End-to-End Ordered Delivery</span></span>  
 <span data-ttu-id="af845-114">MSMQT アダプターでは、メッセージのエンド ツー エンドの順次配送をようにします。</span><span class="sxs-lookup"><span data-stu-id="af845-114">The MSMQT adapter ensures end-to-end ordered delivery of messages.</span></span> <span data-ttu-id="af845-115">つまり、MSMQ アプリケーションでは、これらのメッセージをオーケストレーションに配信されるか、送信ポートを BizTalk Server に同じ順序で、MSMQT アダプタにバインドされている受信場所に 1、2、および 3 のメッセージを送信する場合。1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="af845-115">This means that if an MSMQ application sends messages 1, 2, and 3 to a receive location bound to the MSMQT adapter, then these messages are delivered to an orchestration or send port in BizTalk Server in the same order: 1, 2, 3.</span></span> <span data-ttu-id="af845-116">この機能の用途の 1 つは、送信および受信される順序と同じ順序で実行する必要がありますある株式市場取引を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="af845-116">One use of this functionality might include stock market trades that must be submitted and executed in the same order that they are received.</span></span>  
  
 <span data-ttu-id="af845-117">MSMQT でエンド ツー エンド順次配信では、多くのコンポーネントが連携する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af845-117">End-to-end in-order delivery with MSMQT requires many components to be working together.</span></span> <span data-ttu-id="af845-118">次の一連のイベントは、MSMQT アダプターでこれを行う方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="af845-118">The following sequence of events illustrates how this is done with the MSMQT adapter:</span></span>  
  
1. <span data-ttu-id="af845-119">リモート コンピューター上の MSMQ API では、順序で 1、2、および 3 のメッセージを受信し、同じ順序でトランザクションのローカル キューにプッシュします。1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="af845-119">The MSMQ API on a remote computer receives messages 1, 2, and 3 in order and pushes them into a transactional, local queue in the same order: 1, 2, 3.</span></span>  
  
2. <span data-ttu-id="af845-120">リモート コンピューターの MSMQ クライアントは、キューからメッセージを受け取りの順に MSMQT キューに送信します。1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="af845-120">An MSMQ client on the remote computer takes the messages from the queue and sends them to the MSMQT queue in order: 1, 2, 3.</span></span>  
  
3. <span data-ttu-id="af845-121">MSMQT アダプターでは、注文 1、2、3 のメッセージを受信し、同じ順序で BizTalk メッセージ エージェント コンポーネントに渡します。1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="af845-121">The MSMQT adapter receives the messages in order 1, 2, 3 and hands them to the BizTalk MessageAgent component in the same order: 1, 2, 3.</span></span>  
  
4. <span data-ttu-id="af845-122">BizTalk メッセージ エージェント コンポーネントの順序でメッセージ ボックスに、メッセージが送信されることを保証します。1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="af845-122">The BizTalk MessageAgent component ensures that the messages are sent to the MessageBox in order: 1, 2, 3.</span></span>  
  
5. <span data-ttu-id="af845-123">メッセージ ボックスは、メッセージをルーティングし、により、オーケストレーションまたは送信ポートの同じインスタンスにルーティングされる場合と同じ順序では、このインスタンスに配信されること。1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="af845-123">The MessageBox routes the messages and ensures that if they are routed to the same instance of an orchestration or a send port, that they are delivered to this instance in the same order: 1, 2, 3.</span></span>  
  
   <span data-ttu-id="af845-124">MSMQT アダプターのみを終了することを保証できるが、BizTalk Server 2004 で順次配送を終了します。</span><span class="sxs-lookup"><span data-stu-id="af845-124">In BizTalk Server 2004, MSMQT was the only adapter capable of guaranteeing end-to end ordered delivery.</span></span> <span data-ttu-id="af845-125">手順 3 ~ 5 が上記のメッセージの順序を変更すべて、その他の統合 BizTalk アダプターのことができます可能性があります。</span><span class="sxs-lookup"><span data-stu-id="af845-125">All of the other integrated BizTalk adapters can potentially change the order of the messages in steps 3 through 5 listed above.</span></span> <span data-ttu-id="af845-126">他の統合アダプターのほとんどは、として、エンド ポイント マネージャー、本質的にマルチ スレッドの順序を保持されませんと呼ばれるコンポーネントを使用して手順 3 を完了します。</span><span class="sxs-lookup"><span data-stu-id="af845-126">Most of the other integrated adapters complete step 3 by the use of a component known as the End Point Manager, which is inherently multithreaded and therefore does not preserve order.</span></span> <span data-ttu-id="af845-127">BizTalk Server 2004 の MSMQ アダプターは、手順 3. の順序を保持する「シリアル処理」機能を使用しますが、ので、メッセージをオーケストレーションにルーティングされる可能性がありますまたは送信ポートを順不同の今後の順序を保持するメッセージ エージェントが、要求はしません。</span><span class="sxs-lookup"><span data-stu-id="af845-127">The BizTalk Server 2004 MSMQ adapter used a "Serial Processing" feature that preserves order for step 3, but it does not then ask the MessageAgent to preserve order going forward, so the messages may be routed to an orchestration or send port out of order.</span></span>  
  
   <span data-ttu-id="af845-128">**エンド ツー エンドの MSMQ アダプターで順次配送**</span><span class="sxs-lookup"><span data-stu-id="af845-128">**End-to-end ordered delivery with the MSMQ adapter**</span></span>  
  
   <span data-ttu-id="af845-129">エンド ツー エンドの MSMQ アダプターで順次配送を実現するために次の手順に従います。</span><span class="sxs-lookup"><span data-stu-id="af845-129">To achieve end-to-end ordered delivery with the MSMQ adapter, follow these steps:</span></span>  
  
6. <span data-ttu-id="af845-130">有効にする、**順次配送**受信側のプロパティは、サブスクライブを行うオーケストレーションのポートまたは送信ポート。</span><span class="sxs-lookup"><span data-stu-id="af845-130">Enable the **Ordered Delivery** property on the receive port for the subscribing orchestration or send port.</span></span> <span data-ttu-id="af845-131">BizTalk server のオーケストレーションでポートを受信および送信ポートが設定されて、**順次配送**構成オプション。</span><span class="sxs-lookup"><span data-stu-id="af845-131">In BizTalk Server, receive ports in orchestrations and send ports have an **Ordered Delivery** configuration option.</span></span> <span data-ttu-id="af845-132">このオプションが有効になっている場合、オーケストレーションの受信ポートまたは、送信ポートは、メッセージ ボックスに送信された順序と同じ順序でメッセージを配信するメッセージ ボックスを確認します。</span><span class="sxs-lookup"><span data-stu-id="af845-132">If this option is enabled, then the orchestration receive port or the send port asks the MessageBox to deliver messages to it in the same order they were submitted into the MessageBox.</span></span>  
  
7. <span data-ttu-id="af845-133">設定、**順次処理**に MSMQ アダプターにバインドされている受信場所のプロパティ`True`します。</span><span class="sxs-lookup"><span data-stu-id="af845-133">Set the **Ordered Processing** property for the receive location that is bound to the MSMQ adapter to `True`.</span></span> <span data-ttu-id="af845-134">BizTalk Server で、これが有効な場合は、メッセージが受信された順序と同じ順序でメッセージ ボックスに送信されることにより、順次処理を使用する、MSMQ トランスポートの使用を構成する場所が表示されます。</span><span class="sxs-lookup"><span data-stu-id="af845-134">In BizTalk Server, receive locations that use the MSMQ transport can be configured to use Ordered Processing which, if enabled, ensures that messages are sent to the MessageBox in the same order that they were received.</span></span>  
  
8. <span data-ttu-id="af845-135">設定、**トランザクション**に MSMQ アダプターにバインドされている受信場所のプロパティ`True`します。</span><span class="sxs-lookup"><span data-stu-id="af845-135">Set the **Transactional** property for the receive location that is bound to the MSMQ adapter to `True`.</span></span>  
  
9. <span data-ttu-id="af845-136">MSMQ によって監視されている MSMQ のキューが受信場所であることを確認します「トランザクション」とマークされます。</span><span class="sxs-lookup"><span data-stu-id="af845-136">Ensure that any MSMQ queues that are being monitored by the MSMQ receive locations are marked as "Transactional".</span></span> <span data-ttu-id="af845-137">このプロパティは、キューにメッセージの順次配送を確実に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af845-137">This property must be set on the queues to ensure ordered delivery of messages.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="af845-138">順次配送は、場所は/は 1 台のコンピューターによって処理される MSMQ キューまたは BizTalk によって監視されているキューが表示される場合にのみ保証されます。</span><span class="sxs-lookup"><span data-stu-id="af845-138">Ordered delivery is guaranteed only if the MSMQ queue or queues that are being monitored by BizTalk receive locations is/are serviced by only one computer.</span></span> <span data-ttu-id="af845-139">これは、により、以下に示すよう、スケーラビリティの問題が発生することができます。</span><span class="sxs-lookup"><span data-stu-id="af845-139">This can present problems for scalability, as described below.</span></span>  
  
## <a name="transaction-usage-when-processing-messages-with-the-msmqt-adapter-vs-the-msmq-adapter"></a><span data-ttu-id="af845-140">MSMQ アダプターと MSMQT アダプターでメッセージを処理するときに、トランザクションの使用</span><span class="sxs-lookup"><span data-stu-id="af845-140">Transaction Usage When Processing Messages with the MSMQT Adapter vs. the MSMQ Adapter</span></span>  
 <span data-ttu-id="af845-141">トランザクションの使用に関して、MSMQT アダプターと MSMQ アダプターがメッセージを処理する方法の主な違いがあります。</span><span class="sxs-lookup"><span data-stu-id="af845-141">With regard to transaction usage, there is a key difference between how the MSMQT and MSMQ adapters process messages.</span></span>  
  
 <span data-ttu-id="af845-142">MSMQT アダプターを使用する場合、ネットワークからメッセージを受信して、BizTalk Server による処理のプロセスは、単一のトランザクションで処理されます。</span><span class="sxs-lookup"><span data-stu-id="af845-142">When using the MSMQT adapter, the process of receiving a message from the network and processing it with BizTalk Server is handled under a single transaction.</span></span> <span data-ttu-id="af845-143">MSMQT アダプターを使用する場合、メッセージが受信され、BizTalk Server によって正常に処理されたことを示していますが、ACK メッセージの送信者に対して生成します。</span><span class="sxs-lookup"><span data-stu-id="af845-143">When using the MSMQT adapter, ACK messages generated for the sender are an indication that the message has been received and has been successfully processed by BizTalk Server.</span></span>  
  
 <span data-ttu-id="af845-144">MSMQ アダプターを使用する場合から BizTalk Server では、ネットワークと処理メッセージの受信のプロセスは、ネットワークから受信するため、BizTalk Server で処理するための 2 つの個別のトランザクションを処理します。</span><span class="sxs-lookup"><span data-stu-id="af845-144">When using the MSMQ adapter, the processes of receiving a message from the network and processing it with BizTalk Server are handled under two separate transactions, one for receiving from the network and one for processing it with BizTalk Server.</span></span> <span data-ttu-id="af845-145">MSMQ アダプターを使用する場合、メッセージが BizTalk Server によって正常に処理されていないネットワークからメッセージが正常に受信されたことを示すものは ACK メッセージの送信者に対して生成されました。</span><span class="sxs-lookup"><span data-stu-id="af845-145">When using the MSMQ adapter, ACK messages generated for the sender are only an indication that the message has been successfully received from the network, not that the message has been successfully processed by BizTalk Server.</span></span> <span data-ttu-id="af845-146">送信者は、メッセージがネットワークからの受信し、BizTalk Server がインストールされているかどうかに関係なく、ローカルの MSMQ キューに永続化、Microsoft メッセージ キュー サーバーから ACK を受信します。</span><span class="sxs-lookup"><span data-stu-id="af845-146">The sender receives an ACK from the Microsoft Message Queuing server when the message is received from the network and persisted into the local MSMQ queue regardless of whether BizTalk Server is installed.</span></span> <span data-ttu-id="af845-147">メッセージは MSMQ キューに永続化した後、BizTalk MSMQ アダプターは、ピックアップする、処理、およびメッセージ ボックス データベースに公開します。</span><span class="sxs-lookup"><span data-stu-id="af845-147">After the message has been persisted to the MSMQ queue, the BizTalk MSMQ adapter picks it up, processes it, and publishes it to the MessageBox.</span></span> <span data-ttu-id="af845-148">このプロセスが失敗した場合、メッセージが BizTalk 保留キューに送信されるか、ローカルの MSMQ キュー (トランザクション処理を使用) する場合のままにし、送信者がメッセージに BizTalk Server での処理が失敗したことを示す値を持たない。</span><span class="sxs-lookup"><span data-stu-id="af845-148">If this process fails, the message is either sent to the BizTalk suspended queue or left in the local MSMQ queue (when using transactional processing), and the sender has no indication that the message failed processing in BizTalk Server.</span></span>  
  
 <span data-ttu-id="af845-149">Ack を受信、メッセージが BizTalk Server によって正常に処理されるときに、アーキテクチャを必要とする場合、MSMQT アダプターから MSMQ アダプターに移行する場合は、アプリケーション レベルの Ack を追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af845-149">If your architecture requires that you receive ACKs when your messages are successfully processed by BizTalk Server, then you must add application-level ACKs if you are migrating from the MSMQT adapter to the MSMQ adapter.</span></span> <span data-ttu-id="af845-150">オーケストレーションや送信元アプリケーション アプリケーション レベルの Ack を実装するために更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af845-150">You will need to update your orchestration and sending application to implement application-level ACKs.</span></span>  
  
## <a name="high-availability-transactional-in-order"></a><span data-ttu-id="af845-151">高可用性 (トランザクション、順次)</span><span class="sxs-lookup"><span data-stu-id="af845-151">High Availability (Transactional, in Order)</span></span>  
 <span data-ttu-id="af845-152">MSMQT アダプターの高可用性を実現するには、受信ホストに複数のコンピューターを追加し、フォールト トレランスのためのネットワーク負荷分散 (NLB) の構成または既定の BizTalk ホストをクラスター化することができます。</span><span class="sxs-lookup"><span data-stu-id="af845-152">To provide high availability for the MSMQT adapter you can either add multiple computers to the receive host and configure Network Load Balancing (NLB) for fault tolerance or you can cluster the default BizTalk Host.</span></span> <span data-ttu-id="af845-153">1 つのサーバーの他のサーバーがダウンした場合、NLB を組み合わせて、MSMQT アダプターを実行している場合は、負荷を処理します。</span><span class="sxs-lookup"><span data-stu-id="af845-153">If you are running the MSMQT adapter in conjunction with NLB, if one server goes down the other servers handle the load.</span></span> <span data-ttu-id="af845-154">1 つのホスト ノードが失敗した場合は、クラスター化されたホストで MSMQT アダプター ハンドラーを実行している場合、クラスター ソフトウェアは、その他のノードにクラスター化されたホストをフェールオーバーします。</span><span class="sxs-lookup"><span data-stu-id="af845-154">If you are running the MSMQT adapter handlers on a clustered host, if one host node fails, cluster software fails over the clustered host to the other node.</span></span> <span data-ttu-id="af845-155">MSMQ アダプターを使用する場合、MSMQ アダプターが中間ストレージにローカルの MSMQ キューを使用するためのデータ損失なしでトランザクション処理する必要がある場合は、NLB は機能しません。</span><span class="sxs-lookup"><span data-stu-id="af845-155">When using the MSMQ adapter, NLB does not work if you need transactional processing with no data loss because the MSMQ adapter uses local MSMQ queues for intermediate storage.</span></span> <span data-ttu-id="af845-156">このシナリオでメッセージがローカルの MSMQ キューに配信されたが、MSMQ アダプターによって処理されていない場合、メッセージは失われます、コンピューターが失敗した場合。</span><span class="sxs-lookup"><span data-stu-id="af845-156">In this scenario, if a message has been delivered to the local MSMQ queue but has not been consumed by the MSMQ adapter, the message is lost if the computer fails.</span></span>  
  
 <span data-ttu-id="af845-157">MSMQ アダプターを使用した高可用性とトランザクションの一貫性を提供するには、次の操作を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="af845-157">To provide high availability and transactional consistency with the MSMQ adapter, you should do the following:</span></span>  
  
1. <span data-ttu-id="af845-158">Microsoft メッセージ キュー (MSMQ) は、BizTalk server の Windows Server クラスター グループのクラスター化リソースとして構成します。</span><span class="sxs-lookup"><span data-stu-id="af845-158">Configure Microsoft Message Queuing (MSMQ) as a clustered resource in a Windows Server cluster group on your BizTalk servers.</span></span>  
  
2. <span data-ttu-id="af845-159">MSMQ アダプターを構成するクラスター化された MSMQ リソースと同じクラスター グループ内のクラスター リソースとして構成されている BizTalk ホスト インスタンスで受信するハンドラー。</span><span class="sxs-lookup"><span data-stu-id="af845-159">Configure the MSMQ adapter receive handler in a BizTalk Host instance that has been configured as a cluster resource in the same cluster group as the clustered MSMQ resource.</span></span>  
  
3. <span data-ttu-id="af845-160">クラスター化された MSMQ リソースへの依存関係が維持されるため、BizTalk ホスト インスタンスのクラスター リソースを構成します。</span><span class="sxs-lookup"><span data-stu-id="af845-160">Configure the cluster resource for the BizTalk Host instance so that it maintains a dependency on the clustered MSMQ resource.</span></span>  
  
   <span data-ttu-id="af845-161">このアーキテクチャで順次配送を実装するには、「--エンドツー エンドで順次配送を MSMQ アダプターを」前に示した手順に従います</span><span class="sxs-lookup"><span data-stu-id="af845-161">To implement ordered delivery with this architecture, follow the steps presented earlier under "End-to-end ordered delivery with the MSMQ adapter."</span></span>  
  
## <a name="high-availability-nontransactional-not-in-order"></a><span data-ttu-id="af845-162">高可用性 (非トランザクション、順序ではなく)</span><span class="sxs-lookup"><span data-stu-id="af845-162">High Availability (Nontransactional, Not in Order)</span></span>  
 <span data-ttu-id="af845-163">高可用性を必要がありますが、トランザクションは不要である場合、処理することができます MSMQ アダプターで NLB を実装して、MSMQ 送信で構成されているホストのインスタンスを実行してこれを実現し、受信ハンドラー NLB の背後にある複数の BizTalk server で。</span><span class="sxs-lookup"><span data-stu-id="af845-163">If you need high availability but do not need transactional processing, you can achieve this with the MSMQ adapter by implementing NLB and running instances of a host configured with the MSMQ send and receive handlers on multiple BizTalk servers behind NLB.</span></span> <span data-ttu-id="af845-164">MSMQ で NLB を実装するときに Microsoft サポート技術情報の記事に記載されているベスト プラクティスを従う必要があります[899611。どのようにメッセージ キュー機能ネットワーク負荷分散 (NLB) 経由で](https://support.microsoft.com/help/899611/how-message-queuing-can-function-over-network-load-balancing-nlb)します。</span><span class="sxs-lookup"><span data-stu-id="af845-164">When implementing NLB with MSMQ you should follow best practices as documented in Microsoft Knowledge Base article [899611 : How Message Queuing can function over Network Load Balancing (NLB)](https://support.microsoft.com/help/899611/how-message-queuing-can-function-over-network-load-balancing-nlb).</span></span> <span data-ttu-id="af845-165">このシナリオで BizTalk サーバーのいずれかに失敗した場合で実行されているホスト インスタンスで、BizTalk server は使用できません、BizTalk server までメッセージが復元します。</span><span class="sxs-lookup"><span data-stu-id="af845-165">In this scenario, if one of the BizTalk servers fails, the messages that are running in the host instance on that BizTalk server will be unavailable until the BizTalk server is recovered.</span></span> <span data-ttu-id="af845-166">この構成は、NLB が他の BizTalk server に要求をルーティングする場合は、BizTalk server のいずれかが利用できないために、高可用性を提供します。</span><span class="sxs-lookup"><span data-stu-id="af845-166">This configuration provides high availability because if one of the BizTalk servers is not available, NLB routes requests to the other BizTalk server.</span></span>  
  
## <a name="scalability-nontransactional-not-in-order"></a><span data-ttu-id="af845-167">スケーラビリティ (非トランザクション、順序ではなく)</span><span class="sxs-lookup"><span data-stu-id="af845-167">Scalability (Nontransactional, Not in Order)</span></span>  
 <span data-ttu-id="af845-168">高可用性 (非トランザクション) のためのガイドラインに従うと、ホスト インスタンスを追加してスケーラビリティを実現できます。</span><span class="sxs-lookup"><span data-stu-id="af845-168">You can achieve scalability by following the guidelines for high availability (nontransactional) and adding additional host instances.</span></span> <span data-ttu-id="af845-169">このアーキテクチャでは、高速な配信とスケーラビリティを提供しますが、順次配送を行いません。</span><span class="sxs-lookup"><span data-stu-id="af845-169">This architecture provides fast delivery as well as scalability, but does not provide ordered delivery.</span></span>  
  
## <a name="scalability-transactional-not-in-order"></a><span data-ttu-id="af845-170">スケーラビリティ (トランザクション、順序ではなく)</span><span class="sxs-lookup"><span data-stu-id="af845-170">Scalability (Transactional, Not in Order)</span></span>  
 <span data-ttu-id="af845-171">配信順序を問わないメッセージのトランザクション配信は、MSMQ および Windows クラスタ リングと NLB の使用を結合できます。</span><span class="sxs-lookup"><span data-stu-id="af845-171">For transactional delivery of messages without ordered delivery, you can combine the use of NLB with MSMQ and Windows clustering.</span></span> <span data-ttu-id="af845-172">このアーキテクチャでは、Windows クラスターごとに次の「高可用性 (トランザクション順序で)」セクションの手順 2 つの独立した Windows クラスター環境では、少なくとも 2 つのクラスター グループを構成することが必要です。</span><span class="sxs-lookup"><span data-stu-id="af845-172">This architecture requires that you configure at least two cluster groups on two separate Windows Cluster environments following the steps under "High Availability (Transactional, in Order)" for each Windows Cluster.</span></span> <span data-ttu-id="af845-173">NLB クラスター グループ間で負荷分散を実装します。</span><span class="sxs-lookup"><span data-stu-id="af845-173">You then implement NLB to distribute load between the cluster groups.</span></span> <span data-ttu-id="af845-174">Windows NLB では、Windows クラスター上で実行することはできません、ために、このシナリオにはハードウェア NLB ソリューションが必要です。</span><span class="sxs-lookup"><span data-stu-id="af845-174">Because Windows NLB is not supported running on a Windows Cluster, this scenario requires a hardware NLB solution.</span></span> <span data-ttu-id="af845-175">次の図に、このアーキテクチャを示します。</span><span class="sxs-lookup"><span data-stu-id="af845-175">The following diagram illustrates this architecture.</span></span>  
  
 <span data-ttu-id="af845-176">![クラスター グループ間の負荷分散](../core/media/scaleclusteredmsmqwithnlb.gif "ScaleClusteredMSMQwithNLB")</span><span class="sxs-lookup"><span data-stu-id="af845-176">![Load balancing between cluster groups](../core/media/scaleclusteredmsmqwithnlb.gif "ScaleClusteredMSMQwithNLB")</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="af845-177">このアーキテクチャでは、順次配送は提供されません。</span><span class="sxs-lookup"><span data-stu-id="af845-177">This architecture does not provide ordered delivery.</span></span>  
  
## <a name="scalability-transactional-in-order"></a><span data-ttu-id="af845-178">スケーラビリティ (トランザクション、順次)</span><span class="sxs-lookup"><span data-stu-id="af845-178">Scalability (Transactional, in Order)</span></span>  
 <span data-ttu-id="af845-179">スケール アウト高可用性、トランザクションの一貫性、および順次配送を提供するアーキテクチャは、またはそれ以前の MSMQ 3.0 を使用するときに問題が発生しない限り、リモート トランザクションの読み込みがサポートされていないため、両方の BizTalk Server コンピューターと、リモートの MSMQ サーバーは、MSMQ 4.0 を実行しています。</span><span class="sxs-lookup"><span data-stu-id="af845-179">Scaling out an architecture that provides high availability, transactional consistency, and ordered delivery is problematic when using MSMQ 3.0 or earlier because remote transactional reads are not supported unless both the BizTalk Server computer and the remote MSMQ server are running MSMQ 4.0.</span></span> <span data-ttu-id="af845-180">MSMQ 3.0 以前を使用する場合、複数のローカルの MSMQ キューを使用してスケール アウトを実現する必要があります。</span><span class="sxs-lookup"><span data-stu-id="af845-180">When using MSMQ 3.0 or earlier, scale out must be achieved using multiple local MSMQ queues.</span></span> <span data-ttu-id="af845-181">さらに、このシナリオで、NLB を MSMQ セッションの TCP/IP 接続が切断された場合、可能性がありますによって復元メッセージが NLB の不同配信可能性がある別のコンピューターにします。</span><span class="sxs-lookup"><span data-stu-id="af845-181">Furthermore, in this scenario, if the TCP/IP connection for the MSMQ session to the NLB is broken, it may subsequently be restored by NLB to a different computer, which can cause out-of-order delivery.</span></span>  
  
 <span data-ttu-id="af845-182">この制限を 1 つの考えられる回避策は、別のコンピューターへの送信先キューに割り当てることによって、分散メッセージ配信を手動で読み込むには。</span><span class="sxs-lookup"><span data-stu-id="af845-182">One possible workaround to this limitation is to manually load balance message delivery by allocating destination queues to different computers.</span></span> <span data-ttu-id="af845-183">特定の MSMQ キューにインスタンス固有の BizTalk ホストに結び付けることでこのようにできます。</span><span class="sxs-lookup"><span data-stu-id="af845-183">You can so this by tying specific BizTalk Host instances to specific MSMQ queues.</span></span> <span data-ttu-id="af845-184">たとえば、特定の 1 つの取引先パートナーから多数のドキュメントを受信する場合は、別のホストを作成し、その取引先パートナーだけに対して、特定の BizTalk サーバー上のキューを受信します。</span><span class="sxs-lookup"><span data-stu-id="af845-184">So for example, if you receive a large number of documents from one particular trading partner, create a separate host and receive queue on a particular BizTalk server for just that trading partner.</span></span>  
  
 <span data-ttu-id="af845-185">可能であれば、リモート トランザクションの読み込みと負荷分散の両方が必要な場合は、リモート コンピューターで MSMQ 4.0 を実行します。</span><span class="sxs-lookup"><span data-stu-id="af845-185">If possible, run MSMQ 4.0 on remote computers when both remote transactional reads and load balancing are required.</span></span>  
  
## <a name="summary"></a><span data-ttu-id="af845-186">まとめ</span><span class="sxs-lookup"><span data-stu-id="af845-186">Summary</span></span>  
 <span data-ttu-id="af845-187">次の表は、特定の機能に対応するために実装できるアーキテクチャをまとめたものです。</span><span class="sxs-lookup"><span data-stu-id="af845-187">The following table summarizes the architectures that you can implement to accommodate specific functionality.</span></span>  
  
|<span data-ttu-id="af845-188">**機能**</span><span class="sxs-lookup"><span data-stu-id="af845-188">**Functionality**</span></span>|<span data-ttu-id="af845-189">**NLB とクラスターのどちらも**</span><span class="sxs-lookup"><span data-stu-id="af845-189">**Neither NLB nor cluster**</span></span>|<span data-ttu-id="af845-190">**NLB**</span><span class="sxs-lookup"><span data-stu-id="af845-190">**NLB**</span></span>|<span data-ttu-id="af845-191">**Cluster**</span><span class="sxs-lookup"><span data-stu-id="af845-191">**Cluster**</span></span>|<span data-ttu-id="af845-192">**NLB とクラスター**</span><span class="sxs-lookup"><span data-stu-id="af845-192">**NLB and cluster**</span></span>|  
|-----------------------|---------------------------------|-------------|-----------------|-------------------------|  
|<span data-ttu-id="af845-193">エンド ツー エンドの順次配送</span><span class="sxs-lookup"><span data-stu-id="af845-193">End-to-end ordered delivery</span></span>|<span data-ttu-id="af845-194">はい</span><span class="sxs-lookup"><span data-stu-id="af845-194">Yes</span></span>|<span data-ttu-id="af845-195">いいえ</span><span class="sxs-lookup"><span data-stu-id="af845-195">No</span></span>|<span data-ttu-id="af845-196">はい</span><span class="sxs-lookup"><span data-stu-id="af845-196">Yes</span></span>|<span data-ttu-id="af845-197">構成を手動で実現可能な</span><span class="sxs-lookup"><span data-stu-id="af845-197">Possible with manual configuration</span></span>|  
|<span data-ttu-id="af845-198">トランザクションの一貫性</span><span class="sxs-lookup"><span data-stu-id="af845-198">Transactional consistency</span></span>|<span data-ttu-id="af845-199">いいえ (メッセージは紛失やサービスのエラーが発生した場合に重複しています)</span><span class="sxs-lookup"><span data-stu-id="af845-199">No (messages can be lost or duplicated if service failure occurs)</span></span>|<span data-ttu-id="af845-200">いいえ</span><span class="sxs-lookup"><span data-stu-id="af845-200">No</span></span>|<span data-ttu-id="af845-201">はい</span><span class="sxs-lookup"><span data-stu-id="af845-201">Yes</span></span>|<span data-ttu-id="af845-202">はい</span><span class="sxs-lookup"><span data-stu-id="af845-202">Yes</span></span>|  
|<span data-ttu-id="af845-203">高可用性</span><span class="sxs-lookup"><span data-stu-id="af845-203">Highly available</span></span>|<span data-ttu-id="af845-204">いいえ</span><span class="sxs-lookup"><span data-stu-id="af845-204">No</span></span>|<span data-ttu-id="af845-205">はい</span><span class="sxs-lookup"><span data-stu-id="af845-205">Yes</span></span>|<span data-ttu-id="af845-206">[はい]</span><span class="sxs-lookup"><span data-stu-id="af845-206">Yes</span></span>|<span data-ttu-id="af845-207">はい</span><span class="sxs-lookup"><span data-stu-id="af845-207">Yes</span></span>|  
|<span data-ttu-id="af845-208">スケーラブルです</span><span class="sxs-lookup"><span data-stu-id="af845-208">Scalable</span></span>|<span data-ttu-id="af845-209">いいえ</span><span class="sxs-lookup"><span data-stu-id="af845-209">No</span></span>|<span data-ttu-id="af845-210">はい</span><span class="sxs-lookup"><span data-stu-id="af845-210">Yes</span></span>|<span data-ttu-id="af845-211">いいえ</span><span class="sxs-lookup"><span data-stu-id="af845-211">No</span></span>|<span data-ttu-id="af845-212">はい</span><span class="sxs-lookup"><span data-stu-id="af845-212">Yes</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="af845-213">参照</span><span class="sxs-lookup"><span data-stu-id="af845-213">See Also</span></span>  
 [<span data-ttu-id="af845-214">Windows Server クラスターを使用して BizTalk Server Hosts2 の高可用性を実現するには</span><span class="sxs-lookup"><span data-stu-id="af845-214">Using Windows Server Cluster to Provide High Availability for BizTalk Server Hosts2</span></span>](../core/use-windows-cluster-to-provide-high-availability-for-biztalk-hosts.md)