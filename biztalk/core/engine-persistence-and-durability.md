---
title: エンジンの永続性と耐久性 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 9bd209e9-75d2-422f-b3b2-377986f41f2f
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 929047264eb395636ee7d2a5793642f12ac7e5e4
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65349398"
---
# <a name="engine-persistence-and-durability"></a>エンジンの永続性と耐久性
このセクションでは、BizTalk Server が確実に SQL Server を使用してディスクに永続化するプロセスの状態で疎結合されたビジネス プロセスを統合する方法について説明します。 トランザクションを活用し、適切なタイミングで状態を保持するでは、システムは、プロセスの状態は、ハードウェアまたはソフトウェアに障害が発生しても失われないことを保証します。 これは、システムの耐久性と呼ばれます。  
  
## <a name="loosely-coupled-business-process-management"></a>ビジネス プロセス管理を疎結合  
 1 つの論理ビジネス プロセスを実行する既存のシステムを統合するには、既存のシステムの外部プロセスの状態の管理が必要です。 ビジネス プロセスが実行中の時間の長いまたは短い有効期間、かどうかプロセスの状態する必要があるは別に保持密結合システムを一緒に起因するカスタム通信経路の急増を回避するためにします。  
  
 実行中の状態に明らかに、ビジネス プロセス インスタンスは、ビジネス プロセスがミッション クリティカルな場合、信頼する必要があります。 BizTalk が保持する SQL Server のトランザクションを活用してビジネス プロセスは、信頼性が高く、持続性のあることを保証するには、メッセージ ボックス データベースと呼ばれるデータベース内のディスクの状態およびビジネス データを処理します。 メッセージ ボックス データベースの詳細については、次を参照してください。 [、メッセージ ボックス データベース](../core/the-messagebox-database.md)します。  
  
 すべてのメッセージとそのすべてが最も単純なビジネス プロセスのインスタンス (たとえば、オーケストレーション インスタンス)[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]処理中に 1 回以上メッセージ ボックス データベースに保存されます。  
  
## <a name="persistence-and-sustainability"></a>永続性と持続性  
 BizTalk Server がすべてのメッセージおよび大部分のオーケストレーションが保持されるという事実、持続性で説明したようには直接影響[維持可能なパフォーマンスとは何ですか?](../core/what-is-sustainable-performance.md) メッセージ ボックス データベースにメッセージの着信時、これらは (たとえば、オーケストレーションと送信ポート) を待機しているサブスクライバーにルーティングと入れまたはをピックアップして、それらを処理するサブスクライバーを待機するメッセージ ボックス SQL テーブルに、パブリッシュされました。 到着したメッセージの一部には、新しいサブスクライバー インスタンスがアクティブにします。 その他のメッセージが到着し、関連付けられたオーケストレーションなどの既に実行中のサブスクライバーの待機中のインスタンスに、関連付けを介して回送されます。  
  
 関連付けられたオーケストレーション処理を続行するためには、関連付けられた到着メッセージがブロック解除する必要があります残ります。 そのため、BizTalk はメッセージ (アクティブ化と相関関係の両方)、受信する、高負荷であっても関連するメッセージを待っているサブスクライバーは完了して、他のプロセスを実行に領域が確保されるように残り続けるかどうかを確認することをお勧めが。 つまり、処理し、メッセージのバックログを蓄積ため、メッセージ ボックス データベースから削除するよりも速くメッセージを受信することができます。 ストア アンド フォワード テクノロジである、この種類のバッファリングを提供する BizTalk の自然では、受信レートが一貫して大量のバックログに無期限に、プロセス速度よりも高速な場合、問題の発生できますただし。  
  
 受信した、または内に作成されているすべてのメッセージを BizTalk Server は不変です。 つまり、受信または作成されたが後の内容は変更できません。 さらに、受信したメッセージには、複数のサブスクライバーがあります。 特定のメッセージの各サブスクライバーでは、そのメッセージの同じ 1 つのコピーを参照します。 この方法は、記憶域を最小化、各メッセージの参照カウントを保持する必要があり、0 の参照カウントがそれらのメッセージを削除するメンテナンスを定期的に実行する必要があります。  
  
 メッセージ ボックス データベースを構築するのに十分な大きさのバックログが許可されている場合、(各メッセージ ボックス データベースの SQL ジョブのセットとして実装された) データベースのメンテナンス処理が遅れるし、遅れを取り戻す機会が与えられていない場合は最終的が発生ディスク領域の不足などの問題。 このような状況を避けるためには、BizTalk Server には制限をいくつかのユーザー構成可能なレベルに、メッセージ ボックス データベース バックログを取得すると、メッセージを低下させるメカニズム受信率。 スロットルの詳細については、次を参照してください。[を最適化するリソースをホストの調整](../core/optimizing-resource-usage-through-host-throttling.md)します。  
  
 すべてのアクティビティおよびプロセスを考慮の持続性を時間の経過と共に、持続性の尺度がバックログを無制限に拡大できません。 つまり、時間の経過と共に必要がありますのバランスを取る、高値と安値のピーク スループット レベルの間、メッセージ ボックス データベースが定数で管理しやすい平均バックログを管理できるように。 バックログの主要な基準として公開される、スプール テーブルの深さを[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]パフォーマンス カウンターには、BizTalk:Message ボックス: 一般的なカウンター: Spool のサイズと呼ばれます。 このパフォーマンス カウンターの詳細については、次を参照してください。[メッセージ ボックス パフォーマンス カウンター](../core/message-box-performance-counters.md)します。  
  
 スプール サイズおよびその他のカウンターを使用して、システムが維持できる最大スループットを判断する方法の詳細については、次を参照してください。[最大持続可能なエンジン スループットの測定](../core/measuring-maximum-sustainable-engine-throughput.md)します。  
  
## <a name="recommendations"></a>推奨事項  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] すべてのメッセージおよび大部分のオーケストレーションを永続化し、ディスク領域の不足などの問題につながるメッセージのバックログを作成できます、事態を。 バックログの主要な基準では、というパフォーマンス カウンタとして公開されるメッセージ ボックス スプール テーブルの深さを示します。BizTalk:Message ボックス: 一般的なカウンター: Spool のサイズ。  
  
 維持可能なスループットを検討する場合、スプール サイズは、時間の経過と共に安定した平均的を維持する必要があります。 Spool のサイズは、無期限にでオフ増大し続けることはできません。 [最大持続可能なエンジン スループットの測定](../core/measuring-maximum-sustainable-engine-throughput.md)、この動作がさらに詳しく説明されているし、スプール サイズおよびその他のパフォーマンスを活用するシステムが維持できる最大スループットを特定する方法を提供インジケーター。  
  
## <a name="see-also"></a>参照  
 [維持可能な最大のエンジン スループットの測定](../core/measuring-maximum-sustainable-engine-throughput.md)   
 [維持可能なパフォーマンスとは何ですか。](../core/what-is-sustainable-performance.md)   
 [パフォーマンスのヒントとテクニック](../core/performance-tips-and-tricks.md)   
 [メッセージ ボックスのパフォーマンス カウンター](../core/message-box-performance-counters.md)