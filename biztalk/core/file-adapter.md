---
title: ファイル アダプター |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- File adapters
ms.assetid: e4f6e94b-89b8-42ba-a4c2-a629f1107bb1
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: df810ad31137512713ed7e90a779d82cd48b1b66
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65345552"
---
# <a name="file-adapter"></a>ファイル アダプター
ファイル アダプターは、Microsoft BizTalk Server との間にファイルを転送します。 ファイル アダプターは、2 つのアダプターで構成されます-受信アダプタと送信アダプター。  
  
 このセクションでは、ワークフローを説明しますと、ファイル受信アダプターのバッチ処理の両方のサポートと、ファイル送信アダプター。  
 
## <a name="file-receive-adapter"></a>ファイル受信アダプター  
  
使用して、ファイルは受信、ファイルからメッセージを読み取るし、サーバーに送信するアダプターです。 受信アダプターは、ファイルを読み取って、その BizTalk Server がメッセージを処理できるように、BizTalk メッセージ オブジェクトを作成します。 ファイルからの読み取り中には、アダプターは、ファイルの内容を変更が加えないことを確認するファイルをロックします。  
  
> [!NOTE] 
> ファイル受信アダプターが読み取り専用ファイルまたはシステム ファイルを選択できません。  
  
 ファイルは、ローカル ファイル システム上またはネットワーク共有上のファイルからアダプター読み取り、メッセージを受信します。 ネットワーク共有上の指定の場所がネットワークの問題により利用できない場合は、受信アダプターは、(再試行の回数は、BizTalk Server 管理コンソールで構成可能)、読み取り操作を再試行します。 メッセージを読み取りし、BizTalk メッセージング エンジンによって正常に受け入れた後、受信アダプターはファイル システムまたはネットワーク共有からファイルを削除します。 メッセージが読み取られたパイプラインがメッセージを正常に処理しなかった場合は、アダプターは保留キューにメッセージを配置し、ファイル システムまたはネットワーク共有からファイルを削除します。 ファイル受信アダプターが送信またはメッセージ ボックス データベースにメッセージを中断することはできません、ファイル システムまたはネットワーク共有から、元のファイルは削除されません。  
  
 ファイルを構成することもできます。 受信アダプタは、それらを処理するときにファイルの名前を変更します。 エントリの受信場所がシャット ダウンして再起動した場合、受信アダプターは重複するメッセージが生成しないようにするファイルの名前を変更する必要があります。 これは、ファイル受信場所の構成可能なオプションです。 既定では、名前の変更が無効になります。 名前の変更を有効にすると、ファイルの受信アダプターは、拡張機能を追加します。ファイルには、BTS WIP します。 受信アダプターは、メッセージを受信場所の名前を変更したファイルから読み込むし、サーバーに送信します。 後、受信アダプターでは、ファイルが正常に送信、受信アダプターはファイル システムまたはネットワーク共有から名前が変更されたファイルを削除します。 メッセージが読み取られても失敗する場合、パイプラインで処理、受信アダプター、メッセージ ボックス データベースの保留キューにメッセージを配置し、名前が変更されたファイル、ネットワーク共有から削除します。  
  
> [!NOTE] 
> ファイル名を変更してもパフォーマンスには影響しません。  
  
 せず戻りますを元の名前、名前が変更されたファイル、ファイルが表示される場合、アダプターが正常にメッセージを読み取りますが、メッセージ ボックス データベースに正常にメッセージを格納しなかったのです。BTS WIP の拡張機能。 受信アダプターが、拡張子を持つファイルを読み取らないことに注意してください。BTS WIP の名前の変更のオプションがオンの場合。  
  
#### <a name="using-file-change-notifications-and-polling"></a>ファイル変更通知を使用して、ポーリング
  
 ファイル受信アダプターは、指定されたディレクトリまたは共有からファイルを選択するかを決定するファイル変更通知を Windows に依存しています。 場合は、ファイル受信アダプターは、書き込まれる前に、ファイルが完全に指定されたディレクトリまたは共有にファイルがロックされ、ファイル受信アダプターは、ファイルを取得できません Windows ファイル変更通知を受信します。 このシナリオでのファイルの受信アダプターの指定されたディレクトリをポーリングまたはで共有がアクティブに、**ポーリング間隔 (ミリ秒)** で指定された、**詳細設定** ダイアログ ボックスを構成するときに使用可能なファイルの受信場所。 ファイル受信アダプターは、ディレクトリまたは共有がロックされていないファイル共有から取得し、メッセージ ボックス データベースへのファイルが送信をポーリングします。  
  
> [!NOTE]
>  [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ファイル アダプターでのみテストされているし、NTFS ファイル システムではサポートされています。  
  
 次の Windows ファイル変更通知が発生する、ファイル受信アダプターに指定された場所からファイルを取得します。  
  
 `FILE_NOTIFY_CHANGE_ATTRIBUTES`
  
 監視対象のディレクトリまたはサブツリーで属性が変更を返す、変更通知の待機操作が発生します。  
  
 `FILE_NOTIFY_CHANGE_FILE_NAME`  
  
 任意のファイル名は、監視対象のディレクトリまたはサブツリーの原因で返される、変更通知の待機操作を変更します。 名前変更、作成、またはファイル名の削除、変更が含まれます。  
  
 `FILE_NOTIFY_CHANGE_SIZE`  
  
 監視対象のディレクトリまたはサブツリーでファイルのサイズ変更はにより、変更の通知の待機操作を返します。 オペレーティング システムでは、ファイル サイズの変更を検出、ファイルがディスクに書き込まれたときにのみです。 広範なキャッシュを使用するオペレーティング システムの場合は、検出は、キャッシュが十分にフラッシュされた場合にのみ行われます。  
  
 `FILE_NOTIFY_CHANGE_LAST_WRITE`  
  
 監視対象のディレクトリまたはサブツリーでファイルの最終書き込み時刻の変更により、返される、変更通知の待機操作。 オペレーティング システムは、ファイルがディスクに書き込まれたときにのみ、最終書き込み時刻の変更を検出します。 広範なキャッシュを使用するオペレーティング システムの場合は、検出は、キャッシュが十分にフラッシュされた場合にのみ行われます。  
  
 詳細については、 **FindFirstChangeNotification**関数」を参照[ https://msdn.microsoft.com/library/windows/desktop/aa364417(v=vs.85).aspx](https://msdn.microsoft.com/library/windows/desktop/aa364417(v=vs.85).aspx)します。  
  
### <a name="file-receive-adapter-batching-support"></a>ファイル受信アダプターがバッチ処理のサポート
  
 ファイル受信アダプターがバッチ内のサーバーにメッセージを送信します。 ファイル受信アダプターはすべて、読み取り可能な利用可能なファイルで、受信場所を収集することで、受信場所ごとに 1 つのバッチを構築することにより開始します。 バッチは、使用可能なすべてのファイルが収集されたときに、またはファイルの容量が最大バッチ サイズを超えると、受信アダプターによってメッセージ ボックス データベースに送信されます。  
  
 バッチ内のすべてのメッセージは正常に読み取り、メッセージ ボックス データベースに送信されましたが、後に、ファイル受信アダプターは、受信場所から、対応するファイルを削除します。 バッチ内のメッセージの一部が失敗した場合、処理、ファイル受信アダプター保留しと受信場所から、対応するファイルを削除します。 バッチ操作全体がロールバックされ、対応するすべてのファイルがあるメッセージ ボックス データベースに格納されるメッセージの一部またはすべてが失敗した場合、受信場所では変更されません。  
  
## <a name="file-send-adapter"></a>ファイル送信アダプター
  
 ファイル送信アダプターは、指定された送信先アドレス (URL) をメッセージ ボックス データベースからメッセージを送信します。 メッセージ コンテキスト プロパティに関連するワイルドカード文字を使用してファイルのパスとファイル名であると、URL を定義します。 ファイル送信アダプターの解決、ワイルドカード文字を実際のファイル名にメッセージをファイルに書き込む前に。  
  
 ファイルにメッセージを書き込むときに、ファイル送信アダプターを取得、メッセージの内容 BizTalk メッセージ オブジェクトのボディ部から。 ファイル送信アダプターでは、BizTalk メッセージ オブジェクトの他のメッセージ部分は無視されます。 ファイルの後は、アダプターは、メッセージ ボックス データベースからメッセージを削除、ファイルにメッセージを書き込みます。 ファイル アダプターのファイル システムに書き込むファイルか、直接またはファイル システム キャッシュを使用すると、特に大きなファイルの場合のパフォーマンスを改善できます。  
  
### <a name="file-send-adapter-batching-support"></a>ファイル送信アダプターがバッチ処理のサポート
  
 ファイルは、アダプターのメッセージのバッチを取得をメッセージ ボックス データベースから送信ハンドラーと、ファイル システムまたはネットワーク共有上の宛先の場所でファイルに書き込みます。 ファイル送信アダプターのバッチのサイズは構成できず、20 にあらかじめ設定されています。 BizTalk Server がバッチ内のメッセージの一部のファイルへの書き込みに失敗した場合、システムには、再試行処理用メッセージ ボックス データベースにそれらのメッセージが再送信します。 再試行の間隔を構成して、BizTalk Server 管理コンソールを使用して、再試行の回数。  
  
 
## <a name="in-this-section"></a>このセクションの内容  
  
-   [ファイル アダプターを構成します。](../core/configure-the-file-adapter.md) 
  
-   [ファイル アダプタ構成時の制限事項](../core/restrictions-when-configuring-the-file-adapter.md)  
