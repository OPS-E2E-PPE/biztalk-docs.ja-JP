---
title: ファイル アダプター |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- File adapters
ms.assetid: e4f6e94b-89b8-42ba-a4c2-a629f1107bb1
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: df810ad31137512713ed7e90a779d82cd48b1b66
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65345552"
---
# <a name="file-adapter"></a><span data-ttu-id="9585c-102">ファイル アダプター</span><span class="sxs-lookup"><span data-stu-id="9585c-102">File Adapter</span></span>
<span data-ttu-id="9585c-103">ファイル アダプターは、Microsoft BizTalk Server との間にファイルを転送します。</span><span class="sxs-lookup"><span data-stu-id="9585c-103">The File adapter transfers files into and out of Microsoft BizTalk Server.</span></span> <span data-ttu-id="9585c-104">ファイル アダプターは、2 つのアダプターで構成されます-受信アダプタと送信アダプター。</span><span class="sxs-lookup"><span data-stu-id="9585c-104">The File adapter consists of two adapters — a receive adapter and a send adapter.</span></span>  
  
 <span data-ttu-id="9585c-105">このセクションでは、ワークフローを説明しますと、ファイル受信アダプターのバッチ処理の両方のサポートと、ファイル送信アダプター。</span><span class="sxs-lookup"><span data-stu-id="9585c-105">This section discusses the workflow and batching support for both the File receive adapter and the File send adapter.</span></span>  
 
## <a name="file-receive-adapter"></a><span data-ttu-id="9585c-106">ファイル受信アダプター</span><span class="sxs-lookup"><span data-stu-id="9585c-106">File receive adapter</span></span>  
  
<span data-ttu-id="9585c-107">使用して、ファイルは受信、ファイルからメッセージを読み取るし、サーバーに送信するアダプターです。</span><span class="sxs-lookup"><span data-stu-id="9585c-107">Use the File receive adapter to read messages from files, and submit them to the server.</span></span> <span data-ttu-id="9585c-108">受信アダプターは、ファイルを読み取って、その BizTalk Server がメッセージを処理できるように、BizTalk メッセージ オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="9585c-108">The receive adapter reads the file, and creates a BizTalk Message object, so that BizTalk Server can process the message.</span></span> <span data-ttu-id="9585c-109">ファイルからの読み取り中には、アダプターは、ファイルの内容を変更が加えないことを確認するファイルをロックします。</span><span class="sxs-lookup"><span data-stu-id="9585c-109">While reading from the file, the adapter locks the file to ensure that no modifications can be made to the file content.</span></span>  
  
> [!NOTE] 
> <span data-ttu-id="9585c-110">ファイル受信アダプターが読み取り専用ファイルまたはシステム ファイルを選択できません。</span><span class="sxs-lookup"><span data-stu-id="9585c-110">The File receive adapter does not pick up read-only files or system files.</span></span>  
  
 <span data-ttu-id="9585c-111">ファイルは、ローカル ファイル システム上またはネットワーク共有上のファイルからアダプター読み取り、メッセージを受信します。</span><span class="sxs-lookup"><span data-stu-id="9585c-111">The File receive adapter reads the messages from files on local file systems or on network shares.</span></span> <span data-ttu-id="9585c-112">ネットワーク共有上の指定の場所がネットワークの問題により利用できない場合は、受信アダプターは、(再試行の回数は、BizTalk Server 管理コンソールで構成可能)、読み取り操作を再試行します。</span><span class="sxs-lookup"><span data-stu-id="9585c-112">When the specified location on a network share is unavailable due to network problems, the receive adapter retries the read operation (the number of retries is configurable in the BizTalk Server Administration console).</span></span> <span data-ttu-id="9585c-113">メッセージを読み取りし、BizTalk メッセージング エンジンによって正常に受け入れた後、受信アダプターはファイル システムまたはネットワーク共有からファイルを削除します。</span><span class="sxs-lookup"><span data-stu-id="9585c-113">After the message has been read and successfully accepted by the BizTalk Messaging Engine, the receive adapter deletes the file from the file system or network share.</span></span> <span data-ttu-id="9585c-114">メッセージが読み取られたパイプラインがメッセージを正常に処理しなかった場合は、アダプターは保留キューにメッセージを配置し、ファイル システムまたはネットワーク共有からファイルを削除します。</span><span class="sxs-lookup"><span data-stu-id="9585c-114">If the message was read but the pipeline did not successfully process the message, the adapter puts the message in the suspended queue and then deletes the file from the file system or network share.</span></span> <span data-ttu-id="9585c-115">ファイル受信アダプターが送信またはメッセージ ボックス データベースにメッセージを中断することはできません、ファイル システムまたはネットワーク共有から、元のファイルは削除されません。</span><span class="sxs-lookup"><span data-stu-id="9585c-115">If the File receive adapter cannot submit or suspend the message to the MessageBox database, it does not delete the original file from the file system or network share.</span></span>  
  
 <span data-ttu-id="9585c-116">ファイルを構成することもできます。 受信アダプタは、それらを処理するときにファイルの名前を変更します。</span><span class="sxs-lookup"><span data-stu-id="9585c-116">You can also configure the File receive adapter to rename files when processing them.</span></span> <span data-ttu-id="9585c-117">エントリの受信場所がシャット ダウンして再起動した場合、受信アダプターは重複するメッセージが生成しないようにするファイルの名前を変更する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9585c-117">You should rename files to ensure that the receive adapter does not generate duplicate messages if the receive location is shut down and restarted.</span></span> <span data-ttu-id="9585c-118">これは、ファイル受信場所の構成可能なオプションです。</span><span class="sxs-lookup"><span data-stu-id="9585c-118">This is a configurable option for File receive locations.</span></span> <span data-ttu-id="9585c-119">既定では、名前の変更が無効になります。</span><span class="sxs-lookup"><span data-stu-id="9585c-119">By default, renaming is disabled.</span></span> <span data-ttu-id="9585c-120">名前の変更を有効にすると、ファイルの受信アダプターは、拡張機能を追加します。ファイルには、BTS WIP します。</span><span class="sxs-lookup"><span data-stu-id="9585c-120">When renaming is enabled, the File receive adapter appends the extension .BTS-WIP to the file.</span></span> <span data-ttu-id="9585c-121">受信アダプターは、メッセージを受信場所の名前を変更したファイルから読み込むし、サーバーに送信します。</span><span class="sxs-lookup"><span data-stu-id="9585c-121">The receive adapter then reads the messages from the renamed file in the receive location and submits it to the server.</span></span> <span data-ttu-id="9585c-122">後、受信アダプターでは、ファイルが正常に送信、受信アダプターはファイル システムまたはネットワーク共有から名前が変更されたファイルを削除します。</span><span class="sxs-lookup"><span data-stu-id="9585c-122">After the receive adapter has successfully submitted a file, the receive adapter deletes the renamed file from the file system or network share.</span></span> <span data-ttu-id="9585c-123">メッセージが読み取られても失敗する場合、パイプラインで処理、受信アダプター、メッセージ ボックス データベースの保留キューにメッセージを配置し、名前が変更されたファイル、ネットワーク共有から削除します。</span><span class="sxs-lookup"><span data-stu-id="9585c-123">If a message has been read but failed processing in the pipeline, the receive adapter places the message in the MessageBox database suspended queue, and deletes the renamed file from the network share.</span></span>  
  
> [!NOTE] 
> <span data-ttu-id="9585c-124">ファイル名を変更してもパフォーマンスには影響しません。</span><span class="sxs-lookup"><span data-stu-id="9585c-124">Renaming files has no impact on performance.</span></span>  
  
 <span data-ttu-id="9585c-125">せず戻りますを元の名前、名前が変更されたファイル、ファイルが表示される場合、アダプターが正常にメッセージを読み取りますが、メッセージ ボックス データベースに正常にメッセージを格納しなかったのです。BTS WIP の拡張機能。</span><span class="sxs-lookup"><span data-stu-id="9585c-125">If the File receive adapter successfully reads the message but did not successfully store the message in the MessageBox database, the renamed file reverts to its original name, without the .BTS-WIP extension.</span></span> <span data-ttu-id="9585c-126">受信アダプターが、拡張子を持つファイルを読み取らないことに注意してください。BTS WIP の名前の変更のオプションがオンの場合。</span><span class="sxs-lookup"><span data-stu-id="9585c-126">Note that the receive adapter does not read files with the extension .BTS-WIP if the renaming option is turned on.</span></span>  
  
#### <a name="using-file-change-notifications-and-polling"></a><span data-ttu-id="9585c-127">ファイル変更通知を使用して、ポーリング</span><span class="sxs-lookup"><span data-stu-id="9585c-127">Using file change notifications and polling</span></span>
  
 <span data-ttu-id="9585c-128">ファイル受信アダプターは、指定されたディレクトリまたは共有からファイルを選択するかを決定するファイル変更通知を Windows に依存しています。</span><span class="sxs-lookup"><span data-stu-id="9585c-128">The File receive adapter relies on Windows File Change Notifications to determine when to pick up a file from the specified directory or share.</span></span> <span data-ttu-id="9585c-129">場合は、ファイル受信アダプターは、書き込まれる前に、ファイルが完全に指定されたディレクトリまたは共有にファイルがロックされ、ファイル受信アダプターは、ファイルを取得できません Windows ファイル変更通知を受信します。</span><span class="sxs-lookup"><span data-stu-id="9585c-129">If the File receive adapter receives a Windows File Change Notification before the file has been completely written to the specified directory or share then the file will be locked and the File receive adapter will not retrieve the file.</span></span> <span data-ttu-id="9585c-130">このシナリオでのファイルの受信アダプターの指定されたディレクトリをポーリングまたはで共有がアクティブに、**ポーリング間隔 (ミリ秒)** で指定された、**詳細設定** ダイアログ ボックスを構成するときに使用可能なファイルの受信場所。</span><span class="sxs-lookup"><span data-stu-id="9585c-130">In this scenario, the File receive adapter will actively poll the specified directory or share at the **Polling interval (ms)** specified on the **Advanced settings** dialog box available when configuring a File receive location.</span></span> <span data-ttu-id="9585c-131">ファイル受信アダプターは、ディレクトリまたは共有がロックされていないファイル共有から取得し、メッセージ ボックス データベースへのファイルが送信をポーリングします。</span><span class="sxs-lookup"><span data-stu-id="9585c-131">When the File receive adapter polls a directory or share it retrieves unlocked files from the share and submits the files to the MessageBox database.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9585c-132">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ファイル アダプターでのみテストされているし、NTFS ファイル システムではサポートされています。</span><span class="sxs-lookup"><span data-stu-id="9585c-132">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] File adapter has only been tested on, and is supported on, the NTFS file system.</span></span>  
  
 <span data-ttu-id="9585c-133">次の Windows ファイル変更通知が発生する、ファイル受信アダプターに指定された場所からファイルを取得します。</span><span class="sxs-lookup"><span data-stu-id="9585c-133">The following Windows File Change Notifications will cause the File receive adapter to pick up a file from the specified location:</span></span>  
  
 `FILE_NOTIFY_CHANGE_ATTRIBUTES`
  
 <span data-ttu-id="9585c-134">監視対象のディレクトリまたはサブツリーで属性が変更を返す、変更通知の待機操作が発生します。</span><span class="sxs-lookup"><span data-stu-id="9585c-134">Any attribute change in the watched directory or subtree causes a change notification wait operation to return.</span></span>  
  
 `FILE_NOTIFY_CHANGE_FILE_NAME`  
  
 <span data-ttu-id="9585c-135">任意のファイル名は、監視対象のディレクトリまたはサブツリーの原因で返される、変更通知の待機操作を変更します。</span><span class="sxs-lookup"><span data-stu-id="9585c-135">Any file name change in the watched directory or subtree causes a change notification wait operation to return.</span></span> <span data-ttu-id="9585c-136">名前変更、作成、またはファイル名の削除、変更が含まれます。</span><span class="sxs-lookup"><span data-stu-id="9585c-136">Changes include renaming, creating, or deleting a file name.</span></span>  
  
 `FILE_NOTIFY_CHANGE_SIZE`  
  
 <span data-ttu-id="9585c-137">監視対象のディレクトリまたはサブツリーでファイルのサイズ変更はにより、変更の通知の待機操作を返します。</span><span class="sxs-lookup"><span data-stu-id="9585c-137">Any file-size change in the watched directory or subtree causes a change notification wait operation to return.</span></span> <span data-ttu-id="9585c-138">オペレーティング システムでは、ファイル サイズの変更を検出、ファイルがディスクに書き込まれたときにのみです。</span><span class="sxs-lookup"><span data-stu-id="9585c-138">The operating system detects a change in file size only when the file is written to the disk.</span></span> <span data-ttu-id="9585c-139">広範なキャッシュを使用するオペレーティング システムの場合は、検出は、キャッシュが十分にフラッシュされた場合にのみ行われます。</span><span class="sxs-lookup"><span data-stu-id="9585c-139">For operating systems that use extensive caching, detection occurs only when the cache is sufficiently flushed.</span></span>  
  
 `FILE_NOTIFY_CHANGE_LAST_WRITE`  
  
 <span data-ttu-id="9585c-140">監視対象のディレクトリまたはサブツリーでファイルの最終書き込み時刻の変更により、返される、変更通知の待機操作。</span><span class="sxs-lookup"><span data-stu-id="9585c-140">Any change to the last write-time of files in the watched directory or subtree causes a change notification wait operation to return.</span></span> <span data-ttu-id="9585c-141">オペレーティング システムは、ファイルがディスクに書き込まれたときにのみ、最終書き込み時刻の変更を検出します。</span><span class="sxs-lookup"><span data-stu-id="9585c-141">The operating system detects a change to the last write-time only when the file is written to the disk.</span></span> <span data-ttu-id="9585c-142">広範なキャッシュを使用するオペレーティング システムの場合は、検出は、キャッシュが十分にフラッシュされた場合にのみ行われます。</span><span class="sxs-lookup"><span data-stu-id="9585c-142">For operating systems that use extensive caching, detection occurs only when the cache is sufficiently flushed.</span></span>  
  
 <span data-ttu-id="9585c-143">詳細については、 **FindFirstChangeNotification**関数」を参照[ https://msdn.microsoft.com/library/windows/desktop/aa364417(v=vs.85).aspx](https://msdn.microsoft.com/library/windows/desktop/aa364417(v=vs.85).aspx)します。</span><span class="sxs-lookup"><span data-stu-id="9585c-143">For more information about the **FindFirstChangeNotification** function see [https://msdn.microsoft.com/library/windows/desktop/aa364417(v=vs.85).aspx](https://msdn.microsoft.com/library/windows/desktop/aa364417(v=vs.85).aspx).</span></span>  
  
### <a name="file-receive-adapter-batching-support"></a><span data-ttu-id="9585c-144">ファイル受信アダプターがバッチ処理のサポート</span><span class="sxs-lookup"><span data-stu-id="9585c-144">File Receive Adapter Batching Support</span></span>
  
 <span data-ttu-id="9585c-145">ファイル受信アダプターがバッチ内のサーバーにメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="9585c-145">The File receive adapter submits messages to the server in batches.</span></span> <span data-ttu-id="9585c-146">ファイル受信アダプターはすべて、読み取り可能な利用可能なファイルで、受信場所を収集することで、受信場所ごとに 1 つのバッチを構築することにより開始します。</span><span class="sxs-lookup"><span data-stu-id="9585c-146">The File receive adapter starts by building a single batch per receive location by collecting all the readable files available in the receive location.</span></span> <span data-ttu-id="9585c-147">バッチは、使用可能なすべてのファイルが収集されたときに、またはファイルの容量が最大バッチ サイズを超えると、受信アダプターによってメッセージ ボックス データベースに送信されます。</span><span class="sxs-lookup"><span data-stu-id="9585c-147">Batches are submitted to the MessageBox database by the receive adapter when all the available files have been collected or when the amount of files collected exceeds the maximum batch size.</span></span>  
  
 <span data-ttu-id="9585c-148">バッチ内のすべてのメッセージは正常に読み取り、メッセージ ボックス データベースに送信されましたが、後に、ファイル受信アダプターは、受信場所から、対応するファイルを削除します。</span><span class="sxs-lookup"><span data-stu-id="9585c-148">After all the messages within the batch have been successfully read and submitted into the MessageBox database, the File receive adapter deletes the corresponding files from the receive location.</span></span> <span data-ttu-id="9585c-149">バッチ内のメッセージの一部が失敗した場合、処理、ファイル受信アダプター保留しと受信場所から、対応するファイルを削除します。</span><span class="sxs-lookup"><span data-stu-id="9585c-149">If some of the messages within the batch failed processing, the File receive adapter suspends them and deletes the corresponding files from the receive location.</span></span> <span data-ttu-id="9585c-150">バッチ操作全体がロールバックされ、対応するすべてのファイルがあるメッセージ ボックス データベースに格納されるメッセージの一部またはすべてが失敗した場合、受信場所では変更されません。</span><span class="sxs-lookup"><span data-stu-id="9585c-150">If some or all of the messages fail to be stored in the MessageBox database, the entire batch operation is rolled back and all corresponding files are left unchanged in the receive location.</span></span>  
  
## <a name="file-send-adapter"></a><span data-ttu-id="9585c-151">ファイル送信アダプター</span><span class="sxs-lookup"><span data-stu-id="9585c-151">File Send Adapter</span></span>
  
 <span data-ttu-id="9585c-152">ファイル送信アダプターは、指定された送信先アドレス (URL) をメッセージ ボックス データベースからメッセージを送信します。</span><span class="sxs-lookup"><span data-stu-id="9585c-152">The File send adapter transmits messages from the MessageBox database to a specified destination address (URL).</span></span> <span data-ttu-id="9585c-153">メッセージ コンテキスト プロパティに関連するワイルドカード文字を使用してファイルのパスとファイル名であると、URL を定義します。</span><span class="sxs-lookup"><span data-stu-id="9585c-153">You define the URL, which is a file path and file name, by using wildcard characters related to the message context properties.</span></span> <span data-ttu-id="9585c-154">ファイル送信アダプターの解決、ワイルドカード文字を実際のファイル名にメッセージをファイルに書き込む前に。</span><span class="sxs-lookup"><span data-stu-id="9585c-154">The File send adapter resolves the wildcard characters to the actual file name before writing the message to the file.</span></span>  
  
 <span data-ttu-id="9585c-155">ファイルにメッセージを書き込むときに、ファイル送信アダプターを取得、メッセージの内容 BizTalk メッセージ オブジェクトのボディ部から。</span><span class="sxs-lookup"><span data-stu-id="9585c-155">When writing a message to a file, the File send adapter gets the message content from the body part of the BizTalk Message object.</span></span> <span data-ttu-id="9585c-156">ファイル送信アダプターでは、BizTalk メッセージ オブジェクトの他のメッセージ部分は無視されます。</span><span class="sxs-lookup"><span data-stu-id="9585c-156">The File send adapter ignores other message parts in the BizTalk Message object.</span></span> <span data-ttu-id="9585c-157">ファイルの後は、アダプターは、メッセージ ボックス データベースからメッセージを削除、ファイルにメッセージを書き込みます。</span><span class="sxs-lookup"><span data-stu-id="9585c-157">After the File adapter writes the message to a file, it deletes the message from the MessageBox database.</span></span> <span data-ttu-id="9585c-158">ファイル アダプターのファイル システムに書き込むファイルか、直接またはファイル システム キャッシュを使用すると、特に大きなファイルの場合のパフォーマンスを改善できます。</span><span class="sxs-lookup"><span data-stu-id="9585c-158">The File adapter writes files to the file system either directly or by using the file system cache, which can improve performance, particularly for large files.</span></span>  
  
### <a name="file-send-adapter-batching-support"></a><span data-ttu-id="9585c-159">ファイル送信アダプターがバッチ処理のサポート</span><span class="sxs-lookup"><span data-stu-id="9585c-159">File Send Adapter Batching Support</span></span>
  
 <span data-ttu-id="9585c-160">ファイルは、アダプターのメッセージのバッチを取得をメッセージ ボックス データベースから送信ハンドラーと、ファイル システムまたはネットワーク共有上の宛先の場所でファイルに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="9585c-160">The File send adapter gets batches of messages from the MessageBox database and writes them to files in destination locations on the file system or the network share.</span></span> <span data-ttu-id="9585c-161">ファイル送信アダプターのバッチのサイズは構成できず、20 にあらかじめ設定されています。</span><span class="sxs-lookup"><span data-stu-id="9585c-161">The size of File send adapter batches is not configurable and is preset to 20.</span></span> <span data-ttu-id="9585c-162">BizTalk Server がバッチ内のメッセージの一部のファイルへの書き込みに失敗した場合、システムには、再試行処理用メッセージ ボックス データベースにそれらのメッセージが再送信します。</span><span class="sxs-lookup"><span data-stu-id="9585c-162">If BizTalk Server fails to write some of the messages within a batch to files, the system resubmits those messages to the MessageBox database for retry processing.</span></span> <span data-ttu-id="9585c-163">再試行の間隔を構成して、BizTalk Server 管理コンソールを使用して、再試行の回数。</span><span class="sxs-lookup"><span data-stu-id="9585c-163">You can configure the retry interval and retry count by using the BizTalk Server Administration console.</span></span>  
  
 
## <a name="in-this-section"></a><span data-ttu-id="9585c-164">このセクションの内容</span><span class="sxs-lookup"><span data-stu-id="9585c-164">In this section</span></span>  
  
-   [<span data-ttu-id="9585c-165">ファイル アダプターを構成します。</span><span class="sxs-lookup"><span data-stu-id="9585c-165">Configure the File adapter</span></span>](../core/configure-the-file-adapter.md) 
  
-   [<span data-ttu-id="9585c-166">ファイル アダプタ構成時の制限事項</span><span class="sxs-lookup"><span data-stu-id="9585c-166">Restrictions when configuring the File adapter</span></span>](../core/restrictions-when-configuring-the-file-adapter.md)  
