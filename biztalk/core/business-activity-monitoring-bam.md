---
title: ビジネス アクティビティ監視 (BAM) |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- BAM, tools
- utilities, Tracking Profile Deployment Utility
- BAM, deployment process
- BAM
- BAM, presentation layers
- BAM, Tracking Profile Deployment utility
- BAM, about BAM
- BAM, data storage
- BAM Management utility
- Tracking Profile Deployment utility
- BAM, runtime process
- BAM, design time
- BAM, data insertion
- BAM, data consumption
- BAM, BAM Management utility
- BAM, processing
ms.assetid: a8ad48b1-6891-4bbb-b125-27d224e49293
caps.latest.revision: 17
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 258294a8a51e6f8e80e360668123e522acf6ff15
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36972307"
---
# <a name="business-activity-monitoring-bam"></a><span data-ttu-id="4f55e-102">ビジネス アクティビティ監視 (BAM)</span><span class="sxs-lookup"><span data-stu-id="4f55e-102">Business Activity Monitoring (BAM)</span></span>
<span data-ttu-id="4f55e-103">次の図に、ビジネス アクティビティ監視 (BAM) 機能のアーキテクチャを示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-103">The following diagram illustrates the architecture for the Business Activity Monitoring (BAM) feature.</span></span>  
  
 <span data-ttu-id="4f55e-104">![](../core/media/architecture-bam-01.gif "architecture_bam_01")</span><span class="sxs-lookup"><span data-stu-id="4f55e-104">![](../core/media/architecture-bam-01.gif "architecture_bam_01")</span></span>  
  
## <a name="tools"></a><span data-ttu-id="4f55e-105">ツール</span><span class="sxs-lookup"><span data-stu-id="4f55e-105">Tools</span></span>  
 <span data-ttu-id="4f55e-106">BAM と統合する BizTalk ソリューションのデザイン、開発、および展開には、次のツールを使用できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-106">You can use the following tools to design, develop, and deploy BizTalk solutions that integrate with BAM.</span></span>  
  
-   <span data-ttu-id="4f55e-107">**Microsoft Excel**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-107">**Microsoft Excel**.</span></span> <span data-ttu-id="4f55e-108">Excel 用の BAM アドインによって提供されるユーザー インターフェイスを使用して、ビジネス アナリストはアクティビティとビューを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-108">The BAM Add-In for Excel provides a user interface that guides business analysts during the creation of Activities and Views.</span></span> <span data-ttu-id="4f55e-109">Excel はビジネス アナリストのデザイン ツールとして、およびビジネス ユーザーのデータ利用ツールとして機能します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-109">Excel serves as both a design tool for business analysts and a data consumption tool for business users.</span></span> <span data-ttu-id="4f55e-110">Excel 用 BAM アドインの詳細については、[Excel 用 BAM アドインを使用するための要件](../core/requirements-for-using-the-bam-add-in-for-excel.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4f55e-110">For more information about the BAM Add-In for Excel, see [Requirements for Using the BAM Add-In for Excel](../core/requirements-for-using-the-bam-add-in-for-excel.md).</span></span>  
  
-   <span data-ttu-id="4f55e-111">**BAM 管理ユーティリティ**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-111">**BAM Management Utility**.</span></span> <span data-ttu-id="4f55e-112">BAM 管理ユーティリティは、Excel で作成された BAM の定義を企業に展開するための展開ツールです。</span><span class="sxs-lookup"><span data-stu-id="4f55e-112">The BAM Management Utility is a deployment tool that allows BAM definitions created in Excel to be deployed into the enterprise.</span></span> <span data-ttu-id="4f55e-113">BAM 管理ユーティリティでは、必要な SQL Server データベース、Analysis Services キューブ、SQL Notification Service データベース、および DTS タスクまたは SSIS タスク (インストールされている SQL Server のバージョンによって異なる) を作成します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-113">The BAM Management Utility creates the necessary SQL Server databases, Analysis Services cubes, SQL Notification Services databases, and DTS or SSIS tasks (depending on which version of SQL Server is installed).</span></span> <span data-ttu-id="4f55e-114">BAM マネージャーの詳細については、[BAM 管理ユーティリティ](../core/bam-management-utility.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4f55e-114">For more information about the BAM Manager, see [BAM Management Utility](../core/bam-management-utility.md).</span></span>  
  
-   <span data-ttu-id="4f55e-115">**追跡プロファイル エディター**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-115">**Tracking Profile Editor**.</span></span> <span data-ttu-id="4f55e-116">追跡プロファイル エディターを使用すると、BizTalk 開発者は、ビジネス アナリストによって定義されたデータ要素をオーケストレーションやメッセージングを含む BizTalk 実装にマップできます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-116">The Tracking Profile Editor enables BizTalk developers to map the data elements defined by business analysts into the BizTalk implementation including Orchestrations and Messaging.</span></span> <span data-ttu-id="4f55e-117">追跡プロファイル エディターの詳細については、[追跡プロファイル エディター](../core/tracking-profile-editor.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4f55e-117">For more information about the Tracking Profile Editor, see [Tracking Profile Editor](../core/tracking-profile-editor.md).</span></span>  
  
-   <span data-ttu-id="4f55e-118">**追跡プロファイルの展開ユーティリティ**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-118">**Tracking Profile Deployment Utility**.</span></span> <span data-ttu-id="4f55e-119">追跡プロファイルの展開ユーティリティを使用すると、IT プロフェッショナルは新しい追跡プロファイルや更新された追跡プロファイルを BAM インフラストラクチャに展開できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-119">The Tracking Profile Deployment Utility allows IT professionals to deploy new and updated tracking profiles to the BAM infrastructure.</span></span> <span data-ttu-id="4f55e-120">追跡プロファイルの展開ツールの詳細については、[追跡プロファイルの展開ユーティリティ](../core/tracking-profile-deployment-utility.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4f55e-120">For more information about the Tracking Profile Deploy tool, see [Tracking Profile Deployment Utility](../core/tracking-profile-deployment-utility.md).</span></span>  
  
## <a name="presentation"></a><span data-ttu-id="4f55e-121">効果</span><span class="sxs-lookup"><span data-stu-id="4f55e-121">Presentation</span></span>  
 <span data-ttu-id="4f55e-122">プレゼンテーション層は、次の要素で構成されています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-122">The presentation layer consists of the following:</span></span>  
  
- <span data-ttu-id="4f55e-123">**BAM ポータル**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-123">**BAM Portal**.</span></span> <span data-ttu-id="4f55e-124">Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の BAM ポータルでは、ビジネス プロセスをリアルタイムで詳しく表示できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-124">The BAM portal in Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provides real-time, end-to-end visibility into a business process.</span></span> <span data-ttu-id="4f55e-125">これは、ASP.NET ページのコレクションで構成される Web ベースの機能です。</span><span class="sxs-lookup"><span data-stu-id="4f55e-125">It is a Web-based feature that consists of a collection of ASP.NET  pages.</span></span> <span data-ttu-id="4f55e-126">BAM をカスタマイズすることにより、パフォーマンスとユーザー エクスペリエンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-126">You can customize BAM to enhance the performance and experience for your users.</span></span> <span data-ttu-id="4f55e-127">BAM ポータルの詳細については、[BAM ポータル](../core/bam-portal.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4f55e-127">For more information about the BAM Portal, see [BAM Portal](../core/bam-portal.md).</span></span>  
  
- <span data-ttu-id="4f55e-128">**Microsoft Excel**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-128">**Microsoft Excel**.</span></span> <span data-ttu-id="4f55e-129">Excel 用の BAM アドインによって提供されるユーザー インターフェイスを使用して、ビジネス アナリストはアクティビティとビューを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-129">The BAM Add-In for Excel provides a user interface that guides business analysts during the creation of Activities and Views.</span></span> <span data-ttu-id="4f55e-130">Excel はビジネス アナリストのデザイン ツールとして、およびビジネス ユーザーのデータ利用ツールとして機能します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-130">Excel serves as both a design tool for business analysts and a data consumption tool for business users.</span></span> <span data-ttu-id="4f55e-131">Excel 用 BAM アドインの詳細については、[Excel 用 BAM アドインを使用するための要件](../core/requirements-for-using-the-bam-add-in-for-excel.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4f55e-131">For more information about the BAM Add-In for Excel, see [Requirements for Using the BAM Add-In for Excel](../core/requirements-for-using-the-bam-add-in-for-excel.md).</span></span>  
  
- <span data-ttu-id="4f55e-132">**カスタム ユーザー インターフェイス**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-132">**Custom User Interface**.</span></span> <span data-ttu-id="4f55e-133">ISV および開発者は、BAM データを表示するカスタム アプリケーションを作成できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-133">ISV’s and developers can create custom applications that display BAM data</span></span>  
  
## <a name="processing"></a><span data-ttu-id="4f55e-134">処理</span><span class="sxs-lookup"><span data-stu-id="4f55e-134">Processing</span></span>  
 <span data-ttu-id="4f55e-135">処理層は、次の要素で構成されています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-135">The processing layer consists of the following:</span></span>  
  
- <span data-ttu-id="4f55e-136">**BAM 管理 Web サービス**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-136">**BAM Management Web Service**.</span></span> <span data-ttu-id="4f55e-137">この Web サービスは、BAM プライマリ インポート テーブル (PIT) と通信するために、BAM ポータル アプリケーションによって使用されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-137">This Web service is used by the BAM Portal application to communicate with the BAM Primary Import Tables (PIT).</span></span> <span data-ttu-id="4f55e-138">データベースとの通信は、構成中に作成されたレジストリに保存されている、権限を借用した資格情報を使用して行われます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-138">The communication with the database is done using impersonated credentials stored in the registry which is created during configuration.</span></span> <span data-ttu-id="4f55e-139">この Web サービスで公開されたメソッドは、カスタム クライアントによって、任意のユーザーのビューおよびその詳細、関連アクティビティ、およびピボット テーブル レイアウトを取得するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-139">Methods exposed by this Web service can be used by custom clients to get views and their details, related activities, and pivot table layouts for any user.</span></span> <span data-ttu-id="4f55e-140">さらに、データベース内の警告の管理にも使用できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-140">They can also be used to manage alerts in the database.</span></span>  
  
- <span data-ttu-id="4f55e-141">**イベント バス**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-141">**Event Bus** .</span></span> <span data-ttu-id="4f55e-142">BAM イベント バス サービスでは、ソース データベースに保存された追跡データ (ストリーム) を処理し、そのデータを出力先データベース内にクエリ テーブル形式で保持します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-142">The BAM Event Bus Service processes tracking data (streams) stored in a source database and persists that data in a query table format in the destination database.</span></span>  
  
- <span data-ttu-id="4f55e-143">**SQL Notification Services**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-143">**SQL Notification Services**.</span></span> <span data-ttu-id="4f55e-144">SQL Notification Services では、ビジネス ユーザーが定義したインスタンスおよび集計 BAM 警告を評価します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-144">SQL Notification Services evaluates the Instance and Aggregate BAM alerts that are defined by the business user.</span></span>  
  
  <span data-ttu-id="4f55e-145">次の図に、BAM アーキテクチャの基になる物理プロセスを示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-145">The following diagram illustrates the underlying physical processes for the BAM architecture.</span></span>  
  
  <span data-ttu-id="4f55e-146">![](../core/media/architecture-bam-02.gif "architecture_bam_02")</span><span class="sxs-lookup"><span data-stu-id="4f55e-146">![](../core/media/architecture-bam-02.gif "architecture_bam_02")</span></span>  
  
## <a name="design-time-experience"></a><span data-ttu-id="4f55e-147">デザイン時の操作</span><span class="sxs-lookup"><span data-stu-id="4f55e-147">Design time experience</span></span>  
 <span data-ttu-id="4f55e-148">次の図に、デザイン時の操作を示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-148">The following diagram illustrates the design time experience.</span></span>  
  
 <span data-ttu-id="4f55e-149">![](../core/media/architecture-bam-03.gif "architecture_bam_03")</span><span class="sxs-lookup"><span data-stu-id="4f55e-149">![](../core/media/architecture-bam-03.gif "architecture_bam_03")</span></span>  
  
 <span data-ttu-id="4f55e-150">次の手順では、上の図に示したシーケンスを説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-150">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="4f55e-151">追跡プロファイル エディターでは、BizTalk Server が構成済みであること、少なくとも 1 つの BAM 定義が BM.exe を使用して展開済みであること、およびプライマリ インポート データベースを含むインフラストラクチャが作成済みであることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-151">The Tracking Profile Editor assumes that BizTalk Server has been configured, that at least one BAM definition has already been deployed (using BM.exe), and that the infrastructure, including the Primary Import Database has been created.</span></span> <span data-ttu-id="4f55e-152">追跡プロファイル エディターでは、BizTalk 構成時に設定されるレジストリ キーを使用して、管理データベースの場所を決定します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-152">The Tracking Profile Editor uses a registry key that is set during BizTalk configuration to determine where the Management database is located.</span></span>  
  
    1.  <span data-ttu-id="4f55e-153">BAM では、プライマリ インポート データベースが検出されるとその中のアクティビティが列挙されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-153">BAM enumerates the activities within the Primary Import Database once it is discovered.</span></span> <span data-ttu-id="4f55e-154">BizTalk 開発者は、BAM プライマリ インポート データベースから取得した展開済みのアクティビティを選択します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-154">BizTalk developers select the deployed activities which get pulled from the BAM Primary Import database.</span></span>  
  
    2.  <span data-ttu-id="4f55e-155">BizTalk 開発者は、BizTalk 管理データベースから取得した展開済みのアセンブリを参照することにより、これを物理実装にマップします。</span><span class="sxs-lookup"><span data-stu-id="4f55e-155">The BizTalk developer maps this to a physical implementation by browsing the deployed assemblies retrieved from the BizTalk Management database.</span></span>  
  
    3.  <span data-ttu-id="4f55e-156">開発者がこれを BizTalk アイテムに視覚的にマップすると、メタデータが BizTalk Server ランタイムに送信され、データが収集され保存されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-156">Once the developer has visually mapped this to the BizTalk artifacts, metadata is submitted to the BizTalk Server runtime to collect and store the data.</span></span> <span data-ttu-id="4f55e-157">これは注釈 (収集されたデータのデコードに使用するメッセージング情報の場合) および追跡プロファイル (ランタイム データの取得に使用) によって行われます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-157">This is done via annotations (for messaging information used to decode the collected data) and the tracking profile (used to retrieve the runtime data).</span></span>  
  
2.  <span data-ttu-id="4f55e-158">Microsoft Excel はデザイン時ツール、およびデータ利用ツールまたはプレゼンテーション ツールとして使用されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-158">Microsoft Excel is used as both a design time tool and a data consumption or presentation tool.</span></span> <span data-ttu-id="4f55e-159">デザイン時の Excel の操作では、BAM アクティビティとビューを作成することにより BAM 定義を構築できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-159">The design time Excel experience allows users to construct a BAM definition by creating BAM Activities and Views.</span></span> <span data-ttu-id="4f55e-160">さらに、BAM ポータルに最終的に表示されるピボット コントロールとグラフも作成できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-160">It also allows for the creation of the pivot controls and graphs that are ultimately displayed in the BAM portal.</span></span>  
  
## <a name="deployment"></a><span data-ttu-id="4f55e-161">展開</span><span class="sxs-lookup"><span data-stu-id="4f55e-161">Deployment</span></span>  
 <span data-ttu-id="4f55e-162">展開には次の 2 つのカテゴリがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-162">There are two categories of deployment</span></span>  
  
- <span data-ttu-id="4f55e-163">動的なインフラストラクチャを構築する。</span><span class="sxs-lookup"><span data-stu-id="4f55e-163">Building out the dynamic infrastructure</span></span>  
  
- <span data-ttu-id="4f55e-164">ランタイムをインストルメント化し、データを収集する。</span><span class="sxs-lookup"><span data-stu-id="4f55e-164">Instrumenting the runtime to collect data.</span></span>  
  
  <span data-ttu-id="4f55e-165">次の図に、BAM の展開を示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-165">The following diagram illustrates BAM deployment.</span></span>  
  
  <span data-ttu-id="4f55e-166">![](../core/media/architecture-bam-04.gif "architecture_bam_04")</span><span class="sxs-lookup"><span data-stu-id="4f55e-166">![](../core/media/architecture-bam-04.gif "architecture_bam_04")</span></span>  
  
  <span data-ttu-id="4f55e-167">次の手順では、上の図に示したシーケンスを説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-167">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="4f55e-168">動的インフラストラクチャの構築に、BAM 管理ユーティリティが使用されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-168">The BAM Management Utility is used to build out the dynamic infrastructure.</span></span> <span data-ttu-id="4f55e-169">BAM 管理ユーティリティでは、BAM 定義またはデザイン時の Excel ワークブック、および BAM 構成 XML ファイルを使用し、必要なすべてのデータベース、およびシステムの運用に必要な対応する DTS タスクまたは SSIS タスクを構築します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-169">Using the BAM definition or a design time Excel workbook plus the BAM Configuration XML file, the BAM Management Utility builds all the necessary databases and the corresponding DTS or SSIS tasks necessary for the system to operate.</span></span>  
  
    1.  <span data-ttu-id="4f55e-170">BAM プライマリ インポート データベースと、それをサポートするすべてのストアド プロシージャ、トリガー、および DTS タスクまたは SSIS タスクが構築されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-170">The BAM Primary Import database and all the supporting stored procedures, triggers, and DTS or SSIS tasks are constructed.</span></span>  
  
    2.  <span data-ttu-id="4f55e-171">BAM アーカイブ データベースが定義されますが、アーカイブ DTS または SSIS タスクが実行されるまでは、作成されません。</span><span class="sxs-lookup"><span data-stu-id="4f55e-171">The BAM Archive database is defined, but not created, until the Archiving DTS or SSIS task is executed.</span></span>  
  
    3.  <span data-ttu-id="4f55e-172">BAM OLAP 集計が定義されている場合は、BAM スター スキーマ データベース。</span><span class="sxs-lookup"><span data-stu-id="4f55e-172">The BAM Star Schema database if BAM OLAP Aggregations were defined.</span></span> <span data-ttu-id="4f55e-173">場合、集計が定義されているかどうかを決定できます、**リアルタイム集計**Excel スプレッドシートのボタンが無効になっている、または**CreateOlapCube**に設定されている**true**でBAM 定義と構成 XML ファイルが展開単位**AnalysisDatabase**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-173">You can determine if aggregations have been defined if the **Real Time Aggregation** button in the Excel spreadsheet is disabled or the **CreateOlapCube** is set to **true** in the BAM Definition and the Configuration XML file has a Deployment Unit for **AnalysisDatabase**.</span></span>  
  
    4.  <span data-ttu-id="4f55e-174">BAM OLAP キューブを作成するためには、BAM 定義および構成 XML で RTA 以外の集計が定義されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-174">The BAM Definition and Configuration XML have to have an Aggregation defined that is not an RTA in order for a BAM OLAP cube to be created.</span></span>  
  
    5.  <span data-ttu-id="4f55e-175">BAM マネージャー プロセスの展開したビューでは、SQL NS データベースの作成のために Notification Services プロセス (nscontrol.exe) が呼び出されることを示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-175">Exploded view of the BAM Manager process shows that the Notification Services process (nscontrol.exe) is called to create the SQL NS databases.</span></span>  
  
2.  <span data-ttu-id="4f55e-176">追跡プロファイル エディター UI には、ランタイムをインストルメント化してランタイム システムのデータを追跡し、デコードするための展開コマンドがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-176">The Tracking Profile Editor UI has a deployment command which instruments the runtime to track and decode data from the runtime systems.</span></span> <span data-ttu-id="4f55e-177">この場合をプッシュ**注釈**(データがメッセージング システムから取得した) 場合は、BAM プライマリ インポート データベースにします。</span><span class="sxs-lookup"><span data-stu-id="4f55e-177">In this case it pushes **annotations** into the BAM Primary Import database (if data is pulled from the messaging system).</span></span> <span data-ttu-id="4f55e-178">追跡プロファイルは、BizTalk ランタイムで BAM システムに公開するデータを決定するために使用する BizTalk 管理データベースに挿入されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-178">A tracking profile is inserted into the BizTalk Management database which is used by the BizTalk Runtime to determine what data to publish to the BAM system.</span></span>  
  
3.  <span data-ttu-id="4f55e-179">BizTalk 追跡展開コマンド ライン ツールを使用すると、追跡プロファイルを BAM プライマリ インポート データベースおよび管理データベースに公開できます。これは追跡プロファイル エディターの機能と似ていますが、コマンド ライン ツールにはマッピング機能がありません。</span><span class="sxs-lookup"><span data-stu-id="4f55e-179">The BizTalk Tracking Deployment command line tool allows Tracking Profiles to be published to the BAM Primary Import database and Management database, which is similar to what the Tracking Profile Editor does; however the command line tool does not allow mapping capabilities.</span></span>  
  
## <a name="data-consumption"></a><span data-ttu-id="4f55e-180">データ利用</span><span class="sxs-lookup"><span data-stu-id="4f55e-180">Data Consumption</span></span>  
 <span data-ttu-id="4f55e-181">データ利用とは、BAM インフラストラクチャが収集した情報をビジネス ユーザーが利用するプロセスのことです。</span><span class="sxs-lookup"><span data-stu-id="4f55e-181">Data consumption refers to the process in which a business user consumes the information that the BAM infrastructure has collected.</span></span> <span data-ttu-id="4f55e-182">この時点で、BAM 定義の作成 (収集するデータおよびその表示方法の定義)、BAM 定義の展開 (インフラストラクチャの動的な作成)、および BAM 定義から物理実装へのマップ (データの収集場所の定義と、場合によってはシステムにプッシュするコードの作成) が完了していることが前提になります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-182">It is assumed at this point, that the BAM definition has been created (defining what data to collect and how to view it), that the BAM definition has been deployed (dynamically creating the infrastructure), and that the BAM definition has been mapped to the physical implementation (defining where to collect the data, and in some cases writing code to push into the system).</span></span>  
  
 <span data-ttu-id="4f55e-183">次の図に、データ利用のプロセスを示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-183">The following diagram illustrates the process of data consumption.</span></span>  
  
 <span data-ttu-id="4f55e-184">![](../core/media/architecture-bam-05.gif "architecture_bam_05")</span><span class="sxs-lookup"><span data-stu-id="4f55e-184">![](../core/media/architecture-bam-05.gif "architecture_bam_05")</span></span>  
  
 <span data-ttu-id="4f55e-185">次の手順では、上の図に示したシーケンスを説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-185">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="4f55e-186">BAM ポータルは、Internet Explorer と、インターネット インフォメーション サービスでホストされる BAM Web ポータル プロセスの 2 つのプロセスに分けられます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-186">The BAM portal is split out into two processes, Internet Explorer and the BAM Web portal process hosted in Internet Information Services.</span></span>  
  
    1.  <span data-ttu-id="4f55e-187">Internet Explorer では、BAM ポータル Web サイトに接続するビジネス ユーザーのセキュリティ コンテキストを使用します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-187">Internet Explorer uses the security context of the business user connecting to the BAM Portal Web site.</span></span> <span data-ttu-id="4f55e-188">BAM ポータル Web サイトは、BAM 管理 Web サービスを使用して情報を収集する ASPX アプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="4f55e-188">The BAM Portal Web site is an ASPX application that uses the BAM Management Web Service to collect information.</span></span>  
  
    2.  <span data-ttu-id="4f55e-189">BAM ポータルでは、BAM 管理 Web サービスを呼び出し、特定のビジネス ユーザーが表示可能な BAM アクティビティ/ビューなどの情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-189">The BAM Portal calls the BAM Management Web Service to retrieve information such as what BAM Activities/Views the particular business user can see.</span></span> <span data-ttu-id="4f55e-190">BAM 管理 Web サービスでビジネス ユーザーを偽装できることは重要であるため、通常の展開では BAM ポータルと Web サービスは同じコンピューターでホストされます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-190">It is critical that the BAM Management Web Service is able to impersonate the business user, therefore, the typical deployment is the BAM Portal and the Web Service are hosted on the same machine</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="4f55e-191">企業が Kerberos をサポートしており、Active Directory が委任をサポートするように設定されている場合は、ポータルと Web サービスが異なるコンピューターに存在することがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-191">If your enterprise supports Kerberos and Active Directory is set up to support delegation, it is possible that the Portal and Web Service can be located on different machines.</span></span>  
  
    3.  <span data-ttu-id="4f55e-192">Web サービスは、セキュリティ チェックを実行、メタデータを取得および BAM リアルタイム集計に関する情報を取得する BAM プライマリ インポートでのストアド プロシージャを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-192">The Web Service calls stored procedures in the BAM Primary Import to perform security checks, retrieve metadata, and retrieve information about BAM Real Time Aggregations.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="4f55e-193">現在、BAM ポータルを使用して、ドキュメントに未記載の Web サービスと呼ばれる、**クエリ Web サービス**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-193">Currently the BAM Portal uses an undocumented Web Service called the **Query Web Service**.</span></span> <span data-ttu-id="4f55e-194">これはサポートされておらず、次のリリースでは推奨されなくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-194">This is not supported and will most likely be deprecated in the next release.</span></span>  
  
    4.  <span data-ttu-id="4f55e-195">Internet Explorer は Office Web Controls (OWC) をホストしています。これにより、BAM Analysis Services キューブに直接接続します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-195">Internet Explorer hosts the Office Web Controls (OWC) which makes direct connections to the BAM Analysis Services cubes.</span></span>  
  
2.  <span data-ttu-id="4f55e-196">[エクスポート]</span><span class="sxs-lookup"><span data-stu-id="4f55e-196">Excel</span></span>  
  
## <a name="runtime"></a><span data-ttu-id="4f55e-197">ランタイム</span><span class="sxs-lookup"><span data-stu-id="4f55e-197">Runtime</span></span>  
 <span data-ttu-id="4f55e-198">BAM 定義が完了し、インフラストラクチャが構築され、開発者が必要なシステムをインストルメント化して情報表示が有効になったら、システム内でのデータのフローを開始できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-198">After the BAM Definition has been defined, the infrastructure has been built out, and the developer has instrumented the necessary systems to enable visibility, data can begin flowing through the system.</span></span>  
  
### <a name="data-insertion"></a><span data-ttu-id="4f55e-199">データの挿入</span><span class="sxs-lookup"><span data-stu-id="4f55e-199">Data Insertion</span></span>  
 <span data-ttu-id="4f55e-200">データが BAM システムにフローする代表的な方法の 1 つに、BizTalk Service (BTSNTSvc.exe) を使用したものがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-200">One of the primary ways data flows into the BAM system is via the BizTalk Service (BTSNTSvc.exe).</span></span> <span data-ttu-id="4f55e-201">BizTalk Service は、論理サブシステムを格納できるように構築されています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-201">The BizTalk Service is architected such that it can contain logical subsystems.</span></span>  
  
 <span data-ttu-id="4f55e-202">このプロセスを説明する図を次に示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-202">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="4f55e-203">![](../core/media/architecture-bam-06.gif "architecture_bam_06")</span><span class="sxs-lookup"><span data-stu-id="4f55e-203">![](../core/media/architecture-bam-06.gif "architecture_bam_06")</span></span>  
  
 <span data-ttu-id="4f55e-204">次の手順では、上の図に示したシーケンスを説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-204">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="4f55e-205">1 つのサブシステムでは、BizTalk Server エンジン自体をホストします。</span><span class="sxs-lookup"><span data-stu-id="4f55e-205">One subsystem hosts the BizTalk Server engine itself.</span></span> <span data-ttu-id="4f55e-206">このエンジンは、オーケストレーションとメッセージングを実行します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-206">The engine is responsible for executing orchestrations and messaging.</span></span>  
  
2.  <span data-ttu-id="4f55e-207">もう 1 つのサブシステムとして、イベント バス サービスがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-207">Another subsystem is the Event Bus Service.</span></span> <span data-ttu-id="4f55e-208">イベント バス サービスは、バッファーに格納されたイベント ストリーム データを BAM プライマリ インポート データベースに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-208">The Event Bus Service is responsible for writing Buffered Event Stream data into the BAM Primary Import database.</span></span>  
  
### <a name="booting-the-runtime"></a><span data-ttu-id="4f55e-209">ランタイムの起動</span><span class="sxs-lookup"><span data-stu-id="4f55e-209">Booting the runtime</span></span>  
 <span data-ttu-id="4f55e-210">BizTalk Service が起動すると、サブシステムが動作するために必要なメタデータが、各サブシステムに読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-210">When the BizTalk Service starts, each subsystem loads metadata that is necessary for the subsystems to operate.</span></span>  
  
 <span data-ttu-id="4f55e-211">このプロセスを説明する図を次に示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-211">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="4f55e-212">![](../core/media/architecture-bam-07.gif "architecture_bam_07")</span><span class="sxs-lookup"><span data-stu-id="4f55e-212">![](../core/media/architecture-bam-07.gif "architecture_bam_07")</span></span>  
  
 <span data-ttu-id="4f55e-213">次の手順では、上の図に示したシーケンスを説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-213">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="4f55e-214">BizTalk エンジンの実行中 (オーケストレーションまたはメッセージング)、エンジンから BAM へのデータ フローを制御するインターセプターが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-214">When the BizTalk Engine is executing (either orchestrations or messaging), it calls into interceptors which regulate the data flow from the engine into BAM.</span></span> <span data-ttu-id="4f55e-215">エンジンによって呼び出されたインターセプターでは、オーケストレーションまたはメッセージングのアイテムの実行順序に関してエンジンの場所を分析します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-215">When the engine calls the interceptor, the interceptor analyzes where the engine is at in relation to the order of execution for the orchestration or messaging artifacts.</span></span> <span data-ttu-id="4f55e-216">現在エンジンが実行されている場所から取得する必要のあるデータがある場合は、インターセプターによって適切なデータが収集されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-216">If there is data that needs to be retrieved from the location where the engine is currently executing, the interceptor gathers the appropriate data.</span></span> <span data-ttu-id="4f55e-217">データの取得場所と取得する必要のあるデータを決定するメタデータは、追跡プロファイルに格納されています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-217">The metadata that determines where the data needs to be captured and what data needs to be captured is housed in the Tracking Profile.</span></span> <span data-ttu-id="4f55e-218">BizTalk Service の起動時、エンジンのインターセプターは BizTalk 管理データベースに問い合わせ、実行中のアイテムの追跡プロファイルを取得します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-218">During booting of the BizTalk Service, the engine’s interceptors will contact the BizTalk Management database to pull the appropriate Tracking Profile for the artifacts being executed.</span></span>  
  
2.  <span data-ttu-id="4f55e-219">イベント バス サービスの主な機能は、データ BLOB (BizTalk エンジンで作成) を使用可能なデータ項目に変換し、そのデータを BAM プライマリ インポート データベースに挿入することです。</span><span class="sxs-lookup"><span data-stu-id="4f55e-219">The Event Bus Service's primary function is to convert data blobs (written by the BizTalk Engine) into usable data items and insert the data into the BAM Primary Import database.</span></span> <span data-ttu-id="4f55e-220">メッセージング インターセプターは、未処理のデータを圧縮形式で書き込みます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-220">The messaging interceptor writes the raw data in a compressed form.</span></span> <span data-ttu-id="4f55e-221">これは、メモリ作業セットのサイズが増大するのを避けるためです。</span><span class="sxs-lookup"><span data-stu-id="4f55e-221">This is done to avoid a large memory working set.</span></span> <span data-ttu-id="4f55e-222">イベント バス サービスで、メッセージング データを使用可能なデータ項目に変換するためには、まず未処理のデータを解釈できるメタデータを読み込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-222">In order for the Event Bus Service to convert messaging data into usable data items, it must first load metadata that can interpret the raw data.</span></span> <span data-ttu-id="4f55e-223">このメタデータと呼ばれる**注釈**します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-223">This metadata is known as **annotations**.</span></span> <span data-ttu-id="4f55e-224">注釈メタデータは、追跡プロファイル エディター、またはコマンド ラインの追跡プロファイル展開ツールによって挿入されたものです。</span><span class="sxs-lookup"><span data-stu-id="4f55e-224">The annotation metadata was put there via the Tracking Profile Editor or the command line Tracking Profile Deploy tool.</span></span> <span data-ttu-id="4f55e-225">展開したソリューションで、メッセージングからデータが取得されない場合は、注釈はありません。</span><span class="sxs-lookup"><span data-stu-id="4f55e-225">If the solution deployed does not retrieve data from messaging there will not be any annotations.</span></span> <span data-ttu-id="4f55e-226">オーケストレーション インターセプターでは、イベント バス サービスが、注釈を追加しなくても正しくデコードできるように、未処理の形式で十分な情報をエンコードします。</span><span class="sxs-lookup"><span data-stu-id="4f55e-226">Orchestration interceptors encode enough information in the raw form for the Event Bus Service to properly decode without having additional annotations.</span></span>  
  
### <a name="storing-data"></a><span data-ttu-id="4f55e-227">データの格納</span><span class="sxs-lookup"><span data-stu-id="4f55e-227">Storing data</span></span>  
 <span data-ttu-id="4f55e-228">このセクションでは、BizTalk Service からデータを取得する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-228">This section discusses how data is captured from the BizTalk Service.</span></span>  
  
 <span data-ttu-id="4f55e-229">このプロセスを説明する図を次に示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-229">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="4f55e-230">![](../core/media/architecture-bam-08.gif "architecture_bam_08")</span><span class="sxs-lookup"><span data-stu-id="4f55e-230">![](../core/media/architecture-bam-08.gif "architecture_bam_08")</span></span>  
  
 <span data-ttu-id="4f55e-231">次の手順では、上の図に示したシーケンスを説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-231">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="4f55e-232">前述したとおり、BizTalk エンジンには、オーケストレーションとメッセージング ソリューションのランタイム実行中に呼び出されるインターセプターがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-232">The BizTalk engine, as described earlier, has interceptors that are called during runtime execution of orchestrations and messaging solutions.</span></span> <span data-ttu-id="4f55e-233">追跡プロファイルの情報に基づき、インターセプターでは、取得するデータを決定し、BizTalk メッセージ ボックスにバイナリ形式でデータを送信します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-233">Based on the Tracking Profile information, the interceptors will determine what data to capture and then send it to the BizTalk MessageBox in a binary form.</span></span> <span data-ttu-id="4f55e-234">ランタイム時に取得されたシリアル化 BLOB データを格納する TrackingData テーブルがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-234">There is a TrackingData table which holds serialized blob data captured during runtime.</span></span> <span data-ttu-id="4f55e-235">処理中には、実行時にメモリに保持しているデータを保存する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-235">During the processing, there are times when the engine needs to store data that it holds in memory during execution.</span></span> <span data-ttu-id="4f55e-236">これは、永続化ポイントと呼ばれ、ポイントの発生するタイミングはエンジンで決定されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-236">These are known as persistence points, and the engine decides when these points occur.</span></span> <span data-ttu-id="4f55e-237">永続化ポイントが発生すると、インターセプターから取得したデータも同じトランザクション内でフラッシュされ、永続化されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-237">When a persistence point happens, the data that was captured from the interceptors is also flushed and persisted within the same transaction.</span></span> <span data-ttu-id="4f55e-238">これにより、エンジン内でのデータ、および最終的な BAM の表示内容の一貫性が確保されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-238">This ensures the consistency of the data in the engine and ultimately what BAM can see.</span></span> <span data-ttu-id="4f55e-239">エラーが発生し、トランザクションがロール バックされた場合は、関連する BAM データもロール バックされます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-239">If a failure occurs and the transaction is rolled back, the associated BAM data will also be rolled back.</span></span>  
  
2.  <span data-ttu-id="4f55e-240">イベント バス サービスは、エンジンと同じ実行可能プロセスに格納されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-240">The Event Bus service is housed in the same executable process as the engine.</span></span> <span data-ttu-id="4f55e-241">このサービスは、BTS エンジンに格納された TrackingData テーブル (または任意の BufferedEventStream データ ソース) のデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-241">The service feeds off of data in the TrackingData table stored by the BTS Engine (or any BufferedEventStream data source).</span></span> <span data-ttu-id="4f55e-242">図は、Microsoft.BizTalk.Bam.EventObservation – アセンブリを示しています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-242">The picture depicts an assembly – Microsoft.BizTalk.Bam.EventObservation.</span></span> <span data-ttu-id="4f55e-243">このアセンブリは、BufferedEventStream からデータを取得するメソッドを公開しません。</span><span class="sxs-lookup"><span data-stu-id="4f55e-243">This assembly does not expose a method of retrieving the data from the BufferedEventStream.</span></span> <span data-ttu-id="4f55e-244">このコードはイベント バス サービス自体に格納されています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-244">This code is housed in the Event Bus Service itself.</span></span> <span data-ttu-id="4f55e-245">データが取得され、プライマリ インポート データベースに格納するために準備されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-245">The data is retrieved and then prepared to be stored in the Primary Import database.</span></span> <span data-ttu-id="4f55e-246">通常、バイナリ データとはシリアル化された .NET オブジェクトです。これらは復元され、その後、プロパティはオブジェクトから書式設定済みの SQL ステートメントに移動されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-246">For the most part, the binary data are serialized .NET objects which are rehydrated after which properties are moved from the object to formatted SQL statements.</span></span>  
  
3.  <span data-ttu-id="4f55e-247">データの格納が発生すると、イベント バス サービスでは大規模バッチ処理が試みられます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-247">When storage of the data occurs, the Event Bus service attempts a large batch.</span></span> <span data-ttu-id="4f55e-248">バッチには、BAM マネージャー展開ツールによって生成されたストアド プロシージャの呼び出しが含まれます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-248">The batch contains calls to stored procedures that were generated by the Bam Manager deployment tool.</span></span> <span data-ttu-id="4f55e-249">データベース利用率が高い場合など、テーブルがロックされる状況により、バッチ保存が失敗する場合があります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-249">Due to high database activity or other table locking circumstances, the batch storage could fail.</span></span> <span data-ttu-id="4f55e-250">エラーが発生した場合、バッチがさらに 2 回ほど試みられます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-250">In the event of a failure, the batch is tried a couple more times.</span></span> <span data-ttu-id="4f55e-251">再試行に失敗すると、バッチは小さなバッチに分割され、再試行されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-251">If the retries fail, the batch is broken up into smaller batches and retried.</span></span> <span data-ttu-id="4f55e-252">それも失敗すると、バッチは FailedTracking テーブルに移動されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-252">If this fails, the batch is moved to the FailedTracking table.</span></span>  
  
### <a name="custom-data-insertion"></a><span data-ttu-id="4f55e-253">カスタム データの挿入</span><span class="sxs-lookup"><span data-stu-id="4f55e-253">Custom data insertion</span></span>  
 <span data-ttu-id="4f55e-254">前のセクションでは、BAM がさまざまなメソッドを使用して BizTalk Server ホストからデータを取得する方法を詳しく説明しました。</span><span class="sxs-lookup"><span data-stu-id="4f55e-254">The previous section demonstrated the details of how BAM retrieves data from the BizTalk Server host using a variety of different methods.</span></span> <span data-ttu-id="4f55e-255">追跡プロファイル エディターを間接的に使用してプロファイルを作成し、イベント ストリーム メソッドをコード内で直接的に使用しました。</span><span class="sxs-lookup"><span data-stu-id="4f55e-255">Indirectly using the Tracking Profile Editor to create a profile, and more directly using the Event Stream methods directly within code.</span></span> <span data-ttu-id="4f55e-256">ただし、BAM に関連するすべてのデータが BizTalk で使用できるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="4f55e-256">However, not all data relevant to BAM is necessarily available in BizTalk.</span></span> <span data-ttu-id="4f55e-257">そのため、独自に作成されたアプリケーションに使用できるアセンブリがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-257">Therefore there is an assembly available to custom written applications.</span></span>  
  
 <span data-ttu-id="4f55e-258">このプロセスを説明する図を次に示します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-258">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="4f55e-259">![](../core/media/architecture-bam-09.gif "architecture_bam_09")</span><span class="sxs-lookup"><span data-stu-id="4f55e-259">![](../core/media/architecture-bam-09.gif "architecture_bam_09")</span></span>  
  
 <span data-ttu-id="4f55e-260">次の手順では、上の図に示したシーケンスを説明します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-260">The following steps describe the sequence depicted in the illustration above.</span></span>  
  
1.  <span data-ttu-id="4f55e-261">カスタム アプリケーションは読み込みできる必要があります、 [Microsoft.BizTalk.Bam.EventObservation](http://msdn.microsoft.com/library/microsoft.biztalk.bam.eventobservation.aspx) BAM アクティビティにデータを挿入する BAM メソッドにアクセスするアセンブリ。</span><span class="sxs-lookup"><span data-stu-id="4f55e-261">The custom application must be able to load the [Microsoft.BizTalk.Bam.EventObservation](http://msdn.microsoft.com/library/microsoft.biztalk.bam.eventobservation.aspx) assembly to access the BAM methods of inserting data into a BAM Activity.</span></span> <span data-ttu-id="4f55e-262">公開される主なクラスには、DirectEventStream と BufferedEventStream の 2 つがあります。</span><span class="sxs-lookup"><span data-stu-id="4f55e-262">There are two primary classes that are exposed, DirectEventStream and BufferedEventStream.</span></span> <span data-ttu-id="4f55e-263">上の図では、DirectEventStream クラスが強調表示されています。</span><span class="sxs-lookup"><span data-stu-id="4f55e-263">In the illustration above, the DirectEventStream class is highlighted.</span></span> <span data-ttu-id="4f55e-264">このクラスは、プライマリ インポート データベースに直接書き込みます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-264">This class writes directly to the Primary Import database.</span></span> <span data-ttu-id="4f55e-265">これは BAM アクティビティにデータを書き込むための最も一般的な方法です。</span><span class="sxs-lookup"><span data-stu-id="4f55e-265">This is the most common method of writing data into a BAM activity.</span></span>  
  
2.  <span data-ttu-id="4f55e-266">BizTalk がデータを格納するメソッドと同様に、BufferedEventStream クラスはバイナリ BLOB を間接データベースに書き込みます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-266">Similar to the method in which BizTalk stores data, the BufferedEventStream class writes binary blobs into an indirect database.</span></span> <span data-ttu-id="4f55e-267">この場合、BizTalk メッセージ ボックスが中間ストアとして使用されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-267">In this case, the BizTalk MessageBox is used as the intermediate store.</span></span> <span data-ttu-id="4f55e-268">選択するクラスは、さまざまな要因によって異なりますが、パフォーマンスが優先されます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-268">Which class you choose depends on several things; however performance is a primary concern.</span></span> <span data-ttu-id="4f55e-269">BufferedEventStream クラスは、データをバッチ処理し、より高いスループットを維持します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-269">The BufferedEventStream class will batch data and sustain higher throughput.</span></span> <span data-ttu-id="4f55e-270">ただし、データはすぐには書き込まれません。</span><span class="sxs-lookup"><span data-stu-id="4f55e-270">The drawback is that the data is not written immediately.</span></span>  
  
3.  <span data-ttu-id="4f55e-271">データを挿入する BizTalk メソッドと同様に、イベント バス サービスは、バイナリ データを処理し、デコードし、最終的にそれを BAM プライマリ インポート データベースに格納します。</span><span class="sxs-lookup"><span data-stu-id="4f55e-271">As with the BizTalk method of inserting data, the Event Bus Service will process the binary data, decode it, and ultimately store it within the BAM Primary Import database.</span></span> <span data-ttu-id="4f55e-272">この処理は、BufferedEventStream クラスによって書き込まれたデータにのみ必要です。</span><span class="sxs-lookup"><span data-stu-id="4f55e-272">This is only required for data written via the BufferedEventStream class.</span></span>  
  
## <a name="distributed-navigation"></a><span data-ttu-id="4f55e-273">分散ナビゲーション</span><span class="sxs-lookup"><span data-stu-id="4f55e-273">Distributed Navigation</span></span>  
 <span data-ttu-id="4f55e-274">BAM ポータル分散ナビゲーション機能を使用すると、リモートの全境界でのアクティビティ リレーションシップを表示できます。</span><span class="sxs-lookup"><span data-stu-id="4f55e-274">The BAM portal distributed navigation feature allows users to see activity relationships across remote boundaries.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4f55e-275">参照</span><span class="sxs-lookup"><span data-stu-id="4f55e-275">See Also</span></span>  
 [<span data-ttu-id="4f55e-276">アーキテクチャの管理および追跡</span><span class="sxs-lookup"><span data-stu-id="4f55e-276">Management and Tracking Architecture</span></span>](../core/management-and-tracking-architecture.md)