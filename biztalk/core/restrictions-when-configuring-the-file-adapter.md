---
title: "ファイル アダプタ構成時の制限事項 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- configuring [File adapters], restrictions
- File adapters, restrictions
ms.assetid: 8d8137a7-5b16-4ae3-a0a7-6d114324bdf3
caps.latest.revision: "8"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d6fbf9296e56db816277f9a7a348377bfa4b359d
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2017
---
# <a name="restrictions-when-configuring-the-file-adapter"></a>ファイル アダプタ構成時の制限事項
制限と、ファイル アダプターを使用する場合の規則。

## <a name="file-mask-and-file-name-gotchas"></a>ファイル マスクおよびファイル名の潜在的な問題

ファイル マスクは、ファイル受信ハンドラが受信場所から取得するファイルの種類を指定する文字列です。 ファイル名は、ファイル送信ハンドラがメッセージを書き込むファイルの名前を指定する文字列です。  
  
 ファイル名およびファイル マスクのプロパティには、次の制限が適用されます。  
  
-   各受信場所または送信ポートに指定できるファイル マスクまたはファイル名は 1 つだけです。  
  
-   ファイル マスクまたはファイル名と共に完全パスまたはパスの一部を使用することはできません。 ファイル マスクおよびファイル名は、常にパスを除いた名前を表します。  
  
-   ファイル マスクとファイル名では、大文字と小文字が区別されません。  
  
-   ファイル名には、次の文字を含めることはできません: \< \> :/&#124;です。" ? * ;  
  
-   ファイル マスクには、次の文字を含めることはできません: \< \> :/&#124;です。" ; 
  
-   予約されたデバイス名 (CON、PRN、AUX、CLOCK$、NUL、COM1、COM2、COM3、COM4、COM5、COM6、COM7、COM8、COM9、LPT1、LPT2、LPT3、LPT4、LPT5、LPT6、LPT7、LPT8、および LPT9) は、ファイル名として使用できません。 また、これらの名前を拡張子と組み合わせて使用することはできません。  
  
-   Windows ディスク ボリュームは、既定では、短期および長期のファイル名を使用する名前付け規則 8.3 (8dot3) を使用します。 非システムのディスク ボリュームは 8dot3 名前付け規則を無効にし、したがってのみ長いファイル名を使用します。 

    8dot3 を有効にすると、ファイルとファイル拡張子の短い名前に変換します。 たとえば、`testabcdefgh.docx`に変換を取得`testab~1.doc`です。 ファイル名を短くと、しから、ファイル拡張子の部分が切り捨てられたことに注意してください`.docx`に`doc`です。

    この動作は、ファイル アダプターがファイルを受け取る方法に影響します。 ファイル マスクに設定されている場合`*.xml`、し、ファイルの両方に一致する`*.xml`と`*.xmln`拡張機能が選択されています。 

    表示、ディスク上 8dot3 名前付け規則が有効になっているかどうかは、管理者、および型としてコマンド プロンプトを開き`fsutil 8dot3name query c:`、または`fsutil 8dot3name query d:`のようにします。 サンプル出力は、次のようになります。

    ```
    C:\WINDOWS\system32>fsutil 8dot3name query c:
    The volume state is: 0 (8dot3 name creation is enabled).
    The registry state is: 2 (Per volume setting - the default).
    
    Based on the above two settings, 8dot3 name creation is enabled on c:
    ```
    
    ファイル アダプターを使用して、 [FindFirstFile 関数](https://msdn.microsoft.com/library/windows/desktop/aa364418(v=vs.85).aspx)です。 この関数には、短期および長期のファイルの名前を持つ検索結果が含まれています。 フォルダーで、短期および長期のファイル名を表示するには、コマンド プロンプトを開き、フォルダー、種類にアクセスして、`dir /x`です。 コマンド プロンプトで入力することも`dir c:\foldername /x`します。
    
    ボリュームに 8dot3name 設定を変更する場合、新しいファイルでは、新しい設定を使用します。 既存のファイルは、それらも移動するまでに、名前を保持します。 
    
    のみを目的のファイルを選択して、負荷が高い中にパフォーマンスの向上 (オーバーヘッドが少ない) を取得するには、しがありますに 8dot3name が無効になっているボリュームを使用する、ファイル アダプターを設定してください。 
  
-   ファイル パス、ファイル マスク、およびファイル名の長さの合計 (マクロによる代入を除く) は 256 文字以下にしてください (これは、メッセージ ボックス データベースの制限です)。  
  
-   ファイル パスを "`\\`?" で始めることはできません。  
  
-   割り当てられたネットワーク ドライブ名は、ユーザー セッションに基づいているため、ファイル パスでは使用できません。  
  
 BizTalk メッセージング エンジンでは、上記の項目を使用して、デザイン時に常にファイル名およびファイル マスクのプロパティを検証します。 また、ファイル アダプタでは、アダプタが動的ポートでメッセージを送信する場合、実行時にファイル名およびファイル マスクのプロパティを検証します。  
  
> [!NOTE]
>  ファイル アダプタでは、システム ファイルまたは読み取り専用のファイルは取得されません。 ディスク上のファイルのみが取得され、デバイス ファイルは取得されません。  

## <a name="using-macros-in-file-names"></a>ファイル名のマクロの使用

一連の定義済みマクロを使用して、ファイル送信ハンドラがメッセージを書き込むファイルを、動的に作成できます。 ファイル システム上にファイルを作成する前に、ファイル送信ハンドラによって、ファイル名に含まれるすべてのマクロが個別の値に置き換えられます。 1 つのファイル名で複数の異なるマクロを使用できます。  
  
 ファイル名のマクロは、BizTalk エクスプローラー オブジェクト モデルを使用したファイル送信ハンドラーの構成時に使用できます。  
  
 次のいずれかの条件に当てはまる場合、ファイル送信ハンドラはマクロを値に置き換えません。  
  
-   対応するシステム プロパティが設定されていない場合  
  
-   マクロのスペルが間違っている場合  
  
-   マクロの値に、ファイル名には無効な記号が含まれている場合  
  
 上記のいずれかの条件に当てはまる場合、ファイル送信ハンドラは、ファイル名に含まれるマクロを変更しません (例、Myfile_%MessageID%.xml)。  
  
 次の表は、サポートされているマクロと、ファイル送信ハンドラによってそのマクロがどのような形式に置換されるのかを示しています。  
  
|マクロ名|代入値|  
|----------------|----------------------|  
|%datetime%|YYYY-MM-DDThhmmss 形式の協定世界時 (UTC) の日時 (例、1997-07-12T103508)。|  
|%datetime_bts2000%|YYYYMMDDhhmmsss 形式の UTC 日時。sss は秒およびミリ秒を表します (たとえば、199707121035234 は 1997 年 7 月 12 日 10 時 35 分 23 秒 400 ミリ秒を表します)。|  
|%datetime.tz%|ローカルの日時に GMT のタイム ゾーンを加えた YYYY-MM-DDThhmmssTZD 形式の日時 (例、1997-07-12T103508+800)。|  
|%DestinationParty%|送信先パーティの名前。 この値は、メッセージ コンテキスト プロパティ **BTS.DestinationParty**から取得されます。|  
|%DestinationPartyQualifier%|送信先パーティの修飾子。 この値は、メッセージ コンテキスト プロパティ **BTS.DestinationPartyQualifier**から取得されます。|  
|%MessageID%|BizTalk Server 内のメッセージのグローバル一意識別子 (GUID)。 値は、メッセージ コンテキスト プロパティから直接取得**BTS です。MessageID**です。|  
|%SourceFileName%|ファイル アダプタが読み取るメッセージが存在するファイルの名前。 ファイル名には、拡張子は含まれますが、ファイル パスは含まれません (例、Sample.xml)。 このプロパティを置き換えるときに、ファイル アダプターに格納されている絶対ファイル パスからファイル名を抽出、**ファイル。ReceivedFileName**コンテキスト プロパティです。 コンテキスト プロパティに値がない場合-たとえば、ファイル アダプター以外のアダプタにメッセージを受信しました — マクロ置換しませんし、ファイルの名前をそのままに残ります (C:\Drop など\\%sourcefilename%)。 **注:**このマクロを正しく実装の場合、出力メッセージが受信したメッセージと同じメッセージである必要があります。|  
|%SourceParty%|ファイル アダプタが受信したメッセージの受信元パーティの名前。 **注:**このマクロを正しく実装の場合、出力メッセージが受信したメッセージと同じメッセージである必要があります。|  
|%SourcePartyQualifier%|ファイル アダプタが受信したメッセージの受信元パーティの修飾子。 **注:**このマクロを正しく実装の場合、出力メッセージが受信したメッセージと同じメッセージである必要があります。|  
|%time%|hhmmss 形式の UTC 時刻。|  
|%time.tz%|ローカルの日付に GMT のタイム ゾーンを加えた hhmmssTZD 形式の日付 (例、124525+530)。|  
  
 
## <a name="receive-folder-and-destination-location-properties-gotchas"></a>フォルダーと移動先の場所のプロパティ潜在的な問題が表示されます。

ファイルの受信場所は、ファイル受信ハンドラーで読み取るファイルが存在するファイル システムまたはネットワーク共有上のフォルダーのパスを含む文字列です。 ファイルの送信先は、ファイル送信ハンドラーで書き込むファイルが存在するファイル システムまたはネットワーク共有上のフォルダーのパスを含む文字列です。  
  
 受信フォルダーおよび送信先のプロパティには、次の制限が適用されます。  
  
-   ユーザーのプロパティを指定する場合、その時点でファイル システムまたはネットワーク共有上のファイル パスが存在する必要はありません。  
  
-   ファイル パスは、絶対パスである必要があります。  
  
-   汎用名前付け規則 (UNC) 形式を使用して、ファイルのパスを指定することができます (たとえば、 \\ \\ <*サーバー* \> \\ < *共有*\>)。  
  
-   サーバー名が、次の文字を含める必要がありますいないファイルのパスが UNC 形式である場合は、: ' ~! @ # $ ^ & * ( ) = + [ ] { } \ &#124; ; : ' " , \< \> / ? ;  
  
-   親を使用することはできません (\\..\\) と現在 (\\.\\) ファイルのパスの任意の部分でフォルダー記号。  
  
-   ファイル パスでは、大文字と小文字が区別されません。  
  
-   ファイルのパスには、次の文字を含めることはできません: \< \> :/&#124;です。" ? * ;  
  
-   予約されたデバイス名 (CON、PRN、AUX、CLOCK$、NUL、COM1、COM2、COM3、COM4、COM5、COM6、COM7、COM8、COM9、LPT1、LPT2、LPT3、LPT4、LPT5、LPT6、LPT7、LPT8、および LPT9) は、ファイル パスでは使用できません。  
  
-   ファイル パス、ファイル マスク、またはファイル名の長さの合計 (マクロでの代入を除く) は 256 文字以下にしてください (これはメッセージ ボックス データベースの制限です)。  
  
-   ファイル アダプターがファイルのパスの Unicode 仕様をサポートしていない (たとえば、"\\\\?\\") です。  
  
 受信フォルダーのプロパティのみに、次の制限が適用されます。  
  
-   シンボリック リンクを使用して、Microsoft Windows NT の分散ファイル システムを使用するフォルダーには、受信フォルダーのプロパティを設定しません。 Windows NT の分散ファイル システムを使用している場合は、直接的なファイル アダプターのネットワーク パスのフォルダーを使用する受信場所のみをできます。  
  
-   ドキュメントが UNC パスに送信され、ファイル アダプターの受信場所でサーバーが受信するドキュメントが複数ある場合、その UNC パスに送信されたドキュメントの大半は、1 台のサーバーのみで取得および処理されます。 ファイル名の変更の詳細についてを参照してください、ファイル受信アダプターの[ファイル アダプター](../core/file-adapter.md)です。  
  
 送信フォルダーのプロパティのみに、次の制限が適用されます。  
  
-   Microsoft Windows Vista など、サーバーでないオペレーティング システムでファイル アダプターを実行している場合、すべてのメッセージを同時にバッチ処理するために必要なオペレーティング システム リソースが不足する場合があります。  
  
 ファイル アダプターでは、上記のルールを使用して、デザイン時にファイル パスを検証します。 さらに、ファイル アダプターを使用する動的ポート経由でメッセージを送信する場合、実行時にメッセージを検証します。  
  
