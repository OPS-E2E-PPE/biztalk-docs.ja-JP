---
title: 維持可能なパフォーマンスとは何ですか。 | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- reliability, sustainable performance
- performance, goals
- performance, sustainable performance
- planning, performance
- performance, planning
- sustainable performance
ms.assetid: 4b18b976-7714-431f-8976-f40a1016d5f3
caps.latest.revision: 11
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cc92770921118778cc20edc66dfbbe5a75e3a647
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37003699"
---
# <a name="what-is-sustainable-performance"></a>維持可能なパフォーマンスとは何ですか。
システム持続性を計画および評価する場合、長期間の持続性について考慮することが重要です。 主要な考慮事項は次のとおりです。  
  
- **ロード プロファイルおよびパフォーマンス目標**: ロード プロファイルおよびパフォーマンス目標に関しては、あまり詳細を含めることはできません。 テストと準備が完了したことは、これらの負荷を長期間にわたって処理できるかどうかによって判断されます。  
  
- **その他のアクティビティおよびプロセス サーバーのリソースに対して競合する**: メッセージの読み込みだけはありません。 サーバーでは、パフォーマンスに影響を与える他のプロセスおよびアクティビティ (データベース メンテナンスや、メッセージのクエリなど) が発生します。  
  
- **計画済みおよび計画外のシステムの障害およびダウンタイム**: フラッド ゲート イベントおよびメッセージのバックログが効率的なロード プロファイルを変更できます。  
  
  維持可能なシステムの構築および証明するためのテストについて検討する場合は、これらの事項を考慮する必要があります。  
  
## <a name="is-your-performance-sustainable"></a>維持可能なパフォーマンスについて  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] のパフォーマンスを検討する場合、維持可能な最大パフォーマンスを次のように定義します。  
  
- システムが実稼働環境で無制限に処理できるメッセージ トラフィックの最大負荷。  
  
  単純なようですが、特定のハードウェアで動作するソリューションが、実稼働環境へのソリューション適用後に毎日発生する負荷に対応できるかどうかを評価する場合は、多数の要因を考慮する必要があります。  
  
  ソリューションを実稼働に移す前に、ソリューションがメッセージ トラフィックの最大負荷を無制限に処理できるかどうかを評価するために、次の事項について考慮してください。  
  
- 適切なパフォーマンス目標、および、スループットと待機時間のプロファイル  
  
- 同じハードウェアで実行される他のプロセス  
  
  -   標準の監視ツールとトラブルシューティング ツール  
  
  -   ログ配布、バックアップ、削除、インデックス メンテナンス、統計の更新など、稼働中のデータベースのメンテナンス  
  
  -   他のアプリケーション  
  
- 計画内または計画外のシステムの障害  
  
  -   取引先サイトのダウンによるメッセージ送受信のブロック  
  
  -   通常のシステム メンテナンス ダウン タイム  
  
## <a name="know-your-performance-goals"></a>パフォーマンスの目標の理解  
 ソリューションの持続性を評価するには、実稼働環境の負荷の予測を詳細に理解する必要があります。 目標を適切に把握していないと、準備が十分かどうかを評価できません。 システムのテストおよび保証は、パフォーマンス目標を軸として遂行されるので、目標を適切に設定することが重要です。 パフォーマンスの目標には次の要素が必要です。  
  
-   パフォーマンスを時間の関数として定義する曲線。 これらの関数は、非常に単純なものから非常に複雑なものまであります。  
  
-   パフォーマンス関数に関連付けるパフォーマンス要件。  
  
-   ファイルのサイズと種類の分布。  
  
### <a name="example-1"></a>例 1  
  
-   毎日、蓄積されるメッセージは、8:00AM に 0 メッセージ/秒、正午に 80 メッセージ/秒となり、9:00PM に 0 メッセージ/秒に戻ります。ベル曲線にほぼ近い形です。  
  
-   システムには、メッセージごとに、特定の待機時間の要件がありません、この負荷を処理できる必要がありますが、さらに遅れることがなく (たとえばが発生した場合、24 時間対応のシステム停止) 前日のメッセージのすべてのロードします。  
  
-   次の 3 つのドキュメントの種類があります。 販売バスケット、バックアップの順序、および在庫要求。 販売バスケット ドキュメントのサイズの範囲は 2 ～ 10 KB で、どの時点でもメッセージ数の 75% を占めます。 注文残および在庫要求ドキュメントのサイズは常に約 1 KB で、どの時点でもメッセージ数の 10% と 15% をそれぞれ占めます。  
  
### <a name="example-2"></a>例 2  
  
-   毎日、深夜 0 時に、500,000 メッセージのバッチが処理のために到着します。  
  
-   バッチのメッセージはすべて、8 時間以内に完了するように処理する必要があります。  
  
-   メッセージはすべて同じ種類で、10 ～ 15 KB の範囲で均等に分布しています。 さらに、バッチは常に、それぞれ 10 MB のカタログ タイプ メッセージ 10 件を含んでおり、処理のために個別のカタログ エントリに分割する必要があります。  
  
### <a name="example-3"></a>例 3  
  
-   4,000 人の顧客サービス担当者が、週に 7 日間、毎日午前 8 時から対話型のシステムにログオンし、午後 5 時の終了時間までに各人が 1 分間に平均 4 件の問い合わせを実行します。  
  
-   すべての問い合わせは、2 秒未満で結果を返す必要があります。  
  
-   問い合わせはすべて同じ種類で、500 ～ 1,000 KB の範囲で均等に分布しています。  
  
#### <a name="a-performance-requirement-associated-with-the-performance-function"></a>パフォーマンス関数に関連付けるパフォーマンス要件  
 上記の例をもう一度使用します。  
  
-   **例 1 (続き)**: システムには、メッセージごとに、特定の待機時間の要件がありませんが、この負荷を処理できる必要がありますプラス遅れることがなく (たとえば、およびが発生した場合、24 時間対応のシステム停止) 前日のメッセージのすべてのロードします。  
  
-   **例 2 (続き)**: 8 時間以内に完了するまで、バッチ内のすべてのメッセージを処理する必要があります。  
  
-   **例 3 (続き)**: すべての問い合わせが 2 秒以内に結果を返す必要があります。  
  
#### <a name="a-distribution-of-file-sizes-and-types"></a>ファイルのサイズと種類の分布  
  
-   **例 1 (続き)**: 次の 3 つのドキュメントの種類があります。 販売バスケット、バックアップの順序、および在庫要求。 販売バスケット ドキュメントのサイズの範囲は 2 ～ 10 KB で、どの時点でもメッセージ数の 75% を占めます。 注文残および在庫要求ドキュメントのサイズは常に約 1 KB で、どの時点でもメッセージ数の 10% と 15% をそれぞれ占めます。  
  
-   **例 2 (続き)**: すべてのメッセージの種類が同じおよび 10 と 50 キロバイト単位、包括的な間に均等に分散されます。 さらに、バッチは常に、それぞれ 10 MB のカタログ タイプ メッセージ 10 件を含んでおり、処理のために個別のカタログ エントリに分割する必要があります。  
  
-   **例 3 (続き)**: すべての問い合わせが同じ型でを 500 ~ 1000 のバイト サイズは、包括的な間に均等に分散されます。  
  
## <a name="accounting-for-other-processes"></a>他のプロセスに関する考慮事項  
 BizTalk エンジンに直接送られるロード プロファイル以外に、リソースに対して競合する他のプロセスが同じハードウェア上に常に存在します。  このような他のプロセスにより、維持可能なシステムのパフォーマンス機能が全体的に低下します。 データベース メンテナンスは、この種類のプロセスの最も一般的な例です。  
  
 各データベースは (サイズの大小に関係なく)、ログ配布、バックアップ、アーカイブ、削除など、定期的な稼働中のメンテナンスが必要です。 監視およびトラブルシューティングは、何が維持可能かを定義および証明する場合に考慮すべき操作の 1 つです。 たとえば、管理コンソールの [グループ ハブ] ページなどから、メッセージ ボックスで、24 時間以内に保留された特定の種類のメッセージ数を求めるクエリを実行する場合は、SQL Server のリソースが必要ですが、メッセージの処理に使用されている可能性があります。  
  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の全体的な持続性に、一般的に最も影響が大きいアクティビティを次に示します。  
  
- **ログ配布とバックアップ**します。 SQL Server に関連する大半のディザスター リカバリー計画の一部として、すべての [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] グループ データベースのログ配布およびバックアップを定期的に行う必要があります。 詳細については、次を参照してください。 [Backing Up and BizTalk Server データベースの復元](../core/backing-up-and-restoring-biztalk-server-databases.md)します。 参照してください[ログ配布](../core/log-shipping.md)します。  
  
- **アーカイブと削除の追跡データ**します。 全体的なログ配布およびバックアップのプランだけでなく、BizTalk 追跡 (BizTalkDTADb) データベースが、独自のアーカイブと削除の手法です。詳細については、次を参照してください。[アーカイブおよび BizTalk 追跡データベースの削除](../core/archiving-and-purging-the-biztalk-tracking-database.md)します。 BizTalk 追跡データベースからデータをアーカイブおよび削除できる速度は、特に重要です。追跡が使用中である場合は、通常、BizTalk 追跡データベースのアーカイブと削除がボトルネックとなるためです。  
  
- **システム クエリ**します。 Api または BizTalk Server 管理コンソール UI を使用して、システムに対する各種クエリを実行すると維持可能なパフォーマンスに影響します。  
  
- **メッセージ ボックスのメンテナンス**します。 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] コア機能の一部であるさまざまな SQL ジョブは、メッセージ ボックス データベースのメンテナンスのために、処理を終えたメッセージおよびインスタンスのクリーンアップを行います。 コア エンジンの一部として、これらのジョブを完了できる速度は、持続性を予測するときの主要な要素です。 これらのジョブとその役割の詳細については、次を参照してください。 [BizTalk Server1 を維持](../core/maintaining-biztalk-server1.md)します。  
  
- **ソリューション展開アクティビティ**します。 新しいアプリケーションまたは既存のアプリケーションの新しいバージョンを展開、バインド、および開始すると、メッセージ ボックス データベースの新しいサブスクリプションの作成など、BizTalk に追加の負荷が加わります。 アプリケーションの展開後、処理されるメッセージがリソースに対して競合するので、既存のアプリケーションのパフォーマンスに影響が及びます。  
  
  これらの領域ごとに、確認する必要がありますこれらのアクティビティの影響を最小限に、推奨事項とは何ですか?。 たとえば、午前 3 時に実行する計画を立てるべきか。  
  
## <a name="considering-planned-and-unplanned-outages"></a>計画内または計画外のシステムの障害への考慮  
 障害によるシステム パフォーマンスへの影響は広範であり、障害が発生したシステムによって異なりますが、最も一般的な影響は次のとおりです。  
  
- **フラッド ゲート イベント**します。 システムが一定期間ダウンしている間、メッセージが蓄積され、後でシステムが再び使用可能になったときに、すべてのメッセージが一度に到着します。  たとえば、BizTalk で動作しているアプリケーションが MSMQ を介してメッセージを受信し、そのアプリケーションが一定期間ダウンしている間、取得を待機するメッセージがキューに蓄積されます。 アプリケーションを再び起動すると、大量のメッセージが一度に届いたように動作します。  
  
- **メッセージ バックログ**します。 メッセージの送信先であるシステムがダウンした場合、通常は、追加のリソースを使用する再試行サイクルが使用されます。 再試行サイクルが終了すると、通常、メッセージは保留されます。 ダウンしたシステムが再びオンラインで使用可能になると、フラッドゲート タイプのイベントが発生し、多数のメッセージが再開され、正常に送信されます。  
  
  システムを設計および保証する場合は、スケジュールされた定期的なメンテナンスなど、すべての計画内の障害を必ず考慮する必要があります。 また、計画外の障害とその影響の分析について考慮することもお勧めします。  
  
  発生する可能性のある障害の種類を特定し、リスク レベルの予測 (確率×重大度) によって順位付けし、よりリスクの高い障害の期間および影響 (フラッドゲート イベント、保留メッセージ量、バックログなど) を予測することにより、障害が発生した場合にも問題とならないシステム能力が明らかになります。 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] のようなストア アンド フォワード式のメッセージングベースの非同期システムは、計画内および計画外の障害に対応できる処理能力の「余裕」を十分に備えるように設計する必要があります。  
  
## <a name="see-also"></a>参照  
 [エンジンの永続性と耐久性](../core/engine-persistence-and-durability.md)   
 [プロジェクトの計画フェーズの推奨事項](../core/project-planning-recommendations-by-phase.md)   
 [維持可能な最大のエンジン スループットの測定](../core/measuring-maximum-sustainable-engine-throughput.md)   
 [維持可能な最大の追跡スループットの測定](../core/measuring-maximum-sustainable-tracking-throughput.md)   
 [ソリューションの拡張](../core/scaling-your-solutions.md)   
 [パフォーマンスのボトルネックを特定します。](../core/identifying-performance-bottlenecks.md)   
 [エンジンのパフォーマンスおよび容量](../core/engine-performance-and-capacity.md)