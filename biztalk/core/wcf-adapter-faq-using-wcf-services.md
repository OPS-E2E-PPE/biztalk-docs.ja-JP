---
title: WCF アダプターに関する FAQ:WCF サービスの使用 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: befa2268-8a65-465f-8086-70a66808845e
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 65dc8427321d148430bcf3eb888c645ab4117937
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65393586"
---
# <a name="wcf-adapter-faq-using-wcf-services"></a><span data-ttu-id="5b5c2-102">WCF アダプターに関する FAQ:WCF サービスの使用</span><span class="sxs-lookup"><span data-stu-id="5b5c2-102">WCF Adapter FAQ: Using WCF Services</span></span>
## <a name="how-does-biztalk-server-use-its-wcf-adapters-to-access-wcf-services"></a><span data-ttu-id="5b5c2-103">BizTalk Server の使い方が WCF アダプター WCF サービスにアクセスするでしょうか。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-103">How does BizTalk Server use its WCF adapters to access WCF services?</span></span>  
 <span data-ttu-id="5b5c2-104">BizTalk WCF アダプターが、WCF を通じて BizTalk Server で構成されている受信場所または送信ポート。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-104">BizTalk WCF adapters are configured in BizTalk Server through either a WCF receive location or a send port.</span></span> <span data-ttu-id="5b5c2-105">WCF アダプターを使用して受信場所を有効にすると、1 つの ServiceHost インスタンスがインスタンス化され、各受信場所用に初期化します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-105">When a receive location using a WCF adapter is enabled, a single ServiceHost instance is instantiated and initialized for each receive location.</span></span> <span data-ttu-id="5b5c2-106">ServiceHost は、受信 WCF メッセージを受け取るし、BizTalk メッセージ ボックス データベースに公開する前に BizTalk メッセージに変換する汎用サービスを実行します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-106">The ServiceHost runs a generic service that accepts incoming WCF messages, and converts them to BizTalk messages before publishing them to the BizTalk MessageBox database.</span></span> <span data-ttu-id="5b5c2-107">汎用的な ServiceHost サービスは WCF BizTalk の内部アダプターの実装を受け取り、型宣言不要なコントラクトを公開します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-107">The generic ServiceHost service is internal to the WCF BizTalk receive adapter implementation and exposes a typeless contract.</span></span> <span data-ttu-id="5b5c2-108">WCF では、型宣言不要なコントラクトは WCF System.ServiceModel.Channel.Message 型の 1 つのパラメーターを使用する操作署名で構成されます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-108">In WCF, a typeless contract consists of operation signatures that take a single parameter of type WCF System.ServiceModel.Channel.Message.</span></span>  
  
 <span data-ttu-id="5b5c2-109">WCF サービスの操作を IsOneWay としてマークする必要がありますが返すデータがない場合でも、BizTalk 送信ポートでアクセスする場合は、false を = です。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-109">The operation  of a WCF service should be marked as IsOneWay=false if they are to be accessed by a BizTalk send port even if there is no data to return.</span></span> <span data-ttu-id="5b5c2-110">クライアント側コントラクトに対する操作は IsOneWay で注釈を付ける必要があります = false および ReplyAction ="\*"。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-110">The operations on the client-side contract should be annotated with IsOneWay=false and ReplyAction=”\*”.</span></span>  <span data-ttu-id="5b5c2-111">さらに、クライアントからのすべての呼び出しは、IsOneWay でマークする必要があります ="false"。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-111">Additionally all calls from the client should be marked at IsOneWay=”false”.</span></span> <span data-ttu-id="5b5c2-112">双方向サービス操作には、メッセージ型の値を返す可能性があります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-112">A two-way service operation may return a value of type Message.</span></span> <span data-ttu-id="5b5c2-113">MSMQ のキューにメッセージを投稿する一方向の操作を実行するため、この例外は、Wcf-netmsmq アダプターを使用しています。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-113">The exception to this is using the WCF-NetMsmq adapter since it executes a one-way operation that posts a message into an MSMQ queue.</span></span> <span data-ttu-id="5b5c2-114">ここで、送信ポートが一方向にすることができ、サービス操作が IsOneWay としてマークされている = true。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-114">In this case the send port can be one-way and any service operation marked as IsOneWay=true.</span></span>  
  
 <span data-ttu-id="5b5c2-115">IsOneWay を定義する WCF では、また少し混乱を招く可能性がある = false OperationContract に実際に void を返すメソッド。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-115">It may be a little confusing that it is also possible in WCF to define an isOneWay=false OperationContract on a method that actually returns void.</span></span> <span data-ttu-id="5b5c2-116">このような状況での WCF ランタイムによって作成されたネットワーク上で返される実際にメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-116">In such a situation there is actually a message returned on the wire created by the WCF runtime for you.</span></span>  
  
 <span data-ttu-id="5b5c2-117">BizTalk WCF アダプターを使用するこの機能を使用します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-117">The BizTalk WCF adapters make use of this feature.</span></span> <span data-ttu-id="5b5c2-118">IsOneWay を持つ void メソッドを実際に取得する一方向の BizTalk ポートを指定すると、WCF アダプターの実装内で指定します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-118">When you specify a one-way BizTalk port you actually get a void method with isOneWay=false within the implementation of the WCF adapter.</span></span> <span data-ttu-id="5b5c2-119">BizTalk 一方向のポート、HTTP や net.tcp などの直接チャネルを使用する場合は、isOneWay を実際に対応している点は、= false OperationContract します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-119">The point is that a BizTalk one-way port, when using a direct channel such as HTTP or net.tcp, will actually correspond to an isOneWay=false OperationContract.</span></span> <span data-ttu-id="5b5c2-120">Net.msmq などのキューに置かれたチャネルが異なる = true OperationContract の isOneWay との対話に一方向の BizTalk ポートは行われることにします。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-120">Queued channels such as net.msmq are different in that a one-way BizTalk port does happen to talk to an isOneWay=true OperationContract.</span></span> <span data-ttu-id="5b5c2-121">WCF ディスパッチャーがチャネルに対してトランザクションを使用するためには、状況が異なります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-121">The situation is different because the WCF dispatcher is using a transaction against the channel.</span></span>  
  
## <a name="how-do-you-create-and-use-a-custom-binding-with-a-wcf-custom-adapter"></a><span data-ttu-id="5b5c2-122">実行の作成方法と WCF カスタム アダプターを使用したカスタム バインドを使用しますか。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-122">How do you create and use a custom binding with a WCF custom adapter?</span></span>  
 <span data-ttu-id="5b5c2-123">WCF CustomBinding は Bindingelement のコレクションで構成されます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-123">A WCF CustomBinding consists of a collection of BindingElements.</span></span> <span data-ttu-id="5b5c2-124">(たとえば、別のソースからの既存のエンコーダーを使用して既存のトランスポートを組み合わせること) の既存の Bindingelement を集めて、CustomBinding を作成できます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-124">A CustomBinding can be created by pulling together pre-existing BindingElements (for example, combining a pre-existing Transport with a pre-existing Encoder from another source).</span></span> <span data-ttu-id="5b5c2-125">または、既存の BindingElement と新規に作成されたカスタム BindingElement を組み合わせることで作成できます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-125">Or it can be created by combining a pre-existing BindingElement with a newly written custom BindingElement.</span></span> <span data-ttu-id="5b5c2-126">コード プログラムで追加することによって、CustomBinding を BindingElements のこれらのコンポーネントから構築できます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-126">In code a CustomBinding can be built from these component BindingElements by adding them programmatically.</span></span> <span data-ttu-id="5b5c2-127">WCF では、.NET 構成 (config ファイル) を使用して構築こともできます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-127">WCF also allows this construction through .NET Configuration (config files).</span></span> <span data-ttu-id="5b5c2-128">BizTalk Server を使用して、BizTalk WCF カスタム アダプターを介してこの CustomBinding を作成できます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-128">By using BizTalk Server this CustomBinding can be created through the BizTalk WCF Custom adapter.</span></span>  
  
 <span data-ttu-id="5b5c2-129">BizTalk WCF カスタム アダプターでは、Bindingelement から新しいバインドを作成するためだけでなく、直接新しいバインディングを構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-129">The BizTalk WCF Custom adapter not only allows you to build a new binding from BindingElements but also lets you configure a new binding directly.</span></span> <span data-ttu-id="5b5c2-130">標準バインドでの動作を構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-130">It also allows you to configure behaviors on standard bindings.</span></span> <span data-ttu-id="5b5c2-131">カスタム動作の作成は、新しい BindingElement オブジェクトの作成より簡単なため、これは特に便利です。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-131">This is particularly useful because writing custom behaviors is much easier than writing new BindingElements objects.</span></span>  
  
 <span data-ttu-id="5b5c2-132">BindingElement の構築は複雑な開発作業は、参照することの最適なソース ハイパーリンクで WCF サンプル "<http://go.microsoft.com/fwlink/?LinkId=142449>" \t "_blank" http://go.microsoft.com/fwlink/?LinkId=142449 します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-132">Building a BindingElement is an involved development exercise and the best source of reference for it is the WCF samples at  HYPERLINK "<http://go.microsoft.com/fwlink/?LinkId=142449>" \t "_blank" http://go.microsoft.com/fwlink/?LinkId=142449.</span></span> <span data-ttu-id="5b5c2-133">カスタム BindingElement を作成するには、BindingElement から派生するクラスを作成します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-133">To create a custom BindingElement you create a class that derives from BindingElement.</span></span> <span data-ttu-id="5b5c2-134">新しい BindingElement は新しいアセンブリである必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-134">A new BindingElement will have to be in a new assembly.</span></span> <span data-ttu-id="5b5c2-135">このアセンブリをインストールする必要があります、管理用コンピューターで、BizTalk ホストの送信ポートと受信場所のグローバル アセンブリ キャッシュ (GAC) に構成されます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-135">This assembly must be installed into the Global Assembly Cache (GAC) of the administration computer where the BizTalk Host, send port, and receive location are configured.</span></span> <span data-ttu-id="5b5c2-136">カスタム バインドを関連付ける特定の送信ポートまたは受信場所は、まずに追加する、 \<bindingElementExtensions\>同じコンピューター上の machine.config ファイルのセクション。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-136">To associate a custom binding with a specific send port or receive location, you first need to add it to the \<bindingElementExtensions\> section of the machine.config file on the same computer.</span></span>  
  
 <span data-ttu-id="5b5c2-137">開くことができますし、その変更を行った後、**トランスポートのプロパティの構成**バインディングを構成するダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-137">After making that change you can then bring up the **Transport Properties Configuration** dialog box to configure the binding.</span></span>  
  
1. <span data-ttu-id="5b5c2-138">**バインド**] タブの [バインドの種類、select **customBinding**します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-138">On the **Binding** tab, for Binding type, select **customBinding**.</span></span>  
  
2. <span data-ttu-id="5b5c2-139">**バインド**ウィンドウで、右クリック**CustomBindingElement**を選択し、**拡張機能の追加**します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-139">In the **Binding** pane, right-click **CustomBindingElement**, and select **Add Extension**.</span></span>  
  
3. <span data-ttu-id="5b5c2-140">Machine.config ファイルで指定したバインド要素を選択し、必要に応じて、バインディングを構成します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-140">Select the binding element you specified in the machine.config file and configure the binding as required.</span></span> <span data-ttu-id="5b5c2-141">場合によっては、メッセージの送信または受信に使用する準備ができました。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-141">It is now ready to use for message transmission or receipt.</span></span>  
  
   <span data-ttu-id="5b5c2-142">BizTalk ではカスタム バインドの検証を非常に限定された、この方法で追加されたとき。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-142">BizTalk does very limited validation for a custom binding when it has been added in this manner.</span></span> <span data-ttu-id="5b5c2-143">したがって、バインド要素が正しい順序で表示されていることを確認する重要なは。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-143">Therefore, it is important to ensure the binding elements are listed in the correct order.</span></span> <span data-ttu-id="5b5c2-144">ダイアログ ボックスの CustomBindingElement バインド ツリーの下部にある実行時に最初に呼び出さ バインド要素があります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-144">The binding element you want invoked first at runtime must be on the bottom of the CustomBindingElement binding tree in the dialog box.</span></span> <span data-ttu-id="5b5c2-145">Bindingelement の一覧は、トランスポートを含める必要があり、そのトランスポートは一覧の下部にある必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-145">The list of BindingElements must contain a Transport and that Transport must be at the bottom of the list.</span></span> <span data-ttu-id="5b5c2-146">一連の Bindingelement にエンコーダーが含めることもできます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-146">The set of BindingElements may also contain an Encoder.</span></span> <span data-ttu-id="5b5c2-147">詳細については、バインドの要素で、WCF ドキュメントを参照してください。 [ http://go.microsoft.com/fwlink/?LinkId=142449](http://go.microsoft.com/fwlink/?LinkId=142449)します。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-147">For more information, see the WCF documentation on binding elements at [http://go.microsoft.com/fwlink/?LinkId=142449](http://go.microsoft.com/fwlink/?LinkId=142449).</span></span>  
  
## <a name="what-is-a-wcf-custom-behavior-and-how-do-i-use-one-with-biztalk-server"></a><span data-ttu-id="5b5c2-148">WCF カスタム動作と BizTalk Server のいずれかの使用方法について</span><span class="sxs-lookup"><span data-stu-id="5b5c2-148">What is a WCF custom behavior and how do I use one with BizTalk Server?</span></span>  
 <span data-ttu-id="5b5c2-149">メッセージ通信メカニズムとして WCF を使用する利点の 1 つは、カスタム コードを使用してそのサービスの機能を拡張することです。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-149">One of the advantages of using WCF as a message communication mechanism is the opportunity to extend the functionality of its services by using custom code.</span></span> <span data-ttu-id="5b5c2-150">カスタム動作拡張機能は、WCF の市場での他の Web サービス テクノロジから差別化機能の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-150">Custom behavior extensions are one of the features that differentiate WCF from other Web services technologies in the market.</span></span>  
  
 <span data-ttu-id="5b5c2-151">インターセプトし、メッセージの最終的な送信先に到達する前に、カスタム処理を実行するには、WCF メッセージのフロー内のさまざまなポイントがあります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-151">There are different points within the flow of a WCF message to intercept and execute custom processing before a message reaches its final destination.</span></span> <span data-ttu-id="5b5c2-152">WCF カスタム動作拡張機能は、このような 1 つの種類の傍受メカニズムでさまざまなレベルの粒度の WCF サービスまたはクライアント機能を拡張するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-152">WCF custom behavior extensions are one such type of interception mechanism and can be used to extend WCF service or client functionality at different levels of granularity.</span></span> <span data-ttu-id="5b5c2-153">カスタム動作拡張機能は、WCF サービスとクライアント レベルの両方に存在できます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-153">Custom behavior extensions can exist at both the WCF service and client levels.</span></span> <span data-ttu-id="5b5c2-154">WCF サービスへの呼び出し履歴で動作を構成しても、呼び出しに使用される通信バインドに影響がありません。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-154">Configuring a behavior on the call stack to a WCF service has no influence on the communication binding used to make the call.</span></span> <span data-ttu-id="5b5c2-155">実際には、サービスが公開するメタデータに表示されないため、動作は通常、クライアントに表示されません。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-155">In fact, behaviors are typically invisible to the client because they are not displayed in the metadata a service publishes.</span></span> <span data-ttu-id="5b5c2-156">通常、クライアントには、動作が WCF 操作の呼び出し中に実行するという考えがありません。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-156">The client typically has no idea that the behaviors are executing during a call to a WCF operation.</span></span>  
  
 <span data-ttu-id="5b5c2-157">WCF サービスへの呼び出しでカスタム処理を簡単に実装する機能は、WCF がこのような機能豊富なプログラミング パラダイムと比較する他の Web アプリケーション間の通信方法の主な理由の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-157">The ability to easily implement custom processing in a call to a WCF service is one of the main reasons why WCF is such a rich programming paradigm compared to other ways of communication between Web applications.</span></span> <span data-ttu-id="5b5c2-158">このカスタム処理で、Web アプリケーション内での拡張の要件に従い、ほぼすべての形式がかかる場合があります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-158">This custom processing can take almost any form as dictated by extensibility requirements within a Web application.</span></span> <span data-ttu-id="5b5c2-159">開発者は、検査、サービス構成を検証し、WCF クライアントとサービス アプリケーションのランタイム動作を変更またはカスタムの拡張機能を作成できます。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-159">Developers can create custom extensions that inspect and validate service configuration or modify runtime behavior in WCF client and service applications.</span></span> <span data-ttu-id="5b5c2-160">動作できます通常のメッセージの処理を補完、処理中にメッセージを変更、特定の構成条件を吟味したいと適切なアクションを実行、呼び出し元の id を検証および成功した場合など、メッセージを渡します。完全にカスタムために処理メカニズムがどのような機能拡張を実装するアプリケーションに必要があります。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-160">Behaviors can supplement normal message processing, modify the message during processing, scrutinize certain configuration criteria and take appropriate action, validate identities of the caller and pass the message on if it is successful, etc. Because it is truly a custom processing mechanism you implement whatever extensibility your application needs.</span></span>  
  
 <span data-ttu-id="5b5c2-161">BizTalk Server で WCF カスタム動作を使用する構成を使用して、**動作**受信場所または送信ポートの Wcf-custom または Wcf-customisolated アダプターのタブ。</span><span class="sxs-lookup"><span data-stu-id="5b5c2-161">To use a WCF custom behavior in BizTalk Server you will configure it by using the **Behavior** tab for the WCF-Custom or WCF-CustomIsolated adapter for a receive location or a send port.</span></span>