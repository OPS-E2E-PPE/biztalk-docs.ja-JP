---
title: オーケストレーションでの永続化 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- orchestrations, persistence
- persistence
- BizTalk Server Orchestration Engine
ms.assetid: 2f79d294-f7df-4d84-ba76-50618506b6c6
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 184b4a7dde452902f404a5d6ed5dca5ee611e1e0
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37008915"
---
# <a name="persistence-in-orchestrations"></a>オーケストレーションでの永続化
オーケストレーション エンジンは、さまざまな永続化ポイントでのオーケストレーション インスタンスの全体の状態を保存して、オーケストレーション インスタンスを復元できるようにします。 この状態には、メッセージや変数だけでなく、オーケストレーションで使用できるすべての .NET ベースのコンポーネントが含まれます。 エンジンは、次の永続化ポイントでの状態を保存します。  
  
- トランザクション スコープの最後 (アトミックまたは長時間トランザクション)  
  
- デバッグのブレークポイント  
  
- オーケストレーションの開始図形を使用した他のオーケストレーションの実行時  
  
- 送信図形 (アトミック トランザクションの場合を除く)  
  
- オーケストレーション インスタンスが中断された場合  
  
- システムが適切な方法でシャットダウンした場合  
  
- 退避が必要であるとエンジンが判断した場合  
  
- オーケストレーション インスタンスが完了した場合  
  
  エンジンは、特にサイズの大きいメッセージを処理するときなど、負荷がかかる場合に永続化ポイントの数を最適化します。 以下に 2 つのオーケストレーション インスタンスを示します。アトミックのスコープ内に送信図形のあるオーケストレーションでは、エンジンは、トランザクション スコープの最後とオーケストレーションの最後の間で 1 つの永続化ポイントを決定します。 別のオーケストレーションでは、2 つの永続化ポイントがあります。1 つは最初の送信図形のためのもので、もう 1 つはオーケストレーションの最後がある送信図形のためのものです。  
  
  **オーケストレーションの永続化**  
  
  ![オーケストレーションの永続化](../core/media/bts-trans-orch-fig2.gif "BTS_Trans_Orch_Fig2")  
  
  オーケストレーションで直接的または間接的に使用するすべての .NET ベースのオブジェクトは、アトミックのスコープで呼び出されない場合に、あるいはオブジェクトがステートレスであり、静的メソッドによってのみ呼び出される場合に、シリアル化可能としてマークする必要があります。 **System.Xml.XmlDocument**特殊なケースでは、スコープのトランザクション プロパティに関係なくシリアル化可能としてマーク済みである必要はありません。  
  
  特別な処理をどのように行わ**System.Xml.XmlDocument**機能します。  
  
  ユーザーが変数を定義する場合**X**型の**T**ここで、 **T**は**System.Xml.XmlDocument**から派生したクラスまたは**System.Xml.XmlDocument** 、コンパイラは処理し、 **X**としてシリアル化可能なオブジェクト。  
  
  シリアル化中に**X**、ランタイムは、次の情報を保持: (a)、実際の型**Tr**オブジェクトの**X**を参照している (b) **OuterXml**ドキュメントの文字列。  
  
  逆シリアル化時に**X**、ランタイムのインスタンスが作成されます**Tr** (すべてのパラメーターを受け取らないコンストラクターを想定しています) とが呼び出されます**LoadXml**を提供する、保存されているインスタンス**OuterXml します。X**の新しく作成されたインスタンスを指すように設定し、されます**Tr**します。  
  
## <a name="see-also"></a>参照  
 [トランザクション](../core/transactions.md)