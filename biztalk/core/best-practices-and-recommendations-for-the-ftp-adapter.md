---
title: "ベスト プラクティスと、FTP アダプターの推奨事項 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- best practices, FTP adapters
- FTP adapters, best practices
ms.assetid: f73b2016-d48c-48d8-9ba0-96e26b694d1e
caps.latest.revision: "12"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 85967756089be91939bf5b6f73b12d36ed8caa51
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
---
# <a name="best-practices-and-recommendations-for-the-ftp-adapter"></a>ベスト プラクティスと、FTP アダプターの推奨事項
ベスト プラクティス、セキュリティの推奨事項、および FTP アダプターの機能強化について確認します。

## <a name="best-practices"></a>ベスト プラクティス  
  
-   受信したファイルの一部を定期的に一時フォルダから削除することで、ファイルがコンピュータ リソースを使い続けたり、場合によってはサービスが中断されたりするのを防いでください。  
  
-   ストリーミング サーバーでの作業中は、メッセージ ボックス データベースでファイル全体が取得されるまでは、新しいファイルへの読み取りアクセスを拒否してください。 ファイルの一部分が FTP アダプタからメッセージ ボックス データベースに送信された場合、メッセージ ボックス データベースではメッセージが正常に保存されますが、FTP アダプタでは受信場所からメッセージの断片を削除できません。  
  
-   FTP アダプタの受信ハンドラの高可用性を実現するには、クラスタ化された BizTalk ホスト インスタンスで実行されるように、FTP アダプタの受信ハンドラを構成する必要があります。 詳細については、次を参照してください。[化されたクラスター化されたホストでアダプター ハンドラーの実行に関する考慮事項](../core/considerations-for-running-adapter-handlers-within-a-clustered-host1.md)です。  

## <a name="security-recommendations-and-tips"></a>セキュリティに関する推奨事項とヒント

BizTalk Server では、ファイル転送プロトコル (FTP) サーバーからファイルを取得でき、他のアプリケーション用に FTP サーバーにファイルを送信することができます。 BizTalk Server は FTP サーバーとして機能しません。  
  
 FTP は、本質的に、安全ではありません。 ユーザー名、パスワード、およびその他の資格情報がクリア テキストでネットワークを通過します。 同様に、アップロードまたはダウンロードされたファイルもクリア テキストで移送されるため、途中で簡単に表示または改ざんできます。 さらに、攻撃者が FTP サーバー自体になりすます可能性があります (非認証サーバーによる攻撃とも呼ばれます)。 この場合、特定の FTP サーバーが実際に通信しようとしたコンピューターであるかどうかを判断する方法はありません。  
  
 これらの問題を解決するのには、FTP アダプターは、暗号化によるデータの機密性を保証する SSL/TLS プロトコルをサポートします。  
  
 FTP プロトコルを使用する場合の一般的なセキュリティに関する考慮事項」を参照して、 [Internet FAQ Archives](http://go.microsoft.com/fwlink/p/?LinkId=24779) (http://go.microsoft.com/fwlink/p/?LinkId=24779)。   
  
 FTP アダプターをセキュリティで保護して環境に展開するには、次のガイドラインに従うことをお勧めします。  

- データへのサーバーと制限のアクセスをセキュリティで保護します。 FTP プロトコルはセキュリティで保護されたプロトコルではないので、常に危険にさらされます。 FTP サーバーがセキュリティで保護された専用の接続を使用して、サーバーと BizTalk Server と FTP ホスト間の接続を制限することを確認することができます。 FTP サーバーのセキュリティ ポリシーを設定して、FTP クライアントとの、セキュリティで保護された接続を行うこともできます。  

- アダプターと FTP サーバー間の通信には、SSL (Secure Sockets Layer) プロトコルを使用するように FTP アダプターを構成します。 SSL プロトコルにより、暗号化を通じてデータの機密性が確保されます。 これにより、ユーザー ID とパスワードは暗号化され、テキスト形式で送信されることはありません。 FTP アダプターでは、FTP 接続のデータ チャネルを暗号化する選択もできます。 参照してください**強化**(」を参照)。
  
-   セキュリティで保護されたファイルの転送を実現するために、FTP アダプターによって提供される SSL 固有のプロパティを構成します。 参照してください**強化**(」を参照)。 
  
-   FTP アダプターには、FTP Request for Comments (RFC) 959 がサポートしています。 参照してください、 [World Wide Web Consortium (W3C)](http://go.microsoft.com/fwlink/p/?LinkId=24781) (http://go.microsoft.com/fwlink/p/?LinkId=24781)。 FTP アダプタは、Secure FTP (SFTP) をサポートしていません。 参照してください、 [SFTP アダプター](../core/sftp-adapter.md)です。
  
-   FTP アダプタは、ファイアウォールを越えて使用できます。 で使用するファイアウォールの種類に応じて次のファイアウォールのプロパティの 1 つ以上を構成する必要があります。 ユーザー名、パスワード、コンピューター、ポート、ファイアウォールの種類 (なし、socks 4、socks 5)、とモードです。  
  
-   安全な場所にリモートの FTP サーバーに配置することをお勧めします。 このサーバーの物理的なセキュリティとネットワークのセキュリティを確保して、未認証のサーバーの攻撃を最小限に抑える必要があります。  
  
-   FTP アダプタでは、エンタープライズ シングル サインオンの使用がサポートされています。 参照してください[エンタープライズ シングル サインオンを実装する](../core/implementing-enterprise-single-sign-on.md)です。  
  
-   既定では、FTP 受信アダプターはダウンロード後に FTP サーバーからファイルを削除するので、FTP サーバーへの書き込みアクセス許可が必要になります。 ただし、FTP アダプターは、読み取り専用の場所からファイルのダウンロードをサポートします。 参照してください**強化**(」を参照)。
  
- FTP 送信ポートを使用する場合は、送信ポートの構成時にユーザー ID とパスワードの組み合わせを指定して格納する必要があります。 アダプタは、この情報を使用して FTP サーバーに接続します。 ユーザーの資格情報は、プレーンテキストで SQL Server データベースに格納されます。 動的な送信ポートでは、資格情報は FTP サーバーに送信されます。 実稼働環境の要件によってより強力なセキュリティが保証されている場合は、サーバーに対して匿名の資格情報を使用します。  
  
-   システムでは、アカウントの入力を求められたら、既存のユーザー アカウントとローカル システム アカウントではなく入力することをお勧めします。 これにより、より優れたセキュリティを実装し、ログオンせずにアダプタを自動実行モードで実行できます。  

## <a name="enhancements"></a>機能強化

### <a name="transferring-data-to-and-from-a-secure-ftp-server"></a>セキュリティで保護された FTP サーバーとの間のデータを転送します。  
 FTP アダプターは Secure Sockets Layer (SSL) 経由での FTPS サーバーからのファイル転送をサポートする//transport Level Security (TLS)。 SSL/TLS によって、暗号化をとおしたデータの機密性が確保されます。 セキュリティで保護されたモードを有効にするには、アダプターが提供する SSL 固有のプロパティを構成する必要があります。 アダプターを使用するとセキュリティで保護された FTP サーバーからのデータの読み取りと書き込みが可能になるため、送信ハンドラー/ポートおよび受信ハンドラー/場所を構成するときも SSL 固有のプロパティを使用できます。  

以降で[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]、SYST コマンドには不要、FTP アダプター。 

- **FTP サーバーの種類**プロパティ – SYST コマンドを必要としないサーバーを使用するには、このプロパティに設定します。
   
 SSL 固有のプロパティを構成するときは、以下のオプションを使用できます。  

-   **SSL を使用して**プロパティ – がその FTP アダプターは、転送セッションごとに SSL を使用する必要がありますので、このプロパティを設定します。  
  
-   **データ保護を有効にする**プロパティ – データの暗号化を有効にするには、このプロパティに設定します。 この設定が動作するためには、FTPS サーバーのセキュリティ ポリシーで、アダプターによって SSL 接続のセキュリティを保護することを考慮に入れる必要があります。  
  
-   **FTPS 接続モード**プロパティ-セキュリティをアクティブにするタイミングを決定するには、このプロパティを設定します。  
  
    -   **暗黙的な**モードでは、セキュリティが自動的にオン、アダプターは、サーバーに接続するとすぐにします。  
  
    -   **Explicit**モードでは、アダプターは、セキュリティで保護されたコントロール チャネルを開始するコマンドを送信します。  
  
> [!NOTE]
>  FTP アダプターはサーバー証明書の失効確認をサポートしていません。  
  
### <a name="support-for-downloading-files-from-locations-marked-as-read-only"></a>読み取り専用とマーク付けされている場所からのファイル ダウンロードのサポート  
FTP アダプターは、読み取り専用ファイルの場所からファイルのダウンロードをサポートします。 また、アダプターはダウンロードしたファイルの一覧をデータベースで管理するようになりました。 次回ダウンロード時には、FTP サーバー上のファイルの一覧と、アダプターによって管理されているファイルの一覧とが比較され、サーバー上の新しいファイルだけがダウンロードされます。 2 つのダウンロード間の既存のファイルの更新のシナリオをサポートするためにも設定してファイルのタイムスタンプをチェックするアダプターを構成することができます、 **タイムスタンプ比較の**FTP の受信場所。 このような場合、ファイル名は同じですが、タイムスタンプが更新されると、場合でも、アダプターは、ファイルをダウンロードします。  
  
 FTP サーバーによっては、変更されたタイムスタンプのファイルへの関連付けをサポートしていないことがあります。 そのような場合、アダプターを使用すれば、ファイルを再度ダウンロードする間隔を指定できます。 この間隔を構成するには、**再ダウンロード間隔**FTP の受信場所。  
  
 次の表は、別の値を設定の FTP アダプターの予期される動作を一覧表示されます、**ダウンロード後に削除**、 **タイムスタンプ比較の**と**再ダウンロード間隔**プロパティです。  
  
|ダウンロード後に削除|タイムスタンプ比較の有効化|再ダウンロード間隔|アダプターの動作|  
|---|---|---|---|  
|はい|適用なし|適用なし|アダプターは、ファイルをダウンロードした後、そのファイルを FTP サーバーから削除します。 これがアダプターの既定の動作です。|  
|不可|はい|適用なし|アダプターは、ファイルをダウンロードした後、そのファイルを FTP サーバーから削除しません。 代わりに、アダプターは MDTM コマンドを使用して、ファイルの最終変更タイムスタンプを比較します。 タイムスタンプに応じて、アダプターはファイルを再度ダウンロードします。|  
|不可|不可|適用できます|FTP アダプターは、ファイルが変更されているかどうかにかかわらず、指定された間隔が経過すると、FTP サーバーからファイルをダウンロードします。|  
  
### <a name="support-for-atomic-file-transfer-in-ascii-mode"></a>ASCII モードでのアトミックなファイル転送のサポート  
 FTP アダプターは、ASCII モードのアトミック ファイル転送をサポートします。 ASCII モードでアトミック ファイル転送を有効にするアダプターを使用して、**一時フォルダー**プロパティです。 このプロパティは、ファイルが最初に移動される FTP サーバー上の一時的な場所を指定します。 一時的な場所にファイルが完全に転送されたら、次に、FTP サーバー上の関連する場所に移動されます。 この場合、FTP サーバー上の一時的な場所と関連する場所との間でファイル転送がアトミックであることが前提となります。  
  
> [!NOTE]
>  ASCII ファイルを一時フォルダーを使用する拡張機能にのみ適用、**送信**には適用されず**受信**です。 この機能を実装する主な理由は、サード パーティ製アプリケーションはファイルの書き込みが完了しなければ読み取らないためです。 BizTalk がファイルを受信する場合、アダプターはファイルの読み取りが完了した後でのみ BizTalk にファイルを送信します。  
  
> [!NOTE]
>  バイナリ モードで、**一時フォルダー**プロパティは、間にエラーがある場合は、ファイル転送を再開するも使用できます。 ASCII モードでは適用されません。 ASCII モードで、**一時フォルダー**プロパティはアトミック ファイル転送にのみ使用します。  
  
 
## <a name="next"></a>Next 
[FTP アダプタを構成します。](../core/configuring-the-ftp-adapter.md)  

## <a name="see-also"></a>参照  
 [受信と送信サーバーのポート](../core/ports-for-the-receive-and-send-servers.md)   
 [セキュリティの最小ユーザー権限](../core/minimum-security-user-rights.md)
