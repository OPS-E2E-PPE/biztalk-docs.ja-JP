---
title: アグリーメントの解決、スキーマ探索、および受信した EDI メッセージの承認 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 503e307c-4cb0-49b5-8751-82dcea203151
caps.latest.revision: 45
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 0af984b0665c3ef4d567d3a3dd032232139f7d64
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37006403"
---
# <a name="agreement-resolution-schema-discovery-and-authorization-for-received-edi-messages"></a><span data-ttu-id="576c0-102">受信した EDI メッセージのアグリーメントの解決、スキーマ探索、および認証</span><span class="sxs-lookup"><span data-stu-id="576c0-102">Agreement Resolution, Schema Discovery, and Authorization for Received EDI Messages</span></span>
<span data-ttu-id="576c0-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] が EDI メッセージを受信すると、そのメッセージの処理方法を決定するために、EDI 受信パイプラインによって取引先アグリーメント解決、スキーマ探索、および認証のプロセスが実行されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-103">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives an EDI message, the EDI receive pipeline performs trading partner agreement lookup, schema discovery, and authorization processes to determine how to process the message.</span></span>  
  
## <a name="agreement-resolution"></a><span data-ttu-id="576c0-104">アグリーメント解決</span><span class="sxs-lookup"><span data-stu-id="576c0-104">Agreement Resolution</span></span>  
 <span data-ttu-id="576c0-105">EDI 受信パイプラインによって実行される取引先アグリーメント解決とは、メッセージのヘッダー フィールドに一致するプロパティを持つアグリーメント定義を見つけるための一連の手順を実行することです。</span><span class="sxs-lookup"><span data-stu-id="576c0-105">The EDI receive pipeline performs a trading partner agreement resolution by performing a series of steps to determine whether there is a match between header fields in the message and properties in the agreement definition.</span></span> <span data-ttu-id="576c0-106">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] によってアグリーメントが特定されると、次に、そのインターチェンジに適用されるドキュメント スキーマが特定されます (後述)。</span><span class="sxs-lookup"><span data-stu-id="576c0-106">Once [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement, it determines the document schema that applies to the interchange (see below).</span></span> <span data-ttu-id="576c0-107">一致するアグリーメントに関連付けられたプロパティおよび関連するスキーマを使用して、受信したメッセージが検証され、処理されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-107">It uses the properties associated with the matching agreement and the relevant schema to validate and process the received message.</span></span>  
  
 <span data-ttu-id="576c0-108">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] がアグリーメント解決を実行する手順は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="576c0-108">To perform agreement resolution, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] proceeds as follows:</span></span>  
  
1. <span data-ttu-id="576c0-109">アグリーメントを解決するために、インターチェンジ ヘッダーの中の送信者の修飾子と識別子および受信者の修飾子と識別子をアグリーメントのプロパティと照合して、一致するアグリーメントを見つけます。</span><span class="sxs-lookup"><span data-stu-id="576c0-109">Resolve the agreement by matching the sender qualifier and identifier, and the receiver qualifier and identifier, in the interchange header with those in the properties of an agreement.</span></span>  
  
2. <span data-ttu-id="576c0-110">手順 1. で一致するものが見つからない場合は、インターチェンジ ヘッダーの中の送信者の修飾子と識別子だけをアグリーメントのプロパティと照合して、一致するアグリーメントを見つけます。</span><span class="sxs-lookup"><span data-stu-id="576c0-110">If step 1 does not succeed, resolve the agreement by matching just the sender qualifier and identifier in the interchange header with those in the properties of an agreement.</span></span> <span data-ttu-id="576c0-111">この時点では、最初の手順で一致するものが見つかっていないので、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] がメッセージを受信することになっていると考えることができます。</span><span class="sxs-lookup"><span data-stu-id="576c0-111">Also, because the first step did not succeed, it is safe to assume that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be receiving the message.</span></span> <span data-ttu-id="576c0-112">したがって、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は、受信者の修飾子および識別子が以下の値に一致するものを見つけます。</span><span class="sxs-lookup"><span data-stu-id="576c0-112">Hence, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tries to match the receiver qualifier and identifier with the following:</span></span>  
  
   -   <span data-ttu-id="576c0-113">値 "BT" および "HostX12Recvr" (X12 でエンコードされたメッセージの場合)</span><span class="sxs-lookup"><span data-stu-id="576c0-113">Values “BT” and “HostX12Recvr” (for X12-encoded messages) and</span></span>  
  
   -   <span data-ttu-id="576c0-114">値 "BT" および "HostEdifactRecvr" (EDIFACT でエンコードされたメッセージの場合)</span><span class="sxs-lookup"><span data-stu-id="576c0-114">Values “BT” and “HostEdifactRecvr” (for EDIFACT-encoded messages)</span></span>  
  
   > [!IMPORTANT]
   > - <span data-ttu-id="576c0-115">**BizTalk Server 2013 R2、2013、および 2010**:、ISA5、ISA6、ISA7、ISA8、UNB2.1、UNB2.2、[unb3.1]、および [unb3.2] フィールドには、アグリーメント設定で必須です。</span><span class="sxs-lookup"><span data-stu-id="576c0-115">**BizTalk Server 2013 R2, 2013, and 2010**: The ISA5, ISA6, ISA7, ISA8, UNB2.1, UNB2.2, UNB3.1, and UNB3.2 fields are mandatory in the agreement settings.</span></span>  
   >   -   <span data-ttu-id="576c0-116">**BizTalk Server 2009 および 2006 R2**:、ISA7、ISA8、UNB3.1、および [unb3.2] フィールドは、パーティ設定で必須ではありません。</span><span class="sxs-lookup"><span data-stu-id="576c0-116">**BizTalk Server 2009 and 2006 R2**: The ISA7, ISA8, UNB3.1, and UNB3.2 fields are not mandatory in the party settings.</span></span> <span data-ttu-id="576c0-117">これらのフィールドを空白のままにすると、EDI エンジンでは ISA5、ISA6、UNB2.1、UNB2.2 の値に基づいて解決が実行されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-117">If the fields are left blank, the EDI engine gives a resolution based on the values of ISA5, ISA6, UNB2.1, and UNB2.2.</span></span>  
   >   -   <span data-ttu-id="576c0-118">BizTalk Server 2009 および BizTalk Server 2006 R2 以降のバージョンによる解決をサポートするために、ハード コードされた ID (HostX12Recvr および HostEdifactRecvr) と修飾子 (BT) が導入されています。</span><span class="sxs-lookup"><span data-stu-id="576c0-118">To support the resolutions from BizTalk Server 2009 and 2006 R2 to newer versions of BizTalk Server, the hard coded IDs (HostX12Recvr and HostEdifactRecvr) and qualifiers (BT) are introduced.</span></span>  
   >   -   <span data-ttu-id="576c0-119">EDIFACT メッセージが従う必要があります、 [UNECE ガイドライン](http://www.unece.org/tradewelcome/areas-of-work/un-centre-for-trade-facilitation-and-e-business-uncefact/outputs/standards/unedifact/tradeedifactrules.html)メッセージの構文と規則。</span><span class="sxs-lookup"><span data-stu-id="576c0-119">Your EDIFACT messages should follow the [UNECE guidelines](http://www.unece.org/tradewelcome/areas-of-work/un-centre-for-trade-facilitation-and-e-business-uncefact/outputs/standards/unedifact/tradeedifactrules.html) for message syntax and rules.</span></span>  
  
3. <span data-ttu-id="576c0-120">手順 2. で一致するものが見つからない場合は、フォールバック アグリーメントのプロパティを使用します。</span><span class="sxs-lookup"><span data-stu-id="576c0-120">If step 2 does not succeed, use the fallback agreement properties.</span></span>  
  
   <span data-ttu-id="576c0-121">最初の手順で、X12 の場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は以下の値を照合に使用します。</span><span class="sxs-lookup"><span data-stu-id="576c0-121">In the first step, for X12, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the following values to make the match:</span></span>  
  
- <span data-ttu-id="576c0-122">ISA05 (送信者の修飾子)</span><span class="sxs-lookup"><span data-stu-id="576c0-122">ISA05 (sender qualifier)</span></span>  
  
- <span data-ttu-id="576c0-123">ISA06 (送信者の識別子)</span><span class="sxs-lookup"><span data-stu-id="576c0-123">ISA06 (sender identifier)</span></span>  
  
- <span data-ttu-id="576c0-124">ISA07 (受信者の修飾子)</span><span class="sxs-lookup"><span data-stu-id="576c0-124">ISA07 (receiver qualifier)</span></span>  
  
- <span data-ttu-id="576c0-125">ISA08 (受信者の識別子)</span><span class="sxs-lookup"><span data-stu-id="576c0-125">ISA08 (receiver identifier)</span></span>  
  
  <span data-ttu-id="576c0-126">EDIFACT の場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は以下の値を照合に使用します。</span><span class="sxs-lookup"><span data-stu-id="576c0-126">For EDIFACT, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the following values to make the match:</span></span>  
  
- <span data-ttu-id="576c0-127">UNB2.1 (送信者の識別子)</span><span class="sxs-lookup"><span data-stu-id="576c0-127">UNB2.1 (sender identifier)</span></span>  
  
- <span data-ttu-id="576c0-128">UNB2.2 (送信者の修飾子)</span><span class="sxs-lookup"><span data-stu-id="576c0-128">UNB2.2 (sender qualifier)</span></span>  
  
- <span data-ttu-id="576c0-129">UNB3.1 (受信者の識別子)</span><span class="sxs-lookup"><span data-stu-id="576c0-129">UNB3.1 (receiver identifier)</span></span>  
  
- <span data-ttu-id="576c0-130">UNB3.2 (受信者の修飾子)</span><span class="sxs-lookup"><span data-stu-id="576c0-130">UNB3.2 (receiver qualifier)</span></span>  
  
  <span data-ttu-id="576c0-131">照合に使用されるアグリーメントのプロパティが定義されている、**識別子**の特定方向アグリーメント タブのページ、**アグリーメントのプロパティ** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="576c0-131">The agreement properties used for the match are defined in the **Identifiers** page of the direction-specific agreement tabs of the **Agreement Properties** dialog box.</span></span>  
  
  <span data-ttu-id="576c0-132">この 4 つの受信側と送信側のプロパティによって、取引先アグリーメントが一意に識別されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-132">These four receive-side and send-side properties uniquely identify the trading partner agreement.</span></span> <span data-ttu-id="576c0-133">4 つのプロパティを使用することで、受信側の処理の柔軟性が向上します。</span><span class="sxs-lookup"><span data-stu-id="576c0-133">Using the four properties gives you more flexibility in receive-side processing.</span></span> <span data-ttu-id="576c0-134">たとえば、このアグリーメント解決方法ならば、受信確認の送信先のパーティが複数の場合も、送信ポートを複数作成する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="576c0-134">For example, this method of agreement resolution may enable you to send acknowledgments to multiple parties without creating multiple send ports.</span></span>  
  
  <span data-ttu-id="576c0-135">送信者と受信者の修飾子と識別子の 4 つすべてを使用してもアグリーメントを解決できない場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は送信者の修飾子と識別子のみを使用してアグリーメントの解決を試みます。</span><span class="sxs-lookup"><span data-stu-id="576c0-135">If [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] cannot resolve the agreement using all four sender and receiver qualifiers and identifiers, it will attempt to resolve the agreement using just the sender qualifier and identifier.</span></span> <span data-ttu-id="576c0-136">X12 の場合のこれらのフィールドは、ISA05 と ISA06 です。EDIFACT の場合は、UNB2.1 と UNB2.2 です。</span><span class="sxs-lookup"><span data-stu-id="576c0-136">For X12, these fields are ISA05 and ISA06; for EDIFACT, these fields are UNB2.1 and UNB2.2.</span></span> <span data-ttu-id="576c0-137">送信者と受信者のプロパティと一致すると同様[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]インターチェンジ ヘッダーの値と一致するアグリーメントのプロパティで定義されている、**識別子**の特定方向アグリーメントタブのページ**アグリーメントのプロパティ** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="576c0-137">As with a match of sender and receiver properties, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] matches the values in the interchange header with the agreement properties defined in the **Identifiers** page of the direction-specific agreement tabs of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="576c0-138">送信者の修飾子と識別子を使用して、アグリーメントを解決するには、専用の場合、受信者の修飾子と識別子は未定義になって、双方向アグリーメント タブの**アグリーメントのプロパティ** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="576c0-138">If only the sender qualifier and identifier are used to resolve the agreement, the receiver qualifier and identifier should be undefined in the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
  <span data-ttu-id="576c0-139">アグリーメントが 1 つも見つからない場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] はフォールバック取引先アグリーメントを使用します (認証を必要とするようにポートが設定されている場合を除く)。</span><span class="sxs-lookup"><span data-stu-id="576c0-139">If no agreement is found, then [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses the fallback trading partner agreement, unless the port setting requires authentication.</span></span> <span data-ttu-id="576c0-140">ポートの設定には、認証が必要な場合 (いずれか**認証が失敗した場合は、メッセージを削除**または**認証が失敗した場合は、メッセージを保持する**で選択した、**全般**ページ、**受信ポートのプロパティ**)、アグリーメントが、受信ポートで受信したインターチェンジ必要です。</span><span class="sxs-lookup"><span data-stu-id="576c0-140">If the port setting requires authentication (if either **Drop messages if authentication fails** or **Keep messages if authentication fails** is selected on the **General** page of the **Receive Port Properties**), an agreement is required for any interchange received by the receive port.</span></span> <span data-ttu-id="576c0-141">この場合は、インターチェンジ ヘッダーとアグリーメント プロパティの照合によるアグリーメント解決が不可能ならば、フォールバック アグリーメント プロパティを使用してアグリーメントを特定することは許可されません。</span><span class="sxs-lookup"><span data-stu-id="576c0-141">In this case, if the agreement is not resolved by matching the interchange header with agreement properties, using the fallback agreement properties to determine the agreement is not allowed.</span></span> <span data-ttu-id="576c0-142">アグリーメントが見つからない場合は、インターチェンジは認証に失敗したものと見なされて、中断状態となります。</span><span class="sxs-lookup"><span data-stu-id="576c0-142">The interchange will be treated as though authentication had failed if no agreement is found, and will be suspended.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="576c0-143">EDI パイプライン内のメッセージは、有効な状態のアグリーメントに解決されるまで、アグリーメント解決における次の手順に進みます。</span><span class="sxs-lookup"><span data-stu-id="576c0-143">A message in the EDI pipeline goes to the succeeding step in Agreement Resolution till the message gets resolved with the step having Agreement in enable state.</span></span> <span data-ttu-id="576c0-144">たとえば、メッセージがアグリーメント解決の最初の手順で解決されたとしても、アグリーメントが無効な状態の場合、メッセージは次の解決手順に進みます。</span><span class="sxs-lookup"><span data-stu-id="576c0-144">For example, if the message gets resolved in the first step of Agreement Resolution but the Agreement is in a disabled state then the message goes to the succeeding step for resolution.</span></span>  
  
## <a name="schema-discovery"></a><span data-ttu-id="576c0-145">スキーマ探索</span><span class="sxs-lookup"><span data-stu-id="576c0-145">Schema Discovery</span></span>  
 <span data-ttu-id="576c0-146">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] は、解決を実行してメッセージからアグリーメントを特定したら、次にこのメッセージの検証および処理にどのスキーマを使用するかを決定します。</span><span class="sxs-lookup"><span data-stu-id="576c0-146">After [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement that resolves to the message, it must determine the schema that it should use to validate and process the message.</span></span> <span data-ttu-id="576c0-147">指定されたプロパティを使用して、**ローカル ホストの設定**ページ (送信側) の一方向のアグリーメント タブの**アグリーメントのプロパティ** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="576c0-147">It does so using the properties identified in the **Local Host Settings** page of the one-way (send side) agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
 <span data-ttu-id="576c0-148">スキーマを決定するには、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] で初めにスキーマの名前空間を決定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="576c0-148">To determine the schema, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must first determine the schema namespace.</span></span> <span data-ttu-id="576c0-149">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 付属の標準スキーマに対しては既定の名前空間が使用され、カスタム スキーマに対しては、どの名前空間を使用するかを EDI 逆アセンブラーが決定します。</span><span class="sxs-lookup"><span data-stu-id="576c0-149">The EDI Disassembler will either use a default namespace for the standard schemas shipped with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], or it will determine the namespace to be used for a custom schema.</span></span>  
  
 <span data-ttu-id="576c0-150">**ローカル ホスト設定**の一方向アグリーメント タブのページ、**アグリーメントのプロパティ** ダイアログ ボックスでは、カスタムの名前空間を決定する値のグリッドを設定することができます。</span><span class="sxs-lookup"><span data-stu-id="576c0-150">The **Local Host Settings** page of the one-way agreement tab of the **Agreement Properties** dialog box enables you to set up a grid of values to determine a custom namespace.</span></span> <span data-ttu-id="576c0-151">EDI 逆アセンブラーで既定の名前空間を使用してそのグリッドで一致するものがない場合、**ターゲットの名前空間**フィールドは、既定の行をマークします。</span><span class="sxs-lookup"><span data-stu-id="576c0-151">If no match is found in that grid, the EDI Disassembler uses the default namespace in the **Target namespace** field marked for the default row.</span></span>  
  
### <a name="x12-schema-discovery"></a><span data-ttu-id="576c0-152">X12 スキーマ探索</span><span class="sxs-lookup"><span data-stu-id="576c0-152">X12 Schema Discovery</span></span>  
 <span data-ttu-id="576c0-153">X12 でエンコードされたメッセージの場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では受信したインターチェンジのヘッダーのアプリケーション送信者識別子 (GS02) とトランザクション セット ID (ST01) を使用して、カスタム名前空間が決定されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-153">For X12-encoded messages, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines a custom namespace using the application sender identifier (GS02) and the transaction set ID (ST01) from the header of the incoming interchange.</span></span> <span data-ttu-id="576c0-154">内の GS02] と [ST01 プロパティのこれらの値と値の間の一致を確認しようと、**ターゲットの名前空間をカスタマイズ**でグリッド、**ローカル ホストの設定**ページ ([**トランザクションセットの設定**) の双方向アグリーメント タブの**アグリーメントのプロパティ**] ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="576c0-154">It attempts to find a match between these values and the values for the GS02 and ST01 properties in the **Customize target namespace** grid in the **Local Host Settings** page (under **Transaction Set Settings**) of the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="576c0-155">一致が見つかると、スキーマを検証し、メッセージの処理を決定するのにグリッドの同じ行で指定されたターゲットの名前空間が使用されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-155">If it finds a match, it will use the target namespace identified in the same row of the grid to determine which schema to us to validate and process the message.</span></span> <span data-ttu-id="576c0-156">ターゲットの名前空間が決定されない場合は、既定のターゲットの名前空間が使用されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-156">If the target namespace is not determined, then the default target namespace will be used.</span></span> <span data-ttu-id="576c0-157">名前空間が指定されていない場合、**ターゲットの名前空間**フィールドが設定されていますが、既定の行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]は、既定では、X12でエンコードされたメッセージのフォールバックアグリーメントプロパティで識別されるターゲットの名前空間を使用`http://schemas.microsoft.com/BizTalk/Edi/X12/2006`.</span><span class="sxs-lookup"><span data-stu-id="576c0-157">If no namespace is identified in the **Target namespace** field marked for the default row, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the target namespace identified in the fallback agreement properties for X12-encoded messages, which by default is `http://schemas.microsoft.com/BizTalk/Edi/X12/2006`.</span></span>  
  
 <span data-ttu-id="576c0-158">X12 インターチェンジの場合、ターゲットの名前空間が検出されると、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では次の情報を使用してスキーマが決定されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-158">For X12 interchanges, after the target namespace is discovered, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines the schema using the following information:</span></span>  
  
- <span data-ttu-id="576c0-159">検出されたターゲットの名前空間</span><span class="sxs-lookup"><span data-stu-id="576c0-159">The target namespace just discovered</span></span>  
  
- <span data-ttu-id="576c0-160">ST03 の最初の 5 文字のバージョン/リリース (GS07 == X - Accredited Standards Committee X12 の場合)。</span><span class="sxs-lookup"><span data-stu-id="576c0-160">The version/release in the first five characters of ST03 (if GS07 == X - Accredited Standards Committee X12).</span></span> <span data-ttu-id="576c0-161">ST03 が存在しないか無効である場合、またはスキーマを決定できない場合は、GS08 または ISA12 (GS07 != X の場合) の最初の 5 文字でバージョンが決定されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-161">If ST03 is not present/invalid or does not result in the schema resolution, then the version is determined by the first five characters of GS08 or of ISA12 (if GS07 != X).</span></span>  
  
- <span data-ttu-id="576c0-162">ST01 の DocType</span><span class="sxs-lookup"><span data-stu-id="576c0-162">The DocType in ST01.</span></span>  
  
  <span data-ttu-id="576c0-163">EDI 逆アセンブラーは、エンコードの種類、バージョン/リリース、および DocType を連結して、スキーマ名 ("X12_00401_864" など) を決定します。</span><span class="sxs-lookup"><span data-stu-id="576c0-163">The EDI Disassembler concatenates the encoding type, version/release, and DocType to determine the schema name, for example, "X12_00401_864".</span></span> <span data-ttu-id="576c0-164">次に、ターゲットの名前空間とスキーマ名を連結します (例: `http://schemas.microsoft.com/BizTalk/Edi/X12/2006/X12#X12_00401_864`)。</span><span class="sxs-lookup"><span data-stu-id="576c0-164">It then concatenates the target namespace with the schema name, for example, `http://schemas.microsoft.com/BizTalk/Edi/X12/2006/X12#X12_00401_864`.</span></span>  
  
  <span data-ttu-id="576c0-165">受信した HIPAA 837 インターチェンジの場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では 3 つの HIPAA 837 スキーマをサポートします。</span><span class="sxs-lookup"><span data-stu-id="576c0-165">For an incoming HIPAA 837 interchange, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] supports three HIPAA 837 schemas:</span></span>  
  
|<span data-ttu-id="576c0-166">837 スキーマ</span><span class="sxs-lookup"><span data-stu-id="576c0-166">837 Schema</span></span>|<span data-ttu-id="576c0-167">GS08 の値 (Version 4010)</span><span class="sxs-lookup"><span data-stu-id="576c0-167">GS08 Value in version 4010</span></span>|<span data-ttu-id="576c0-168">GS08/ST03 の値 (Version 5010)</span><span class="sxs-lookup"><span data-stu-id="576c0-168">GS08/ST03 Value in version 5010</span></span>|  
|----------------|--------------------------------|--------------------------------------|  
|<span data-ttu-id="576c0-169">Claim-Dental_837D</span><span class="sxs-lookup"><span data-stu-id="576c0-169">Claim-Dental_837D</span></span>|<span data-ttu-id="576c0-170">004010X097A1</span><span class="sxs-lookup"><span data-stu-id="576c0-170">004010X097A1</span></span>|<span data-ttu-id="576c0-171">005010X224A1</span><span class="sxs-lookup"><span data-stu-id="576c0-171">005010X224A1</span></span>|  
|<span data-ttu-id="576c0-172">Claim-Institutional_837I</span><span class="sxs-lookup"><span data-stu-id="576c0-172">Claim-Institutional_837I</span></span>|<span data-ttu-id="576c0-173">004010X096A1</span><span class="sxs-lookup"><span data-stu-id="576c0-173">004010X096A1</span></span>|<span data-ttu-id="576c0-174">005010X223A1</span><span class="sxs-lookup"><span data-stu-id="576c0-174">005010X223A1</span></span>|  
|<span data-ttu-id="576c0-175">Claim-Professional_837P</span><span class="sxs-lookup"><span data-stu-id="576c0-175">Claim-Professional_837P</span></span>|<span data-ttu-id="576c0-176">004010X098A1</span><span class="sxs-lookup"><span data-stu-id="576c0-176">004010X098A1</span></span>|<span data-ttu-id="576c0-177">005010X222</span><span class="sxs-lookup"><span data-stu-id="576c0-177">005010X222</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="576c0-178">HIPAA の各バージョンのトランザクション セット 278 (Health Care Services Review) については、GS08 および ST01 の値は要求と応答のどちらのペアも同じです。</span><span class="sxs-lookup"><span data-stu-id="576c0-178">In HIPAA versions, for the transaction set 278 (Health Care Services Review), both the request and response pairs share the same value for GS08 and ST01.</span></span> <span data-ttu-id="576c0-179">BHT02 のフィールドを 278 とを区別することがあります内のトリガー値に応じて要求/応答バージョン 5010 で。</span><span class="sxs-lookup"><span data-stu-id="576c0-179">Depending on the trigger values in BHT02 field you may differentiate between a 278 Request/ Response in version 5010:</span></span>  
> 
> 1. <span data-ttu-id="576c0-180">BHT02 の値が 01、13、36 のいずれかならば、Health Care Services Review Request</span><span class="sxs-lookup"><span data-stu-id="576c0-180">Any of the values 01, 13 and 36 in BHT02 indicates a Health Care Services Review Request</span></span>  
>    2.  <span data-ttu-id="576c0-181">BHT02 が 11 ならば、Health Care Services Review Response</span><span class="sxs-lookup"><span data-stu-id="576c0-181">11 in BHT02 indicates Health Care Services Review Response</span></span>  
  
### <a name="edifact-schema-discovery"></a><span data-ttu-id="576c0-182">EDIFACT スキーマ探索</span><span class="sxs-lookup"><span data-stu-id="576c0-182">EDIFACT Schema Discovery</span></span>  
 <span data-ttu-id="576c0-183">EDIFACT でエンコードされたメッセージの場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では受信したインターチェンジのヘッダーからメッセージの種類 (UNH2.1)、メッセージのバージョン番号 (UNH2.2)、メッセージのリリース番号 (UNH2.3)、割り当てコード (UNH2.5)、機能グループ ID (UNG2.1)、およびアプリケーション送信コードの修飾子 (UNG2.2) を使用して、カスタムの名前空間が決定されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-183">For EDIFACT-encoded messages, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines a custom namespace using the message type (UNH2.1), message version number (UNH2.2), message release number (UNH2.3), assigned code (UNH2.5), functional group ID (UNG2.1), and application send code qualifier (UNG2.2) from the header of the incoming interchange.</span></span> <span data-ttu-id="576c0-184">UNH2.1、UNH2.2、UNH2.3、UNH2.5、UNG2.1、および UNG2.2 のプロパティの値とこれらの値の検索を試みます、**ターゲットの名前空間のカスタマイズ**グリッド ([**トランザクション セットの設定**)双方向アグリーメント タブの**アグリーメントのプロパティ**] ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="576c0-184">It then attempts to find a match between these values and the values for the UNH2.1, UNH2.2, UNH2.3, UNH2.5, UNG2.1, and UNG2.2 properties in the **Customize target namespace** grid (under **Transaction Set Settings**) of the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="576c0-185">一致するものが見つかった場合は、グリッドの同じ行で指定されたターゲットの名前空間が使用されて、メッセージの検証および処理のためのスキーマが決定されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-185">If it finds a match, it will use the target namespace identified in the same row of the grid to determine which schema to use to validate and process the message.</span></span> <span data-ttu-id="576c0-186">ターゲットの名前空間が決定されない場合は、既定のターゲットの名前空間が使用されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-186">If the target namespace is not determined, then the default target namespace will be used.</span></span> <span data-ttu-id="576c0-187">名前空間が指定されていない場合、**ターゲットの名前空間**フィールドが設定されていますが、既定の行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]ターゲットの名前空間、EDIFACT でエンコードされたメッセージをフォールバック アグリーメント プロパティで指定された既定を使用`http://schemas.microsoft.com/BizTalk/Edi/EDIFACT/2006`.</span><span class="sxs-lookup"><span data-stu-id="576c0-187">If no namespace is identified in the **Target namespace** field marked for the default row, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the target namespace identified in the fallback agreement properties for EDIFACT-encoded messages, which by default is `http://schemas.microsoft.com/BizTalk/Edi/EDIFACT/2006`.</span></span>  
  
 <span data-ttu-id="576c0-188">EDIFACT インターチェンジの場合、ターゲットの名前空間が検出されると、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では次の情報を使用してスキーマが決定されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-188">For EDIFACT interchanges, once the target namespace is discovered, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines the schema using the following information:</span></span>  
  
- <span data-ttu-id="576c0-189">検出されたターゲットの名前空間。</span><span class="sxs-lookup"><span data-stu-id="576c0-189">The target namespace just discovered.</span></span>  
  
- <span data-ttu-id="576c0-190">メッセージ バージョン番号 (UNH2.2)。</span><span class="sxs-lookup"><span data-stu-id="576c0-190">The message version number in UNH2.2.</span></span>  
  
- <span data-ttu-id="576c0-191">メッセージ リリース番号 (UNH2.3)。</span><span class="sxs-lookup"><span data-stu-id="576c0-191">The message release number in UNH2.3.</span></span>  
  
- <span data-ttu-id="576c0-192">メッセージの種類 (UNH2.1)。</span><span class="sxs-lookup"><span data-stu-id="576c0-192">The message type in UNH2.1.</span></span>  
  
- <span data-ttu-id="576c0-193">割り当てコード (UNH2.5)。</span><span class="sxs-lookup"><span data-stu-id="576c0-193">The assigned code in UNH2.5.</span></span>  
  
  <span data-ttu-id="576c0-194">EDI 逆アセンブラーは、エンコードの種類、バージョン、リリース、およびメッセージの種類を連結して、スキーマ名 ("EFACT_D94A_CONTEN" など) を決定します。</span><span class="sxs-lookup"><span data-stu-id="576c0-194">The EDI Disassembler concatenates the encoding type, the version, the release, and the message type to determine the schema name, for example, " EFACT_D94A_CONTEN".</span></span> <span data-ttu-id="576c0-195">次に、ターゲットの名前空間とスキーマ名を連結します (例: `http://schemas.microsoft.com/BizTalk/Edi/Edifact/2006/EFACT#EFACT_D94A_CONTEN`)。</span><span class="sxs-lookup"><span data-stu-id="576c0-195">It then concatenates the target namespace with the schema name, for example, `http://schemas.microsoft.com/BizTalk/Edi/Edifact/2006/EFACT#EFACT_D94A_CONTEN`.</span></span>  
  
  <span data-ttu-id="576c0-196">メッセージ内に UNH2.5 が存在する場合は、UNH2.5 の値が名前に含まれるスキーマ (たとえば "EFACT_D94A_CONTEN_TEST") の検出が試行されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-196">If UNH2.5 is present in the message, the EDI Disassembler will first attempt to find a matching schema by using the value of UNH2.5 as part of the schema name, for example “EFACT_D94A_CONTEN_TEST”.</span></span> <span data-ttu-id="576c0-197">一致するスキーマが見つからない場合は、UNH2.5 の値を使用せずにスキーマの検出が試行されます。</span><span class="sxs-lookup"><span data-stu-id="576c0-197">If no matching schema is found, the EDI Disassembler will fall back to finding the schema without the UNH2.5 value.</span></span>  
  
## <a name="authorization"></a><span data-ttu-id="576c0-198">承認</span><span class="sxs-lookup"><span data-stu-id="576c0-198">Authorization</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="576c0-199"> は、アグリーメントに対して定義されている認証およびセキュリティのフィールドの値と、メッセージのフィールドを比較します。</span><span class="sxs-lookup"><span data-stu-id="576c0-199"> checks the values of the authorization and security fields defined for the agreement with the fields in the message.</span></span> <span data-ttu-id="576c0-200">一致しない場合、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] はインターチェンジを中断します。</span><span class="sxs-lookup"><span data-stu-id="576c0-200">If there is a mismatch, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will suspend the interchange.</span></span> <span data-ttu-id="576c0-201">EDIFACT エンコード メッセージの場合のこれらのフィールドは、受信者の参照パスワード (UNB6.1 および UNB6.2) です。</span><span class="sxs-lookup"><span data-stu-id="576c0-201">For EDIFACT-encoded messages, these fields are the recipient reference password (UNB6.1 and UNB6.2).</span></span> <span data-ttu-id="576c0-202">X12 エンコード メッセージの場合のこれらのフィールドは、認証修飾子および認証情報 ([ISA1] ～ [ISA2]) とセキュリティ修飾子およびセキュリティ情報 ([ISA3] ～ [ISA4]) です。</span><span class="sxs-lookup"><span data-stu-id="576c0-202">For X12-encoded messages, these fields are the Authorization qualifier and information (ISA1-2) and Security qualifier and information (ISA3-4).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="576c0-203">参照</span><span class="sxs-lookup"><span data-stu-id="576c0-203">See Also</span></span>  
 [<span data-ttu-id="576c0-204">BizTalk Server が EDI メッセージを受信する方法</span><span class="sxs-lookup"><span data-stu-id="576c0-204">How BizTalk Server Receives EDI Messages</span></span>](../core/how-biztalk-server-receives-edi-messages.md)