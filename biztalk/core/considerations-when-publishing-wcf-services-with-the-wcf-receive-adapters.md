---
title: 受信アダプター、WCF を使用した WCF サービス公開する場合の考慮事項 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- publishing, WCF services
- WCF adapters, best practices
- WCF adapters, receive adapters
- WCF services, publishing
- best practices, WCF adapters
ms.assetid: 797b7ffd-534c-4f09-9738-fb17b208bc96
caps.latest.revision: 34
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f9c232f085647d3f69f576232ec9d9adb3b01a2b
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37004083"
---
# <a name="considerations-when-publishing-wcf-services-with-the-wcf-receive-adapters"></a><span data-ttu-id="b0b4a-102">WCF 受信アダプターで WCF サービスを公開する場合の考慮事項</span><span class="sxs-lookup"><span data-stu-id="b0b4a-102">Considerations When Publishing WCF Services with the WCF Receive Adapters</span></span>
<span data-ttu-id="b0b4a-103">このトピックでは、WCF 受信アダプターで WCF サービスを公開する際に考慮する必要がある情報を示します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-103">This topic provides information that you should take into consideration when publishing WCF services with the WCF receive adapters.</span></span>  <span data-ttu-id="b0b4a-104">WCF アダプターを使用してサービスを公開すると、サービスを標準の WCF サービスのように WCF クライアントから呼び出すことができます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-104">Publishing a service using a WCF adapter allows it to be called by a WCF client as if it were a typical WCF service.</span></span>  
  
## <a name="in-process-hosting"></a><span data-ttu-id="b0b4a-105">インプロセス ホスト</span><span class="sxs-lookup"><span data-stu-id="b0b4a-105">In-Process Hosting</span></span>  
 <span data-ttu-id="b0b4a-106">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] プロセス空間 btsntsvc.exe 内で受信場所をホストすると、開発および展開が簡素化されるという利点があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-106">Hosting the receive location within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] process space, btsntsvc.exe, allows the benefits of simplified development and deployment.</span></span> <span data-ttu-id="b0b4a-107">また、IIS でホストするよりも多くのホスト インスタンスが作成されて、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の高可用性機能と負荷分散機能を利用できます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-107">Additionally, it creates more host instances than hosting in IIS to take advantage of the high-availability and load balancing capabilities of  [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  <span data-ttu-id="b0b4a-108">外部でホストでは、 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] IIS のプロセスを参照してください[IIS 分離 WCF 受信アダプタを構成する](../core/configuring-iis-for-the-isolated-wcf-receive-adapters.md)します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-108">For information in hosting outside of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] process in IIS refer to [Configuring IIS for the Isolated WCF Receive Adapters](../core/configuring-iis-for-the-isolated-wcf-receive-adapters.md).</span></span>  
  
## <a name="set-the-isoneway-property-of-wcf-services-published-with-the-wcf-adapters-except-for-the-wcf-netmsmq-receive-adapter-to-false"></a><span data-ttu-id="b0b4a-109">WCF アダプター (WCF-NetMsmq 受信アダプター以外) によって公開された WCF サービスの IsOneWay プロパティを false に設定する</span><span class="sxs-lookup"><span data-stu-id="b0b4a-109">Set the IsOneWay property of WCF services published with the WCF adapters (except for the WCF-NetMsmq receive adapter) to false</span></span>  
 <span data-ttu-id="b0b4a-110">**System.ServiceModel.OperationContractAttribute.IsOneWay** WCF アダプターで公開した WCF サービスのプロパティ-Wcf-netmsmq によって公開されたサービスを除く受信アダプターに設定されている**は true。** — に設定されている**false**一方向の受信場所に対してもします。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-110">The **System.ServiceModel.OperationContractAttribute.IsOneWay** property of WCF services published with the WCF adapters—except for services published with the WCF-NetMsmq receive adapter where it is set to **true** —is set to **false** even for the one-way receive locations.</span></span> <span data-ttu-id="b0b4a-111">場合、 **IsOneWay**プロパティに設定されて**false**を返すメソッドであっても、 **void**応答メッセージで発生します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-111">If the **IsOneWay** property is set to **false**, even methods that return a **void** result in a reply message.</span></span> <span data-ttu-id="b0b4a-112">この場合、インフラストラクチャにより、メソッドが返した呼び出し元に示す空のメッセージが作成および送信されます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-112">In this case, the infrastructure creates and sends an empty message to indicate to the caller that the method has returned.</span></span> <span data-ttu-id="b0b4a-113">この方法により、インフラストラクチャはサービス操作によってスローされた例外をクライアントに返すことができます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-113">Using this approach enables the infrastructure to send exceptions thrown by the service operation back to the client.</span></span>  
  
 <span data-ttu-id="b0b4a-114">これで WCF アダプター (Wcf-netmsmq 受信アダプター) 以外で公開された WCF サービスを使用する**IsOneWay**は**false**、 **IsOneWay**プロパティをクライアント側に設定する必要があります**false**次のようにします。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-114">To consume WCF services published with the WCF adapters (except for the WCF-NetMsmq receive adapter) in which **IsOneWay** is **false**, the **IsOneWay** property on the client side must be set to **false** as follows:</span></span>  
  
```  
[ServiceContract(Namespace="Microsoft.WCF.Documentation")]  
  public interface ISampleService{  
    [OperationContract(IsOneWay=false, ReplyAction="*",Action="…"]  
    string SampleMethod(string msg);  
}  
```  
  
> [!NOTE]
>  <span data-ttu-id="b0b4a-115">の既定値、 **IsOneWay**プロパティは**false**コードでプロパティを指定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-115">Because the default value of the **IsOneWay** property is **false**, you do not have to specify the property in the code.</span></span>  
  
## <a name="the-replyaction-property-of-the-operationcontractattribute-on-the-client-side-should-be-set-to--an-asterisk-when-consuming-wcf-services-published-with-one-way-receive-locations"></a><span data-ttu-id="b0b4a-116">一方向の受信場所で公開される WCF サービスを使用する場合、クライアント側の OperationContractAttribute の ReplyAction プロパティを "\*" (アスタリスク) に設定する必要がある</span><span class="sxs-lookup"><span data-stu-id="b0b4a-116">The ReplyAction property of the OperationContractAttribute on the client side should be set to "\*" (an asterisk) when consuming WCF services published with one-way receive locations</span></span>  
 <span data-ttu-id="b0b4a-117">**System.ServiceModel.OperationContractAttribute.ReplyAction**のプロパティ、 **System.ServiceModel.OperationContractAttribute**の値を指定するクライアント側で使用できます、WCF サービスから応答メッセージの SOAP アクション。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-117">The **System.ServiceModel.OperationContractAttribute.ReplyAction** property of the **System.ServiceModel.OperationContractAttribute** can be used on the client side to specify the value of the SOAP action for the response messages from WCF services.</span></span>  
  
 <span data-ttu-id="b0b4a-118">応答メッセージのアクション ヘッダーに特定の値を指定する (クライアントにこれが応答であることと、実行するアクションを伝えるため) 以外に、文字列 "\*" (アスタリスク) を指定することもできます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-118">In addition to specifying a particular value for the action header of the reply message (to notify the client this is a reply and what action to be taken), you can also specify the string "\*" (an asterisk).</span></span> <span data-ttu-id="b0b4a-119">クライアント アプリケーションでアスタリスクを指定することで、サービスが送信する応答メッセージの応答アクションを検証しないようにクライアントに指示します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-119">Specifying an asterisk in a client application instructs the client not to validate the reply action in response messages that the service sends.</span></span>  
  
 <span data-ttu-id="b0b4a-120">WCF を使用する一方向によって発行されるサービスの受信場所は、プロキシのメソッド、WCF サービスが返す必要があります**void**、その場合、プロキシのメソッドでは、WCF サービスが、呼び出し元に示すために空のメッセージを送信することが必要ですがメソッドが返されます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-120">To consume a WCF service published by a one-way receive location, the proxy method for the WCF service must return **void**, in which case the proxy method expects that the WCF service will send an empty message to indicate to the caller that the method has returned.</span></span> <span data-ttu-id="b0b4a-121">この空のメッセージを受信するプロキシ メソッドの**ReplyAction**のプロパティ、 **OperationContractAttribute**に設定する必要があります"\*"(アスタリスク) 次のようにします。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-121">For the proxy method to receive this empty message, the **ReplyAction** property of the **OperationContractAttribute** should be set to "\*" (an asterisk) as follows:</span></span>  
  
```  
[ServiceContract(Namespace="Microsoft.WCF.Documentation")]  
  public interface ISampleService{  
    [OperationContract(IsOneWay=false, ReplyAction="*",Action="…"]  
    string SampleMethod(string msg);  
}  
```  
  
> [!NOTE]
>  <span data-ttu-id="b0b4a-122">設定する必要はありません、 **ReplyAction**プロパティを"\*"(アスタリスク)、Wcf-netmsmq アダプターの場合、Wcf-netmsmq アダプターが WCF クライアントを設定する必要があるため、 **IsOneWay**プロパティを**true**します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-122">You do not have to set the **ReplyAction** property to "\*" (an asterisk) for the WCF-NetMsmq adapter, because the WCF-NetMsmq adapter requires the WCF clients to set the **IsOneWay** property to **true**.</span></span>  
  
## <a name="an-isolated-host-instance-can-run-only-one-adapter"></a><span data-ttu-id="b0b4a-123">分離ホスト インスタンスは 1 つのアダプターでのみ実行できる</span><span class="sxs-lookup"><span data-stu-id="b0b4a-123">An isolated host instance can run only one adapter</span></span>  
 <span data-ttu-id="b0b4a-124">分離ホスト インスタンスは、1 つのアダプターでのみ実行できます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-124">An isolated host instance can run only one adapter.</span></span> <span data-ttu-id="b0b4a-125">1 つの分離ホストで HTTP、SOAP、WCF などの複数の分離アダプターの受信ハンドラーを構成する場合、複数のアプリケーション プール (各アダプターに 1 つのアプリケーション プール) を作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-125">If you configure the receive handlers of multiple isolated adapters such as HTTP, SOAP, and WCF adapters with one isolated host, you must create multiple application pools, one application pool for each adapter.</span></span> <span data-ttu-id="b0b4a-126">BizTalk 分離ホストの詳細については、[Web サービスを有効にする](../core/enabling-web-services.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-126">For more information about BizTalk isolated hosts, see [Enabling Web Services](../core/enabling-web-services.md).</span></span>  
  
## <a name="use-the-template----content-specified-by-template-option-when-sending-non-xml-content-as-response-messages"></a><span data-ttu-id="b0b4a-127">XML 以外のコンテンツを応答メッセージとして送信する場合は、[テンプレート -- テンプレートで指定されたコンテンツ] オプションを使用する</span><span class="sxs-lookup"><span data-stu-id="b0b4a-127">Use the "Template -- content specified by template" option when sending non-XML content as response messages</span></span>  
 <span data-ttu-id="b0b4a-128">WCF アダプターで**ボディ--BizTalk 応答メッセージ本文**(既定値) オプションは文字データやビットマップ イメージなどの XML 以外のメッセージの送信を許可していません。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-128">The WCF adapters with **Body -- BizTalk response message body** (the default value) option do not allow sending non-XML messages such as character data and bitmap images.</span></span> <span data-ttu-id="b0b4a-129">使用することができます、**テンプレート--テンプレートで指定されたコンテンツ**XML 以外のメッセージを送信する WCF アダプターのオプション。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-129">You can use the **Template -- content specified by template** option for the WCF adapters to send non-XML messages.</span></span> <span data-ttu-id="b0b4a-130">テンプレートを使用する方法の詳細については、[WCF アダプタのメッセージ本文の指定](../core/specifying-the-message-body-for-the-wcf-adapters.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-130">For more information about how to use the template, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
## <a name="setting-up-the-permissions-for-a-wcf-service-published-with-the-wcf-service-publishing-wizard"></a><span data-ttu-id="b0b4a-131">WCF サービス公開ウィザードで公開した WCF サービスに対してアクセス許可を設定する</span><span class="sxs-lookup"><span data-stu-id="b0b4a-131">Setting up the permissions for a WCF service published with the WCF Service Publishing Wizard</span></span>  
 <span data-ttu-id="b0b4a-132">[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] または [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] プラットフォームの WCF サービス公開ウィザードを使用して作成された ASP.NET アプリケーションを使用する場合、WCF サービスの呼び出し時に DLL へのアクセスに関連するエラーが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-132">When using ASP.NET applications created with the WCF Service Publishing Wizard on the [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] or [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] platform, errors relating to accessing DLLs during WCF service invocation may occur.</span></span> <span data-ttu-id="b0b4a-133">通常、これらのエラーは、[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] および [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] の既定のセキュリティの問題に関連しています。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-133">These errors are typically related to issues with default [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] and [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] security.</span></span> <span data-ttu-id="b0b4a-134">これらのエラーの詳細については、Microsoft ヘルプとサポート資料という、"System.IO.FileNotFoundException"エラー時に、クライアント アプリケーションの呼び出しを Web サービス"のヘルプとサポート Web サイトで参照してください[ http://go.microsoft.com/fwlink/?LinkId=43659](http://go.microsoft.com/fwlink/?LinkId=43659).</span><span class="sxs-lookup"><span data-stu-id="b0b4a-134">For more information about these errors, see the Microsoft Help and Support article called "You Receive a "System.IO.FileNotFoundException" Error When the Client Application Calls a Web Service" on the Help and Support Web site at [http://go.microsoft.com/fwlink/?LinkId=43659](http://go.microsoft.com/fwlink/?LinkId=43659).</span></span>  
  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] <span data-ttu-id="b0b4a-135">では、インプロセス ホストと分離ホストのどちらがサービスを実行するかに関係なく、WCF サービスを実行するプロセスに適切なアクセス許可が付与されることが必要です。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-135">requires that the process running the WCF service is granted the appropriate permissions whether an in-process host or an isolated host runs the service.</span></span> <span data-ttu-id="b0b4a-136">[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] および [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] では、分離ホストの既定の Windows グループは分離ホスト ユーザー グループであるため、分離ホスト ユーザー グループにアクセス許可を追加することで、この問題を解決します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-136">Under [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] and [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] the default Windows group for isolated hosts is the Isolated Host Users Group, so adding the permissions to the Isolated Host Users Group should resolve this issue.</span></span>  
  
#### <a name="to-add-the-permissions-to-the-isolated-host-users-group"></a><span data-ttu-id="b0b4a-137">分離ホスト ユーザー グループにアクセス許可を追加するには</span><span class="sxs-lookup"><span data-stu-id="b0b4a-137">To add the permissions to the Isolated Host Users Group</span></span>  
  
1.  <span data-ttu-id="b0b4a-138">Microsoft Windows エクスプローラーで、%windir%\temp ディレクトリを探します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-138">In Microsoft Windows Explorer, locate the %windir%\temp directory.</span></span>  
  
2.  <span data-ttu-id="b0b4a-139">Windir%\temp を右クリックし、をクリックし、**プロパティ**します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-139">Right-click %windir%\temp, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="b0b4a-140">**プロパティ**ダイアログ ボックスで、をクリックして、**セキュリティ**タブ。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-140">In the **Properties** dialog box, click the **Security** tab.</span></span>  
  
4.  <span data-ttu-id="b0b4a-141">をクリックして**追加**を選択します**分離ホスト ユーザー グループ**、順にクリックします**OK**します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-141">Click **Add**, select **the Isolated Host Users Group**, and then click **OK**.</span></span>  
  
## <a name="setting-up-the-permissions-for-a-wcf-receive-location-with-the-wcf-netmsmq-adapter"></a><span data-ttu-id="b0b4a-142">Wcf-netmsmq アダプターを使用した場所を受信する WCF のアクセス許可を設定</span><span class="sxs-lookup"><span data-stu-id="b0b4a-142">Setting up the permissions for a WCF receive location with the WCF-NetMsmq adapter</span></span>  
 <span data-ttu-id="b0b4a-143">NetMsmqBinding を使用する WCF クライアントは、WCF-NetMsmq アダプターによって公開された WCF サービスにメッセージを送信する場合、サービスのキュー マネージャーによって管理されているターゲット キューにこのメッセージの宛先を指定します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-143">When a WCF client using the NetMsmqBinding sends a message to a WCF service published with the WCF-NetMsmq adapter, it addresses the message to the target queue, which is the queue managed by the service's queue manager.</span></span> <span data-ttu-id="b0b4a-144">クライアント上のキュー マネージャーは、メッセージを転送 (または送信) キューに送ります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-144">The queue manager on the client sends the message to a transmission (or outgoing) queue.</span></span> <span data-ttu-id="b0b4a-145">転送キューは、ターゲット キューに転送するためのメッセージを格納する、クライアント側キュー マネージャー上のキューです。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-145">The transmission queue is a queue on the client-side queue manager that stores messages for transmission to the target queue.</span></span>  
  
 <span data-ttu-id="b0b4a-146">サービスのキュー マネージャーは、それが所有するターゲット キューに宛先指定されたメッセージを受け入れて、格納します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-146">The service's queue manager accepts messages addressed to the target queues it owns and stores the messages.</span></span> <span data-ttu-id="b0b4a-147">次に、サービスがターゲット キューからの読み取り要求を行い、キュー マネージャーがメッセージをサービスに配布します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-147">Then, the service makes requests to read from the target queue, and the queue manager delivers the messages to the service.</span></span> <span data-ttu-id="b0b4a-148">そのため、受信場所をホストする BizTalk ホスト インスタンスのサービス アカウントには、ターゲット キューから読み取るためのアクセス許可を与える必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-148">For this reason, the service account for the BizTalk host instance hosting the receive location should have the permissions to read from the target queue.</span></span>  
  
## <a name="use-an-empty-body-path-expression-to-receive-a-soap-message-with-character-data-in-the-content-of-the-soap-body-element"></a><span data-ttu-id="b0b4a-149">SOAP Body 要素のコンテンツに文字データが含まれた SOAP メッセージを受信するには、空のボディ パス式を使用する</span><span class="sxs-lookup"><span data-stu-id="b0b4a-149">Use an empty body path expression to receive a SOAP message with character data in the content of the SOAP Body element</span></span>  
 <span data-ttu-id="b0b4a-150">WCF 受信アダプター、SOAP のコンテンツに文字データの受信応答メッセージから BizTalk メッセージを作成する**本文**要素、次の例で示すようにしておき、**本文のパス式**で空のテキスト ボックス、**メッセージ**WCF アダプター トランスポートのプロパティ ダイアログ ボックスのタブ。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-150">For a WCF receive adapter to create a BizTalk message from an incoming response message with character data in the content of the SOAP **Body** element, as shown in the following example, you should leave the **Body path expression** text box empty on the **Message** tab in the WCF adapter transport properties dialog box.</span></span>  
  
```  
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing">  
    <s:Header>  
      ...  
    </s:Header>  
    <s:Body>Contoso</s:Body>  
</s:Envelope>  
```  
  
 <span data-ttu-id="b0b4a-151">選択した場合、**エンベロープ**または**本文**オプション、アダプター、BizTalk メッセージを作成できません前の受信メッセージから。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-151">If you select the **Envelope** or **Body** option, the adapter cannot create the BizTalk message from the previous incoming message.</span></span> <span data-ttu-id="b0b4a-152">受信 SOAP マーシャリング プロセスでエラーとなったメッセージは保留されないので、このメッセージは保留されません。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-152">The message is not suspended because messages that fail in the inbound SOAP marshaling processing are not suspended.</span></span> <span data-ttu-id="b0b4a-153">ボディ パス式を使用する方法について、**メッセージ** タブを参照してください[WCF アダプタのメッセージ本文の指定](../core/specifying-the-message-body-for-the-wcf-adapters.md)します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-153">For more information about how to use the body path expression on the **Message** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b0b4a-154">BTSNTSvc.exe.config ファイルを構成すると、Windows SDK の TraceViewer ツール (SvcTraceViewer.exe) を使用できます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-154">You can use the TraceViewer tool (SvcTraceViewer.exe) in the Windows SDK by configuring the BTSNTSvc.exe.config.file.</span></span> <span data-ttu-id="b0b4a-155">Windows SDK の詳細についてを参照してください"What is Windows SDK の新" [ http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219)します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-155">For more information about the Windows SDK, see "What's New in the Windows SDK" at [http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219).</span></span> <span data-ttu-id="b0b4a-156">TraceViewer ツールの詳細についてを参照してください「TraceViewer ツール (SvcTraceViewer.exe)」 [ http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218)します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-156">For more information about the TraceViewer tool, see "TraceViewer Tool (SvcTraceViewer.exe)" at [http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218).</span></span>  
  
## <a name="using-schemas-that-reference-other-schemas"></a><span data-ttu-id="b0b4a-157">他のスキーマを参照するスキーマの使用</span><span class="sxs-lookup"><span data-stu-id="b0b4a-157">Using schemas that reference other schemas</span></span>  
 <span data-ttu-id="b0b4a-158">使用することができます、**再定義**、**含める**と**インポート**大規模で複雑な場合は、スキーマになったときに要素またはときに、スキーマを表す、さまざまな種類のインスタンス メッセージでは、共通のいくつかの部分があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-158">You can use the **redefine**, **include**, and **import** elements when your schemas become large and complex, or when the schemas that represent your different types of instance messages have some portions in common.</span></span> <span data-ttu-id="b0b4a-159">小さいスキーマを、取引先と交換するインスタンス メッセージの構造を最終的に定義するスキーマに結合すると便利な場合があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-159">It can be useful to combine smaller schemas into the schemas that ultimately define the structure of the instance messages you plan to exchange with trading partners.</span></span> <span data-ttu-id="b0b4a-160">BizTalk WCF サービス公開ウィザードを使用して、これらのスキーマを WCF サービスとして公開できます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-160">You can publish these schemas as WCF services by using the BizTalk WCF Service Publishing Wizard.</span></span>  
  
 <span data-ttu-id="b0b4a-161">BizTalk プロジェクトから WCF サービスを使用するために必要な BizTalk アイテムを作成するには、BizTalk WCF サービス使用ウィザードを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-161">You should use the BizTalk WCF Service Consuming Wizard to create the BizTalk artifacts necessary to consume the WCF services from a BizTalk project.</span></span> <span data-ttu-id="b0b4a-162">.NET アプリケーションから WCF サービスを使用するには、ServiceModel メタデータ ユーティリティ ツール (Svcutil.exe) を使用して、WCF サービスのプロキシ クラスを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-162">If you want to consume the WCF services from a .NET application, you should use the Service Model Metadata Utility tool (Svcutil.exe) to create the proxy class for the WCF services.</span></span> <span data-ttu-id="b0b4a-163">その他のスキーマを参照するスキーマを使用する方法の詳細については、[を使用して、他のスキーマ](../core/schemas-that-use-other-schemas.md)と[作成を使用して、他のスキーマ方法](../core/how-to-create-schemas-that-use-other-schemas.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-163">For more information about how to use schemas that reference other schemas, see [Schemas That Use Other Schemas](../core/schemas-that-use-other-schemas.md) and [How to Create Schemas That Use Other Schemas](../core/how-to-create-schemas-that-use-other-schemas.md).</span></span> <span data-ttu-id="b0b4a-164">Svcutil.exe の詳細についてを参照してください「サービス モデル メタデータ ユーティリティ ツール (Svcutil.exe)」 [ http://go.microsoft.com/fwlink/?LinkID=74696](http://go.microsoft.com/fwlink/?LinkID=74696)します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-164">For more information about Svcutil.exe, see "Service Model Metadata Utility Tool (Svcutil.exe)" at [http://go.microsoft.com/fwlink/?LinkID=74696](http://go.microsoft.com/fwlink/?LinkID=74696).</span></span>  
  
 <span data-ttu-id="b0b4a-165">次の表は、他のスキーマを使用するスキーマを使って公開された WCF サービスを使用するときに理解しておく必要がある制限と注意点を示しています。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-165">The following table shows the limitations and considerations that you need to know when consuming published WCF services with schemas that use other schemas.</span></span>  
  
|<span data-ttu-id="b0b4a-166">XML スキーマ要素</span><span class="sxs-lookup"><span data-stu-id="b0b4a-166">XML schema element</span></span>|<span data-ttu-id="b0b4a-167">BizTalk WCF サービス公開ウィザードで公開した WCF サービスの使用</span><span class="sxs-lookup"><span data-stu-id="b0b4a-167">Consuming WCF services published with the BizTalk WCF Service Publishing Wizard</span></span>|<span data-ttu-id="b0b4a-168">.NET アプリケーションでホストされる WCF サービスの使用</span><span class="sxs-lookup"><span data-stu-id="b0b4a-168">Consuming WCF services hosted by .NET applications</span></span>|  
|------------------------|-------------------------------------------------------------------------------------|--------------------------------------------------------|  
|<span data-ttu-id="b0b4a-169">\<import\></span><span class="sxs-lookup"><span data-stu-id="b0b4a-169">\<import\></span></span>|<span data-ttu-id="b0b4a-170">BizTalk WCF サービス使用ウィザードと Svcutil.exe の両方でサポート</span><span class="sxs-lookup"><span data-stu-id="b0b4a-170">Supported with both the BizTalk WCF Service Consuming Wizard and Svcutil.exe</span></span>|<span data-ttu-id="b0b4a-171">BizTalk WCF サービス使用ウィザードと Svcutil.exe の両方でサポート</span><span class="sxs-lookup"><span data-stu-id="b0b4a-171">Supported with both the BizTalk WCF Service Consuming Wizard and Svcutil.exe</span></span>|  
|<span data-ttu-id="b0b4a-172">\<include\></span><span class="sxs-lookup"><span data-stu-id="b0b4a-172">\<include\></span></span>|<span data-ttu-id="b0b4a-173">BizTalk WCF サービス使用ウィザードと Svcutil.exe の両方でサポートされている**注:** プロキシ クラスを作成するときに、Svcutil.exe が警告メッセージを発生させる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-173">Supported with both the BizTalk WCF Service Consuming Wizard and Svcutil.exe **Note:**  Svcutil.exe may raise a warning message when creating the proxy class.</span></span>|<span data-ttu-id="b0b4a-174">BizTalk WCF サービス使用ウィザードと Svcutil.exe の両方でサポートされている**注:** プロキシ クラスを作成するときに、Svcutil.exe が警告メッセージを発生させる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-174">Supported with both the BizTalk WCF Service Consuming Wizard and Svcutil.exe **Note:**  Svcutil.exe may raise a warning message when creating the proxy class.</span></span>|  
|<span data-ttu-id="b0b4a-175">\<redefine\></span><span class="sxs-lookup"><span data-stu-id="b0b4a-175">\<redefine\></span></span>|<span data-ttu-id="b0b4a-176">BizTalk WCF サービス使用ウィザードでサポートされています。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-176">-   Supported with the BizTalk WCF Service Consuming Wizard</span></span><br /><span data-ttu-id="b0b4a-177">-Svcutil.exe によってサポートが制限される**に注意してください:** Svcutil.exe が、同じ制限の**redefine** XSD.exe と要素が。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-177">-   Limited support by Svcutil.exe **Note:**  Svcutil.exe has the same limitation for the **redefine** element as XSD.exe has.</span></span>|<span data-ttu-id="b0b4a-178">BizTalk WCF サービス使用ウィザードと Svcutil.exe の両方でサポートされている**注:** プロキシ クラスを作成するときに、Svcutil.exe が警告メッセージを発生させる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-178">Supported with both the BizTalk WCF Service Consuming Wizard and Svcutil.exe **Note:**  Svcutil.exe may raise a warning message when creating the proxy class.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="b0b4a-179">使用してスキーマを公開した BizTalk WCF サービスに対してプロキシ クラスを作成するときに、Svcutil.exe が警告メッセージを発生させる可能性があります、**含める**と**redefine**要素。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-179">Svcutil.exe may raise a warning message when creating the proxy class against the published BizTalk WCF service with the schemas using the **include** and **redefine** elements.</span></span> <span data-ttu-id="b0b4a-180">たとえば、"グローバル要素は既に宣言されています。" などです。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-180">For example, "The global element has already been declared."</span></span>  
  
## <a name="ensure-that-an-in-process-wcf-receive-location-is-not-disabled-after-you-change-the-computer-name-part-in-its-service-endpoint-address"></a><span data-ttu-id="b0b4a-181">サービス エンドポイント アドレスのコンピューター名の部分を変更した場合、インプロセス WCF 受信場所が無効になっていないことを確認する</span><span class="sxs-lookup"><span data-stu-id="b0b4a-181">Ensure that an in-process WCF receive location is not disabled after you change the computer name part in its service endpoint address</span></span>  
 <span data-ttu-id="b0b4a-182">コンピューター名の部分を変更する場合、**アドレス (URI)** プロセスで実行されている WCF のテキスト ボックスの受信場所、受信場所がまだ実行されているかどうかを確認するのには、BizTalk 管理コンソールを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-182">If you change the computer name part in the **Address (URI)** text box of a running in-process WCF receive location, we recommend that you use the BizTalk Administration console to check whether the receive location is still running.</span></span> <span data-ttu-id="b0b4a-183">たとえば、変更した場合、WCF NetTcp を使用してサービスのエンドポイント アドレスは受信アダプター、 **net.tcp://\<**<em>コンピューター名を</em>**\>/samplepath**を**net.tcp://localhost/samplepath**で、受信場所を無効にすることがあります、 **Service.InvalidOperationException**します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-183">For example, if you change a service endpoint address using the WCF-NetTcp receive adapter, **net.tcp://\<**<em>Your Computer Name</em>**\>/samplepath**, to **net.tcp://localhost/samplepath**, the receive location may be disabled with a **Service.InvalidOperationException**.</span></span> <span data-ttu-id="b0b4a-184">パスの部分を変更せずに、サービス エンドポイント アドレスのコンピューター名の部分のみを変更した場合は、受信場所が無効になっていないことを確認し、必要に応じて有効にします。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-184">If you change only the computer name part in the service endpoint address without modifying the path part, make sure that the receive location is not disabled, and enable it if necessary.</span></span>  
  
## <a name="set-the-appropriate-msdtc-security-configuration-options-on-client-computers-communicating-with-remote-wcf-receive-locations-through-a-transaction-protocol"></a><span data-ttu-id="b0b4a-185">トランザクション プロトコルを使用してリモートの WCF 受信場所と通信するクライアント コンピューターで、適切な MSDTC セキュリティ構成オプションを設定する</span><span class="sxs-lookup"><span data-stu-id="b0b4a-185">Set the appropriate MSDTC Security Configuration options on client computers communicating with remote WCF receive locations through a transaction protocol</span></span>  
 <span data-ttu-id="b0b4a-186">Wcf-nettcp、Wcf-wshttp、および Wcf-netnamedpipe 受信アダプターで WCF クライアントを管理するトランザクション調整プロセスに参加できる、 **WS-AtomicTransaction**と**OleTransaction**トランザクション プロトコルです。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-186">WCF-NetTcp, WCF-WSHttp, and WCF-NetNamedPipe receive adapters can participate in transactional coordination processes that WCF clients manage with the **WS-AtomicTransaction** and **OleTransaction** transaction protocols.</span></span> <span data-ttu-id="b0b4a-187">メッセージは、送信先の受信場所に送信したり、トランザクション プロトコルを使用してトランザクション コンテキストでメッセージ ボックス データベースから削除できます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-187">Messages can be transmitted to the destination receive locations and deleted from the MessageBox database in a transactional context by using the transaction protocols.</span></span>  
  
 <span data-ttu-id="b0b4a-188">WCF 受信場所をリモートで通信するためにトランザクション プロトコルを使用して、MSDTC を構成する必要が適切に**セキュリティ構成**WCF クライアント コンピューター上でオプションです。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-188">To communicate with remote WCF receive locations by using the transaction protocols, you must appropriately configure MSDTC **Security Configuration** options on WCF client computers.</span></span> <span data-ttu-id="b0b4a-189">次の表に、必要な値は、MSDTC で使用できるオプションを**セキュリティ構成** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-189">The following table lists the required values for the options that are available in the MSDTC **Security Configuration** dialog box:</span></span>  
  
|<span data-ttu-id="b0b4a-190">構成オプション</span><span class="sxs-lookup"><span data-stu-id="b0b4a-190">Configuration option</span></span>|<span data-ttu-id="b0b4a-191">既定値</span><span class="sxs-lookup"><span data-stu-id="b0b4a-191">Default value</span></span>|<span data-ttu-id="b0b4a-192">推奨値</span><span class="sxs-lookup"><span data-stu-id="b0b4a-192">Recommended value</span></span>|  
|--------------------------|-------------------|-----------------------|  
|<span data-ttu-id="b0b4a-193">ネットワーク DTC アクセス</span><span class="sxs-lookup"><span data-stu-id="b0b4a-193">Network DTC Access</span></span>|<span data-ttu-id="b0b4a-194">Disabled</span><span class="sxs-lookup"><span data-stu-id="b0b4a-194">Disabled</span></span>|<span data-ttu-id="b0b4a-195">有効</span><span class="sxs-lookup"><span data-stu-id="b0b4a-195">Enabled</span></span>|  
|<span data-ttu-id="b0b4a-196">送信を許可する</span><span class="sxs-lookup"><span data-stu-id="b0b4a-196">Allow Outbound</span></span>|<span data-ttu-id="b0b4a-197">Disabled</span><span class="sxs-lookup"><span data-stu-id="b0b4a-197">Disabled</span></span>|<span data-ttu-id="b0b4a-198">有効</span><span class="sxs-lookup"><span data-stu-id="b0b4a-198">Enabled</span></span>|  
|<span data-ttu-id="b0b4a-199">相互認証を必要とする</span><span class="sxs-lookup"><span data-stu-id="b0b4a-199">Mutual Authentication Required</span></span>|<span data-ttu-id="b0b4a-200">有効</span><span class="sxs-lookup"><span data-stu-id="b0b4a-200">Enabled</span></span>|<span data-ttu-id="b0b4a-201">場所が Windows Server 2003 SP1 または SP2 を実行しているしで構成された場合は、対応するリモートの受信が有効な**相互認証を必要**します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-201">Enabled if the corresponding remote receive locations are running Windows Server 2003 SP1 or SP2, and are configured with **Mutual Authentication Required**.</span></span>|  
|<span data-ttu-id="b0b4a-202">着信呼び出し側には認証を必要とする</span><span class="sxs-lookup"><span data-stu-id="b0b4a-202">Incoming Caller Authentication Required</span></span>|<span data-ttu-id="b0b4a-203">Disabled</span><span class="sxs-lookup"><span data-stu-id="b0b4a-203">Disabled</span></span>|<span data-ttu-id="b0b4a-204">クラスター上で MSDTC を実行している場合は有効</span><span class="sxs-lookup"><span data-stu-id="b0b4a-204">Enabled if running MSDTC on a cluster.</span></span>|  
  
 <span data-ttu-id="b0b4a-205">これらの変更を適用した後で、MSDTC サービスを再開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-205">After you apply these changes, you have to restart the MSDTC service.</span></span>  
  
 <span data-ttu-id="b0b4a-206">MSDTC へのアクセスに**セキュリティの構成** ダイアログ ボックスで、これらの手順に従います。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-206">To access the MSDTC **Security Configuration** dialog box, follow these steps:</span></span>  
  
1.  <span data-ttu-id="b0b4a-207">をクリックして**開始**、 をクリックして**実行**、および種類**dcomcnfg**を起動する、**コンポーネント サービス**管理コンソール。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-207">Click **Start**, click **Run**, and type **dcomcnfg** to launch the **Component Services** Management console.</span></span>  
  
2.  <span data-ttu-id="b0b4a-208">展開**コンポーネント サービス**、展開**コンピューター**、右クリックして**マイ コンピューター**、順にクリックします**プロパティ**します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-208">Expand **Component Services**, expand **Computers**, right-click **My Computer**, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="b0b4a-209">**マイ コンピューター プロパティ**ダイアログ ボックスで、をクリックして、 **MSDTC**  タブをクリックして**セキュリティ構成**を表示する、**セキュリティの構成**  ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-209">In the **My Computer Properties** dialog box, click the **MSDTC** tab, and then click **Security Configuration** to display the **Security Configuration** dialog box.</span></span>  
  
## <a name="explanation-of-the-soap-wrapper-when-using-the-biztalk-wcf-service-publishing-wizard"></a><span data-ttu-id="b0b4a-210">BizTalk WCF サービス公開ウィザードを使用する場合の SOAP ラッパーについての説明</span><span class="sxs-lookup"><span data-stu-id="b0b4a-210">Explanation of the SOAP wrapper when using the BizTalk WCF Service Publishing Wizard</span></span>  
 <span data-ttu-id="b0b4a-211">オーケストレーションが [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] サービス公開ウィザードを使用して [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] サービスとして公開されると、ラッパーが生成されます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-211">When an orchestration is exposed as a [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] service by using the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Service Publishing Wizard, a wrapper is generated.</span></span> <span data-ttu-id="b0b4a-212">このラッパーは、XML メッセージでメッセージの送信先のポートのメソッド名を使用します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-212">This wrapper uses the method name of the port in the XML message to which the message is sent.</span></span> <span data-ttu-id="b0b4a-213">このラッパーは Microsoft SOAP エンベロープの既定の設定です。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-213">This wrapper is the default for Microsoft SOAP envelopes.</span></span> <span data-ttu-id="b0b4a-214">ラッパーを使用すると、[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] でマルチパート SOAP メッセージを 1 つの WCF メッセージにラップして、アダプターによってエンドポイントに送信できます。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-214">It allows [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] to wrap the multi-part SOAP message in one WCF message to be transmitted to the endpoint by the adapter.</span></span>  
  
 <span data-ttu-id="b0b4a-215">ベスト プラクティスとして、送信者はラッパーを使用して受信者はそのラッパーを要求するか、送信者はラッパーを使用しないで受信者は生の [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] メッセージを要求します。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-215">As a best practice, either the sender should use a wrapper and the receiver should expect it, or the sender should not use a wrapper and the receiver should expect the raw [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message.</span></span> <span data-ttu-id="b0b4a-216">ラッパーを使用するかどうかについてあらかじめ合意できていないと、送信内容と受信内容が一致しないという問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="b0b4a-216">Failure to agree ahead of time on whether to use a wrapper can cause incompatibility issues between what is sent and what is received.</span></span>