---
title: 指向ソリューションのパターンのサービスの変換 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- patterns [service solutions], translating patterns to orchestration shapes
- artifacts, patterns
- orchestrations, patterns
- patterns [process management solutions], connections
- patterns [service solutions], orchestration boundaries
- patterns [process management solutions], translating patterns to orchestrations
- orchestrations, boundaries
- patterns [service solutions], translating patterns to artifacts
ms.assetid: ff17cc41-2a7b-4304-b5bd-96b1174cea7f
caps.latest.revision: 19
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 95285c93bdb290adbee988305dbcd365e4e729a6
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22280002"
---
# <a name="translating-the-patterns-of-the-service-oriented-solution"></a><span data-ttu-id="78d86-102">指向ソリューションのパターンのサービスの変換</span><span class="sxs-lookup"><span data-stu-id="78d86-102">Translating the Patterns of the Service Oriented Solution</span></span>
<span data-ttu-id="78d86-103">このセクションでは、このソリューションでパターン ダイアグラムがどのように BizTalk Server のアイテムに変換されるかを説明します。</span><span class="sxs-lookup"><span data-stu-id="78d86-103">This section describes how the solution translates the pattern diagram into BizTalk Server artifacts.</span></span>  
  
 <span data-ttu-id="78d86-104">![サービス &#45; 指向のソリューション パターン](../core/media/service-oriented-solution-patterns.gif "Service_Oriented_Solution_Patterns")</span><span class="sxs-lookup"><span data-stu-id="78d86-104">![Service&#45;Oriented Solution Patterns](../core/media/service-oriented-solution-patterns.gif "Service_Oriented_Solution_Patterns")</span></span>  
  
## <a name="connections-and-completeness-conditions"></a><span data-ttu-id="78d86-105">接続および完全性の条件</span><span class="sxs-lookup"><span data-stu-id="78d86-105">Connections and Completeness Conditions</span></span>  
 <span data-ttu-id="78d86-106">BizTalk Server コンポーネントへのパターンの変換は、どこからでも開始できます。</span><span class="sxs-lookup"><span data-stu-id="78d86-106">We can pretty much start anywhere with translating the patterns into BizTalk Server components.</span></span> <span data-ttu-id="78d86-107">ただし、コンポーネントにとっての実質的なインフラストラクチャはコンポーネント間の接続なので、ここから開始することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="78d86-107">However, the connections among the components are, in effect, the infrastructure for the components so that it seems a good place to start.</span></span> <span data-ttu-id="78d86-108">また、アグリゲータ パターンの場合は、必要なすべての情報が揃っていることをどのように示すかを決定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-108">Also, in the case of the aggregator pattern, we need to think about what will tell it that it has all of the information it needs.</span></span> <span data-ttu-id="78d86-109">これは、他のコンポーネントへの接続およびそのデザインに影響を及ぼします。</span><span class="sxs-lookup"><span data-stu-id="78d86-109">This affects both its connections to other components as well as its design.</span></span>  
  
 <span data-ttu-id="78d86-110">ソリューションは、便利で一貫した使用方法を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-110">The solution needs to provide a convenient and consistent way of being used.</span></span> <span data-ttu-id="78d86-111">他のアプリケーションがソリューションをどのように使用するかは、サービス インターフェイスによって指定されます。</span><span class="sxs-lookup"><span data-stu-id="78d86-111">The service interface specifies how other applications can use it.</span></span> <span data-ttu-id="78d86-112">このソリューションでは IBM WebSphere MQ を使用しているレガシ アプリケーションと通信する必要があるので、IBM WebSphere MQ をサービス インターフェイスの一部にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-112">Because the solution needs to communicate with a legacy application using IBM WebSphere MQ, IBM WebSphere MQ needs to be part of the service interface.</span></span> <span data-ttu-id="78d86-113">ところが、これより新しいアプリケーションでは、明らかに Web サービス インターフェイスが選択されているようです。</span><span class="sxs-lookup"><span data-stu-id="78d86-113">However, for newer applications, a Web service interface seems an obvious choice.</span></span> <span data-ttu-id="78d86-114">Web サービス インターフェイスを使用すれば、サービスを使用する他のアプリケーションに対する柔軟性を最大限に高めることができます。</span><span class="sxs-lookup"><span data-stu-id="78d86-114">A Web service interface provides maximum flexibility for other applications using the service.</span></span> <span data-ttu-id="78d86-115">ここでは、BizTalk Server の柔軟性を使用して、デュアル サービス インターフェイスとします。</span><span class="sxs-lookup"><span data-stu-id="78d86-115">Here, we can use the flexibility of BizTalk Server to have a dual service interface.</span></span> <span data-ttu-id="78d86-116">オーケストレーションを Web サービスとして公開する方法については、次を参照してください。 [Web サービスにオーケストレーションをマップする方法](../core/how-to-map-orchestrations-to-web-services.md)です。</span><span class="sxs-lookup"><span data-stu-id="78d86-116">For information about exposing orchestrations as Web services, see [How to Map Orchestrations to Web Services](../core/how-to-map-orchestrations-to-web-services.md).</span></span>  
  
 <span data-ttu-id="78d86-117">その他に、サービス インターフェイスと受信者の一覧の間の接続、受信者の一覧とバックエンド アプリケーションの間の接続、およびバックエンド アプリケーション、アグリゲータ、サービス インターフェイス間の接続があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-117">The other connections are those between the service interface and the recipient list, between the recipient list and the back-end applications, and among the back-end applications, aggregator, and the service interface.</span></span>  
  
 <span data-ttu-id="78d86-118">受信者の一覧への接続が同期接続である場合、受信者の一覧へのすべてのメッセージの送受信が確実に行われるように関連付けを使用する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="78d86-118">If the connection to the recipient list is synchronous, the solution does not need to use correlations to ensure all messages to the recipient list are sent and received.</span></span> <span data-ttu-id="78d86-119">同じ理由で、バックエンド アプリケーションと、アグリゲーター間の接続は同期していることができます。</span><span class="sxs-lookup"><span data-stu-id="78d86-119">The connections between the back-end applications and the aggregator can be synchronous for the same reasons.</span></span> <span data-ttu-id="78d86-120">アグリゲータは、クエリの応答を完了するために、3 つのバックエンド アプリケーションすべてからの応答を必要とします。</span><span class="sxs-lookup"><span data-stu-id="78d86-120">The aggregator needs the responses from all three of the back-end applications to complete the query response.</span></span> <span data-ttu-id="78d86-121">同期接続を適切に行い、ソリューションを単純化するために応答時間を短縮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-121">Response times should be short so that synchronous connections are appropriate and simplify the solution.</span></span>  
  
 <span data-ttu-id="78d86-122">通常、アグリゲータ パターンには、完全性条件が存在します。</span><span class="sxs-lookup"><span data-stu-id="78d86-122">In the aggregator pattern, there is usually a completeness condition.</span></span> <span data-ttu-id="78d86-123">複数のバックエンド サーバーが存在し、応答時間が遅い場合は、たとえば、一定の期間内に 1 つ以上の応答を受信することなどが完全性条件になります。</span><span class="sxs-lookup"><span data-stu-id="78d86-123">In cases where there are multiple back-end servers and response times are slow, the completeness condition might be, for example, receiving at least one response in a given time period.</span></span> <span data-ttu-id="78d86-124">このサービス指向ソリューションでは、最終的なメッセージを構築するために 3 つの応答すべてが必要になります。</span><span class="sxs-lookup"><span data-stu-id="78d86-124">This service-oriented solution requires all three responses in order to construct the final message.</span></span> <span data-ttu-id="78d86-125">したがって、この場合の完全性条件は、3 つの応答すべてを受信することです。</span><span class="sxs-lookup"><span data-stu-id="78d86-125">Thus, here, the completeness condition is receiving all three responses.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="78d86-126">IBM WebSphere MQ 経由で要求を受信するときに、ソリューションはコピーして関連付け識別子を追加、 **MQMD_MsgId**値を**MQMD_CorrelId**応答メッセージのです。</span><span class="sxs-lookup"><span data-stu-id="78d86-126">When receiving requests through IBM WebSphere MQ, the solution adds a correlation identifier by copying the **MQMD_MsgId** value to the **MQMD_CorrelId** of the response message.</span></span> <span data-ttu-id="78d86-127">これは、予想される競合状態を回避するために要求 - 応答で IBM MQSeries アダプタを使用する標準的な方法の一部です。</span><span class="sxs-lookup"><span data-stu-id="78d86-127">This is part of the standard way of using the MQSeries adapter in request-reply to avoid a possible race condition.</span></span> <span data-ttu-id="78d86-128">詳細については、次を参照してください。[を相互に関連付けるメッセージを使用して要求/応答](../core/correlating-messages-using-request-reply.md)です。</span><span class="sxs-lookup"><span data-stu-id="78d86-128">For more information, see [Correlating Messages Using Request-Reply](../core/correlating-messages-using-request-reply.md).</span></span>  
  
## <a name="determining-orchestration-boundaries"></a><span data-ttu-id="78d86-129">オーケストレーションの境界の決定</span><span class="sxs-lookup"><span data-stu-id="78d86-129">Determining Orchestration Boundaries</span></span>  
 <span data-ttu-id="78d86-130">ソリューションは、Web サービス インターフェイスを使用する要求だけでなく、IBM WebSphere MQ キューからの要求も許可する必要があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-130">The solution must allow for requests from an IBM WebSphere MQ queue as well as through the Web service interface.</span></span> <span data-ttu-id="78d86-131">サービス インターフェイスを 1 つのオーケストレーションに配置し、IBM WebSphere MQ 入力を別のオーケストレーションに配置して、処理の大部分を 3 番目のオーケストレーションに配置すると、外部通信が処理から切り離されます。</span><span class="sxs-lookup"><span data-stu-id="78d86-131">Putting the service interface into one orchestration, the IBM WebSphere MQ input into another, and the bulk of the processing into a third keeps the external communication separated from the processing.</span></span>  
  
## <a name="translating-the-components-into-orchestration-shapes"></a><span data-ttu-id="78d86-132">コンポーネントのオーケストレーション図形への変換</span><span class="sxs-lookup"><span data-stu-id="78d86-132">Translating the Components into Orchestration Shapes</span></span>  
 <span data-ttu-id="78d86-133">図形に変換するパターンはすべて、最終的なソリューションでは単一のオーケストレーションに含められます。</span><span class="sxs-lookup"><span data-stu-id="78d86-133">The patterns to translate into shapes will, in the final solution, be in a single orchestration.</span></span> <span data-ttu-id="78d86-134">メッセージ ボックス サブスクリプションを作成するなど、コンテンツ ベースのルーターを BizTalk Server に作成する方法は多数あります。</span><span class="sxs-lookup"><span data-stu-id="78d86-134">There are numerous ways to create a content-based router in BizTalk Server, including creating MessageBox subscriptions.</span></span> <span data-ttu-id="78d86-135">このソリューションでは、メッセージ ボックス サブスクリプションを使用してルーティングが行われます。</span><span class="sxs-lookup"><span data-stu-id="78d86-135">In the solution, the routing uses MessageBox subscriptions.</span></span> <span data-ttu-id="78d86-136">式図形は、必須フィールドの値がメッセージに含まれているかどうかを評価します。</span><span class="sxs-lookup"><span data-stu-id="78d86-136">An expression shape evaluates whether or not the message includes values for the required fields.</span></span> <span data-ttu-id="78d86-137">判断図形は、式図形内の変数セットを評価し、オーケストレーションを使用してパスを選択します。</span><span class="sxs-lookup"><span data-stu-id="78d86-137">A decision shape evaluates the variable set in the expression shape and selects the path through the orchestration.</span></span>  
  
 <span data-ttu-id="78d86-138">**CustomerService**オーケストレーションでは、並列図形を使用してバックエンド アプリケーションにメッセージを送信し、同時に応答を受信します。</span><span class="sxs-lookup"><span data-stu-id="78d86-138">The **CustomerService** orchestration uses the parallel shape to send messages to the backend applications and receive responses simultaneously.</span></span> <span data-ttu-id="78d86-139">次の要求を行う前に 1 つのアプリケーションが完了するまで待機する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="78d86-139">It does not have to wait on one application finishing before making the next request.</span></span> <span data-ttu-id="78d86-140">アプリケーションの数が頻繁に変更されたり、アプリケーションへの通信の信頼性が低い場合は、オーケストレーションはパターンを個別に変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-140">If the number of applications were to change frequently, or if the connections to the applications were unreliable, then the orchestration would need to translate the pattern differently.</span></span>  
  
 <span data-ttu-id="78d86-141">このソリューションで、アグリゲータは 3 つの応答メッセージの要素を結合する必要があります。</span><span class="sxs-lookup"><span data-stu-id="78d86-141">In the solution the aggregator must combine elements from three response messages.</span></span> <span data-ttu-id="78d86-142">並列図形を使用すると、バックエンド システムとの通信は並列になります。</span><span class="sxs-lookup"><span data-stu-id="78d86-142">Using the parallel shape ensures that the communication with the back-end systems is parallel.</span></span> <span data-ttu-id="78d86-143">また、図形はすべての応答を受信するかタイムアウトが発生するまで終了しないので、アグリゲータは処理を進めることができるタイミングを常に認識しています。</span><span class="sxs-lookup"><span data-stu-id="78d86-143">And, because the shape does not terminate until it receives all responses or a timeout, the aggregator will always know when it can proceed.</span></span> <span data-ttu-id="78d86-144">オーケストレーションは、次の 3 つのバックエンド応答メッセージと元の要求メッセージから応答メッセージ内の要素までの要素をマップする変換図形を使用します。</span><span class="sxs-lookup"><span data-stu-id="78d86-144">The orchestration uses a transform shape that maps elements from the three backend response messages and the original request message to elements in the response message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="78d86-145">バックエンド システムとの通信でタイムアウトが発生する場合もあります。タイムアウト期間を設定するにはそれを囲むによって、**受信**図形に、**スコープ**図形と設定、**タイムアウト**スコープのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="78d86-145">The communications with the back-end systems may also time out. You can set the time-out period by enclosing the **Receive** shape in a **Scope** shape and setting the **Timeout** property of the scope.</span></span>  
  
 <span data-ttu-id="78d86-146">オーケストレーション図形の一覧については、次を参照してください。[オーケストレーション図形](../core/orchestration-shapes.md)です。</span><span class="sxs-lookup"><span data-stu-id="78d86-146">For a complete list of orchestration shapes, see [Orchestration Shapes](../core/orchestration-shapes.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="78d86-147">参照</span><span class="sxs-lookup"><span data-stu-id="78d86-147">See Also</span></span>  
 <span data-ttu-id="78d86-148">[パターンで、サービス指向ソリューション](../core/patterns-in-the-service-oriented-solution.md) </span><span class="sxs-lookup"><span data-stu-id="78d86-148">[Patterns in the Service Oriented Solution](../core/patterns-in-the-service-oriented-solution.md) </span></span>  
 [<span data-ttu-id="78d86-149">コンポーネントのサービス指向ソリューション</span><span class="sxs-lookup"><span data-stu-id="78d86-149">Components of the Service Oriented Solution</span></span>](../core/components-of-the-service-oriented-solution.md)