---
title: SSO と BizTalk ホストで同じクラスター グループ 1 のクラスター化する方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 413cc8f4-f343-4c1c-8b79-3b15cb4c101d
caps.latest.revision: 44
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 554f6a6515b9b586387c85e040b051e528a9db8b
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36966971"
---
# <a name="how-to-cluster-sso-and-a-biztalk-host-in-the-same-cluster-group"></a><span data-ttu-id="20291-102">SSO と BizTalk ホストを同じクラスター グループでクラスター化する方法</span><span class="sxs-lookup"><span data-stu-id="20291-102">How to Cluster SSO and a BizTalk Host in the Same Cluster Group</span></span>
<span data-ttu-id="20291-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では、1 つ以上の BizTalk ホストとエンタープライズ シングル サインオン (SSO) サービスを同じ Windows Server クラスターでクラスター化できます。</span><span class="sxs-lookup"><span data-stu-id="20291-103">With [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] you can cluster one or more BizTalk hosts and the Enterprise Single Sign-On (SSO) service on the same Windows Server cluster.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="20291-104">この方法を正しく実装するには、BizTalk ホスト インスタンスと SSO サービスを、同じクラスター グループのクラスター リソースとして作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="20291-104">Correct implementation of this strategy requires that you create any BizTalk host instances and the SSO service as cluster resources in the same cluster group.</span></span>  
  
 <span data-ttu-id="20291-105">1 つ以上の BizTalk ホストと SSO で Windows クラスタリングを使用するシナリオは、通常、以下のいずれかに分類されます。</span><span class="sxs-lookup"><span data-stu-id="20291-105">The use of Windows Clustering with one or more BizTalk hosts and SSO typically falls into one of these categories:</span></span>  
  
1. <span data-ttu-id="20291-106">SSO マスター シークレット サーバーと 1 つ以上の BizTalk ホストを同じクラスター グループでクラスター化する。</span><span class="sxs-lookup"><span data-stu-id="20291-106">Clustering the SSO master secret server and one or more BizTalk hosts in the same cluster group.</span></span>  
  
    <span data-ttu-id="20291-107">このシナリオでは、クラスター グループがフェールオーバーする場合のすべてのリソースがグループと共に移動できるように、クラスター化された BizTalk ホストとクラスター化された SSO サービスの依存関係が維持されます。</span><span class="sxs-lookup"><span data-stu-id="20291-107">In this scenario, the dependency between the clustered BizTalk hosts and the clustered SSO service is maintained so that if the cluster group is failed over, all resources move with the group.</span></span>  
  
    <span data-ttu-id="20291-108">SSO サービスが [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] コンピューターでクラスター化リソースとして構成されている場合、クラスター化された IIS Web サービスを同じクラスター グループで作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="20291-108">If the SSO service is configured as a clustered resource on a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, you must create a clustered IIS web service in the same cluster group.</span></span> <span data-ttu-id="20291-109">これは、すべての分離ホスト インスタンスが、SSO サービスを実行しているクラスター ノードで実行されるようにする必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="20291-109">This must be done to ensure that all isolated host instances will run on the cluster node that the SSO service is running on.</span></span> <span data-ttu-id="20291-110">これにより、分離ホスト インスタンスが IIS で実行されるので、分離ホスト インスタンスで実行されるアダプターは SSO サービスにアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="20291-110">This ensures that any adapters that run in an isolated host instance will have access to the SSO service since isolated host instances run in IIS.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="20291-111">BizTalk ホストのクラスター化されていないインスタンスが、SSO サービスのクラスター化されたインスタンスを実行している同じクラスター ノードで実行している場合、BizTalk ホストのクラスター化されていないインスタンスが停止しない限り、SSO サービスのクラスター化されたインスタンスはフェールオーバーしたことはできません。</span><span class="sxs-lookup"><span data-stu-id="20291-111">If an unclustered instance of a BizTalk host is running on the same cluster node that a clustered instance of the SSO service is running, the clustered instance of the SSO service cannot be failed over unless the unclustered instance of the BizTalk host is stopped.</span></span> <span data-ttu-id="20291-112">BizTalk ホストのクラスター化されていないインスタンスでは、クラスター ノードで実行されている SSO サービスのクラスター化されたインスタンスの依存を維持し、SSO サービスのクラスター化されたインスタンスにフェールオーバーを防ぎます。</span><span class="sxs-lookup"><span data-stu-id="20291-112">An unclustered instance of the BizTalk host maintains a dependency upon the clustered instance of the SSO service running on the cluster node and prevents the clustered instance of the SSO service from failing over.</span></span> <span data-ttu-id="20291-113">そのため、SSO サービスのクラスター化インスタンスが実行されているのと同じクラスター ノードで実行するように、BizTalk ホストのクラスター化されていないインスタンスを作成しないことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="20291-113">For this reason, it is recommended that you do not create an unclustered instance of a BizTalk host to run on the same cluster node that is running a clustered instance of the SSO service.</span></span>  
  
2. <span data-ttu-id="20291-114">SSO サービス (マスター シークレット サーバー以外) と 1 つ以上の BizTalk ホストを同じクラスター グループでクラスター化する。</span><span class="sxs-lookup"><span data-stu-id="20291-114">Clustering the SSO service (non master secret server) and one or more BizTalk hosts in the same cluster group.</span></span> <span data-ttu-id="20291-115">このシナリオでは、リモートのマスター シークレット サーバーが使用できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="20291-115">This scenario requires that a remote master secret server be available.</span></span> <span data-ttu-id="20291-116">このシナリオでは、クラスター化された BizTalk ホストとクラスター化された SSO サービスの依存関係が保持されるため、クラスター グループがフェールオーバーされると、すべてのリソースがグループと共に移動します。</span><span class="sxs-lookup"><span data-stu-id="20291-116">In this scenario, the dependency between the clustered BizTalk hosts and the clustered SSO service is maintained so if the cluster group is failed over, all resources move with the group.</span></span>  
  
    <span data-ttu-id="20291-117">SSO サービスが [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] コンピューターでクラスター化リソースとして構成されている場合、クラスター化された IIS Web サービスを同じクラスター グループで作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="20291-117">If the SSO service is configured as a clustered resource on a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, you must create a clustered IIS web service in the same cluster group.</span></span> <span data-ttu-id="20291-118">これは、すべての分離ホスト インスタンスが、SSO サービスを実行しているクラスター ノードで実行されるようにする必要があるためです。</span><span class="sxs-lookup"><span data-stu-id="20291-118">This must be done to ensure that all isolated host instances will run on the cluster node that the SSO service is running on.</span></span> <span data-ttu-id="20291-119">これにより、分離ホスト インスタンスが IIS で実行されるので、分離ホスト インスタンスで実行されるアダプターは SSO サービスにアクセスできるようになります。</span><span class="sxs-lookup"><span data-stu-id="20291-119">This ensures that any adapters that run in an isolated host instance will have access to the SSO service since isolated host instances run in IIS.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="20291-120">SSO サービスのクラスター化インスタンスが実行されているのと同じクラスター ノードで、BizTalk ホストのクラスター化されていないインスタンスが実行されている場合、SSO サービスのクラスター化インスタンスは、BizTalk ホストのクラスター化されていないインスタンスが停止している場合を除き、フェールオーバーできません。</span><span class="sxs-lookup"><span data-stu-id="20291-120">If an unclustered instance of a BizTalk host is running on the same cluster node that a clustered instance of the SSO service is running then the clustered instance of the SSO service cannot be failed over unless the unclustered instance of the BizTalk host is stopped.</span></span> <span data-ttu-id="20291-121">BizTalk ホストのクラスター化されていないインスタンスでは、クラスター ノードで実行されている SSO サービスのクラスター化インスタンスの依存関係を維持し、SSO サービスのクラスター化インスタンスがフェールオーバーされるのを防ぎます。</span><span class="sxs-lookup"><span data-stu-id="20291-121">An un-clustered instance of the BizTalk host maintains a dependency upon the clustered instance of the SSO service running on the cluster node and prevents the clustered instance of the SSO service from failing over.</span></span> <span data-ttu-id="20291-122">このため、いない SSO サービスのクラスター化されたインスタンスを実行している同じクラスター ノードで実行する BizTalk ホストのクラスター化されていないインスタンスを作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="20291-122">For this reason, it is recommended that you not create a unclustered instance of a BizTalk host to run on the same cluster node that is running a clustered instance of the SSO service.</span></span>  
  
3. <span data-ttu-id="20291-123">SSO サービスをクラスター化せずに、Windows Server クラスターで 1 つ以上の BizTalk ホストをクラスター化する。</span><span class="sxs-lookup"><span data-stu-id="20291-123">Clustering one or more BizTalk hosts on a Windows Server cluster without clustering the SSO service.</span></span> <span data-ttu-id="20291-124">このシナリオでは、1 つ以上の BizTalk ホストがクラスター リソースとして構成されますが、SSO サービスはクラスター化リソースとして構成されません。</span><span class="sxs-lookup"><span data-stu-id="20291-124">In this scenario, one or more BizTalk hosts are configured as cluster resources but the SSO service is not configured as a clustered resource.</span></span> <span data-ttu-id="20291-125">この仕様により、クラスター化された BizTalk ホストの高可用性は実現されますが、SSO サービスの高可用性は実現されません。</span><span class="sxs-lookup"><span data-stu-id="20291-125">This design provides high availability for the clustered BizTalk hosts but does not provide high availability for the SSO service.</span></span> <span data-ttu-id="20291-126">このシナリオでは、あるノードの SSO サービスが失敗した場合、そのノードの SSO に依存している BizTalk Server コンポーネントも失敗します。</span><span class="sxs-lookup"><span data-stu-id="20291-126">In this scenario, if the SSO service on a node fails then BizTalk Server components that depend on SSO on that node will also fail.</span></span> <span data-ttu-id="20291-127">詳細については、BizTalk Server ホストをクラスター リソースとして構成する方法についてを参照してください。 [BizTalk ホストをクラスター リソースとして構成する方法](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)します。</span><span class="sxs-lookup"><span data-stu-id="20291-127">For more information about how to configure a BizTalk Server host as a cluster resource see [How to Configure a BizTalk Host as a Cluster Resource](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3).</span></span>  
  
   <span data-ttu-id="20291-128">BizTalk ホストと SSO サービスを同じ Windows Server クラスターでクラスター化するために実行する必要がある手順を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="20291-128">The following procedures describe the steps that you should follow to cluster a BizTalk host and the SSO service on the same Windows Server cluster.</span></span>  
  
### <a name="to-cluster-a-biztalk-host-and-the-sso-master-secret-server-on-the-same-windows-server-cluster"></a><span data-ttu-id="20291-129">BizTalk ホストと SSO マスター シークレット サーバーを同じ Windows Server クラスターでクラスター化するには</span><span class="sxs-lookup"><span data-stu-id="20291-129">To cluster a BizTalk host and the SSO master secret server on the same Windows Server cluster</span></span>  
  
1. <span data-ttu-id="20291-130">クラスター化された分散トランザクション コーディネーター (MSDTC) リソースをクラスターが構成されていない場合で MSDTC をクラスター、Windows Server フェールオーバー クラスターで次の手順に従って、[チェックリスト: Windows Server 2008 での MS DTC リソースの作成フェールオーバー クラスター](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677)します。</span><span class="sxs-lookup"><span data-stu-id="20291-130">If the cluster is not configured with a clustered Distributed Transaction Coordinator (MSDTC) resource, cluster MSDTC on a Windows Server failover cluster by following the steps in [Checklist: Creating an MS DTC Resource in a Windows Server 2008 Failover Cluster](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677).</span></span>  
  
2. <span data-ttu-id="20291-131">インストールし、次の手順に従って、Windows Server クラスターで SSO サービスを構成[マスター シークレット サーバーをクラスター化する方法](http://msdn.microsoft.com/library/59895616-4178-46d0-b9ff-95589b809ff5)します。</span><span class="sxs-lookup"><span data-stu-id="20291-131">Install and configure the SSO service on the Windows Server cluster by following the steps in [How to Cluster the Master Secret Server](http://msdn.microsoft.com/library/59895616-4178-46d0-b9ff-95589b809ff5).</span></span> <span data-ttu-id="20291-132">Windows Server クラスターで BizTalk Server を実行するため、この時点で SSO コンポーネントのみを構成する場合でも、必要な BizTalk Server コンポーネントをすべてインストールしてください。</span><span class="sxs-lookup"><span data-stu-id="20291-132">Since you will be running BizTalk Server on the Windows Server cluster, install all required BizTalk Server components even though you will only be configuring the SSO components at this time.</span></span>  
  
3. <span data-ttu-id="20291-133">IIS をクラスター、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]に記載されている手順に従ってコンピューター[マイクロソフト サポート技術情報の記事 970759「を構成する IIS 7.0 では Microsoft Windows Server 2008 フェールオーバー クラスター」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (<http://go.microsoft.com/fwlink/p/?LinkId=152793>)。</span><span class="sxs-lookup"><span data-stu-id="20291-133">Cluster IIS on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer by following the steps documented in [Microsoft Knowledge Base article 970759 "Configuring IIS 7.0 in a Microsoft Windows Server 2008 failover cluster"](http://go.microsoft.com/fwlink/p/?LinkId=152793) (<http://go.microsoft.com/fwlink/p/?LinkId=152793>).</span></span> <span data-ttu-id="20291-134">同じクラスター グループ内のクラスター化された IIS Web サービスを、クラスター化された SSO サービスとして作成します。</span><span class="sxs-lookup"><span data-stu-id="20291-134">Create the clustered IIS Web service in the same cluster group as the clustered SSO service.</span></span>  
  
4. <span data-ttu-id="20291-135">クラスターのノードの 1 つにクラスター化された SSO サービスを含むクラスター グループに移動し、このクラスター ノードにログオンします。</span><span class="sxs-lookup"><span data-stu-id="20291-135">Move the cluster group that contains the clustered SSO service to one of the cluster nodes, and log on to this cluster node.</span></span>  
  
5. <span data-ttu-id="20291-136">このクラスター ノードで BizTalk Server 構成プログラムを起動し、BizTalk Server の構成を完了します。</span><span class="sxs-lookup"><span data-stu-id="20291-136">Start the BizTalk Server Configuration program, and complete the configuration of BizTalk Server on this cluster node.</span></span> <span data-ttu-id="20291-137">これは、グループ内の最初の BizTalk Server コンピューターであるため、クリックして**新しい BizTalk グループを作成**BizTalk グループを構成するときにします。</span><span class="sxs-lookup"><span data-stu-id="20291-137">Since this is the first BizTalk Server computer in the group, click **Create a new BizTalk Group** when configuring the BizTalk Group.</span></span>  
  
6. <span data-ttu-id="20291-138">BizTalk Server 構成が正常に完了したら、クラスター化された SSO サービスを含むクラスター グループを他のクラスター ノードに移動して、このクラスター ノードにログオンします。</span><span class="sxs-lookup"><span data-stu-id="20291-138">Once the BizTalk Server configuration has completed successfully, move the cluster group that contains the clustered SSO service to the other cluster node, and log on to this cluster node.</span></span>  
  
7. <span data-ttu-id="20291-139">このクラスター ノードで BizTalk Server 構成プログラムを起動し、BizTalk Server の構成を完了します。</span><span class="sxs-lookup"><span data-stu-id="20291-139">Start the BizTalk Server Configuration program, and complete the configuration of BizTalk Server on this cluster node.</span></span> <span data-ttu-id="20291-140">クリックして**既存の BizTalk グループに参加**このクラスター ノードで、BizTalk グループ コンポーネントを構成するときに最初のノードで作成した BizTalk グループを指定します。</span><span class="sxs-lookup"><span data-stu-id="20291-140">Click **Join an existing BizTalk Group** when configuring the BizTalk Group component on this cluster node, and specify the BizTalk group that you created on the first node.</span></span>  
  
8. <span data-ttu-id="20291-141">BizTalk Server の構成が正常に完了すると 1 つを作成または次の手順に従って、BizTalk ホストをクラスター化の詳細は[BizTalk ホストをクラスター リソースとして構成する方法](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)します。</span><span class="sxs-lookup"><span data-stu-id="20291-141">Once the BizTalk Server configuration has completed successfully, create one or more clustered BizTalk hosts by following the steps in [How to Configure a BizTalk Host as a Cluster Resource](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3).</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="20291-142">このシナリオでは、クラスター化された SSO サービス リソースと同じクラスター グループ内のクラスター リソースとして、すべての BizTalk ホストを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="20291-142">In this scenario, all BizTalk hosts must be created as cluster resources in the same cluster group as the clustered SSO service resource.</span></span> <span data-ttu-id="20291-143">SSO サービスがクラスター化されていない Windows Server クラスター ノードで、非クラスター化 BizTalk ホスト インスタンスを実行することは、構成上サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="20291-143">Running a unclustered BizTalk host instance on a Windows Server Cluster node where the SSO service is clustered is not a supported configuration.</span></span> <span data-ttu-id="20291-144">これは、SSO サービス上の BizTalk ホスト インスタンスの依存関係が原因で、クラスター化された SSO サービスが他のノードにフェールオーバーするときに、クラスター化されていない BizTalk ホスト インスタンスが失敗するためです。</span><span class="sxs-lookup"><span data-stu-id="20291-144">This is because the unclustered BizTalk host instance will fail when the clustered SSO service is failed over to another node due to the dependency of a BizTalk host instance on the SSO service.</span></span>  
  
### <a name="to-cluster-a-biztalk-host-and-sso-non-master-secret-server-on-the-same-windows-server-cluster-when-the-sso-master-secret-server-is-remote"></a><span data-ttu-id="20291-145">SSO マスター シークレット サーバーがリモートに存在するときに BizTalk ホストと SSO (マスター シークレット サーバー以外) を同じ Windows Server クラスターでクラスター化するには</span><span class="sxs-lookup"><span data-stu-id="20291-145">To cluster a BizTalk host and SSO (non master secret server) on the same Windows Server cluster when the SSO master secret server is remote</span></span>  
  
1. <span data-ttu-id="20291-146">クラスター化された分散トランザクション コーディネーター (MSDTC) リソースをクラスターが構成されていない場合で MSDTC をクラスター、Windows Server フェールオーバー クラスターで次の手順に従って、[チェックリスト: Windows Server 2008 での MS DTC リソースの作成フェールオーバー クラスター](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677)します。</span><span class="sxs-lookup"><span data-stu-id="20291-146">If the cluster is not configured with a clustered Distributed Transaction Coordinator (MSDTC) resource, cluster MSDTC on a Windows Server failover cluster by following the steps in [Checklist: Creating an MS DTC Resource in a Windows Server 2008 Failover Cluster](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677).</span></span>  
  
2. <span data-ttu-id="20291-147">ドメイン グループを作成、名前を持つ**SSO 管理者**と**SSO 関連管理者**します。</span><span class="sxs-lookup"><span data-stu-id="20291-147">Create domain groups with the names **SSO Administrators** and **SSO Affiliate Administrators**.</span></span> <span data-ttu-id="20291-148">SSO サービスのクラスター化されたインスタンスを作成するには、作成する必要があります、 **SSO 管理者**と**SSO 関連管理者**ドメイン グループとしてグループ。</span><span class="sxs-lookup"><span data-stu-id="20291-148">To create a clustered instance of the SSO service, you must create the **SSO Administrators** and **SSO Affiliate Administrators** groups as domain groups.</span></span>  
  
3. <span data-ttu-id="20291-149">作成またはのメンバであるドメイン アカウントを指定、 **SSO 管理者**ドメイン グループです。</span><span class="sxs-lookup"><span data-stu-id="20291-149">Create or designate a domain account that is a member of the **SSO Administrators** domain group.</span></span> <span data-ttu-id="20291-150">各ノードの SSO サービスは、このドメイン アカウントとしてログオンするように構成されます。</span><span class="sxs-lookup"><span data-stu-id="20291-150">The SSO service on each node will be configured to log on as this domain account.</span></span> <span data-ttu-id="20291-151">このアカウントが必要、**サービスとしてログオン**クラスター内の各ノードで右。</span><span class="sxs-lookup"><span data-stu-id="20291-151">This account must have the **Log on as a service** right on each node in the cluster.</span></span>  
  
4. <span data-ttu-id="20291-152">ドメインにインストールおよび構成プロセス中にログオンに使用しているアカウントを追加**SSO 管理者**グループ。</span><span class="sxs-lookup"><span data-stu-id="20291-152">Add the account that you are using to log on during the installation and configuration process to the domain **SSO Administrators** group.</span></span>  
  
   > [!IMPORTANT]
   >  <span data-ttu-id="20291-153">手順 3. および手順 4. を完了しないと、SSO サービスの構成が失敗します。</span><span class="sxs-lookup"><span data-stu-id="20291-153">Configuration of the SSO service will fail if steps 3 and 4 are not completed.</span></span>  
  
5. <span data-ttu-id="20291-154">クラスター ノードの 1 つにログオンし、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] をインストールします。</span><span class="sxs-lookup"><span data-stu-id="20291-154">Log on to one of the cluster nodes and install [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="20291-155">インストールが正常に完了したら、構成プログラムを起動するオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="20291-155">Select the option to start the configuration program when installation has completed successfully.</span></span>  
  
6. <span data-ttu-id="20291-156">選択、**カスタム構成**オプションし、の適切な値を入力して、**データベース サーバー名**、**ユーザー名**と**パスワード**フィールド。</span><span class="sxs-lookup"><span data-stu-id="20291-156">Choose the **Custom Configuration** option and enter the appropriate values for the **Database server name**, **User name** and **Password** fields.</span></span> <span data-ttu-id="20291-157">これらの値を入力した後にをクリックして、**構成**続行ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="20291-157">After entering these values click the **Configure** button to continue.</span></span>  
  
7. <span data-ttu-id="20291-158">SSO の機能に次のオプションを設定します。</span><span class="sxs-lookup"><span data-stu-id="20291-158">Set the following options for the SSO feature:</span></span>  
  
   1.  <span data-ttu-id="20291-159">横のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオン コンピューターこの**します。</span><span class="sxs-lookup"><span data-stu-id="20291-159">Select the check the box next to **Enable Enterprise Single Sign-On on this computer**.</span></span>  
  
   2.  <span data-ttu-id="20291-160">オプションをクリックして**既存の SSO システムに参加**します。</span><span class="sxs-lookup"><span data-stu-id="20291-160">Click the option to **Join an existing SSO system**.</span></span>  
  
   3.  <span data-ttu-id="20291-161">既存の SSO データベース サーバー名およびデータベース名を入力します。</span><span class="sxs-lookup"><span data-stu-id="20291-161">Enter values for the existing SSO Database Server Name and Database Name.</span></span>  
  
   4.  <span data-ttu-id="20291-162">エンタープライズ シングル サインオン サービスに使用するアカウントを指定する場合は、既存の SSO サービス アカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="20291-162">Enter the existing SSO service account when specifying the account to use for the Enterprise Single Sign-On service.</span></span>  
  
8. <span data-ttu-id="20291-163">これは、最初の BizTalk Server グループであるため、オプションを選択します。**新しい BizTalk グループを作成する**BizTalk グループ コンポーネントを構成するときにします。</span><span class="sxs-lookup"><span data-stu-id="20291-163">Since this is the first BizTalk Server in the group choose the option to **Create a new BizTalk Group** when configuring the BizTalk Group component.</span></span>  
  
9. <span data-ttu-id="20291-164">必要に応じて残りの構成オプションを指定し、このノードに BizTalk Server 構成を適用します。</span><span class="sxs-lookup"><span data-stu-id="20291-164">Specify the remaining configuration options as needed and apply the BizTalk Server configuration to this node.</span></span>  
  
10. <span data-ttu-id="20291-165">最初のノードで BizTalk Server 構成が正常に完了したら、2 番目のノードにログオンし、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] をインストールします。</span><span class="sxs-lookup"><span data-stu-id="20291-165">Once the BizTalk Server configuration has completed successfully on the first node, log on to the second node and install [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="20291-166">インストールが正常に完了したら、構成プログラムを起動するオプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="20291-166">Select the option to start the configuration program when installation has completed successfully.</span></span>  
  
11. <span data-ttu-id="20291-167">選択、**カスタム構成**オプション、および適切な値を入力し、**データベース サーバー名**、**ユーザー名**と**パスワード**フィールド。</span><span class="sxs-lookup"><span data-stu-id="20291-167">Choose the **Custom Configuration** option, and then enter the appropriate values for the **Database server name**, **User name** and **Password** fields.</span></span> <span data-ttu-id="20291-168">これらの値を入力すると、クリックして、**構成**続行ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="20291-168">After entering these values, click the **Configure** button to continue.</span></span>  
  
12. <span data-ttu-id="20291-169">SSO の機能に次のオプションを設定します。</span><span class="sxs-lookup"><span data-stu-id="20291-169">Set the following options for the SSO feature:</span></span>  
  
    1.  <span data-ttu-id="20291-170">横のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオン コンピューターこの**します。</span><span class="sxs-lookup"><span data-stu-id="20291-170">Select the check the box next to **Enable Enterprise Single Sign-On on this computer**.</span></span>  
  
    2.  <span data-ttu-id="20291-171">クリックして**既存の SSO システムに参加**します。</span><span class="sxs-lookup"><span data-stu-id="20291-171">Click **Join an existing SSO system**.</span></span>  
  
    3.  <span data-ttu-id="20291-172">既存の SSO データベース サーバー名およびデータベース名を入力します。</span><span class="sxs-lookup"><span data-stu-id="20291-172">Enter values for the existing SSO Database Server Name and Database Name.</span></span>  
  
    4.  <span data-ttu-id="20291-173">エンタープライズ シングル サインオン サービスに使用するアカウントを指定する場合は、既存の SSO サービス アカウントを入力します。</span><span class="sxs-lookup"><span data-stu-id="20291-173">Enter the existing SSO service account when specifying the account to use for the Enterprise Single Sign-On service.</span></span>  
  
13. <span data-ttu-id="20291-174">オプションを選択**既存の BizTalk グループに参加**このクラスター ノードで、BizTalk グループ コンポーネントを構成するときに最初のノードで作成した BizTalk グループを指定します。</span><span class="sxs-lookup"><span data-stu-id="20291-174">Choose the option to **Join an existing BizTalk Group** when configuring the BizTalk Group component on this cluster node, and specify the BizTalk group that you created on the first node.</span></span>  
  
14. <span data-ttu-id="20291-175">必要に応じて残りの構成オプションを指定し、このノードに BizTalk Server 構成を適用します。</span><span class="sxs-lookup"><span data-stu-id="20291-175">Specify the remaining configuration options as needed and apply the BizTalk Server configuration to this node.</span></span>  
  
15. <span data-ttu-id="20291-176">BizTalk Server の構成が正常に完了した後、次の手順に従って SSO サービスをクラスター化します。</span><span class="sxs-lookup"><span data-stu-id="20291-176">After the BizTalk Server configuration has completed successfully, follow these steps to cluster the SSO service:</span></span>  
  
    1.  <span data-ttu-id="20291-177">コマンド プロンプトで次のコマンドを入力して、各クラスター ノードの SSO サービスを停止します。</span><span class="sxs-lookup"><span data-stu-id="20291-177">Stop the SSO service on each of the cluster nodes by typing the following command from a command:</span></span>  
  
        ```  
        net stop entsso  
        ```  
  
    2.  <span data-ttu-id="20291-178">フェールオーバー クラスター管理ですべてのクラスター グループを 1 つのノードに移動し、このノードにログオンします。</span><span class="sxs-lookup"><span data-stu-id="20291-178">In Failover Cluster Management, move all cluster groups to one node and log on to this node.</span></span>  
  
    3.  <span data-ttu-id="20291-179">左側のウィンドウで、IP アドレスおよびネットワーク名リソースが入ったクラスター化されたサービスかアプリケーションをクリックして選択します。</span><span class="sxs-lookup"><span data-stu-id="20291-179">In the left hand pane click to select a clustered service or application that contains an IP Address and Network Name resource.</span></span> <span data-ttu-id="20291-180">このクラスター化されたサービスまたはアプリケーションには、クラスター化された SSO サービスおよびクラスター化された BizTalk ホストが含まれます。</span><span class="sxs-lookup"><span data-stu-id="20291-180">This clustered service or application will contain the clustered SSO service and the clustered BizTalk host.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="20291-181">クラスター化された SSO サービスでは、同じグループ内でクラスター化された物理ディスク リソースの使用は明示的に要求されません。</span><span class="sxs-lookup"><span data-stu-id="20291-181">A clustered SSO service does not explicitly require the use of a clustered Physical Disk resource in the same group.</span></span>  
  
    4.  <span data-ttu-id="20291-182">クラスター化されたサービスまたはアプリケーションを右クリックし、**リソースを追加**、 をクリック**汎用サービス**を表示する、**の新しいリソース ウィザード** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="20291-182">Right-click the clustered service or application, point to **Add a resource**, and click **Generic Service** to display the **New Resource Wizard** dialog box.</span></span>  
  
    5.  <span data-ttu-id="20291-183">**サービスの選択**のページ、**リソースの新規作成ウィザード**を選択します**エンタープライズ シングル サインオン サービス**、順にクリックします**次**します。</span><span class="sxs-lookup"><span data-stu-id="20291-183">On the **Select Service** page of the **New Resource Wizard**, select **Enterprise Single Sign-On Service**, and then click **Next**.</span></span>  
  
    6.  <span data-ttu-id="20291-184">**確認**ページ クリック **[次へ]** します。</span><span class="sxs-lookup"><span data-stu-id="20291-184">On the **Confirmation** page click **Next**.</span></span>  
  
    7.  <span data-ttu-id="20291-185">**概要**ページ クリック**完了**。</span><span class="sxs-lookup"><span data-stu-id="20291-185">On the **Summary** page click **Finish**.</span></span> <span data-ttu-id="20291-186">エンタープライズ シングル サインオン サービスのクラスター化されたインスタンスは、下に表示されます**その他のリソース**の中央のペインで、**フェールオーバー クラスター管理**インターフェイス。</span><span class="sxs-lookup"><span data-stu-id="20291-186">A clustered instance of the Enterprise Single Sign-On Service will appear under **Other Resources** in the center pane of the **Failover Cluster Management** interface.</span></span>  
  
    8.  <span data-ttu-id="20291-187">エンタープライズ シングル サインオン サービスのクラスター化されたインスタンスを右クリックして**プロパティ**を表示する、**エンタープライズ シングル サインオン サービスのプロパティ** ダイアログ ボックス。</span><span class="sxs-lookup"><span data-stu-id="20291-187">Right-click the clustered instance of the Enterprise Single Sign-On Service and select **Properties** to display the **Enterprise Single Sign-On Service Properties** dialog box.</span></span>  
  
    9. <span data-ttu-id="20291-188">をクリックして、**依存関係**プロパティ ダイアログ ボックスのタブ**挿入**します。</span><span class="sxs-lookup"><span data-stu-id="20291-188">Click the **Dependencies** tab of the properties dialog box and click **Insert**.</span></span>  
  
    10. <span data-ttu-id="20291-189">ドロップダウン ボックスをクリックします。**リソース**を選択、**名:** リソースをクリックします **[ok]** します。</span><span class="sxs-lookup"><span data-stu-id="20291-189">Click the drop down box under **Resource**, select the **Name:** resource and click **OK**.</span></span>  
  
        > [!IMPORTANT]
        >  <span data-ttu-id="20291-190">依存関係を追加しない場合、**名:** リソース、SSO クライアント コンピューターが生成されます、次のようなエラー、SSO サービスのクラスター化されたこのインスタンスに接続しようとするとします。</span><span class="sxs-lookup"><span data-stu-id="20291-190">If you do not add the dependency to the **Name:** resource, SSO client computers will generate an error similar to the following when they try to contact this clustered instance of the SSO service:</span></span>  
        >   
        >  <span data-ttu-id="20291-191">マスター シークレットを取得できませんでした。</span><span class="sxs-lookup"><span data-stu-id="20291-191">Failed to retrieve master secrets.</span></span>  
        >   
        >  <span data-ttu-id="20291-192">マスター シークレット サーバー名が正しいこと、および利用可能であることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="20291-192">Verify that the master secret server name is correct and that it is available.</span></span> <span data-ttu-id="20291-193">シークレット サーバー名: ENTSSO エラー コード: 0x800706D9、エンドポイント マッパーから使用できるエンドポイントはこれ以上ありません。</span><span class="sxs-lookup"><span data-stu-id="20291-193">Secret Server Name: ENTSSO Error Code: 0x800706D9, there are no more endpoints available from the endpoint mapper.</span></span>  
  
16. <span data-ttu-id="20291-194">IIS をクラスター、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]に記載されている手順に従ってコンピューター[マイクロソフト サポート技術情報の記事 970759「を構成する IIS 7.0 では Microsoft Windows Server 2008 フェールオーバー クラスター」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (<http://go.microsoft.com/fwlink/p/?LinkId=152793>)。</span><span class="sxs-lookup"><span data-stu-id="20291-194">Cluster IIS on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer by following the steps documented in [Microsoft Knowledge Base article 970759 "Configuring IIS 7.0 in a Microsoft Windows Server 2008 failover cluster"](http://go.microsoft.com/fwlink/p/?LinkId=152793) (<http://go.microsoft.com/fwlink/p/?LinkId=152793>).</span></span> <span data-ttu-id="20291-195">クラスター化された SSO サービスと同じクラスター グループでクラスター化された IIS web サービスを作成します。</span><span class="sxs-lookup"><span data-stu-id="20291-195">Create the clustered IIS web service in the same cluster group as the clustered SSO service.</span></span>  
  
17. <span data-ttu-id="20291-196">フェールオーバー クラスターの管理では、クラスター化されたサービスまたはアプリケーションをクラスター化されたエンタープライズ シングル サインオン サービスを含む右クリックし、順にクリックします**このサービスまたはアプリケーションをオンライン**内のリソースのすべてを開始するにはクラスター化されたサービスまたはアプリケーション。</span><span class="sxs-lookup"><span data-stu-id="20291-196">In Failover Cluster Management, right click the clustered service or application that contains the clustered Enterprise Single Sign-On service and then click **Bring this service or application online** to start all of the resources in the clustered service or application.</span></span>  
  
18. <span data-ttu-id="20291-197">クラスター化されたサービスまたはアプリケーションを右クリックし、**このサービスまたはアプリケーションを別のノードに移動**、2 番目のノードをクリックします。</span><span class="sxs-lookup"><span data-stu-id="20291-197">Right-click the clustered service or application, point to **Move this service or application to another node**, and click the second node.</span></span> <span data-ttu-id="20291-198">この手順では、クラスター化されたエンタープライズ シングル サインオン サービスが入ったクラスター化されたサービスまたはアプリケーションを最初のノードから 2 番目のノードに移動します。</span><span class="sxs-lookup"><span data-stu-id="20291-198">This step moves the clustered service or application that contains the clustered Enterprise Single Sign-On service from the first node to the second node.</span></span>  
  
19. <span data-ttu-id="20291-199">クラスター化されたエンタープライズ シングル サインオン サービスを右クリックし、をクリックして**このサービスまたはアプリケーションをオフラインに**、SSO サービスのクラスター化されたインスタンスを右クリックしておよびクリックして**このサービスまたはアプリケーションをオンライン**します。</span><span class="sxs-lookup"><span data-stu-id="20291-199">Right-click the clustered Enterprise Single Sign-On service and click **Take this service or application offline**, then right-click the clustered instance of the SSO service and click **Bring this service or application online**.</span></span>  
  
20. <span data-ttu-id="20291-200">ssomanage コマンド ライン ユーティリティを使用して、すべてのユーザーの SSO サーバー名を、クラスター化された SSO サービスに設定します。</span><span class="sxs-lookup"><span data-stu-id="20291-200">Set the SSO server name for all users to the clustered SSO service with the ssomanage command line utility.</span></span> <span data-ttu-id="20291-201">このコマンドは、グループ内の BizTalk サーバーごとに、SSO のインストール フォルダーから実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="20291-201">This command should be run from the SSO installation folder on each BizTalk server in the group.</span></span> <span data-ttu-id="20291-202">たとえば、次のコマンド ラインを使用して、すべてのユーザーの SSO サーバー名をクラスター化された SSO サービスに設定します。</span><span class="sxs-lookup"><span data-stu-id="20291-202">For example, the following command line will set the SSO server name for all users to the clustered SSO service:</span></span>  
  
    ```  
    ssomanage -serverall SSOCLUSTER  
    ```  
  
    > [!NOTE]
    >  <span data-ttu-id="20291-203">*SSOCLUSTER*はクラスター化された SSO サービスを含むクラスター グループに作成される実際のネットワーク名リソースのプレース ホルダーです。</span><span class="sxs-lookup"><span data-stu-id="20291-203">*SSOCLUSTER* is a placeholder for the actual network name resource that is created in the cluster group that contains the clustered SSO service.</span></span>  
  
21. <span data-ttu-id="20291-204">SSO サーバー名を更新、 **BizTalk グループのプロパティ**クラスター化された SSO サービスを参照するページ。</span><span class="sxs-lookup"><span data-stu-id="20291-204">Update the SSO Server name accessible in the **BizTalk Group Properties** page to reference the clustered SSO service.</span></span> <span data-ttu-id="20291-205">開いている**BizTalk Server 管理**、BizTalk グループを右クリックし、選択、**プロパティ**メニュー項目では、SSO サーバー名、エントリを更新し、順にクリックします**OK**。</span><span class="sxs-lookup"><span data-stu-id="20291-205">Open **BizTalk Server Administration**, right-click the BizTalk Group, select the **Properties** menu item, update the entry for SSO Server name, and then click **OK**.</span></span>  
  
22. <span data-ttu-id="20291-206">次の手順では、 [BizTalk ホストをクラスター リソースとして構成する方法](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)同じクラスター グループがクラスター化された SSO サービスを作成することで、1 つまたは複数のクラスター化された BizTalk ホスト インスタンスを作成します。</span><span class="sxs-lookup"><span data-stu-id="20291-206">Follow the steps in [How to Configure a BizTalk Host as a Cluster Resource](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3) to create one or more clustered BizTalk host instances in the same cluster group that you have created the clustered SSO service.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="20291-207">このシナリオでは、クラスター化された SSO サービス リソースと同じクラスター グループ内のクラスター リソースとして、すべての BizTalk ホストを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="20291-207">In this scenario, all BizTalk hosts must be created as cluster resources in the same cluster group as the clustered SSO service resource.</span></span> <span data-ttu-id="20291-208">SSO サービスがクラスター化されている Windows Server クラスター ノードで、クラスター化されていない BizTalk ホスト インスタンスを実行することは、構成上サポートされていません。</span><span class="sxs-lookup"><span data-stu-id="20291-208">Running an unclustered BizTalk host instance on a Windows Server Cluster node where the SSO service is clustered is not a supported configuration.</span></span> <span data-ttu-id="20291-209">これは、SSO サービス上の BizTalk ホスト インスタンスの依存関係が原因で、クラスター化された SSO サービスが他のノードにフェールオーバーするときに、クラスター化されていない BizTalk ホスト インスタンスが失敗するためです。</span><span class="sxs-lookup"><span data-stu-id="20291-209">This is because the unclustered BizTalk host instance will fail when the clustered SSO service is failed over to another node due to the dependency of a BizTalk host instance on the SSO service.</span></span>