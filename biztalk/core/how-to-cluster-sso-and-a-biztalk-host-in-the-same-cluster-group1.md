---
title: SSO と同じクラスター Group1 の BizTalk ホストをクラスター化する方法 |Microsoft ドキュメント
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 413cc8f4-f343-4c1c-8b79-3b15cb4c101d
caps.latest.revision: 44
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a72b6e343d2e417a718c238181fefdea8e5cceba
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2017
ms.locfileid: "22250626"
---
# <a name="how-to-cluster-sso-and-a-biztalk-host-in-the-same-cluster-group"></a>SSO と BizTalk ホストを同じクラスター グループでクラスター化する方法
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] では、1 つ以上の BizTalk ホストとエンタープライズ シングル サインオン (SSO) サービスを同じ Windows Server クラスターでクラスター化できます。  
  
> [!NOTE]
>  この方法を正しく実装するには、BizTalk ホスト インスタンスと SSO サービスを、同じクラスター グループのクラスター リソースとして作成する必要があります。  
  
 1 つ以上の BizTalk ホストと SSO で Windows クラスタリングを使用するシナリオは、通常、以下のいずれかに分類されます。  
  
1.  SSO マスター シークレット サーバーと 1 つ以上の BizTalk ホストを同じクラスター グループでクラスター化する。  
  
     このシナリオでは、クラスター グループがフェールオーバーは、すべてのリソースがグループと共に移動できるように、クラスター化された BizTalk ホストとクラスター化された SSO サービス間の依存関係が維持されます。  
  
     SSO サービスが [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] コンピューターでクラスター化リソースとして構成されている場合、クラスター化された IIS Web サービスを同じクラスター グループで作成する必要があります。 これは、すべての分離ホスト インスタンスが、SSO サービスを実行しているクラスター ノードで実行されるようにする必要があるためです。 これにより、分離ホスト インスタンスが IIS で実行されるので、分離ホスト インスタンスで実行されるアダプターは SSO サービスにアクセスできるようになります。  
  
    > [!NOTE]
    >  BizTalk ホストのクラスター化されていないインスタンスが、SSO サービスのクラスター化されたインスタンスが実行されているのと同じクラスター ノードで実行されている場合、BizTalk ホストのクラスター化されていないインスタンスが停止しない限り、SSO サービスのクラスター化されたインスタンスはフェールオーバーしたことはできません。 BizTalk ホストのクラスター化されていないインスタンスでは、クラスター ノードで実行されている SSO サービスのクラスター化されたインスタンスに対する依存関係を維持し、により、SSO サービスのクラスター化されたインスタンスがフェールオーバーします。 そのため、SSO サービスのクラスター化インスタンスが実行されているのと同じクラスター ノードで実行するように、BizTalk ホストのクラスター化されていないインスタンスを作成しないことをお勧めします。  
  
2.  SSO サービス (マスター シークレット サーバー以外) と 1 つ以上の BizTalk ホストを同じクラスター グループでクラスター化する。 このシナリオでは、リモートのマスター シークレット サーバーが使用できる必要があります。 このシナリオでは、クラスター化された BizTalk ホストとクラスター化された SSO サービスの依存関係が保持されるため、クラスター グループがフェールオーバーされると、すべてのリソースがグループと共に移動します。  
  
     SSO サービスが [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] コンピューターでクラスター化リソースとして構成されている場合、クラスター化された IIS Web サービスを同じクラスター グループで作成する必要があります。 これは、すべての分離ホスト インスタンスが、SSO サービスを実行しているクラスター ノードで実行されるようにする必要があるためです。 これにより、分離ホスト インスタンスが IIS で実行されるので、分離ホスト インスタンスで実行されるアダプターは SSO サービスにアクセスできるようになります。  
  
    > [!NOTE]
    >  SSO サービスのクラスター化インスタンスが実行されているのと同じクラスター ノードで、BizTalk ホストのクラスター化されていないインスタンスが実行されている場合、SSO サービスのクラスター化インスタンスは、BizTalk ホストのクラスター化されていないインスタンスが停止している場合を除き、フェールオーバーできません。 BizTalk ホストのクラスター化されていないインスタンスでは、クラスター ノードで実行されている SSO サービスのクラスター化インスタンスの依存関係を維持し、SSO サービスのクラスター化インスタンスがフェールオーバーされるのを防ぎます。 このため、ありません、SSO サービスのクラスター化されたインスタンスが実行されているのと同じクラスター ノードで実行する BizTalk ホストのクラスター化されていないインスタンスを作成することをお勧めします。  
  
3.  SSO サービスをクラスター化せずに、Windows Server クラスターで 1 つ以上の BizTalk ホストをクラスター化する。 このシナリオでは、1 つ以上の BizTalk ホストがクラスター リソースとして構成されますが、SSO サービスはクラスター化リソースとして構成されません。 この仕様により、クラスター化された BizTalk ホストの高可用性は実現されますが、SSO サービスの高可用性は実現されません。 このシナリオでは、あるノードの SSO サービスが失敗した場合、そのノードの SSO に依存している BizTalk Server コンポーネントも失敗します。 BizTalk Server ホストをクラスター リソースとして構成する方法の詳細については「 [BizTalk ホストをクラスター リソースとして構成する方法](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)です。  
  
 BizTalk ホストと SSO サービスを同じ Windows Server クラスターでクラスター化するために実行する必要がある手順を以下に示します。  
  
### <a name="to-cluster-a-biztalk-host-and-the-sso-master-secret-server-on-the-same-windows-server-cluster"></a>BizTalk ホストと SSO マスター シークレット サーバーを同じ Windows Server クラスターでクラスター化するには  
  
1.  クラスター化された分散トランザクション コーディネーター (MSDTC) リソース クラスターが構成されていない場合で MSDTC をクラスター、Windows Server フェールオーバー クラスターでの手順に従って[チェックリスト: Windows Server 2008 での MS DTC リソースの作成フェールオーバー クラスター](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677)。  
  
2.  インストールし、次の手順に従って、Windows Server クラスターで SSO サービスを構成する[マスター シークレット サーバーをクラスター化する方法](http://msdn.microsoft.com/library/59895616-4178-46d0-b9ff-95589b809ff5)です。 Windows Server クラスターで BizTalk Server を実行するため、この時点で SSO コンポーネントのみを構成する場合でも、必要な BizTalk Server コンポーネントをすべてインストールしてください。  
  
3.  IIS をクラスター、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]に記載されている手順に従ってコンピューター[マイクロソフト サポート技術情報の記事 970759「を構成する IIS 7.0、Microsoft Windows Server 2008 フェールオーバー クラスターで」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (http://go.microsoft.com/fwlink/p/?LinkId=152793)。 同じクラスター グループ内のクラスター化された IIS Web サービスを、クラスター化された SSO サービスとして作成します。  
  
4.  クラスター ノードの 1 つのクラスター化された SSO サービスを含むクラスター グループに移動し、このクラスター ノードにログオンします。  
  
5.  このクラスター ノードで BizTalk Server 構成プログラムを起動し、BizTalk Server の構成を完了します。 これは、グループ内の最初の BizTalk Server コンピューターであるためにをクリックして**新しい BizTalk グループを作成**BizTalk グループを構成するときにします。  
  
6.  BizTalk Server 構成が正常に完了したら、クラスター化された SSO サービスを含むクラスター グループを他のクラスター ノードに移動して、このクラスター ノードにログオンします。  
  
7.  このクラスター ノードで BizTalk Server 構成プログラムを起動し、BizTalk Server の構成を完了します。 をクリックして**既存の BizTalk グループに参加**このクラスター ノードで、BizTalk グループ コンポーネントを構成するときに最初のノードで作成した BizTalk グループを指定します。  
  
8.  BizTalk Server の構成が正常に完了したら、1 つを作成または以上のクラスター化 BizTalk ホストを次の手順に従って、 [BizTalk ホストをクラスター リソースとして構成する方法](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)です。  
  
    > [!NOTE]
    >  このシナリオでは、クラスター化された SSO サービス リソースと同じクラスター グループ内のクラスター リソースとして、すべての BizTalk ホストを作成する必要があります。 SSO サービスがクラスター化されていない Windows Server クラスター ノードで、非クラスター化 BizTalk ホスト インスタンスを実行することは、構成上サポートされていません。 これは、SSO サービス上の BizTalk ホスト インスタンスの依存関係が原因で、クラスター化された SSO サービスが他のノードにフェールオーバーするときに、クラスター化されていない BizTalk ホスト インスタンスが失敗するためです。  
  
### <a name="to-cluster-a-biztalk-host-and-sso-non-master-secret-server-on-the-same-windows-server-cluster-when-the-sso-master-secret-server-is-remote"></a>SSO マスター シークレット サーバーがリモートに存在するときに BizTalk ホストと SSO (マスター シークレット サーバー以外) を同じ Windows Server クラスターでクラスター化するには  
  
1.  クラスター化された分散トランザクション コーディネーター (MSDTC) リソース クラスターが構成されていない場合で MSDTC をクラスター、Windows Server フェールオーバー クラスターでの手順に従って[チェックリスト: Windows Server 2008 での MS DTC リソースの作成フェールオーバー クラスター](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677)。  
  
2.  名前のドメイン グループを作成**SSO 管理者**と**SSO 関連管理者**です。 SSO サービスのクラスター化されたインスタンスを作成する必要がありますを作成する、 **SSO 管理者**と**SSO 関連管理者**ドメイン グループとしてグループ。  
  
3.  作成またはのメンバーであるドメイン アカウントを指定、 **SSO 管理者**ドメイン グループです。 各ノードの SSO サービスは、このドメイン アカウントとしてログオンするように構成されます。 このアカウントが必要、**サービスとしてログオン**クラスター内の各ノードを右にします。  
  
4.  ドメインにインストールおよび構成プロセス中にログオンに使用しているアカウントを追加**SSO 管理者**グループ。  
  
    > [!IMPORTANT]
    >  手順 3. および手順 4. を完了しないと、SSO サービスの構成が失敗します。  
  
5.  クラスター ノードの 1 つにログオンし、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] をインストールします。 インストールが正常に完了したら、構成プログラムを起動するオプションを選択します。  
  
6.  選択、**カスタム構成**オプションし、適切な値を入力、**データベース サーバー名**、**ユーザー名**と**パスワード**フィールドです。 これらの値を入力した後にをクリックして、**構成**続行するボタンをクリックします。  
  
7.  SSO の機能に次のオプションを設定します。  
  
    1.  横のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオンこのコンピューターに**です。  
  
    2.  オプションをクリックして**既存の SSO システムに参加**です。  
  
    3.  既存の SSO データベース サーバー名およびデータベース名を入力します。  
  
    4.  エンタープライズ シングル サインオン サービスを使用するアカウントを指定する場合は、既存の SSO サービス アカウントを入力します。  
  
8.  これは、グループ内の最初の BizTalk Server なので、オプションを選択します。**新しい BizTalk グループを作成**、BizTalk グループ コンポーネントを構成するときにします。  
  
9. 必要に応じて残りの構成オプションを指定し、このノードに BizTalk Server 構成を適用します。  
  
10. 最初のノードで BizTalk Server 構成が正常に完了したら、2 番目のノードにログオンし、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] をインストールします。 インストールが正常に完了したら、構成プログラムを起動するオプションを選択します。  
  
11. 選択、**カスタム構成**オプション、および適切な値を入力、**データベース サーバー名**、**ユーザー名**と**パスワード**フィールドです。 これらの値を入力すると、をクリックして、**構成**続行するボタンをクリックします。  
  
12. SSO の機能に次のオプションを設定します。  
  
    1.  横のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオンこのコンピューターに**です。  
  
    2.  をクリックして**既存の SSO システムに参加**です。  
  
    3.  既存の SSO データベース サーバー名およびデータベース名を入力します。  
  
    4.  エンタープライズ シングル サインオン サービスを使用するアカウントを指定する場合は、既存の SSO サービス アカウントを入力します。  
  
13. オプションを選択**既存の BizTalk グループに参加**このクラスター ノードで、BizTalk グループ コンポーネントを構成するときに、最初のノード上に作成した BizTalk グループを指定します。  
  
14. 必要に応じて残りの構成オプションを指定し、このノードに BizTalk Server 構成を適用します。  
  
15. BizTalk Server の構成が正常に完了した後、次の手順に従って SSO サービスをクラスター化します。  
  
    1.  コマンド プロンプトで次のコマンドを入力して、各クラスター ノードの SSO サービスを停止します。  
  
        ```  
        net stop entsso  
        ```  
  
    2.  フェールオーバー クラスター管理ですべてのクラスター グループを 1 つのノードに移動し、このノードにログオンします。  
  
    3.  左側のウィンドウで、IP アドレスおよびネットワーク名リソースが入ったクラスター化されたサービスかアプリケーションをクリックして選択します。 このクラスター化されたサービスまたはアプリケーションには、クラスター化された SSO サービスおよびクラスター化された BizTalk ホストが含まれます。  
  
        > [!NOTE]
        >  クラスター化された SSO サービスでは、同じグループ内でクラスター化された物理ディスク リソースの使用は明示的に要求されません。  
  
    4.  クラスター化されたサービスまたはアプリケーションを右クリックし、**リソースを追加**、 をクリック**汎用サービス**を表示する、**新しいリソース ウィザード** ダイアログ ボックス。  
  
    5.  **サービスの選択**のページ、**新しいリソース ウィザード****エンタープライズ シングル サインオン サービス**、順にクリック**次へ**です。  
  
    6.  **確認**ページをクリックして**次**です。  
  
    7.  **概要**ページをクリックして**完了**です。 エンタープライズ シングル サインオン サービスのクラスター化されたインスタンスに表示されます**その他のリソース**の中央のペインで、**フェイル オーバー クラスター管理**インターフェイスです。  
  
    8.  エンタープライズ シングル サインオン サービスのクラスター化されたインスタンスを右クリックし [**プロパティ**を表示する、**エンタープライズ シングル サインオン サービスのプロパティ**] ダイアログ ボックス。  
  
    9. クリックして、**の依存関係** タブをクリックして、プロパティ ダイアログ ボックスの**挿入**です。  
  
    10. 下のボックスのドロップダウンをクリックして**リソース**を選択、**名前:** リソースをクリック**OK**です。  
  
        > [!IMPORTANT]
        >  依存関係を追加しない場合、**名前:** リソース、SSO クライアント コンピューターはエラーを生成、次のような SSO サービスのクラスター化されたこのインスタンスに接続しようとするとします。  
        >   
        >  マスター シークレットを取得できませんでした。  
        >   
        >  マスター シークレット サーバー名が正しいこと、および利用可能であることを確認してください。 シークレット サーバー名: ENTSSO エラー コード: 0x800706D9、エンドポイント マッパーから使用できるエンドポイントはこれ以上ありません。  
  
16. IIS をクラスター、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]に記載されている手順に従ってコンピューター[マイクロソフト サポート技術情報の記事 970759「を構成する IIS 7.0、Microsoft Windows Server 2008 フェールオーバー クラスターで」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (http://go.microsoft.com/fwlink/p/?LinkId=152793)。 クラスター化された SSO サービスと同じクラスター グループで、クラスター化された IIS web サービスを作成します。  
  
17. フェールオーバー クラスター管理では、クラスター化されたサービスまたはクラスター化されたエンタープライズ シングル サインオン サービスを含むアプリケーションを右クリックし、をクリックして**このサービスまたはアプリケーションをオンライン**内のリソースのすべてを開始するにはクラスター化されたサービスまたはアプリケーションです。  
  
18. クラスター化されたサービスまたはアプリケーションを右クリックし、**このサービスまたはアプリケーションを別のノードに移動**、2 番目のノードをクリックします。 この手順では、クラスター化されたエンタープライズ シングル サインオン サービスが入ったクラスター化されたサービスまたはアプリケーションを最初のノードから 2 番目のノードに移動します。  
  
19. クラスター化されたエンタープライズ シングル サインオン サービスを右クリックし、をクリックして**このサービスまたはアプリケーションをオフラインに**、SSO サービスのクラスター化されたインスタンスを右クリックしてをクリックして**このサービスまたはアプリケーションをオンライン**です。  
  
20. ssomanage コマンド ライン ユーティリティを使用して、すべてのユーザーの SSO サーバー名を、クラスター化された SSO サービスに設定します。 このコマンドは、グループ内の BizTalk サーバーごとに、SSO のインストール フォルダーから実行する必要があります。 たとえば、次のコマンド ラインを使用して、すべてのユーザーの SSO サーバー名をクラスター化された SSO サービスに設定します。  
  
    ```  
    ssomanage -serverall SSOCLUSTER  
    ```  
  
    > [!NOTE]
    >  *SSOCLUSTER*をクラスター化された SSO サービスを含むクラスター グループに作成される実際のネットワーク名リソースのプレース ホルダーです。  
  
21. SSO サーバー名を更新、 **BizTalk グループのプロパティ**クラスター化された SSO サービスを参照するページ。 開いている**BizTalk Server 管理コンソール**、BizTalk グループを右クリックし、選択、**プロパティ**メニュー項目が SSO サーバー名のエントリを更新し、をクリックして**OK**です。  
  
22. 手順に従います[BizTalk ホストをクラスター リソースとして構成する方法](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)をクラスター化された SSO サービスを作成した同じクラスター グループ内の 1 つまたは複数のクラスター化された BizTalk ホスト インスタンスを作成します。  
  
    > [!NOTE]
    >  このシナリオでは、クラスター化された SSO サービス リソースと同じクラスター グループ内のクラスター リソースとして、すべての BizTalk ホストを作成する必要があります。 SSO サービスがクラスター化されている Windows Server クラスター ノードで、クラスター化されていない BizTalk ホスト インスタンスを実行することは、構成上サポートされていません。 これは、SSO サービス上の BizTalk ホスト インスタンスの依存関係が原因で、クラスター化された SSO サービスが他のノードにフェールオーバーするときに、クラスター化されていない BizTalk ホスト インスタンスが失敗するためです。