---
title: SSO と BizTalk ホストで同じクラスター グループ 1 のクラスター化する方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 413cc8f4-f343-4c1c-8b79-3b15cb4c101d
caps.latest.revision: 44
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4e8fef44d59a12c42da35d85e0c4357ca7fce5b3
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65342353"
---
# <a name="cluster-sso-and-a-biztalk-host-in-the-same-cluster-group"></a>SSO と BizTalk ホストで同じクラスタ グループ
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 1 つまたは複数の BizTalk ホストとエンタープライズ シングル サインオン (SSO) サービスを同じ Windows Server クラスターでクラスターことができます。  
  
> [!NOTE]
>  この戦略を正しく実装するには、同じクラスター グループ内のクラスター リソースとして、BizTalk ホスト インスタンスと SSO サービスを作成することが必要です。  
  
 1 つまたは複数の BizTalk ホストと SSO での Windows クラスタ リングの使用は、通常、これらのカテゴリのいずれかに分類されます。  
  
1. SSO マスター シークレット サーバーと同じクラスター グループ内の 1 つまたは複数の BizTalk ホストをクラスタ リングします。  
  
    このシナリオでは、クラスター グループがフェールオーバーする場合のすべてのリソースがグループと共に移動できるように、クラスター化された BizTalk ホストとクラスター化された SSO サービスの依存関係が維持されます。  
  
    クラスター化リソースとして、SSO サービスを構成、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]コンピューター、同じクラスター グループでクラスター化された IIS web サービスを作成する必要があります。 SSO サービスが実行されているクラスター ノードですべての分離ホスト インスタンスを実行することを確認するのには、これを実行する必要があります。 これにより、分離ホスト インスタンスで実行されるアダプターがアクセスできるよう、SSO サービスの分離ホスト インスタンスが IIS で実行されるためです。  
  
   > [!NOTE]
   >  BizTalk ホストのクラスター化されていないインスタンスが、SSO サービスのクラスター化されたインスタンスを実行している同じクラスター ノードで実行している場合、BizTalk ホストのクラスター化されていないインスタンスが停止しない限り、SSO サービスのクラスター化されたインスタンスはフェールオーバーしたことはできません。 BizTalk ホストのクラスター化されていないインスタンスでは、クラスター ノードで実行されている SSO サービスのクラスター化されたインスタンスの依存を維持し、SSO サービスのクラスター化されたインスタンスにフェールオーバーを防ぎます。 このため、SSO サービスのクラスター化されたインスタンスを実行している同じクラスター ノードで実行する BizTalk ホストのクラスター化されていないインスタンスを作成しないことをお勧めします。  
  
2. SSO サービス (マスター シークレット サーバー以外) と同じクラスター グループ内の 1 つまたは複数の BizTalk ホストをクラスタ リングします。 このシナリオでは、リモートのマスター シークレット サーバーが利用できることが必要です。 このシナリオでは、すべてのリソースがグループと共に移動、クラスター グループがフェールオーバーする場合、クラスター化された BizTalk ホストとクラスター化された SSO サービスの依存関係が維持されます。  
  
    クラスター化リソースとして、SSO サービスを構成、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]コンピューター、同じクラスター グループでクラスター化された IIS web サービスを作成する必要があります。 SSO サービスが実行されているクラスター ノードですべての分離ホスト インスタンスを実行することを確認するのには、これを実行する必要があります。 これにより、分離ホスト インスタンスで実行されるアダプターがアクセスできるよう、SSO サービスの分離ホスト インスタンスが IIS で実行されるためです。  
  
   > [!NOTE]
   >  BizTalk ホストのクラスター化されていないインスタンスが停止しない限り、非クラスター化された BizTalk ホストのインスタンスが、SSO サービスのクラスター化されたインスタンスが実行されていること、SSO サービスのクラスター化されたインスタンスと同じクラスター ノードで実行されている場合はフェールオーバーしたことはできません。 BizTalk ホストのクラスタ化されていないインスタンスでは、クラスター ノードで実行されている SSO サービスのクラスター化されたインスタンスの依存を維持し、SSO サービスのクラスター化されたインスタンスにフェールオーバーを防ぎます。 このため、いない SSO サービスのクラスター化されたインスタンスを実行している同じクラスター ノードで実行する BizTalk ホストのクラスター化されていないインスタンスを作成することをお勧めします。  
  
3. SSO サービスをクラスタ リングのない Windows Server クラスターで 1 つまたは複数の BizTalk ホストをクラスタ リングします。 このシナリオでは、1 つまたは複数の BizTalk ホストのクラスター リソースとして構成されますが、SSO サービスがクラスター化リソースとして構成されていません。 この仕様では、クラスター化された BizTalk ホストの高可用性を提供しますが、SSO サービスの高可用性は実現されません。 このシナリオで、ノードの SSO サービスが失敗した場合、そのノードの SSO に依存する BizTalk Server コンポーネントも失敗します。 詳細については、BizTalk Server ホストをクラスター リソースとして構成する方法についてを参照してください。 [、BizTalk ホストをクラスター リソースとして構成](how-to-configure-a-biztalk-host-as-a-cluster-resource1.md)します。  
  
   次の手順では、同じ Windows Server クラスターをクラスター化された BizTalk ホストと SSO サービスに従う必要のある手順について説明します。  
  
## <a name="cluster-a-biztalk-host-and-the-sso-master-secret-server-on-the-same-windows-server-cluster"></a>BizTalk ホストと SSO マスター シークレット サーバーを同じ Windows Server クラスターでクラスターします。  
  
1. クラスター化された分散トランザクション コーディネーター (MSDTC) リソースをクラスターが構成されていない場合で MSDTC をクラスター、Windows Server フェールオーバー クラスターで次の手順に従って、[チェックリスト。Windows Server 2008 フェールオーバー クラスターでの MS DTC リソースの作成](http://go.microsoft.com/fwlink/p/?LinkID=129677)(http://go.microsoft.com/fwlink/p/?LinkID=129677)します。  
  
2. インストールし、次の手順に従って、Windows Server クラスターで SSO サービスを構成[マスター シークレット サーバーをクラスター](how-to-cluster-the-master-secret-server1.md)します。 Windows Server クラスターで BizTalk Server を実行するためはのみで構成する場合、SSO コンポーネント現時点でも、必要なすべての BizTalk Server コンポーネントをインストールします。  
  
3. BizTalk Server コンピューター上に記載されている手順に従って IIS をクラスター[マイクロソフト サポート技術情報の記事 970759「を構成する IIS 7.0 では Microsoft Windows Server 2008 フェールオーバー クラスター」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (<http://go.microsoft.com/fwlink/p/?LinkId=152793>)。 クラスター化された SSO サービスと同じクラスター グループでクラスター化された IIS Web サービスを作成します。  
  
4. クラスターのノードの 1 つにクラスター化された SSO サービスを含むクラスター グループに移動し、このクラスター ノードにログオンします。  
  
5. BizTalk Server 構成プログラムを起動し、このクラスター ノードで BizTalk Server の構成を完了します。 これは、グループ内の最初の BizTalk Server コンピューターであるため、クリックして**新しい BizTalk グループを作成**BizTalk グループを構成するときにします。  
  
6. BizTalk Server の構成が正常に完了すると、その他のクラスター ノードとこのクラスター ノードにログオンするクラスター化された SSO サービスを含むクラスター グループを移動します。  
  
7. BizTalk Server 構成プログラムを起動し、このクラスター ノードで BizTalk Server の構成を完了します。 クリックして**既存の BizTalk グループに参加**このクラスター ノードで、BizTalk グループ コンポーネントを構成するときに最初のノードで作成した BizTalk グループを指定します。  
  
8. BizTalk Server の構成が正常に完了すると 1 つを作成または次の手順に従って、BizTalk ホストをクラスター化の詳細は[、BizTalk ホストをクラスター リソースとして構成](how-to-configure-a-biztalk-host-as-a-cluster-resource1.md)します。  
  
   > [!NOTE]
   >  このシナリオでは、クラスター化された SSO サービス リソースと同じクラスター グループ内のクラスター リソースとしてすべての BizTalk ホストを作成する必要があります。 SSO サービスがクラスター化された Windows Server クラスター ノードでクラスター化されていない BizTalk ホスト インスタンスを実行することは、サポートされる構成ではありません。 これは、クラスター化された SSO サービスは、SSO サービス上の BizTalk ホスト インスタンスの依存関係のための別のノードにフェールオーバーしたときに、クラスター化されていない BizTalk ホスト インスタンスが失敗するためです。  
  
## <a name="cluster-a-biztalk-host-and-sso-non-master-secret-server-on-the-same-windows-server-cluster-when-the-sso-master-secret-server-is-remote"></a>BizTalk ホストと SSO (マスター シークレット サーバー以外) は、SSO マスター シークレット サーバーがリモート時に、同じ Windows Server クラスターでクラスターします。  
  
1. クラスター化された分散トランザクション コーディネーター (MSDTC) リソースをクラスターが構成されていない場合で MSDTC をクラスター、Windows Server フェールオーバー クラスターで次の手順に従って、[チェックリスト。Windows Server 2008 フェールオーバー クラスターでの MS DTC リソースの作成](http://go.microsoft.com/fwlink/p/?LinkID=129677)(http://go.microsoft.com/fwlink/p/?LinkID=129677)します。  
  
2. ドメイン グループを作成、名前を持つ**SSO 管理者**と**SSO 関連管理者**します。 SSO サービスのクラスター化されたインスタンスを作成するには、作成する必要があります、 **SSO 管理者**と**SSO 関連管理者**ドメイン グループとしてグループ。  
  
3. 作成またはのメンバであるドメイン アカウントを指定、 **SSO 管理者**ドメイン グループです。 各ノードの SSO サービスは、このドメイン アカウントとしてログオンするように構成されます。 このアカウントが必要、**サービスとしてログオン**クラスター内の各ノードで右。  
  
4. ドメインにインストールおよび構成プロセス中にログオンに使用しているアカウントを追加**SSO 管理者**グループ。  
  
   > [!IMPORTANT]
   >  手順 3 と 4 が完了していない場合、SSO サービスの構成は失敗します。  
  
5. 1 つのクラスター ノードにログオンし、BizTalk Server をインストールします。 インストールが正常に完了したら、構成プログラムを起動するオプションを選択します。  
  
6. 選択、**カスタム構成**オプションし、の適切な値を入力して、**データベース サーバー名**、**ユーザー名**と**パスワード**フィールド。 これらの値を入力した後にをクリックして、**構成**続行ボタンをクリックします。  
  
7. SSO の機能は、次のオプションを設定します。  
  
   1.  横のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオン コンピューターこの**します。  
  
   2.  オプションをクリックして**既存の SSO システムに参加**します。  
  
   3.  既存の SSO データベース サーバー名とデータベース名の値を入力します。  
  
   4.  エンタープライズ シングル サインオン サービスに使用するアカウントを指定する場合は、既存の SSO サービス アカウントを入力します。  
  
8. これは、最初の BizTalk Server グループであるため、オプションを選択します。**新しい BizTalk グループを作成する**BizTalk グループ コンポーネントを構成するときにします。  
  
9. 必要に応じて残りの構成オプションを指定し、このノードに BizTalk Server の構成を適用します。  
  
10. BizTalk Server の構成が最初のノードに正常に完了すると、2 番目のノードにログオンし、BizTalk Server をインストールします。 インストールが正常に完了したら、構成プログラムを起動するオプションを選択します。  
  
11. 選択、**カスタム構成**オプション、および適切な値を入力し、**データベース サーバー名**、**ユーザー名**と**パスワード**フィールド。 これらの値を入力すると、クリックして、**構成**続行ボタンをクリックします。  
  
12. SSO の機能は、次のオプションを設定します。  
  
    1.  横のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオン コンピューターこの**します。  
  
    2.  クリックして**既存の SSO システムに参加**します。  
  
    3.  既存の SSO データベース サーバー名とデータベース名の値を入力します。  
  
    4.  エンタープライズ シングル サインオン サービスに使用するアカウントを指定する場合は、既存の SSO サービス アカウントを入力します。  
  
13. オプションを選択**既存の BizTalk グループに参加**このクラスター ノードで、BizTalk グループ コンポーネントを構成するときに最初のノードで作成した BizTalk グループを指定します。  
  
14. 必要に応じて残りの構成オプションを指定し、このノードに BizTalk Server の構成を適用します。  
  
15. BizTalk Server の構成が正常に完了したら後、は、SSO サービスをクラスターにこれらの手順に従います。  
  
    1.  コマンドから次のコマンドを入力して、各クラスター ノードで、SSO サービスを停止します。  
  
        ```  
        net stop entsso  
        ```  
  
    2.  フェールオーバー クラスターの管理では、すべてのクラスター グループを 1 つのノードに移動し、このノードにログオンします。  
  
    3.  左側にあるウィンドウをクリックして、クラスター化されたサービスまたはアプリケーションを選択する、IP アドレスおよびネットワーク名リソースが含まれています。 このクラスター化されたサービスまたはアプリケーションは、クラスター化された SSO サービスおよびクラスター化された BizTalk ホストが含まれます。  
  
        > [!NOTE]
        >  クラスター化された SSO サービスは、同じグループ内のクラスター化された物理ディスク リソースの使用を明示的に要求されません。  
  
    4.  クラスター化されたサービスまたはアプリケーションを右クリックし、**リソースを追加**、 をクリック**汎用サービス**を表示する、**の新しいリソース ウィザード** ダイアログ ボックス。  
  
    5.  **サービスの選択**のページ、**リソースの新規作成ウィザード**を選択します**エンタープライズ シングル サインオン サービス**、順にクリックします**次**します。  
  
    6.  **確認**ページ クリック **[次へ]** します。  
  
    7.  **概要**ページ クリック**完了**。 エンタープライズ シングル サインオン サービスのクラスター化されたインスタンスは、下に表示されます**その他のリソース**の中央のペインで、**フェールオーバー クラスター管理**インターフェイス。  
  
    8.  エンタープライズ シングル サインオン サービスのクラスター化されたインスタンスを右クリックして**プロパティ**を表示する、**エンタープライズ シングル サインオン サービスのプロパティ** ダイアログ ボックス。  
  
    9. をクリックして、**依存関係**プロパティ ダイアログ ボックスのタブ**挿入**します。  
  
    10. ドロップダウン ボックスをクリックします。**リソース**を選択、**名:** リソースをクリックします **[ok]** します。  
  
        > [!IMPORTANT]
        >  依存関係を追加しない場合、**名:** リソース、SSO クライアント コンピューターが生成されます、次のようなエラー、SSO サービスのクラスター化されたこのインスタンスに接続しようとするとします。  
        >   
        >  マスター シークレットを取得できませんでした。  
        >   
        >  マスター シークレット サーバー名が正しいことと、使用可能なであることを確認します。 シークレット サーバー名:ENTSSO エラー コード:0x800706D9、エンドポイントがあるエンドポイント マッパーから使用できます。  
  
16. BizTalk Server コンピューター上に記載されている手順に従って IIS をクラスター[マイクロソフト サポート技術情報の記事 970759「を構成する IIS 7.0 では Microsoft Windows Server 2008 フェールオーバー クラスター」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (<http://go.microsoft.com/fwlink/p/?LinkId=152793>)。 クラスター化された SSO サービスと同じクラスター グループでクラスター化された IIS web サービスを作成します。  
  
17. フェールオーバー クラスターの管理では、クラスター化されたサービスまたはアプリケーションをクラスター化されたエンタープライズ シングル サインオン サービスを含む右クリックし、順にクリックします**このサービスまたはアプリケーションをオンライン**内のリソースのすべてを開始するにはクラスター化されたサービスまたはアプリケーション。  
  
18. クラスター化されたサービスまたはアプリケーションを右クリックし、**このサービスまたはアプリケーションを別のノードに移動**、2 番目のノードをクリックします。 この手順では、クラスター化されたサービスまたは 2 番目のノードに最初のノードからクラスター化されたエンタープライズ シングル サインオン サービスを含むアプリケーションを移動します。  
  
19. クラスター化されたエンタープライズ シングル サインオン サービスを右クリックし、をクリックして**このサービスまたはアプリケーションをオフラインに**、SSO サービスのクラスター化されたインスタンスを右クリックしておよびクリックして**このサービスまたはアプリケーションをオンライン**します。  
  
20. Ssomanage コマンド ライン ユーティリティを使用したクラスター化された SSO サービスには、すべてのユーザーの SSO サーバー名を設定します。 このコマンドは、SSO のインストール フォルダーから、グループ内の各 BizTalk サーバーで実行する必要があります。 たとえば、次のコマンドラインはクラスター化された SSO サービスをすべてのユーザーの SSO サーバー名を設定します。  
  
    ```  
    ssomanage -serverall SSOCLUSTER  
    ```  
  
    > [!NOTE]
    >  *SSOCLUSTER*はクラスター化された SSO サービスを含むクラスター グループに作成される実際のネットワーク名リソースのプレース ホルダーです。  
  
21. SSO サーバー名を更新、 **BizTalk グループのプロパティ**クラスター化された SSO サービスを参照するページ。 開いている**BizTalk Server 管理**、BizTalk グループを右クリックし、選択、**プロパティ**メニュー項目では、SSO サーバー名、エントリを更新し、順にクリックします**OK**。  
  
22. 次の手順では、 [、BizTalk ホストをクラスター リソースとして構成](how-to-configure-a-biztalk-host-as-a-cluster-resource1.md)同じクラスター グループがクラスター化された SSO サービスを作成することで、1 つまたは複数のクラスター化された BizTalk ホスト インスタンスを作成します。  
  
    > [!NOTE]
    >  このシナリオでは、クラスター化された SSO サービス リソースと同じクラスター グループ内のクラスター リソースとしてすべての BizTalk ホストを作成する必要があります。 SSO サービスがクラスター化された Windows Server クラスター ノードでクラスター化されていない BizTalk ホスト インスタンスを実行することは、サポートされる構成ではありません。 これは、クラスター化された SSO サービスは、SSO サービス上の BizTalk ホスト インスタンスの依存関係のための別のノードにフェールオーバーしたときに、クラスター化されていない BizTalk ホスト インスタンスが失敗するためです。
