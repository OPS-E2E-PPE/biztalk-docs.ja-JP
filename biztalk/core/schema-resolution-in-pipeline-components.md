---
title: パイプライン コンポーネントのスキーマの解決 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- pipelines, schema resolution
- pipeline components, schema resolution
- schemas, pipeline components
ms.assetid: 35a79a6f-788b-4ca1-8483-36dcba5ae580
caps.latest.revision: 14
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c269ff3a7a5d973356754a222699c93179c90362
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36984787"
---
# <a name="schema-resolution-in-pipeline-components"></a>パイプライン コンポーネントのスキーマの解決
パイプラインの逆アセンブラー コンポーネントおよびアセンブラー コンポーネントは、XSD スキーマを使用して、メッセージを処理します。 スキーマには、昇格させたプロパティの一覧、識別フィールド、フラット ファイル メッセージの注釈、XML エンベロープの注釈などの情報が含まれます。  
  
 標準の逆アセンブラー コンポーネントおよびアセンブラー コンポーネントは、スキーマの種類名およびメッセージの種類を使用して、展開されたスキーマの取得をサポートします。 一部のコンポーネントは、スキーマの種類名とメッセージの種類の両方を使用して、スキーマを取得します。スキーマの種類だけでスキーマを取得するコンポーネント (フラット ファイル逆アセンブラーなど) もあります。  
  
 XML メッセージを取得するパイプライン コンポーネントは、メッセージのルート要素および名前空間を調べて、メッセージの種類を判別します。 たとえば、次の XML のメッセージの種類は"<http://MyDocument.org#MyDocument>"。  
  
```  
<ns0:MyDocument xmlns:ns0="http://MyDocument.org">  
  
</ns0:MyDocument>  
```  
  
 スキーマが定義された名前空間を持たない場合、メッセージの種類は、"\<**rootNode**\>"。 たとえば、前の例の XML で名前空間がない場合、メッセージの種類は、"MyDocument" になります。  
  
 標準のパイプライン コンポーネントは、メッセージの種類を使用して、データベースから適切なスキーマを取得します。 既定の XML の受信および送信パイプラインは、メッセージの XML コンテンツから実行時に動的に検出されるメッセージの種類を使用して、読み込むスキーマを常に判別します (認識されないメッセージが許可されるように、パイプライン コンポーネントが設定されている場合を除く)。 XML 逆アセンブラーでは、このメカニズムを使用して、メッセージのエンベロープを削除できます。ただし、XML アセンブラーは、使用するエンベロープ スキーマを認識しないままで送信メッセージのエンベロープを作成することはできません。  
  
 パイプライン デザイナーから、XML アセンブラーの構成プロパティのエンベロープ スキーマを指定します。  
  
## <a name="how-schemas-are-resolved"></a>スキーマの解決方法  
 XmlDisassembler で直接スキーマを指定していない場合、スキーマは次の方法で解決されます。  
  
1. 最初に、展開されたスキーマで修飾されていない検索されるルート ノード名と名前空間を使用して (たとえば、http://MyNamespace#MyRoot)します。 一致するものが 1 つだけ見つかった場合、スキーマは解決されます。 一致するものが複数見つかった場合で、バージョン番号のみが異なり 1 つのバージョンのみがアクティブな場合は、そのバージョンが使用され、スキーマは解決されます。 同じスキーマが複数のアプリケーションでアクティブになっている場合は、複数のアクティブなスキーマが検出されます。この場合、次のステップ 2 に進んでさらに検索が行われます。  
  
2. 手順 1 の複数の一致を解決できない場合は、検索は、アセンブリで、パイプラインの実行によって修飾されます。 一意のスキーマが同じアセンブリ内で見つかった場合、パイプラインを実行し、スキーマは解決されます。  
  
3. 一致するスキーマが見つからない場合は、スキーマの解決にパブリッシャーが使用され、 ルート ノード、名前空間、および公開キー トークンを使用して検索が絞り込まれます。 一致するスキーマが 1 つだけ見つかった場合、スキーマは解決されます。  
  
4. スキーマを解決できない場合は、 一意のスキーマが見つからないというエラーが返されます。  
  
   スキーマの解決には、SQL Server 照合順序の大文字小文字の区別の影響を含むその他の考慮事項を参照してください。 [Namespace 管理](../core/namespace-management.md)します。  
  
   XML アセンブラーのエンベロープまたはフラット ファイル アセンブラーのヘッダーおよびトレーラーを作成するには、次のいずれかの操作を行います。  
  
- カスタムの送信パイプラインを作成し、XML アセンブラーの構成プロパティのエンベロープ スキーマを指定します。 この操作はパイプライン デザイナーで行います。  
  
- BizTalk Server 管理コンソールで、送信ポートの送信パイプラインのプロパティに XMLTransmit を指定します。 省略記号をクリックし、パイプラインのプロパティを構成します。次に、EnvelopeDocSpecNames プロパティのエンベロープ スキーマを指定します。  
  
  同じスキーマの複数のバージョンがデータベースに意図的に (または誤って) 展開されている場合 (並列配置や複数のシナリオが固有のメッセージの種類を使用している場合など)、メッセージの種類によるスキーマ解決が機能しないことがあります。 メッセージの種類によるスキーマ解決に失敗した場合、"スキーマがあいまい" であることを示すエラーがイベント ログに追加されます。 メッセージの種類によるスキーマ解決が成功したかを確認するには、次のいずれかの操作を行います。  
  
- カスタム パイプラインと同じ BizTalk プロジェクトのスキーマを定義します。  
  
- パイプラインを含むアセンブリと同じキーを持つスキーマのアセンブリに署名します。  
  
- パイプライン コンポーネントのスキーマを明示的に指定します (メッセージの種類の名前は、BizTalk 管理データベースで固有にする必要があります)。  
  
> [!IMPORTANT]
>  同じアセンブリ内のスキーマでメッセージの種類を共有する場合、同一のパイプライン コンポーネント アセンブリ内にこれらのスキーマを含めないでください。これは、あいまい解決の制限があるためです。代わりに、パイプライン コンポーネント アセンブリの外部のスキーマを参照してください。 スキーマおよびパイプライン コンポーネントが同じアセンブリにある場合、スキーマの種類名がカスタム パイプラインのパイプライン コンポーネントで明示的に指定されていても、あいまい解決は機能しません。  
  
> [!NOTE]
>  使用するカスタム パイプライン コンポーネント**IPipelineContext**展開されたスキーマを取得する必要があります、実行時に、コンポーネントのスキーマの種類名が指定しない場合にのみ、スキーマの種類ごとにスキーマを取得し、メッセージの種類のみでスキーマを取得場合は、コンポーネントの実行時に、スキーマの種類の情報を使用できません。  
  
## <a name="see-also"></a>参照  
 [パイプライン コンポーネント](../core/pipeline-components.md)