---
title: "Windows SharePoint Services アダプターの式 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- macros, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], supported macros
- configuring [Windows SharePoint Services adapters], expressions
- Windows SharePoint Services adapters, expressions
ms.assetid: 15e3afb2-0ef8-41b4-b3ec-de84af738c12
caps.latest.revision: "22"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 377859a1b2c28774342c6ff9dc5cc312c9fd82d9
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/28/2017
---
# <a name="windows-sharepoint-services-adapter-expressions"></a><span data-ttu-id="498ab-102">Windows SharePoint Services アダプターの式</span><span class="sxs-lookup"><span data-stu-id="498ab-102">Windows SharePoint Services Adapter Expressions</span></span>
<span data-ttu-id="498ab-103">このトピックは、形式との値として指定できる文字列の意味について説明します、**ファイル NameProperty ソース**Windows SharePoint Services アダプターのプロパティです。</span><span class="sxs-lookup"><span data-stu-id="498ab-103">This topic describes the format and the meaning of the strings that can be specified as values for the **File NameProperty Source** properties of the Windows SharePoint Services adapter.</span></span> <span data-ttu-id="498ab-104">関連するコンテキスト プロパティについても説明**WSS です。Filename**と**WSS です。ConfigPropertiesXml**です。</span><span class="sxs-lookup"><span data-stu-id="498ab-104">It also describes the related context properties, **WSS.Filename** and **WSS.ConfigPropertiesXml**.</span></span> <span data-ttu-id="498ab-105">これらの式を使用すると、メッセージや BizTalk システムから抽出された値だけでなく、ファイル名の値、つまり、カスタム Windows SharePoint Service 列値を、リテラルに基づいて簡単に定義できます。</span><span class="sxs-lookup"><span data-stu-id="498ab-105">These expressions allow you to easily define the file name value, or custom Windows SharePoint Service column value, based on literals as well as values extracted from the message or the BizTalk system.</span></span>  
  
 <span data-ttu-id="498ab-106">式には、リテラルやマクロを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="498ab-106">The expressions can contain literals and macros.</span></span> <span data-ttu-id="498ab-107">リテラルは、入力したとおりにファイル名に表示されます。</span><span class="sxs-lookup"><span data-stu-id="498ab-107">The literals will show up in the file name exactly as you type them.</span></span> <span data-ttu-id="498ab-108">マクロは、'%' 文字の間に配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="498ab-108">Macros must be placed between '%' characters.</span></span> <span data-ttu-id="498ab-109">マクロの例として `%MessageID%` があります。このマクロは、実行時にメッセージの GUID に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="498ab-109">An example of a macro is `%MessageID%` which at runtime will be replaced with the GUID of the message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="498ab-110">使用する場合、% 文字がリテラルとして、または、XPATH 内で、次のようにエスケープする必要がある\\% です。</span><span class="sxs-lookup"><span data-stu-id="498ab-110">When the % character is used as a literal or within an XPATH, it must be escaped like this \\%.</span></span> <span data-ttu-id="498ab-111">1 つの % はマクロの区切り記号と見なされます場所、 \\% は 1 つの % によって実行時に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="498ab-111">A single % will be considered a macro delimiter, where a \\% will be replaced at runtime by a single %.</span></span> <span data-ttu-id="498ab-112">\ 文字は、次のようにエスケープする必要があります\\\\です。</span><span class="sxs-lookup"><span data-stu-id="498ab-112">The \ character must be escaped like this \\\\.</span></span>  
  
## <a name="expression-examples"></a><span data-ttu-id="498ab-113">式の例</span><span class="sxs-lookup"><span data-stu-id="498ab-113">Expression examples</span></span>  
  
|<span data-ttu-id="498ab-114">デザイン時の値</span><span class="sxs-lookup"><span data-stu-id="498ab-114">Design time value</span></span>|<span data-ttu-id="498ab-115">実行時の値</span><span class="sxs-lookup"><span data-stu-id="498ab-115">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="498ab-116">XYZ 社</span><span class="sxs-lookup"><span data-stu-id="498ab-116">XYZ</span></span>|<span data-ttu-id="498ab-117">XYZ 社</span><span class="sxs-lookup"><span data-stu-id="498ab-117">XYZ</span></span>|  
|<span data-ttu-id="498ab-118">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="498ab-118">PurchaseOrder</span></span>|<span data-ttu-id="498ab-119">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="498ab-119">PurchaseOrder</span></span>|  
|<span data-ttu-id="498ab-120">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="498ab-120">%MessageID%</span></span>|<span data-ttu-id="498ab-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="498ab-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="498ab-122">PurchaseOrder - %MessageID%</span><span class="sxs-lookup"><span data-stu-id="498ab-122">PurchaseOrder - %MessageID%</span></span>|<span data-ttu-id="498ab-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="498ab-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="498ab-124">割引\\%10</span><span class="sxs-lookup"><span data-stu-id="498ab-124">Discount \\%10</span></span>|<span data-ttu-id="498ab-125">Discount %10</span><span class="sxs-lookup"><span data-stu-id="498ab-125">Discount %10</span></span>|  
|<span data-ttu-id="498ab-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="498ab-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="498ab-127">PurchaseOrder – 10001</span><span class="sxs-lookup"><span data-stu-id="498ab-127">PurchaseOrder – 10001</span></span>|  
|<span data-ttu-id="498ab-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="498ab-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="498ab-129">PurchaseOrder – Contoso-10001</span><span class="sxs-lookup"><span data-stu-id="498ab-129">PurchaseOrder – Contoso-10001</span></span>|  
  
## <a name="supported-macros"></a><span data-ttu-id="498ab-130">サポートされているマクロ</span><span class="sxs-lookup"><span data-stu-id="498ab-130">Supported macros</span></span>  
  
|<span data-ttu-id="498ab-131">デザイン時の値</span><span class="sxs-lookup"><span data-stu-id="498ab-131">Design time value</span></span>|<span data-ttu-id="498ab-132">実行時の値</span><span class="sxs-lookup"><span data-stu-id="498ab-132">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="498ab-133">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="498ab-133">%MessageID%</span></span>|<span data-ttu-id="498ab-134">一意な GUID を表す BizTalk メッセージ ID。</span><span class="sxs-lookup"><span data-stu-id="498ab-134">The BizTalk message ID which is a unique GUID.</span></span>|  
|<span data-ttu-id="498ab-135">%SendingOrchestrationID%</span><span class="sxs-lookup"><span data-stu-id="498ab-135">%SendingOrchestrationID%</span></span>|<span data-ttu-id="498ab-136">メッセージの発信元であるオーケストレーション インスタンスの BizTalk ID。</span><span class="sxs-lookup"><span data-stu-id="498ab-136">The BizTalk ID of the orchestration instance where the message originated.</span></span>|  
|<span data-ttu-id="498ab-137">%SendingOrchestrationType%</span><span class="sxs-lookup"><span data-stu-id="498ab-137">%SendingOrchestrationType%</span></span>|<span data-ttu-id="498ab-138">メッセージの発信元であるオーケストレーションの種類名。</span><span class="sxs-lookup"><span data-stu-id="498ab-138">The type name of the orchestration where the message originated.</span></span>|  
|<span data-ttu-id="498ab-139">%Xpath =\<xpath\>%</span><span class="sxs-lookup"><span data-stu-id="498ab-139">%XPATH=\<xpath\>%</span></span>|<span data-ttu-id="498ab-140">メッセージから値を抽出する際に XPATH を使用するように指定できます。</span><span class="sxs-lookup"><span data-stu-id="498ab-140">Allows specifying an XPATH to be used for extracting the value from the message.</span></span> <span data-ttu-id="498ab-141">"\<xpath\>"有効な XPATH 式と置き換える必要があります。</span><span class="sxs-lookup"><span data-stu-id="498ab-141">“\<xpath\>” must be replaced with a valid XPATH expression.</span></span> <span data-ttu-id="498ab-142">**注:** ' Namespace Aliases' または WSS 内の式の外部名前空間の別名を定義する必要があります。ConfigNamespaceAliases フィールドです。</span><span class="sxs-lookup"><span data-stu-id="498ab-142">**Note:**  The namespace alias must be defined outside the expression in the 'Namespace Aliases' or WSS.ConfigNamespaceAliases field.</span></span>|  
|<span data-ttu-id="498ab-143">%Filename%</span><span class="sxs-lookup"><span data-stu-id="498ab-143">%Filename%</span></span>|<span data-ttu-id="498ab-144">メッセージのコンテキスト プロパティ WSS.Filename から抽出されたファイル名の値と置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="498ab-144">Replaced with the filename value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="498ab-145">SharePoint から受け取ったメッセージの WSS.Filename コンテキスト プロパティの値には、SharePoint ファイル名が設定されます。</span><span class="sxs-lookup"><span data-stu-id="498ab-145">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="498ab-146">戻り値は、Path.GetFilenameWithoutExtension を使用して前処理されます。</span><span class="sxs-lookup"><span data-stu-id="498ab-146">The returned value is preprocessed using Path.GetFilenameWithoutExtension.</span></span> <span data-ttu-id="498ab-147">**注:** WSS でこのマクロは使用できません。Config * (オーケストレーション) からコンテキスト プロパティです。</span><span class="sxs-lookup"><span data-stu-id="498ab-147">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
|<span data-ttu-id="498ab-148">%Extension%</span><span class="sxs-lookup"><span data-stu-id="498ab-148">%Extension%</span></span>|<span data-ttu-id="498ab-149">メッセージのコンテンツ プロパティ WSS.Filename から抽出されたファイル拡張子の値に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="498ab-149">Replaced with the file extension value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="498ab-150">SharePoint から受け取ったメッセージの WSS.Filename コンテキスト プロパティの値には、SharePoint ファイル名が設定されます。</span><span class="sxs-lookup"><span data-stu-id="498ab-150">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="498ab-151">戻り値は、Path.GetExtension を使用して前処理されます。</span><span class="sxs-lookup"><span data-stu-id="498ab-151">The returned value is preprocessed using Path.GetExtension.</span></span> <span data-ttu-id="498ab-152">戻り値には、"." は含まれません。</span><span class="sxs-lookup"><span data-stu-id="498ab-152">The returned value will not contain ".".</span></span> <span data-ttu-id="498ab-153">**注:** WSS でこのマクロは使用できません。Config * (オーケストレーション) からコンテキスト プロパティです。</span><span class="sxs-lookup"><span data-stu-id="498ab-153">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
  
 <span data-ttu-id="498ab-154">プロパティの昇格でサポートされている有効な式は、デザイン時の有効なファイル名です。</span><span class="sxs-lookup"><span data-stu-id="498ab-154">Any valid expression supported by property promotion is a valid design time file name.</span></span> <span data-ttu-id="498ab-155">デザイン時のファイル名は、実行時に、Windows SharePoint Services ファイル名に拡張されます。</span><span class="sxs-lookup"><span data-stu-id="498ab-155">The design time file name will be expanded at runtime into Windows SharePoint Services file names.</span></span> <span data-ttu-id="498ab-156">この Windows SharePoint Services ファイル名には、次のようにいくつかの制限事項があります。</span><span class="sxs-lookup"><span data-stu-id="498ab-156">This Windows SharePoint Services file name has some additional limitations, which are described as follows:</span></span>  
  
-   <span data-ttu-id="498ab-157">有効な Windows ファイル名には、Unicode 文字を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="498ab-157">Valid Windows file names can contain any Unicode characters with the exception of the following: /  \  :  *  ?</span></span>  <span data-ttu-id="498ab-158">< > &#124;です。 "# {} % & ~ およびタブ文字や複数の期間。</span><span class="sxs-lookup"><span data-stu-id="498ab-158"><  >  &#124;  "  #  {  }  %  &  ~ or tab characters and multiple periods.</span></span>  
  
-   <span data-ttu-id="498ab-159">ファイル名は 256 文字以下にしてください。また、URL 全体は 256 文字以下にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="498ab-159">The file name cannot be longer than 256 characters and the entire URL must be less than or equal to 256 characters.</span></span>  
  
-   <span data-ttu-id="498ab-160">拡張された Windows SharePoint Services ファイル名に無効な文字が含まれている場合、または拡張されたファイル名や URL が長すぎる場合は、エラーがアプリケーション イベント ログに記録され、メッセージは中断されます。</span><span class="sxs-lookup"><span data-stu-id="498ab-160">If the expanded Windows SharePoint Services file name contains invalid characters, or if the expanded file name or URL is too long, an error will be logged in the application event log and the message will be suspended.</span></span> <span data-ttu-id="498ab-161">[グループ ハブ] ページでは、メッセージ イベントおよびサービス インスタンスの追跡を使用して、エラーおよびメッセージの状態を表示することもできます。</span><span class="sxs-lookup"><span data-stu-id="498ab-161">The error and the message state will also be visible in the Group Hub page using the message event and service instance tracking.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="498ab-162">参照</span><span class="sxs-lookup"><span data-stu-id="498ab-162">See Also</span></span>  
 <span data-ttu-id="498ab-163">[サービスの受信場所を Windows SharePoint を構成する方法](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span><span class="sxs-lookup"><span data-stu-id="498ab-163">[How to Configure a Windows SharePoint Services Receive Location](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span></span>  
 <span data-ttu-id="498ab-164">[Windows SharePoint Services 送信ハンドラーを構成する方法](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span><span class="sxs-lookup"><span data-stu-id="498ab-164">[How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span></span>  
 <span data-ttu-id="498ab-165">[Windows SharePoint Services 送信ポートを構成する方法](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span><span class="sxs-lookup"><span data-stu-id="498ab-165">[How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span></span>  
 <span data-ttu-id="498ab-166">[Windows SharePoint Services アダプターのプロパティのリファレンス](../core/windows-sharepoint-services-adapter-properties-reference.md) </span><span class="sxs-lookup"><span data-stu-id="498ab-166">[Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md) </span></span>  
 [<span data-ttu-id="498ab-167">サポートされている Windows SharePoint Services 列の型</span><span class="sxs-lookup"><span data-stu-id="498ab-167">Supported Windows SharePoint Services Column Types</span></span>](../core/supported-windows-sharepoint-services-column-types.md)