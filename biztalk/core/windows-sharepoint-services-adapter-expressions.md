---
title: Windows SharePoint Services アダプターの式 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- macros, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], supported macros
- configuring [Windows SharePoint Services adapters], expressions
- Windows SharePoint Services adapters, expressions
ms.assetid: 15e3afb2-0ef8-41b4-b3ec-de84af738c12
caps.latest.revision: 22
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 553ed4526607a30141f9643f08a5afa11c5bc538
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65240333"
---
# <a name="windows-sharepoint-services-adapter-expressions"></a><span data-ttu-id="f0498-102">Windows SharePoint Services アダプターの式</span><span class="sxs-lookup"><span data-stu-id="f0498-102">Windows SharePoint Services Adapter Expressions</span></span>
<span data-ttu-id="f0498-103">このトピックでは、形式との値として指定できる文字列の意味について説明します、**ファイル NameProperty ソース**Windows SharePoint Services アダプターのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="f0498-103">This topic describes the format and the meaning of the strings that can be specified as values for the **File NameProperty Source** properties of the Windows SharePoint Services adapter.</span></span> <span data-ttu-id="f0498-104">関連するコンテキストのプロパティについても説明**WSS。ファイル名**と**WSS。ConfigPropertiesXml**します。</span><span class="sxs-lookup"><span data-stu-id="f0498-104">It also describes the related context properties, **WSS.Filename** and **WSS.ConfigPropertiesXml**.</span></span> <span data-ttu-id="f0498-105">これらの式を使用すると、ファイル名の値、またはリテラルと、メッセージや BizTalk システムから抽出された値に基づいて、カスタムの Windows SharePoint Service 列値を簡単に定義できます。</span><span class="sxs-lookup"><span data-stu-id="f0498-105">These expressions allow you to easily define the file name value, or custom Windows SharePoint Service column value, based on literals as well as values extracted from the message or the BizTalk system.</span></span>  
  
 <span data-ttu-id="f0498-106">式には、リテラルやマクロを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="f0498-106">The expressions can contain literals and macros.</span></span> <span data-ttu-id="f0498-107">それらを入力したとおりに、リテラルがファイル名で表示されます。</span><span class="sxs-lookup"><span data-stu-id="f0498-107">The literals will show up in the file name exactly as you type them.</span></span> <span data-ttu-id="f0498-108">マクロは、'%' 文字の間に配置する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f0498-108">Macros must be placed between '%' characters.</span></span> <span data-ttu-id="f0498-109">マクロの例は`%MessageID%`ランタイムでは、メッセージの GUID に置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="f0498-109">An example of a macro is `%MessageID%` which at runtime will be replaced with the GUID of the message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f0498-110">% 文字をリテラルとして、または、XPATH 内で使用する場合、次のようにはエスケープする必要があります\\%。</span><span class="sxs-lookup"><span data-stu-id="f0498-110">When the % character is used as a literal or within an XPATH, it must be escaped like this \\%.</span></span> <span data-ttu-id="f0498-111">単一の % はマクロの区切り記号、考慮する場所、\\単一の % で、実行時に % が置き換えられます。</span><span class="sxs-lookup"><span data-stu-id="f0498-111">A single % will be considered a macro delimiter, where a \\% will be replaced at runtime by a single %.</span></span> <span data-ttu-id="f0498-112">\ 文字は、次のようにエスケープする必要があります\\\\します。</span><span class="sxs-lookup"><span data-stu-id="f0498-112">The \ character must be escaped like this \\\\.</span></span>  
  
## <a name="expression-examples"></a><span data-ttu-id="f0498-113">式の例</span><span class="sxs-lookup"><span data-stu-id="f0498-113">Expression examples</span></span>  
  
|<span data-ttu-id="f0498-114">デザイン時の値</span><span class="sxs-lookup"><span data-stu-id="f0498-114">Design time value</span></span>|<span data-ttu-id="f0498-115">ランタイム値</span><span class="sxs-lookup"><span data-stu-id="f0498-115">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="f0498-116">XYZ 社</span><span class="sxs-lookup"><span data-stu-id="f0498-116">XYZ</span></span>|<span data-ttu-id="f0498-117">XYZ 社</span><span class="sxs-lookup"><span data-stu-id="f0498-117">XYZ</span></span>|  
|<span data-ttu-id="f0498-118">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="f0498-118">PurchaseOrder</span></span>|<span data-ttu-id="f0498-119">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="f0498-119">PurchaseOrder</span></span>|  
|<span data-ttu-id="f0498-120">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="f0498-120">%MessageID%</span></span>|<span data-ttu-id="f0498-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="f0498-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="f0498-122">PurchaseOrder の %messageid%</span><span class="sxs-lookup"><span data-stu-id="f0498-122">PurchaseOrder - %MessageID%</span></span>|<span data-ttu-id="f0498-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="f0498-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="f0498-124">割引\\10%</span><span class="sxs-lookup"><span data-stu-id="f0498-124">Discount \\%10</span></span>|<span data-ttu-id="f0498-125">10% を割引します。</span><span class="sxs-lookup"><span data-stu-id="f0498-125">Discount %10</span></span>|  
|<span data-ttu-id="f0498-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="f0498-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="f0498-127">PurchaseOrder – 10001</span><span class="sxs-lookup"><span data-stu-id="f0498-127">PurchaseOrder – 10001</span></span>|  
|<span data-ttu-id="f0498-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="f0498-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="f0498-129">PurchaseOrder – Contoso 10001</span><span class="sxs-lookup"><span data-stu-id="f0498-129">PurchaseOrder – Contoso-10001</span></span>|  
  
## <a name="supported-macros"></a><span data-ttu-id="f0498-130">サポートされているマクロ</span><span class="sxs-lookup"><span data-stu-id="f0498-130">Supported macros</span></span>  
  
|<span data-ttu-id="f0498-131">デザイン時の値</span><span class="sxs-lookup"><span data-stu-id="f0498-131">Design time value</span></span>|<span data-ttu-id="f0498-132">ランタイム値</span><span class="sxs-lookup"><span data-stu-id="f0498-132">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="f0498-133">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="f0498-133">%MessageID%</span></span>|<span data-ttu-id="f0498-134">これは一意の GUID を BizTalk メッセージの ID です。</span><span class="sxs-lookup"><span data-stu-id="f0498-134">The BizTalk message ID which is a unique GUID.</span></span>|  
|<span data-ttu-id="f0498-135">%Sendingorchestrationid%</span><span class="sxs-lookup"><span data-stu-id="f0498-135">%SendingOrchestrationID%</span></span>|<span data-ttu-id="f0498-136">メッセージが発信元であるオーケストレーション インスタンスの BizTalk ID。</span><span class="sxs-lookup"><span data-stu-id="f0498-136">The BizTalk ID of the orchestration instance where the message originated.</span></span>|  
|<span data-ttu-id="f0498-137">%SendingOrchestrationType%</span><span class="sxs-lookup"><span data-stu-id="f0498-137">%SendingOrchestrationType%</span></span>|<span data-ttu-id="f0498-138">メッセージが発信元であるオーケストレーションの型名。</span><span class="sxs-lookup"><span data-stu-id="f0498-138">The type name of the orchestration where the message originated.</span></span>|  
|<span data-ttu-id="f0498-139">%Xpath =\<xpath\>%</span><span class="sxs-lookup"><span data-stu-id="f0498-139">%XPATH=\<xpath\>%</span></span>|<span data-ttu-id="f0498-140">メッセージから値を抽出するために使用される XPATH を指定できます。</span><span class="sxs-lookup"><span data-stu-id="f0498-140">Allows specifying an XPATH to be used for extracting the value from the message.</span></span> <span data-ttu-id="f0498-141">"\<xpath\>"有効な XPATH 式に置き換える必要があります。</span><span class="sxs-lookup"><span data-stu-id="f0498-141">“\<xpath\>” must be replaced with a valid XPATH expression.</span></span> <span data-ttu-id="f0498-142">**注:**' Namespace Aliases' または WSS の式の外部名前空間の別名を定義する必要があります。ConfigNamespaceAliases フィールドです。</span><span class="sxs-lookup"><span data-stu-id="f0498-142">**Note:**  The namespace alias must be defined outside the expression in the 'Namespace Aliases' or WSS.ConfigNamespaceAliases field.</span></span>|  
|<span data-ttu-id="f0498-143">ファイル名 %</span><span class="sxs-lookup"><span data-stu-id="f0498-143">%Filename%</span></span>|<span data-ttu-id="f0498-144">WSS メッセージ コンテキスト プロパティから抽出されたファイル名の値に置き換えられます。ファイル名。</span><span class="sxs-lookup"><span data-stu-id="f0498-144">Replaced with the filename value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="f0498-145">SharePoint から受信したメッセージは、WSS があります。ファイル名のコンテキスト プロパティの値は、SharePoint ファイルの名前に設定します。</span><span class="sxs-lookup"><span data-stu-id="f0498-145">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="f0498-146">返される値は Path.GetFilenameWithoutExtension を使用して前処理されます。</span><span class="sxs-lookup"><span data-stu-id="f0498-146">The returned value is preprocessed using Path.GetFilenameWithoutExtension.</span></span> <span data-ttu-id="f0498-147">**注:** このマクロは、WSS では使用できません。Config \* (オーケストレーション) からコンテキスト プロパティです。</span><span class="sxs-lookup"><span data-stu-id="f0498-147">**Note:**  This macro cannot be used in WSS.Config\* context properties (from orchestration).</span></span>|  
|<span data-ttu-id="f0498-148">拡張機能 %</span><span class="sxs-lookup"><span data-stu-id="f0498-148">%Extension%</span></span>|<span data-ttu-id="f0498-149">WSS メッセージ コンテキスト プロパティから抽出するファイルの拡張機能値に置き換えられます。ファイル名。</span><span class="sxs-lookup"><span data-stu-id="f0498-149">Replaced with the file extension value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="f0498-150">SharePoint から受信したメッセージは、WSS があります。ファイル名のコンテキスト プロパティの値は、SharePoint ファイルの名前に設定します。</span><span class="sxs-lookup"><span data-stu-id="f0498-150">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="f0498-151">返される値は Path.GetExtension を使用して前処理されます。</span><span class="sxs-lookup"><span data-stu-id="f0498-151">The returned value is preprocessed using Path.GetExtension.</span></span> <span data-ttu-id="f0498-152">返される値にが含まれていません"."です。</span><span class="sxs-lookup"><span data-stu-id="f0498-152">The returned value will not contain ".".</span></span> <span data-ttu-id="f0498-153">**注:** このマクロは、WSS では使用できません。Config \* (オーケストレーション) からコンテキスト プロパティです。</span><span class="sxs-lookup"><span data-stu-id="f0498-153">**Note:**  This macro cannot be used in WSS.Config\* context properties (from orchestration).</span></span>|  
  
 <span data-ttu-id="f0498-154">プロパティの昇格でサポートされている任意の有効な式は、有効なデザイン時のファイル名です。</span><span class="sxs-lookup"><span data-stu-id="f0498-154">Any valid expression supported by property promotion is a valid design time file name.</span></span> <span data-ttu-id="f0498-155">デザイン時のファイル名は、Windows SharePoint Services ファイル名に、実行時に展開されます。</span><span class="sxs-lookup"><span data-stu-id="f0498-155">The design time file name will be expanded at runtime into Windows SharePoint Services file names.</span></span> <span data-ttu-id="f0498-156">この Windows SharePoint Services ファイル名には、次のように説明されているいくつか追加の制限があります。</span><span class="sxs-lookup"><span data-stu-id="f0498-156">This Windows SharePoint Services file name has some additional limitations, which are described as follows:</span></span>  
  
-   <span data-ttu-id="f0498-157">有効な Windows ファイル名は、次を除く任意の Unicode 文字を含めることができます:/\: \*?</span><span class="sxs-lookup"><span data-stu-id="f0498-157">Valid Windows file names can contain any Unicode characters with the exception of the following: /  \  :  \*  ?</span></span>  <span data-ttu-id="f0498-158">< > &#124; "# {} % & ~ およびタブ文字や複数の期間。</span><span class="sxs-lookup"><span data-stu-id="f0498-158"><  >  &#124;  "  #  {  }  %  &  ~ or tab characters and multiple periods.</span></span>  
  
-   <span data-ttu-id="f0498-159">ファイル名は 256 文字より長くすることはできませんし、URL 全体は 256 文字以下である必要があります。</span><span class="sxs-lookup"><span data-stu-id="f0498-159">The file name cannot be longer than 256 characters and the entire URL must be less than or equal to 256 characters.</span></span>  
  
-   <span data-ttu-id="f0498-160">展開の Windows SharePoint Services ファイル名に無効な文字が含まれている場合、または拡張されたファイルの名前または URL が長すぎる場合は、アプリケーション イベント ログでエラーがログに記録して、メッセージは中断されます。</span><span class="sxs-lookup"><span data-stu-id="f0498-160">If the expanded Windows SharePoint Services file name contains invalid characters, or if the expanded file name or URL is too long, an error will be logged in the application event log and the message will be suspended.</span></span> <span data-ttu-id="f0498-161">エラーおよびメッセージの状態も表示されます、グループ ハブ ページで、メッセージ イベントおよびサービス インスタンスの追跡を使用します。</span><span class="sxs-lookup"><span data-stu-id="f0498-161">The error and the message state will also be visible in the Group Hub page using the message event and service instance tracking.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f0498-162">参照</span><span class="sxs-lookup"><span data-stu-id="f0498-162">See Also</span></span>  
 <span data-ttu-id="f0498-163">[サービスの受信場所を Windows SharePoint を構成する方法](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span><span class="sxs-lookup"><span data-stu-id="f0498-163">[How to Configure a Windows SharePoint Services Receive Location](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span></span>  
 <span data-ttu-id="f0498-164">[Windows SharePoint Services 送信ハンドラーを構成する方法](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span><span class="sxs-lookup"><span data-stu-id="f0498-164">[How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span></span>  
 <span data-ttu-id="f0498-165">[Windows SharePoint Services 送信ポートを構成する方法](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span><span class="sxs-lookup"><span data-stu-id="f0498-165">[How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span></span>  
 <span data-ttu-id="f0498-166">[Windows SharePoint Services アダプターのプロパティに関するリファレンス](../core/windows-sharepoint-services-adapter-properties-reference.md) </span><span class="sxs-lookup"><span data-stu-id="f0498-166">[Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md) </span></span>  
 [<span data-ttu-id="f0498-167">サポートされている Windows SharePoint Services 列の型</span><span class="sxs-lookup"><span data-stu-id="f0498-167">Supported Windows SharePoint Services Column Types</span></span>](../core/supported-windows-sharepoint-services-column-types.md)