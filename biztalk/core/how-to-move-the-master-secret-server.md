---
title: "マスター シークレット サーバーを移動する方法 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- managing [Master Secret server], migrating
- migrating, Master Secret server
- Master Secret server, migrating
ms.assetid: 2bc5137e-f81d-486d-bb91-7c5981896f79
caps.latest.revision: "20"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4158b59e3cce9664ca7c8c7d8ea4c5e3221b04b9
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/01/2017
---
# <a name="how-to-move-the-master-secret-server"></a>マスター シークレット サーバーを移動する方法
このトピックでは、マスター シークレットをあるサーバーから別のサーバーに移動するための手順、およびマスター シークレットをあるサーバーから Windows Server クラスターに移動するための手順について説明します。  
  
### <a name="to-move-the-master-secret-from-one-server-to-another-server"></a>マスター シークレットをあるサーバーから別のサーバーに移動するには  
  
1.  新しいマスター シークレット サーバーに Microsoft エンタープライズ シングル サインオン (SSO) サーバーがインストールされていない場合はインストールします。 BizTalk Server の CD の \Platform\SSO\setup.exe から Microsoft エンタープライズ シングル サインオン サーバーのセットアップを起動します。  
  
2.  新しいマスター シークレット サーバーでエンタープライズ SSO が構成されていない場合は構成します。 エンタープライズ SSO を構成するには、次の手順を実行します。  
  
    1.  構成ツールを起動します。 既定では、構成ツールにある\<ドライブ\>: \program files \common files \enterprise Single sign-on On\Configuration.exe です。  
  
    2.  クリックして選択**エンタープライズ SSO**左側のウィンドウでします。  
  
    3.  次のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオンこのコンピューターに**右側のウィンドウでします。  
  
    4.  オプションをクリックして**既存の SSO システムに参加**です。  
  
    5.  既存の指定**サーバー名**と**データベース名**SSO データベースのオプションです。  
  
    6.  既存のエンタープライズ SSO サービス アカウントを指定、**エンタープライズ シングル サインオン サーバーの Windows サービスの**オプション。  
  
        > [!NOTE]
        >  これは、ドメイン アカウントである必要があります。  
  
    7.  オプションをクリックして**構成の適用** をクリック**構成**構成ウィザード ダイアログ ボックスで、構成を完了します。  
  
    8.  をクリックして**完了**し、構成ツールを閉じます。  
  
3.  」の手順に従って、既存のマスター シークレットをバックアップ[バックアップ マスター シークレットを方法](../core/how-to-back-up-the-master-secret.md)です。  
  
4.  新しいマスター シークレット サーバーを参照するように、SSO データベースのマスター シークレット サーバー名を変更します。 たとえば、新しいマスター シークレット サーバーの名前があります**NewMSSServer**です。 SSO データベースのマスター シークレット サーバー名を変更するには、元のマスター シークレット サーバーで次の手順を実行します。  
  
    1.  notepad.exe などのテキスト エディターに次のコードを貼り付けます。  
  
        ```  
        <sso>  
        <globalInfo>  
        <secretServer>NewMSSServer</secretServer>  
        </globalInfo>  
        </sso>  
        ```  
  
    2.  ファイルを .xml ファイルとして保存します。 たとえば、としてファイルを保存**NewMSSServer.xml**です。  
  
    3.  コマンド プロンプトで、エンタープライズ SSO のインストール フォルダーに移動します。 インストール フォルダーは、既定では、\<ドライブ\>: \program files \common files \enterprise シングル サインオンします。  
  
    4.  型**ssomanage-updatedb** *XMLFile*データベースのマスター シークレット サーバー名を更新します。  
  
        > [!NOTE]
        >  置き換える*XMLFile*保存した .xml ファイルの名前に置き換えます。  
  
        > [!NOTE]
        >  ユーザー アカウント制御 (UAC) をサポートするシステムでは、管理者特権を使用してこのツールを実行することが必要な場合があります。  
  
5.  新しいマスター シークレット サーバーで、エンタープライズ シングル サインオン サービスを再開します。  
  
6.  次の手順に従って、新しいマスター シークレット サーバー上にバックアップしたマスター シークレットを復元[マスター シークレットを復元する方法](../core/how-to-restore-the-master-secret.md)新しいマスター シークレット サーバーでします。  
  
### <a name="to-move-the-master-secret-from-one-server-to-a-windows-server-cluster"></a>マスター シークレットをサーバーから Windows Server クラスターに移動するには  
  
1.  インストールし、次の手順に従って、Windows Server クラスターで、エンタープライズ SSO サービスを構成する[マスター シークレット サーバーをクラスター化する方法](../core/how-to-cluster-the-master-secret-server1.md)です。 すべての手順で説明する手順は除くには、このトピックで、 **2 番目のクラスター ノードでマスター シークレットを復元**セクションです。 既存のマスター シークレット サーバーをクラスターに移動するためにオプションを選択しない**新しい SSO システムを作成する**クラスター ノードにエンタープライズ SSO を構成するときにします。 各クラスター ノードを構成する際に、BizTalk Server 構成プログラムで、エンタープライズ SSO の機能に対して、次のオプションを設定します。  
  
    1.  横にチェック ボックスをオン**を有効にするエンタープライズ シングル サインオンこのコンピューターに**です。  
  
    2.  オプションをクリックして**既存の SSO システムに参加**です。  
  
    3.  既存の SSO データベース サーバー名およびデータベース名を入力します。  
  
    4.  エンタープライズ シングル サインオン サービスに使用するアカウントを指定するときに既存の SSO サービス アカウントを入力します。  
  
2.  既存のマスター シークレットのバックアップ ファイルを、各クラスター ノードの \Enterprise Single Sign-On フォルダーにコピーします。  
  
3.  この Windows Server クラスターでは、1 つまたは複数のクラスター化された BizTalk ホストをホストする、ssomanage コマンド ライン ユーティリティを使用して、クラスター化されたマスター シークレット サーバーにすべてのユーザーの SSO サーバー名を設定します。 このコマンドは、グループ内の BizTalk Server ごとに、エンタープライズ SSO のインストール フォルダーから実行する必要があります。 たとえば、次のコマンド ラインを使用して、すべてのユーザーの SSO サーバー名をクラスター化されたマスター シークレット サーバーに設定します。  
  
    ```  
    ssomanage -serverall SSOCLUSTER  
    ```  
  
    > [!NOTE]
    >  *SSOCLUSTER*は、このシナリオをマスター シークレット サーバーをクラスター化されたリソースを含むクラスター グループに作成されるリソースの名前は、実際のネットワークのプレース ホルダー、すべての BizTalk ホストを同じクラスター リソースとして作成する必要がありますクラスター化されたエンタープライズ SSO サービス リソースとクラスター グループ。 エンタープライズ SSO サービスがクラスター化されていない Windows Server クラスター ノードで、非クラスター化 BizTalk ホスト インスタンスを実行することは、構成上サポートされていません。 これは、SSO サービス上の BizTalk ホスト インスタンスの依存性が原因で、クラスター化されたエンタープライズ SSO サービスが他のノードにフェールオーバーするときに、非クラスター化 BizTalk ホスト インスタンスが失敗するためです。  
  
    > [!NOTE]
    >  ユーザー アカウント制御 (UAC) をサポートするシステムでは、管理者特権を使用してこのツールを実行することが必要な場合があります。  
  
4.  クラスター アドミニストレーターは、クラスター化されたエンタープライズ SSO サービス リソースを含むクラスター グループを右クリックし、クリックして**オンライン**クラスター グループ内のすべてのリソースを開始します。  
  
5.  この Windows Server クラスターをホストする 1 つまたは複数のクラスター化された BizTalk ホストは、更新で、SSO サーバー名、 **BizTalk グループのプロパティ**クラスター化されたマスター シークレット サーバーを参照するページ。 起動**BizTalk Server 管理コンソール**を BizTalk グループを右クリックし、**プロパティ**メニュー更新し、エントリを**SSO サーバー名** をクリック**Ok**です。  
  
    > [!NOTE]
    >  このシナリオでは、クラスター化されたエンタープライズ SSO サービス リソースと同じクラスター グループ内のクラスター リソースとして、すべての BizTalk ホストを作成する必要があります。 エンタープライズ SSO サービスがクラスター化されていない Windows Server クラスター ノードで、非クラスター化 BizTalk ホスト インスタンスを実行することは、構成上サポートされていません。 これは、SSO サービス上の BizTalk ホスト インスタンスの依存性が原因で、クラスター化されたエンタープライズ SSO サービスが他のノードにフェールオーバーするときに、非クラスター化 BizTalk ホスト インスタンスが失敗するためです。  
  
6.  エンタープライズ SSO サービスのクラスター化されたインスタンスを右クリックし、をクリックして**オフライン**、エンタープライズ SSO サービスのクラスター化されたインスタンスを右クリックしてをクリックして**オンライン**です。  
  
    > [!NOTE]
    >  この手順を完了していない場合、マスター シークレットを復元する試行が失敗します。  
  
7.  クラスター化されたマスター シークレット サーバーをホストする Windows クラスターの各ノードで、バックアップしておいたマスター シークレットを復元します。 手順に従います[マスター シークレットを復元する方法](../core/how-to-restore-the-master-secret.md)クラスター化されたマスター シークレット サーバーをホストする Windows クラスターの各ノードにします。  
  
## <a name="see-also"></a>参照  
 [マスター シークレットの管理](../core/managing-the-master-secret.md)