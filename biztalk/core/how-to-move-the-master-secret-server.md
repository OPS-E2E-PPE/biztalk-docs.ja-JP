---
title: マスター シークレット サーバーを移動する方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- managing [Master Secret server], migrating
- migrating, Master Secret server
- Master Secret server, migrating
ms.assetid: 2bc5137e-f81d-486d-bb91-7c5981896f79
caps.latest.revision: 20
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b71ee8252d0a268bb3d087f53607c8a58e831c85
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65384484"
---
# <a name="how-to-move-the-master-secret-server"></a>マスター シークレット サーバーを移動する方法
このトピックでは、別のサーバーに、1 つのサーバーから Windows Server クラスターにマスター シークレットを移動する手順からマスター シークレットを移動する手順を説明します。  
  
### <a name="to-move-the-master-secret-from-one-server-to-another-server"></a>1 つのサーバーから別のサーバーにマスター シークレットを移動するには  
  
1.  インストールされていない場合は、Microsoft エンタープライズ シングル サインオン (SSO) サーバーを新しいマスター シークレット サーバーにインストールします。 BizTalk Server の CD の \Platform\SSO\setup.exe から Microsoft エンタープライズ シングル サインオン サーバーのセットアップを起動します。  
  
2.  構成されていない場合は、新しいマスター シークレット サーバーでエンタープライズ SSO を構成します。 エンタープライズ SSO を構成するこれらの手順に従います。  
  
    1.  構成ツールを開きます。 既定では、構成ツールはある\<ドライブ\>: \Program Files\Common \enterprise シングル サインオン On\Configuration.exe します。  
  
    2.  クリックして選択**エンタープライズ SSO**左側のウィンドウでします。  
  
    3.  次のチェック ボックスをオン**を有効にするエンタープライズ シングル サインオン コンピューターこの**右側のウィンドウで。  
  
    4.  オプションをクリックして**既存の SSO システムに参加**します。  
  
    5.  既存の指定**サーバー名**と**データベース名**sso データベース オプション。  
  
    6.  既存のエンタープライズ SSO サービス アカウントを指定、 **Windows サービスのエンタープライズのシングル サインオン サーバー**オプション。  
  
        > [!NOTE]
        >  これには、ドメイン アカウントがあります。  
  
    7.  オプションをクリックして**構成の適用** をクリック**構成**構成ウィザード ダイアログ ボックスの構成を完了します。  
  
    8.  クリックして**完了**構成ツールを閉じます。  
  
3.  次の手順では、既存のマスター シークレットをバックアップする[バックアップ マスター シークレットを方法](../core/how-to-back-up-the-master-secret.md)します。  
  
4.  新しいマスター シークレット サーバーを参照する SSO データベースのマスター シークレット サーバー名を変更します。 たとえば、新しいマスター シークレット サーバーの名前があります**NewMSSServer**します。 これを行うには、元のマスター シークレット サーバーで次の手順に従います。  
  
    1.  Notepad.exe などのテキスト エディターで、次のコードを貼り付けます。  
  
        ```  
        <sso>  
        <globalInfo>  
        <secretServer>NewMSSServer</secretServer>  
        </globalInfo>  
        </sso>  
        ```  
  
    2.  .Xml ファイルとして保存します。 たとえば、ファイルを保存**NewMSSServer.xml**します。  
  
    3.  コマンド プロンプトで、エンタープライズ SSO のインストール フォルダーに変更します。 インストール フォルダーは、既定では、\<ドライブ\>: \Program Files\Common \enterprise シングル サインオンします。  
  
    4.  型**ssomanage-updatedb** *XMLFile*データベースのマスター シークレット サーバー名を更新します。  
  
        > [!NOTE]
        >  置換*XMLFile*保存した .xml ファイルの名前に置き換えます。  
  
        > [!NOTE]
        >  ユーザー アカウント制御 (UAC) をサポートするシステムでは、管理者特権を使用してこのツールを実行することが必要な場合があります。  
  
5.  新しいマスター シークレット サーバーでエンタープライズ シングル サインオン サービスを再起動します。  
  
6.  次の手順に従って、新しいマスター シークレット サーバー上にマスター シークレットをバックアップを復元[マスター シークレットを復元する方法](../core/how-to-restore-the-master-secret.md)新しいマスター シークレット サーバーでします。  
  
### <a name="to-move-the-master-secret-from-one-server-to-a-windows-server-cluster"></a>1 つのサーバーから Windows Server クラスターにマスター シークレットを移動するには  
  
1.  インストールし、次の手順に従って、Windows Server クラスターで、エンタープライズ SSO サービスを構成[マスター シークレット サーバーをクラスター化する方法](../core/how-to-cluster-the-master-secret-server1.md)します。 すべての記載された手順以外には、このトピックの手順、 **2 番目のクラスター ノードでマスター シークレットを復元**セクション。 既存のマスター シークレット サーバーをクラスターに移動するためにオプションを選択しないでください**新しい SSO システムを作成する**クラスター ノードにエンタープライズ SSO を構成するときにします。 各クラスター ノードを構成する場合は、BizTalk Server 構成プログラムで、エンタープライズ SSO 機能の次のオプションを設定します。  
  
    1.  次に、ボックスをオン**を有効にするエンタープライズ シングル サインオン コンピューターこの**します。  
  
    2.  オプションをクリックして**既存の SSO システムに参加**します。  
  
    3.  既存の SSO データベース サーバー名とデータベース名の値を入力します。  
  
    4.  エンタープライズ シングル サインオン サービスを使用するアカウントを指定するときに、既存の SSO サービス アカウントを入力します。  
  
2.  既存のマスター シークレット バックアップ ファイルを各クラスター ノードの \Enterprise でシングル サインオン フォルダーにコピーします。  
  
3.  この Windows Server クラスターが 1 つまたは複数のクラスター化された BizTalk ホストをホストする場合は、ssomanage コマンド ライン ユーティリティを使用したクラスター化されたマスター シークレット サーバーにすべてのユーザーの SSO サーバー名を設定します。 このコマンドは、エンタープライズ SSO のインストール フォルダーから、グループ内の各 BizTalk サーバーで実行する必要があります。 たとえば、次のコマンドラインは、クラスター化されたマスター シークレット サーバーにすべてのユーザーの SSO サーバー名を設定します。  
  
    ```  
    ssomanage -serverall SSOCLUSTER  
    ```  
  
    > [!NOTE]
    >  *SSOCLUSTER*はこのシナリオをクラスター化されたマスター シークレット サーバーのリソースを含むクラスター グループに作成されるリソースの名前は実際のネットワークのプレース ホルダー、すべての BizTalk ホストを同じクラスター リソースとして作成する必要がありますクラスター化されたエンタープライズ SSO サービス リソースとクラスター グループ。 エンタープライズ SSO サービスがクラスター化された Windows Server クラスター ノードの非クラスター化 BizTalk ホスト インスタンスを実行することは、サポートされる構成ではありません。 これは、クラスター化されたエンタープライズ SSO サービスは、SSO サービス上の BizTalk ホスト インスタンスの依存関係のための別のノードにフェールオーバーしたときに、非クラスター化 BizTalk ホスト インスタンスが失敗するためです。  
  
    > [!NOTE]
    >  ユーザー アカウント制御 (UAC) をサポートするシステムでは、管理者特権を使用してこのツールを実行することが必要な場合があります。  
  
4.  クラスター アドミニストレーターでは、クラスター化されたエンタープライズ SSO サービス リソースを含むクラスター グループを右クリックし、クリックして**オンライン**クラスター グループ内のすべてのリソースを開始します。  
  
5.  この Windows Server クラスターをホストする 1 つまたは複数のクラスター化された BizTalk ホストは、更新で、SSO サーバー名、 **BizTalk グループのプロパティ**クラスター化されたマスター シークレット サーバーを参照するページ。 起動**BizTalk Server 管理**を BizTalk グループを右クリックし、**プロパティ**項目、メニューのエントリを更新**SSO サーバー名**をクリックします。**[Ok]** します。  
  
    > [!NOTE]
    >  このシナリオでは、クラスター化されたエンタープライズ SSO サービス リソースと同じクラスター グループ内のクラスター リソースとしてすべての BizTalk ホストを作成する必要があります。 エンタープライズ SSO サービスがクラスター化された Windows Server クラスター ノードの非クラスター化 BizTalk ホスト インスタンスを実行することは、サポートされる構成ではありません。 これは、クラスター化されたエンタープライズ SSO サービスは、SSO サービス上の BizTalk ホスト インスタンスの依存関係のための別のノードにフェールオーバーしたときに、非クラスター化 BizTalk ホスト インスタンスが失敗するためです。  
  
6.  エンタープライズ SSO サービスのクラスター化されたインスタンスを右クリックし、をクリックして**オフライン**、エンタープライズ SSO サービスのクラスター化されたインスタンスを右クリックしておよびクリックして**オンライン**します。  
  
    > [!NOTE]
    >  この手順を完了していない場合、マスター シークレットを復元する際は成功しません。  
  
7.  クラスター化されたマスター シークレット サーバーをホストしている Windows クラスターの各ノードでバックアップされたマスター シークレットを復元します。 次の手順では、[マスター シークレットを復元する方法](../core/how-to-restore-the-master-secret.md)クラスター化されたマスター シークレット サーバーをホストしている Windows クラスターの各ノードにします。  
  
## <a name="see-also"></a>参照  
 [マスター シークレットの管理](../core/managing-the-master-secret.md)