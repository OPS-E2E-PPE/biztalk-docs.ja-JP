---
title: パブリッシュ/サブスクライブ アーキテクチャ |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- publish/subscribe architecture, publishers
- architecture, publish/subscribe
- publishing, publish/subscribe architecture
- publish/subscribe architecture, about publish/subscribe architecture
- creating, subscriptions
- publish/subscribe architecture, Messaging Engine
- routing, publishing
- Messaging Engine, publishing
- publish/subscribe architecture, subscribers
- publish/subscribe architecture
- subscriptions, publish/subscribe architecture
- publish/subscribe architecture, creating subscriptions
- subscriptions, creating
- Messaging Engine, subscribing
- publishing, routing
- Messaging Engine, publish/subscribe architecture
- publish/subscribe architecture, events
ms.assetid: 5ed36c1f-077d-468f-a99e-60f97377cef6
caps.latest.revision: 11
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bf90d1f0fe1ed298d42c6ed9b0cf1086abe8eb7f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65398431"
---
# <a name="publish-and-subscribe-architecture"></a><span data-ttu-id="43322-102">パブリッシュ/サブスクライブ アーキテクチャ</span><span class="sxs-lookup"><span data-stu-id="43322-102">Publish and Subscribe Architecture</span></span>
<span data-ttu-id="43322-103">パブリッシュ/サブスクライブの設計では、3 つのコンポーネントがあります。</span><span class="sxs-lookup"><span data-stu-id="43322-103">In a publish/subscribe design, you have three components:</span></span>  
  
- <span data-ttu-id="43322-104">[ディストリビューターのプロパティ]</span><span class="sxs-lookup"><span data-stu-id="43322-104">Publishers</span></span>  
  
- <span data-ttu-id="43322-105">[サブスクライバー]</span><span class="sxs-lookup"><span data-stu-id="43322-105">Subscribers</span></span>  
  
- <span data-ttu-id="43322-106">イベント</span><span class="sxs-lookup"><span data-stu-id="43322-106">Events</span></span>  
  
  <span data-ttu-id="43322-107">発行元を含めるに到着するメッセージを公開する受信ポート、受信場所、送信ポートを公開するメッセージまたは別のオーケストレーションを非同期的に開始し、送信請求-応答を送信するときにメッセージを公開するオーケストレーションメッセージのターゲット アプリケーションまたはトランスポートからの応答を受け取ったとき。</span><span class="sxs-lookup"><span data-stu-id="43322-107">Publishers include receive ports that publish messages that arrive in their receive locations, orchestrations that publish messages when sending messages or starting another orchestration asynchronously, and solicit/response send ports that publish messages when they receive a response from the target application or transport.</span></span>  
  
  <span data-ttu-id="43322-108">BizTalk Server では、2 つの主な種類のサブスクリプション: アクティベーションとインスタンス。</span><span class="sxs-lookup"><span data-stu-id="43322-108">In BizTalk Server, there are two main types of subscriptions: activation and instance.</span></span> <span data-ttu-id="43322-109">*アクティベーションのサブスクリプション*は 1 つを指定するサブスクリプションを処理するメッセージがアクティブ化、または受信時にサブスクライバーの新しいインスタンスを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="43322-109">An *activation subscription* is one specifying that a message that fulfills the subscription should activate, or create, a new instance of the subscriber when it is received.</span></span> <span data-ttu-id="43322-110">アクティベーションのサブスクリプションを作成することの例は、フィルターを使用した送信ポートを含めるまたは送信ポート、オーケストレーションにバインドされていると、オーケストレーションの受信図形をアクティブ化プロパティが true に設定します。</span><span class="sxs-lookup"><span data-stu-id="43322-110">Examples of things that create activation subscriptions include send ports with filters or send ports that are bound to orchestrations, and orchestration receive shapes that have their Activate property set to true.</span></span> <span data-ttu-id="43322-111">*インスタンス サブスクリプション*サブスクリプションを処理するメッセージが、サブスクライバーの既に実行中のインスタンスにルーティングすることを示します。</span><span class="sxs-lookup"><span data-stu-id="43322-111">An *instance subscription* indicates that messages that fulfill the subscription should be routed to an already-running instance of the subscriber.</span></span> <span data-ttu-id="43322-112">インスタンスのサブスクリプションを作成することの例としては、オーケストレーションに関連付けられた受信と要求/応答形式の受信ポートの BizTalk Server からの応答を待機しています。</span><span class="sxs-lookup"><span data-stu-id="43322-112">Examples of things that create instance subscriptions are orchestrations with correlated receives and request/response-style receive ports waiting for a response from BizTalk Server.</span></span>  
  
  <span data-ttu-id="43322-113">情報レベルでサブスクリプションの 2 つの型の間の違いは、インスタンスのサブスクリプションがサブスクリプション テーブルに、マスター メッセージ ボックス データベースに格納されている、一意のインスタンス ID が含まれることです。</span><span class="sxs-lookup"><span data-stu-id="43322-113">The difference between the two types of subscription at the information level is that an instance subscription includes the unique instance ID, stored in the subscription table in the master MessageBox database.</span></span> <span data-ttu-id="43322-114">オーケストレーション インスタンスまたは受信ポートには、処理が完了すると、オーケストレーションまたは送信ポートが参加している限り、アクティベーションのサブスクリプションがアクティブなまま中にインスタンスのサブスクリプションがメッセージ ボックス データベースから削除されます。</span><span class="sxs-lookup"><span data-stu-id="43322-114">When an orchestration instance or receive port completes processing, instance subscriptions are removed from the MessageBox while activation subscriptions remain active as long as the orchestration or send port is enlisted.</span></span>  
  
## <a name="creating-subscriptions"></a><span data-ttu-id="43322-115">サブスクリプションの作成</span><span class="sxs-lookup"><span data-stu-id="43322-115">Creating Subscriptions</span></span>  
 <span data-ttu-id="43322-116">BizTalk Server では、BizTalk Server 管理データベースの adm_ServiceClass テーブルに記載されているサービス クラスでは、サブスクリプションを作成します。</span><span class="sxs-lookup"><span data-stu-id="43322-116">Subscriptions are created by service classes in BizTalk Server, which are listed in the adm_ServiceClass table in the BizTalk Server Management database.</span></span> <span data-ttu-id="43322-117">これらのサービスには、キャッシュ サービスが含まれます。インプロセスおよび分離メッセージング、エンドポイント マネージャーによってホストされます。オーケストレーション/XLANG XLANG サブサービスでホストされています。</span><span class="sxs-lookup"><span data-stu-id="43322-117">These services include the caching service; in-process and isolated messaging, hosted by the Endpoint Manager; and orchestrations/XLANG hosted by the XLANG subservice.</span></span> <span data-ttu-id="43322-118">サブスクリプションを作成し、公開されたメッセージが表示されるこれらのサービス クラスのことができます。</span><span class="sxs-lookup"><span data-stu-id="43322-118">Each of these service classes can create subscriptions and receive published messages.</span></span>  
  
 <span data-ttu-id="43322-119">サブスクリプションは、メッセージ コンテキスト プロパティと、サブスクリプションに固有の値を含む述語と呼ばれる、比較ステートメントのコレクションです。</span><span class="sxs-lookup"><span data-stu-id="43322-119">A subscription is a collection of comparison statements, known as predicates, involving message context properties and the values specific to the subscription.</span></span> <span data-ttu-id="43322-120">たとえば、メッセージの種類ではメッセージと多数のサブスクリプションのコンテキスト プロパティは、サブスクリプションでメッセージ型を指定します。</span><span class="sxs-lookup"><span data-stu-id="43322-120">For example, Message Type is a context property of messages and many subscriptions specify the message type in their subscription.</span></span> <span data-ttu-id="43322-121">サブスクリプションの詳細については、特定の述語が指定されたサブスクリプション操作の種類に応じて、次の述語テーブルのいずれかに移動中に、メッセージ エージェントによってサブスクリプション テーブルに挿入されます。</span><span class="sxs-lookup"><span data-stu-id="43322-121">General information about the subscription is inserted into the subscriptions table by the Message Agent while the specific predicates go into one of the following predicate tables, depending on the type of operation specified for the subscription:</span></span>  
  
- <span data-ttu-id="43322-122">BitwiseANDPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-122">BitwiseANDPredicates</span></span>  
  
- <span data-ttu-id="43322-123">EqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-123">EqualsPredicates</span></span>  
  
- <span data-ttu-id="43322-124">EqualsPredicates2ndPass</span><span class="sxs-lookup"><span data-stu-id="43322-124">EqualsPredicates2ndPass</span></span>  
  
- <span data-ttu-id="43322-125">ExistsPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-125">ExistsPredicates</span></span>  
  
- <span data-ttu-id="43322-126">FirstPassPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-126">FirstPassPredicates</span></span>  
  
- <span data-ttu-id="43322-127">GreaterThanOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-127">GreaterThanOrEqualsPredicates</span></span>  
  
- <span data-ttu-id="43322-128">GreaterThanPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-128">GreaterThanPredicates</span></span>  
  
- <span data-ttu-id="43322-129">LessThenOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-129">LessThenOrEqualsPredicates</span></span>  
  
- <span data-ttu-id="43322-130">LessThenPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-130">LessThenPredicates</span></span>  
  
- <span data-ttu-id="43322-131">NotEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="43322-131">NotEqualsPredicates</span></span>  
  
  <span data-ttu-id="43322-132">このすべては、実行を呼び出すことにより実現が\<アプリケーション名\>と bts_insertpredicate _\<アプリケーション名\>ストアド プロシージャでメッセージ ボックス データベース\<アプリケーション名\>サブスクリプションを作成している BizTalk ホストの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="43322-132">All of this is accomplished by calling the Bts_CreateSubscription_\<application name\> and Bts_InsertPredicate_\<application name\> stored procedures in the MessageBox database where \<application name\> is the name of the BizTalk host that is creating the subscription.</span></span>  
  
  <span data-ttu-id="43322-133">送信ポートが参加しているときに、ポートを作成、最低限、サブスクリプションを持つメッセージのコンテキストでポートのトランスポートの ID を送信します。</span><span class="sxs-lookup"><span data-stu-id="43322-133">When a send port is enlisted, the port creates, at a minimum, a subscription for any message with that send port's transport ID in the context.</span></span> <span data-ttu-id="43322-134">これにより、常に専用のメッセージを受信する送信ポートができます。</span><span class="sxs-lookup"><span data-stu-id="43322-134">This allows the send port to always receive messages intended specifically for it.</span></span> <span data-ttu-id="43322-135">オーケストレーション ポートは、特定の送信ポートにバインドするときに、そのバインドに関する情報が BizTalk 管理データベースに格納されます。</span><span class="sxs-lookup"><span data-stu-id="43322-135">When an orchestration port is bound to a particular send port, the information about that binding is stored in the BizTalk Management database.</span></span> <span data-ttu-id="43322-136">送信されたメッセージは、物理的にバインドされたポートをオーケストレーションの送信ポート、メッセージを取得にルーティングされるようにする送信ポートに、コンテキストで、トランスポート ID が含まれています。</span><span class="sxs-lookup"><span data-stu-id="43322-136">When messages are sent from the orchestration through the port bound to the physical send port, the Transport ID is included in the context so that the message gets routed to that send port.</span></span> <span data-ttu-id="43322-137">ただしは、この送信ポートが唯一の送信ポート、オーケストレーションから送信されたメッセージを受信できるいないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="43322-137">However, it is important to note that this send port is not the only send port that can receive messages sent from the orchestration.</span></span> <span data-ttu-id="43322-138">オーケストレーションでは、メッセージを送信するときに、そのメッセージは、すべての関連する昇格させたプロパティと一緒にメッセージ ボックス データベースに公開されます。</span><span class="sxs-lookup"><span data-stu-id="43322-138">When an orchestration sends a message, that message is published to the MessageBox with all of the relevant promoted properties.</span></span> <span data-ttu-id="43322-139">バインド済み送信ポートであるため、トランスポート ID コンテキストでは、他の送信ポートまたはオーケストレーションがメッセージのプロパティにも一致するサブスクリプションを持つことができます、メッセージのコピーを受信することが保証されます。</span><span class="sxs-lookup"><span data-stu-id="43322-139">The bound send port is guaranteed to receive a copy of the message because the transport ID is in the context, but any other send port, or orchestration, can have a subscription that also matches the message properties.</span></span> <span data-ttu-id="43322-140">いつでもメッセージが、メッセージ ボックスに直接発行されたサブスクリプションに一致するすべてのサブスクライバーが受信するメッセージのコピーを理解する非常に重要ですが。</span><span class="sxs-lookup"><span data-stu-id="43322-140">It is very important to understand that any time a message is published directly to the MessageBox, all subscribers with matching subscriptions will receive a copy of the message.</span></span>  
  
## <a name="publishing-and-routing"></a><span data-ttu-id="43322-141">公開とルーティング</span><span class="sxs-lookup"><span data-stu-id="43322-141">Publishing and Routing</span></span>  
 <span data-ttu-id="43322-142">サブスクリプションが作成され、有効になっている場合は後、は、処理を行う前にメッセージを公開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="43322-142">After a subscription is created and enabled, a message must be published before any processing takes place.</span></span> <span data-ttu-id="43322-143">既に説明したように、サービスのいずれかから BizTalk Server に受信されると、メッセージが発行されます。</span><span class="sxs-lookup"><span data-stu-id="43322-143">Messages are published when they are received into BizTalk Server from one of the services mentioned previously.</span></span> <span data-ttu-id="43322-144">ここのルーティングでは、アダプターを通じて BizTalk Server に受信するメッセージについて説明します。</span><span class="sxs-lookup"><span data-stu-id="43322-144">For this discussion of routing, we will focus on messages received into BizTalk Server through an adapter.</span></span>  
  
 <span data-ttu-id="43322-145">メッセージが受信パイプラインの処理を通過するときは、プロパティがメッセージ コンテキストに昇格されます。</span><span class="sxs-lookup"><span data-stu-id="43322-145">When messages go through the receive pipeline processing, properties are promoted into the message context.</span></span> <span data-ttu-id="43322-146">メッセージの受信アダプターとパイプラインによって処理された後、メッセージ ボックスに公開する準備が最初に行われるが、メッセージ エージェントは、メッセージから昇格させたプロパティのプロパティ値および述語の値を挿入します。マスター メッセージ ボックス SQL Server データベースにコンテキスト。</span><span class="sxs-lookup"><span data-stu-id="43322-146">After a message is ready to be published into the MessageBox after being processed by the receive adapter and pipeline, the first thing that happens is the Message Agent inserts the property values for the promoted properties and predicate values from the message context into the master MessageBox SQL Server database.</span></span> <span data-ttu-id="43322-147">データベースにこれらの値を持つには、ルーティングの決定を行うメッセージ エージェントができるようにします。</span><span class="sxs-lookup"><span data-stu-id="43322-147">Having these values in the database enables the Message Agent to make routing decisions.</span></span>  
  
 <span data-ttu-id="43322-148">次の手順は、マスター メッセージ ボックス データベース公開されるメッセージの現在のバッチのサブスクリプションへの問い合わせへのメッセージ エージェントによってです。</span><span class="sxs-lookup"><span data-stu-id="43322-148">The next step is for the Message Agent to ask the master MessageBox database to find subscriptions for the current batch of messages being published.</span></span> <span data-ttu-id="43322-149">データベース コンテキストのプロパティのみにメッセージがまだ書き込まれていないことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="43322-149">Keep in mind that the messages have not yet been written to the database, only the properties from the context.</span></span> <span data-ttu-id="43322-150">Bts_FindSubscriptions は、メッセージのクエリでプロシージャを保存するサブスクリプションを述語テーブル上に示した、格納されているメッセージの現在のバッチのメッセージ プロパティにリンクすることです。</span><span class="sxs-lookup"><span data-stu-id="43322-150">The bts_FindSubscriptions stored procedure in the MessageBox queries the subscription and predicate tables identified above, linking them to the message properties stored for the current batch of messages.</span></span>  
  
 <span data-ttu-id="43322-151">この情報により、メッセージ エージェントは、1 回、bts_InsertMessage ストアド プロシージャを呼び出すことでサブスクリプションのある各メッセージ ボックス データベースにメッセージを挿入します。</span><span class="sxs-lookup"><span data-stu-id="43322-151">With this information, the Message Agent inserts the message once into each MessageBox database that has a subscription by calling the bts_InsertMessage stored procedure.</span></span> <span data-ttu-id="43322-152">サブスクリプション ID に、bts_InsertMessage ストアド プロシージャが最初に呼び出されました。</span><span class="sxs-lookup"><span data-stu-id="43322-152">The bts_InsertMessage stored procedure is first called with a subscription ID.</span></span> <span data-ttu-id="43322-153">この最初のパスで、この int_EvaluateSubscriptions ストアド プロシージャの呼び出しにをチェックして、メッセージが、アプリケーションのセキュリティ要件を満たしていることを確認するサブスクリプションの詳細については、検索するための手順が格納されています。述語のホスト、およびアプリケーションの特定のキューまたはアプリケーション固有の保留キューの状態によってメッセージへの参照を挿入するアプリケーションのプロパティに一致するメッセージ。</span><span class="sxs-lookup"><span data-stu-id="43322-153">On this first pass, the stored procedure calls the int_EvaluateSubscriptions stored procedure which is responsible for looking up the subscription detail information, verifying that the message meets security requirements for the application by checking that message predicates match application properties for the host, and inserting a reference to the message in the application specific queue or application specific suspended queue depending on the state.</span></span> <span data-ttu-id="43322-154">メッセージ ID、サブスクリプション ID、サービス ID、およびその他のサブスクリプション情報は、サブスクリプションごとにこのアプリケーションで検出されたアプリケーションの特定のキュー テーブルに挿入されます。</span><span class="sxs-lookup"><span data-stu-id="43322-154">The message ID, subscription ID, service ID, and other subscription information are inserted into the application specific queue table for each subscription that was found for this application.</span></span> <span data-ttu-id="43322-155">バッチのメッセージのプロパティとメッセージの述語テーブルを消去後、メッセージを挿入して、関連する値。</span><span class="sxs-lookup"><span data-stu-id="43322-155">After the messages are inserted, the message properties and message predicates tables are cleared of the batch related values.</span></span>  
  
 <span data-ttu-id="43322-156">Bts_InsertMessage ストアド プロシージャが、その後、メッセージ部分ごとに呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="43322-156">The bts_InsertMessage stored procedure is called subsequently for each part in the message.</span></span> <span data-ttu-id="43322-157">最初の呼び出しでは、メッセージ コンテキストが渡され、メッセージの部分では、ボディ部の名前および ID の数などに関するメタデータと共に SPOOL テーブルに挿入し、</span><span class="sxs-lookup"><span data-stu-id="43322-157">On the first call, the message context is passed and is then inserted into the SPOOL table along with metadata about the message such as the number of parts, the body part name and ID.</span></span> <span data-ttu-id="43322-158">さらにメッセージのボディ部が、int_InsertPart ストアド プロシージャを使用して部品テーブルに挿入されます。</span><span class="sxs-lookup"><span data-stu-id="43322-158">In addition the message body part is inserted into the PARTS table using the int_InsertPart stored procedure.</span></span> <span data-ttu-id="43322-159">Bts_InsertMessage ストアド プロシージャは PARTS テーブルに保存される、int_InsertPart ストアド プロシージャに渡されるだけで、残りのメッセージ部分ごとに呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="43322-159">The bts_InsertMessage stored procedure is then called for each of the remaining message parts where they are simply passed to the int_InsertPart stored procedure to be persisted in the PARTS table.</span></span>  
  
 <span data-ttu-id="43322-160">メッセージがルーティングされると、次のテーブルにレコードを挿入して、メッセージとその要素の特定のインスタンスを受信する各サービスの参照が追加されます。</span><span class="sxs-lookup"><span data-stu-id="43322-160">When messages are routed, references are added for each service that receives the specific instance of the message and its parts by inserting records into the following tables:</span></span>  
  
- <span data-ttu-id="43322-161">MessageRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="43322-161">MessageRefCountLog1</span></span>  
  
- <span data-ttu-id="43322-162">MessageRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="43322-162">MessageRefCountLog2</span></span>  
  
- <span data-ttu-id="43322-163">PartRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="43322-163">PartRefCountLog1</span></span>  
  
- <span data-ttu-id="43322-164">PartRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="43322-164">PartRefCountLog2</span></span>  
  
  <span data-ttu-id="43322-165">これらの参照は、メッセージ ボックスは、システムでメッセージのメッセージ データでいっぱいになりつつを定期的に実行されるクリーンアップ ジョブによって削除されているからメッセージと部分を保持します。</span><span class="sxs-lookup"><span data-stu-id="43322-165">These references keep the messages and parts from being deleted by cleanup jobs that run periodically to keep the MessageBox from getting full with message data for messages that are no longer in the system.</span></span> <span data-ttu-id="43322-166">2 つのテーブルを使用して、競合とロックの問題を軽減します。</span><span class="sxs-lookup"><span data-stu-id="43322-166">Two tables are used to reduce contention and locking issues.</span></span>  
  
  <span data-ttu-id="43322-167">これで、メッセージは、右側のキューにルーティングされているが、スプールとパーツのテーブルに保存され、アプリケーションの特定のキューで参照されているメッセージする必要があるキューから取り出すアプリケーション インスタンスによって。</span><span class="sxs-lookup"><span data-stu-id="43322-167">Now that the message has been routed to the right queue, stored in the Spool and Parts tables, and referenced in the application specific queues, the messages must be pulled off the queues by the application instances.</span></span> <span data-ttu-id="43322-168">各ホスト インスタンスでは、さまざまな BizTalk 管理データベースの adm_ServiceClass テーブルで構成されている間隔で継続的に、データベースをポーリングするキューから取り出すスレッドがあります。</span><span class="sxs-lookup"><span data-stu-id="43322-168">Each host instance has a number of dequeuing threads that continuously poll the database on an interval that is configured in the adm_ServiceClass table in the BizTalk Management database.</span></span> <span data-ttu-id="43322-169">この同じテーブルには、使用するキューから取り出すスレッドの数を示す列があります。</span><span class="sxs-lookup"><span data-stu-id="43322-169">This same table has a column to indicate the number of dequeuing threads to be used.</span></span> <span data-ttu-id="43322-170">各スレッドがメッセージ ボックス データベースに呼び出しを呼び出し、bts_dequeuemessages\<アプリケーション名\>ストアド プロシージャで実行されているホスト アプリケーションに適しています。</span><span class="sxs-lookup"><span data-stu-id="43322-170">Each thread calls into the MessageBox database and calls the bts_DequeueMessages_\<application name\> stored procedure appropriate for the host application it is running in.</span></span> <span data-ttu-id="43322-171">このストアド プロシージャでは、ロック セマンティクスを使用して、1 つだけのインスタンスし、1 つのキューから取り出すスレッドが特定の時点でキューにメッセージを処理することができます。</span><span class="sxs-lookup"><span data-stu-id="43322-171">This stored procedure uses locking semantics to make sure that only one instance and one dequeuing thread are able to operate on a message in the queue at a given time.</span></span> <span data-ttu-id="43322-172">ロックを取得するホスト インスタンスでは、メッセージを取得しは、メッセージの処理の対象となるサブサービスする責任を負います。</span><span class="sxs-lookup"><span data-stu-id="43322-172">The host instance that gets the lock gets the message, and is then responsible for handing the message to the subservice for which it is intended.</span></span>  
  
  <span data-ttu-id="43322-173">作成されたかに配置されているサービス、サブスクリプション、メッセージを受信するサービスは、エンドポイント マネージャーでは、し、送信ポートが呼び出されます (または受信ポートの要求/応答の応答部分)、xlang/s サブサービスである場合は、オーケストレーションとはかどうかに応じて、サブスクリプションでインスタンス ID があります。</span><span class="sxs-lookup"><span data-stu-id="43322-173">If the service receiving the message is the Endpoint Manager, then the send port is invoked (or the response portion of a request/response receive port) and if it is the XLANG/s subservice, an orchestration is either created, or located to service the subscription depending on whether there is an instance ID in the subscription.</span></span> <span data-ttu-id="43322-174">サービスは、他のサービスには、参照がない、メッセージ データが削除されるようにし、メッセージおよびメッセージ部分への参照を解放します。</span><span class="sxs-lookup"><span data-stu-id="43322-174">The service then releases the reference to the message and its part so that if no other services have references, the message data can be deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="43322-175">参照</span><span class="sxs-lookup"><span data-stu-id="43322-175">See Also</span></span>  
 [<span data-ttu-id="43322-176">メッセージング エンジン </span><span class="sxs-lookup"><span data-stu-id="43322-176">The Messaging Engine </span></span>](../core/the-messaging-engine.md)