---
title: メッセージのルーティングを使用して失敗しました |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
f1_keywords:
- bts10.ops.tsroutingfailure
ms.assetid: d081934c-600e-44ce-8ba4-fb646d494589
caps.latest.revision: 33
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d5c3f4fa3b978775c9f2c8fa91467b88cc74eae8
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "36976571"
---
# <a name="using-failed-message-routing"></a><span data-ttu-id="32134-102">失敗したメッセージのルーティングの使用</span><span class="sxs-lookup"><span data-stu-id="32134-102">Using Failed Message Routing</span></span>
<span data-ttu-id="32134-103">エラー処理機能を使用すると、設計者は、失敗したメッセージを保留キューに配置する従来の処理 (現在では、既定の処理) の代わりに、失敗したメッセージの自動処理を指定できます。</span><span class="sxs-lookup"><span data-stu-id="32134-103">The error-handling facility allows the designer to designate automated handling of messaging failures as an alternative to the traditional (now default) behavior of placing failed messages in the Suspended queue.</span></span> <span data-ttu-id="32134-104">この自動処理では、サブスクライブしているルーティング先 (送信ポートやオーケストレーションなど) にエラー メッセージをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="32134-104">This automated handling routes an error message to any subscribing routing destination, such as a send port or orchestration.</span></span> <span data-ttu-id="32134-105">エラー メッセージは、元のメッセージのクローンであり、以前昇格させたすべてのプロパティが降格されています。また、特定のメッセージの失敗に関連した、選択済みのプロパティがメッセージ コンテキストに昇格されています。</span><span class="sxs-lookup"><span data-stu-id="32134-105">The error message is a clone of the original message with all previously promoted properties now demoted and with selected properties related to the specific messaging failure promoted to the message context.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="32134-106">失敗したメッセージには、元のメッセージのコピーが含まれます。</span><span class="sxs-lookup"><span data-stu-id="32134-106">Failed messages contain a copy of the original message.</span></span> <span data-ttu-id="32134-107">元のメッセージに重要な情報が含まれる場合、重要な情報が誤って開示されることを防ぐように、失敗したメッセージの手動プロセスおよび自動プロセスをデザインしてください。</span><span class="sxs-lookup"><span data-stu-id="32134-107">If the original message contains sensitive information, design your manual and automatic failed message processes so that they avoid accidental disclosure.</span></span>  
  
## <a name="what-does-failed-message-routing-consist-of"></a><span data-ttu-id="32134-108">失敗したメッセージのルーティングの構成要素</span><span class="sxs-lookup"><span data-stu-id="32134-108">What Does Failed Message Routing Consist Of?</span></span>  
 <span data-ttu-id="32134-109">失敗したメッセージのルーティングが有効になっていると、BizTalk Server では、メッセージを保留せずに、メッセージをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="32134-109">When failed message routing is enabled, BizTalk Server does not suspend the message—it routes the message instead.</span></span> <span data-ttu-id="32134-110">失敗したメッセージのルーティングは、受信ポートおよび送信ポートで使用できます。結果は次のようになります。</span><span class="sxs-lookup"><span data-stu-id="32134-110">Failed message routing can be enabled on both receive and send ports, with the following results:</span></span>  
  
- <span data-ttu-id="32134-111">失敗したメッセージのルーティングが受信ポートに対して有効になっており、受信パイプラインまたはルーティングでメッセージが失敗した場合、失敗したメッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="32134-111">If failed message routing is enabled on a receive port and a message fails in the receive pipeline or in routing, a failed message is generated.</span></span> <span data-ttu-id="32134-112">逆アセンブリ フェーズ中 (または前) にエラーが発生した場合、エラー メッセージは、元のインターチェンジのクローンになります。</span><span class="sxs-lookup"><span data-stu-id="32134-112">In the case where an error occurs in or before the disassembly phase, the error message is a clone of the original interchange.</span></span>  
  
- <span data-ttu-id="32134-113">失敗したメッセージのルーティングが送信ポートに対して有効になっており、送信パイプラインでメッセージが失敗した場合、失敗したメッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="32134-113">If failed message routing is enabled on a send port and the message fails in the send pipeline, a failed message is generated.</span></span>  
  
  <span data-ttu-id="32134-114">失敗したメッセージが生成されると、失敗したメッセージが公開される前に、BizTalk Server は、エラー報告に関連するメッセージ コンテキスト プロパティを昇格し、通常のメッセージ コンテキスト プロパティを降格します。</span><span class="sxs-lookup"><span data-stu-id="32134-114">When a failed message is generated, BizTalk Server promotes error-report-related message context properties and demotes regular message context properties before publishing the failed message.</span></span> <span data-ttu-id="32134-115">失敗したメッセージのルーティングが無効な場合の既定の処理では、失敗したメッセージが保留されませんが、ルーティングが有効な場合の処理では、失敗したメッセージが保留されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="32134-115">Compare this to the default behavior when failed message routing is not enabled: Messages that fail are suspended.</span></span>  
  
## <a name="what-kinds-of-messaging-failures-trigger-an-error-message"></a><span data-ttu-id="32134-116">エラー メッセージの発生原因となるメッセージの失敗</span><span class="sxs-lookup"><span data-stu-id="32134-116">What Kinds of Messaging Failures Trigger an Error Message?</span></span>  
 <span data-ttu-id="32134-117">アダプター処理、パイプライン処理、マッピング、またはメッセージのルーティングでエラーが発生した場合、失敗したメッセージのルーティングが有効になっていれば、エラー メッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="32134-117">Any failure that occurs in adapter processing, pipeline processing, mapping, or message routing results in an error message if routing for failed messages is enabled.</span></span> <span data-ttu-id="32134-118">オーケストレーションが受信ポートからメッセージを受信しているとき (または、送信ポートにメッセージを送信しているとき) にメッセージ エラーが発生した場合、生成されるエラー メッセージは、オーケストレーションがバインドしているメッセージ ポートに関連付けられます。</span><span class="sxs-lookup"><span data-stu-id="32134-118">When a messaging error occurs while an orchestration is receiving from a receive port or sending to a send port, the resulting error message is associated with the messaging ports to which the orchestration is bound.</span></span>  
  
## <a name="subscribing-to-an-error-message"></a><span data-ttu-id="32134-119">エラー メッセージのサブスクライブ</span><span class="sxs-lookup"><span data-stu-id="32134-119">Subscribing to an Error Message</span></span>  
 <span data-ttu-id="32134-120">エラー メッセージは、受信用にサブスクライブしているオーケストレーションまたは送信ポートに配信されます。</span><span class="sxs-lookup"><span data-stu-id="32134-120">Error messages are delivered to orchestrations or send ports that have subscribed to receive them.</span></span> <span data-ttu-id="32134-121">通常、サブスクリプションは、メッセージ エラーが発生したポート (送信ポートまたは受信ポート) の名前に基づいて、エラー メッセージを選択します。</span><span class="sxs-lookup"><span data-stu-id="32134-121">A subscription typically selects an error message based on the name of the port in which the messaging error occurred (either a send or a receive port).</span></span> <span data-ttu-id="32134-122">また、サブスクリプションは、エラーが発生したメッセージ コンテキストに昇格させる他のプロパティ ( **InboundTransportLocation** や **FailureCode**など) に対して、フィルターを設定できます。</span><span class="sxs-lookup"><span data-stu-id="32134-122">A subscription might also filter on other properties promoted to the error's message context (for example, **InboundTransportLocation** or **FailureCode**).</span></span>  
  
## <a name="error-message-specification"></a><span data-ttu-id="32134-123">エラー メッセージの仕様</span><span class="sxs-lookup"><span data-stu-id="32134-123">Error Message Specification</span></span>  
 <span data-ttu-id="32134-124">エラー メッセージは、失敗した元のメッセージのクローンであり、以前昇格させたすべてのプロパティが降格されています。また、エラー固有のプロパティ セットがメッセージ コンテキストに昇格されています。</span><span class="sxs-lookup"><span data-stu-id="32134-124">An error message is a clone of the original failed message, with all previously promoted properties demoted and with a set of error-specific properties promoted to the message context.</span></span> <span data-ttu-id="32134-125">エラー メッセージの受信を指定していないサブスクライバーへの予期しない配信を防止するため、以前昇格させたプロパティは降格されます。</span><span class="sxs-lookup"><span data-stu-id="32134-125">Previously promoted properties are demoted to avoid unintended delivery to subscribers not designated to receive the error message.</span></span> <span data-ttu-id="32134-126">エラー メッセージは、サブスクライバー (オーケストレーション、送信ポート、および送信ポート グループ) への配信のために公開されます。</span><span class="sxs-lookup"><span data-stu-id="32134-126">The error message is published for distribution to subscribers (orchestrations, send ports, and send port groups).</span></span>  
  
 <span data-ttu-id="32134-127">すべてのエラー メッセージのコンテキストに昇格されるプロパティ、 **ErrorReport** BizTalk Server で名前空間。</span><span class="sxs-lookup"><span data-stu-id="32134-127">The properties that are promoted to the context of an error message all fall under the **ErrorReport** namespace in BizTalk Server.</span></span> <span data-ttu-id="32134-128">次のようなプロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="32134-128">They are as follows:</span></span>  
  
|<span data-ttu-id="32134-129">プロパティ名</span><span class="sxs-lookup"><span data-stu-id="32134-129">Property name</span></span>|<span data-ttu-id="32134-130">データ型</span><span class="sxs-lookup"><span data-stu-id="32134-130">Data type</span></span>|<span data-ttu-id="32134-131">昇格</span><span class="sxs-lookup"><span data-stu-id="32134-131">Promoted</span></span>|<span data-ttu-id="32134-132">説明</span><span class="sxs-lookup"><span data-stu-id="32134-132">Description</span></span>|  
|-------------------|---------------|--------------|-----------------|  
|<span data-ttu-id="32134-133">FailureCode</span><span class="sxs-lookup"><span data-stu-id="32134-133">FailureCode</span></span>|<span data-ttu-id="32134-134">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-134">System.String</span></span>|<span data-ttu-id="32134-135">はい</span><span class="sxs-lookup"><span data-stu-id="32134-135">Yes</span></span>|<span data-ttu-id="32134-136">エラー コードです。</span><span class="sxs-lookup"><span data-stu-id="32134-136">Error code.</span></span> <span data-ttu-id="32134-137">BizTalk Server 管理コンソールに表示される 16 進数の値です。</span><span class="sxs-lookup"><span data-stu-id="32134-137">A hexadecimal value that is reported in the BizTalk Server Administration console.</span></span>|  
|<span data-ttu-id="32134-138">FailureCategory</span><span class="sxs-lookup"><span data-stu-id="32134-138">FailureCategory</span></span>|<span data-ttu-id="32134-139">System.Int32</span><span class="sxs-lookup"><span data-stu-id="32134-139">System.Int32</span></span>|<span data-ttu-id="32134-140">はい</span><span class="sxs-lookup"><span data-stu-id="32134-140">Yes</span></span>|<span data-ttu-id="32134-141">このプロパティは使用されません。</span><span class="sxs-lookup"><span data-stu-id="32134-141">This property is not used.</span></span> <span data-ttu-id="32134-142">値は未定義です。</span><span class="sxs-lookup"><span data-stu-id="32134-142">Its value is undefined.</span></span>|  
|<span data-ttu-id="32134-143">説明</span><span class="sxs-lookup"><span data-stu-id="32134-143">Description</span></span>|<span data-ttu-id="32134-144">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-144">System.String</span></span>|<span data-ttu-id="32134-145">いいえ</span><span class="sxs-lookup"><span data-stu-id="32134-145">No</span></span>|<span data-ttu-id="32134-146">エラーの説明です。</span><span class="sxs-lookup"><span data-stu-id="32134-146">Error description.</span></span> <span data-ttu-id="32134-147">このメッセージの失敗に関してアプリケーション イベント ログに書き込まれる診断テキストと同じです。</span><span class="sxs-lookup"><span data-stu-id="32134-147">Same diagnostic text as is written to the Application Event Log regarding this messaging failure.</span></span>|  
|<span data-ttu-id="32134-148">[MessageType]</span><span class="sxs-lookup"><span data-stu-id="32134-148">MessageType</span></span>|<span data-ttu-id="32134-149">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-149">System.String</span></span>|<span data-ttu-id="32134-150">はい</span><span class="sxs-lookup"><span data-stu-id="32134-150">Yes</span></span>|<span data-ttu-id="32134-151">失敗したメッセージの種類です。メッセージの種類を確定できない場合は空です。</span><span class="sxs-lookup"><span data-stu-id="32134-151">Message type of failed message, or empty if message type is indeterminate.</span></span><br /><br /> <span data-ttu-id="32134-152">BizTalk Server は、メッセージの種類を使用して、メッセージを XML スキーマに関連付けます。</span><span class="sxs-lookup"><span data-stu-id="32134-152">BizTalk Server uses the message type to associate messages with their XML schemas.</span></span> <span data-ttu-id="32134-153">メッセージの種類は、スキーマのルート ノードを持つスキーマ名前空間を連結して形成されます: http://mynamespace#rootnode します。</span><span class="sxs-lookup"><span data-stu-id="32134-153">Message type is formed by concatenating the schema namespace with the schema root node: http://mynamespace#rootnode.</span></span> <span data-ttu-id="32134-154">**注:** メッセージ失敗メッセージの種類を決定する前にこのプロパティがないことを設定します。</span><span class="sxs-lookup"><span data-stu-id="32134-154">**Note:**  Messages that fail before their message type is determined do not have this property set.</span></span>|  
|<span data-ttu-id="32134-155">ReceivePortName</span><span class="sxs-lookup"><span data-stu-id="32134-155">ReceivePortName</span></span>|<span data-ttu-id="32134-156">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-156">System.String</span></span>|<span data-ttu-id="32134-157">受信ポートでの受信処理中にエラーが発生した場合は **"昇格しました"** </span><span class="sxs-lookup"><span data-stu-id="32134-157">**Promoted** if the failure happened during inbound processing (in a receive port)</span></span><br /><br /> <span data-ttu-id="32134-158">送信ポートでエラーが発生した場合は **"昇格していません"** </span><span class="sxs-lookup"><span data-stu-id="32134-158">**Not promoted** if the failure happened in a send port.</span></span>|<span data-ttu-id="32134-159">エラーが発生した場合の受信ポートの名前です。</span><span class="sxs-lookup"><span data-stu-id="32134-159">Name of the receive port where the failure happened.</span></span>|  
|<span data-ttu-id="32134-160">InboundTransportLocation</span><span class="sxs-lookup"><span data-stu-id="32134-160">InboundTransportLocation</span></span>|<span data-ttu-id="32134-161">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-161">System.String</span></span>|<span data-ttu-id="32134-162">受信ポートでの受信処理中にエラーが発生した場合は **"昇格しました"** </span><span class="sxs-lookup"><span data-stu-id="32134-162">**Promoted** if the failure happened during inbound processing (in a receive port)</span></span><br /><br /> <span data-ttu-id="32134-163">送信ポートでエラーが発生した場合は **"昇格していません"** </span><span class="sxs-lookup"><span data-stu-id="32134-163">**Not promoted** if the failure happened in a send port.</span></span>|<span data-ttu-id="32134-164">エラーが発生した場合の受信場所の URI です。</span><span class="sxs-lookup"><span data-stu-id="32134-164">URI of the receive location where the failure happened.</span></span>|  
|<span data-ttu-id="32134-165">SendPortName</span><span class="sxs-lookup"><span data-stu-id="32134-165">SendPortName</span></span>|<span data-ttu-id="32134-166">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-166">System.String</span></span>|<span data-ttu-id="32134-167">送信ポートでの送信処理中にエラーが発生した場合は **"昇格しました"** </span><span class="sxs-lookup"><span data-stu-id="32134-167">**Promoted** if the failure happened during outbound processing (in a send port)</span></span><br /><br /> <span data-ttu-id="32134-168">受信ポートでエラーが発生した場合は **"昇格していません"** </span><span class="sxs-lookup"><span data-stu-id="32134-168">**Not promoted** if the failure happened in a receive port.</span></span>|<span data-ttu-id="32134-169">エラーが発生した場合の送信ポートの名前です。</span><span class="sxs-lookup"><span data-stu-id="32134-169">Name of the send port where the failure happened.</span></span>|  
|<span data-ttu-id="32134-170">OutboundTransportLocation</span><span class="sxs-lookup"><span data-stu-id="32134-170">OutboundTransportLocation</span></span>|<span data-ttu-id="32134-171">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-171">System.String</span></span>|<span data-ttu-id="32134-172">送信ポートでの送信処理中にエラーが発生した場合は **"昇格しました"** </span><span class="sxs-lookup"><span data-stu-id="32134-172">**Promoted** if the failure happened during outbound processing (in a send port)</span></span><br /><br /> <span data-ttu-id="32134-173">受信ポートでエラーが発生した場合は **"昇格していません"** </span><span class="sxs-lookup"><span data-stu-id="32134-173">**Not promoted** if the failure happened in a receive port.</span></span>|<span data-ttu-id="32134-174">エラーが発生した場合の送信場所の URI です。</span><span class="sxs-lookup"><span data-stu-id="32134-174">URI of the send location where the failure happened.</span></span>|  
|<span data-ttu-id="32134-175">ErrorType</span><span class="sxs-lookup"><span data-stu-id="32134-175">ErrorType</span></span>|<span data-ttu-id="32134-176">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-176">System.String</span></span>|<span data-ttu-id="32134-177">はい</span><span class="sxs-lookup"><span data-stu-id="32134-177">Yes</span></span>|<span data-ttu-id="32134-178">エラーに含まれるメッセージの種類を示します。</span><span class="sxs-lookup"><span data-stu-id="32134-178">Indicates the type of message that the error contains.</span></span> <span data-ttu-id="32134-179">このプロパティは、常に **FailedMessage**値を含みます。つまり、失敗した元のメッセージがエラーに格納されます。</span><span class="sxs-lookup"><span data-stu-id="32134-179">This property always contains the value **FailedMessage**, meaning that the error contains the original failed message.</span></span>|  
|<span data-ttu-id="32134-180">RoutingFailureReportID</span><span class="sxs-lookup"><span data-stu-id="32134-180">RoutingFailureReportID</span></span>|<span data-ttu-id="32134-181">System.String</span><span class="sxs-lookup"><span data-stu-id="32134-181">System.String</span></span>|<span data-ttu-id="32134-182">はい</span><span class="sxs-lookup"><span data-stu-id="32134-182">Yes</span></span>|<span data-ttu-id="32134-183">このプロパティは、ルーティングのエラーが発生した際に BizTalk Server が生成するルーティング エラー報告の ID を提供します。</span><span class="sxs-lookup"><span data-stu-id="32134-183">This property provides the ID of the routing failure report that BizTalk Server generates when there is a routing failure.</span></span> <span data-ttu-id="32134-184">ルーティング エラー報告は、BizTalk Server が生成して保留する特殊なメッセージです。</span><span class="sxs-lookup"><span data-stu-id="32134-184">A routing failure report is a special message that BizTalk Server generates and suspends.</span></span> <span data-ttu-id="32134-185">このメッセージには、本文がありません。ただし、失敗したメッセージのコンテキストが含まれています。</span><span class="sxs-lookup"><span data-stu-id="32134-185">This message does not have a body, but it has the context of the failed message.</span></span> <span data-ttu-id="32134-186">この ID を使用することにより、エラーを処理するオーケストレーションや送信ポートは、メッセージ ボックス データベースに対してクエリを実行し、ルーティング エラー報告を処理します。</span><span class="sxs-lookup"><span data-stu-id="32134-186">Using this ID, an error-handling orchestration or a send port can query the MessageBox database and process the routing failure report.</span></span> <span data-ttu-id="32134-187">たとえば、失敗したメッセージを取得した後に、オーケストレーションがルーティング エラー報告を終了させる場合などに、この ID が使用されます。</span><span class="sxs-lookup"><span data-stu-id="32134-187">For example, an orchestration may want to terminate the routing failure report after it gets the failed message.</span></span>|  
  
## <a name="handling-error-messages"></a><span data-ttu-id="32134-188">エラー メッセージの処理</span><span class="sxs-lookup"><span data-stu-id="32134-188">Handling Error Messages</span></span>  
 <span data-ttu-id="32134-189">オーケストレーションまたは送信ポートのサブスクリプションのフィルターが、エラー メッセージのメッセージ コンテキストへ昇格させたプロパティに一致した場合に、エラー処理が指定されます。</span><span class="sxs-lookup"><span data-stu-id="32134-189">Error handling is specified by an orchestration or send-port subscription whose filter matches the properties that have been promoted to the message context of the error message.</span></span>  
  
## <a name="security-implications"></a><span data-ttu-id="32134-190">セキュリティの影響</span><span class="sxs-lookup"><span data-stu-id="32134-190">Security Implications</span></span>  
 <span data-ttu-id="32134-191">元のメッセージに関連付けられている ID (受信パイプラインのパーティの解決ステージで決められた最初の ID または最後の ID) は、エラー メッセージに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="32134-191">The identity associated with the original message—either its initial identity or its final identity determined by the Resolve Party stage of the receive pipeline—is assigned to the error message.</span></span>  
  
 <span data-ttu-id="32134-192">サブスクライブの対象となる、認証されたポートおよびオーケストレーションへのメッセージ配信を制限するセキュリティ メカニズムも、エラー メッセージに適用されます。</span><span class="sxs-lookup"><span data-stu-id="32134-192">The security mechanisms that restrict delivery of messages to authorized subscribing ports and orchestrations also apply to error messages.</span></span>  
  
 <span data-ttu-id="32134-193">エラー メッセージにサブスクライブする送信ポートが適切な解読証明書を使用して構成されていない場合は、エラー メッセージを受信しません。このエラー メッセージは、BizTalk Server で元のメッセージを受信したときに使用した受信パイプラインの、復号化ステージ中 (または前) に発生したメッセージ エラーによって生成されます。</span><span class="sxs-lookup"><span data-stu-id="32134-193">A send port that subscribes to an error message, but is not configured with an appropriate decryption certificate, does not receive error messages that result from messaging failures at or before the decrypt stage of the receive pipeline through which the original message entered BizTalk Server.</span></span> <span data-ttu-id="32134-194">エラー メッセージが受信されなかった場合、失敗したメッセージは、保留キューに配置されます。</span><span class="sxs-lookup"><span data-stu-id="32134-194">Instead, the failed messages are placed in the Suspended queue.</span></span>  
  
## <a name="adapter-messaging-failure"></a><span data-ttu-id="32134-195">アダプターのメッセージ エラー</span><span class="sxs-lookup"><span data-stu-id="32134-195">Adapter Messaging Failure</span></span>  
 <span data-ttu-id="32134-196">アダプターがメッセージを保留すると、エラー メッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="32134-196">If an adapter suspends a message, an error message is published.</span></span> <span data-ttu-id="32134-197">メッセージを保留しないと、エラー メッセージは生成されません。</span><span class="sxs-lookup"><span data-stu-id="32134-197">No error message is generated if the message is not suspended.</span></span>  
  
## <a name="transactional-receive-pipelines"></a><span data-ttu-id="32134-198">トランザクション受信パイプライン</span><span class="sxs-lookup"><span data-stu-id="32134-198">Transactional Receive Pipelines</span></span>  
 <span data-ttu-id="32134-199">トランザクション受信パイプラインが例外をスローすると (トランザクションを中止する必要がある場合に指定する)、トランザクションが中止され、エラー メッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="32134-199">If a transactional receive pipeline throws an exception (specifies that the transaction should be aborted), then the transaction is aborted and an error message is published.</span></span>  
  
 <span data-ttu-id="32134-200">トランザクション受信パイプラインが明示的にメッセージを中断すると (MessageDestination = SuspendQueue を指定する)、現在のトランザクションを続行して (後続のステージで中止が指定されている場合を除いてコミットされる可能性がある)、エラー メッセージが生成されます。</span><span class="sxs-lookup"><span data-stu-id="32134-200">If a transactional receive pipeline explicitly suspends a message (specifies that MessageDestination = SuspendQueue), then the current transaction is allowed to proceed (and may be committed unless subsequent stages specify to abort it) and the resulting error message is published.</span></span>  
  
## <a name="solicit-response-send-ports"></a><span data-ttu-id="32134-201">送信請求 - 応答の送信ポート</span><span class="sxs-lookup"><span data-stu-id="32134-201">Solicit-Response Send Ports</span></span>  
 <span data-ttu-id="32134-202">オーケストレーションからの要求メッセージの送信またはその応答の受信処理に失敗した場合、失敗したメッセージがルーティングされているかどうかに関係なく、オーケストレーションは例外を取得します。</span><span class="sxs-lookup"><span data-stu-id="32134-202">When a request message is sent from an orchestration and it fails transmission or its response fails inbound processing, the orchestration gets an exception, regardless of whether the failed message has been routed.</span></span>  
  
 <span data-ttu-id="32134-203">送信請求 - 応答の送信ポートが要求 - 応答の受信ポートに接続されている場合、受信ポートは、失敗したメッセージがルーティングされているかどうかに関係なく、応答メッセージ (送信が成功した場合) または NACK (送信が失敗した場合) を取得します。</span><span class="sxs-lookup"><span data-stu-id="32134-203">In the case where a solicit-response send port is connected to a request-response receive port, the receive port gets either a response message (if the transmission succeeds) or a NACK (if the transmission fails), regardless of whether the failed message has been routed.</span></span>  
  
## <a name="one-way-send-ports"></a><span data-ttu-id="32134-204">一方向の送信ポート</span><span class="sxs-lookup"><span data-stu-id="32134-204">One-Way Send Ports</span></span>  
 <span data-ttu-id="32134-205">配信通知のために構成された送信ポートを通じてメッセージをオーケストレーションから送信する場合、エラー メッセージがルーティングされているかどうかに関係なく、オーケストレーションは配信通知を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="32134-205">When a message is sent from an orchestration through a send port configured for delivery notification, then the orchestration receives a delivery notification regardless of whether the error message has been routed.</span></span> <span data-ttu-id="32134-206">つまり、送信ポートは、処理中にポートでメッセージ エラーが発生しても、オーケストレーションに対して配信通知を生成します。</span><span class="sxs-lookup"><span data-stu-id="32134-206">In other words, the send port generates a delivery notification for the orchestration even if the port encounters a messaging failure during processing.</span></span> <span data-ttu-id="32134-207">通知では、ポートへの配信を確認しますが、ポートを通じた正常な処理は扱いません。</span><span class="sxs-lookup"><span data-stu-id="32134-207">The notification confirms delivery to the port, but does not address successful processing through the port.</span></span>  
  
## <a name="resuming-suspended-messages"></a><span data-ttu-id="32134-208">保留されたメッセージの再開</span><span class="sxs-lookup"><span data-stu-id="32134-208">Resuming Suspended Messages</span></span>  
 <span data-ttu-id="32134-209">受信処理 (受信アダプターからの処理および受信アダプターを含む処理。ただし、メッセージ ボックスへのパブリケーションを含まない) に失敗したが、エラー処理されていないメッセージのほとんどは、再開可能な状態で保留されます。</span><span class="sxs-lookup"><span data-stu-id="32134-209">Most messages that fail inbound processing (that is, processing from and including the receive adapter and up to but not including publication to the message box), and whose failures are not handled, are suspended as resumable.</span></span> <span data-ttu-id="32134-210">双方向の受信ポートからのメッセージを要求する例外は、再開不可として保留されます。</span><span class="sxs-lookup"><span data-stu-id="32134-210">The exception is that request messages from two-way receive ports are suspended as nonresumable.</span></span>  
  
 <span data-ttu-id="32134-211">通常、メッセージは、元の形式 (パイプライン処理の前の状態) で保留されます。ただし、例外が 2 つあります。</span><span class="sxs-lookup"><span data-stu-id="32134-211">Messages are typically suspended in their original form (as they were before pipeline processing), with two exceptions:</span></span>  
  
-   <span data-ttu-id="32134-212">**パイプライン コンポーネントによって保留されたメッセージ。**</span><span class="sxs-lookup"><span data-stu-id="32134-212">**Messages suspended by pipeline components.**</span></span> <span data-ttu-id="32134-213">BizTalk Server は、失敗したパイプライン コンポーネントにメッセージが提供されたときと同じ形式で、この種類のメッセージを保留します。</span><span class="sxs-lookup"><span data-stu-id="32134-213">BizTalk Server suspends this type of message in the same form as it was provided to the failing pipeline component.</span></span> <span data-ttu-id="32134-214">メッセージを再開すると、パイプラインの最初からパイプライン処理が行われます。</span><span class="sxs-lookup"><span data-stu-id="32134-214">When the message is resumed, it undergoes pipeline processing from the beginning of the same pipeline.</span></span> <span data-ttu-id="32134-215">このため、元のエラーが発生したステージの前のパイプライン ステージにおけるパイプライン コンポーネントを準備して、メッセージを最初に処理したときとは異なる形式で "同じ" メッセージを処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="32134-215">This implies that a pipeline component in a pipeline stage that precedes the stage where the original failure occurred must be prepared to handle the "same" message in a form that is different from the original form in which it processed that message.</span></span>  
  
-   <span data-ttu-id="32134-216">**回復可能なメッセージはインターチェンジ逆アセンブリ、その後のルーティングに失敗しました。**</span><span class="sxs-lookup"><span data-stu-id="32134-216">**Messages from recoverable interchange disassembly that subsequently fail routing.**</span></span> <span data-ttu-id="32134-217">BizTalk Server は、メッセージが公開されたときと同じ形式で、この種類のメッセージを保留します。</span><span class="sxs-lookup"><span data-stu-id="32134-217">BizTalk Server suspends this type of message in the same form as it was published.</span></span> <span data-ttu-id="32134-218">これは、パイプラインの実行 **後** のメッセージの形式です。</span><span class="sxs-lookup"><span data-stu-id="32134-218">This is the form the message had **after** pipeline execution.</span></span> <span data-ttu-id="32134-219">メッセージを再開すると、パイプライン処理がスキップされ、メッセージ ボックス データベースに直接メッセージが公開されます。</span><span class="sxs-lookup"><span data-stu-id="32134-219">When the message is resumed, it skips pipeline processing and is published directly to the MessageBox database.</span></span>  
  
## <a name="scenarios-leading-to-suspended-non-resumable-messages"></a><span data-ttu-id="32134-220">中断 (再開不可) メッセージに至るシナリオ</span><span class="sxs-lookup"><span data-stu-id="32134-220">Scenarios Leading to Suspended (Non-Resumable) Messages</span></span>  
 <span data-ttu-id="32134-221">メッセージが中断されたとき、多くの場合メッセージは再開可能ですが、再開不可となることもあります。このシナリオは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="32134-221">While it is more common for messages to be suspended as resumable, there are some scenarios that lead to non-resumable messages:</span></span>  
  
-   <span data-ttu-id="32134-222">エラー時に続行するよう構成された順次配送送信ポートで、パイプライン、マッピング、または送信のエラーが発生した場合。</span><span class="sxs-lookup"><span data-stu-id="32134-222">In an Ordered Delivery send port with continue on failure enabled, if there is a failure in the pipeline, mapping or transmission.</span></span>  
  
-   <span data-ttu-id="32134-223">順次配送受信ポートで、エラー発生時に再開不可としてメッセージを中断するようアダプターが構成されている場合。</span><span class="sxs-lookup"><span data-stu-id="32134-223">In an Ordered Delivery receive port, if the adapter is configured to suspend messages on non-resumable on failure.</span></span> <span data-ttu-id="32134-224">たとえば、MSMQ アダプターで "エラー時" が "中断 (再開不可)" に設定されている場合、または MQSeries アダプターで "再開不可として保留" が有効になっている場合は、エラーが発生したメッセージは再開不可として中断されます。</span><span class="sxs-lookup"><span data-stu-id="32134-224">For example, if the MSMQ adapter setting "On Failure" is set to "Suspend (non-resumable)" or the MQSeries adapter has "Suspend as Non Resumable" enabled, failed messages will be suspended as non-resumable.</span></span>  
  
-   <span data-ttu-id="32134-225">双方向受信ポートで、応答メッセージに、パイプライン、マッピング、または送信のエラーが発生した場合。</span><span class="sxs-lookup"><span data-stu-id="32134-225">In a two-way receive port, if the response message fails in the pipeline, mapping, or transmission.</span></span>  
  
-   <span data-ttu-id="32134-226">双方向受信ポートで、受信メッセージに、パイプライン、マッピング、または送信のエラーが発生した場合。</span><span class="sxs-lookup"><span data-stu-id="32134-226">In a two-way receive port, if the receive message fails in the pipeline, mapping or transmission.</span></span> <span data-ttu-id="32134-227">アダプターによって動作は異なる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="32134-227">Individual adapter behavior may be different.</span></span> <span data-ttu-id="32134-228">たとえば HTTP アダプターの場合、既定ではメッセージは中断されませんが、中断するよう構成することもできます。</span><span class="sxs-lookup"><span data-stu-id="32134-228">For example, the HTTP adapter does not suspend messages by default but can be configured to do so.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="32134-229">参照</span><span class="sxs-lookup"><span data-stu-id="32134-229">See Also</span></span>  
 <span data-ttu-id="32134-230">[エラー処理](../core/error-handling.md) </span><span class="sxs-lookup"><span data-stu-id="32134-230">[Error Handling](../core/error-handling.md) </span></span>  
 <span data-ttu-id="32134-231">[受信確認の使用](../core/using-acknowledgments.md) </span><span class="sxs-lookup"><span data-stu-id="32134-231">[Using Acknowledgments](../core/using-acknowledgments.md) </span></span>  
 [<span data-ttu-id="32134-232">メッセージの順次配送</span><span class="sxs-lookup"><span data-stu-id="32134-232">Ordered Delivery of Messages</span></span>](../core/ordered-delivery-of-messages.md)