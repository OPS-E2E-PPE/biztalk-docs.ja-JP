---
title: AS2 の証明書の構成 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c160f294-7529-4e0a-876c-5827feaed067
caps.latest.revision: 20
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 916f3f633e9311d970121cd3f41a03fbae8b8259
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/27/2018
ms.locfileid: "37011179"
---
# <a name="configuring-certificates-for-as2"></a>AS2 の証明書の構成
暗号化とデジタル署名を使用して安全な AS2 データ送信を行うには、[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] で AS2 を適切に構成するだけではなく、適切な証明書をインストールする必要があります。 このトピックでは、必要な証明書、証明書の設定方法、および証明書に関する一般的な問題について説明します。  

## <a name="prerequisites"></a>前提条件  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理者グループのメンバーとしてログオンしている必要があります。  

## <a name="certificates-required-for-as2-transport"></a>AS2 トランスポートに必要な証明書  
 安全な AS2 データ送信を行うには、適切な証明書を適切な証明書ストアに追加して、証明書を適切な BizTalk アイテムに関連付ける必要があります。 AS2 メッセージを保護するために、以下の証明書が使用されます。  


|        証明書の使用         |          証明書の種類           | パイプライン コンポーネント |                              ユーザー コンテキスト                              |                                                                                           証明書ストア                                                                                           |                                                                                                                                                                                                                                                                                                                                                            定義されている場所                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------|-------------------------------------|--------------------|------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|       署名 (送信)       |       固有の秘密キー (.pfx)        |    AS2 エンコーダー     |  送信ハンドラに関連付けられているホスト インスタンスが使用するアカウント   |    各ホスト インスタンス サービス アカウントとして AS2 エンコーダー パイプラインをホストする各 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の "現在のユーザー\個人用" ストア    | -   **証明書**のページ、**グループ プロパティ** ダイアログ ボックス。 これは、署名されたドキュメントの送信時に使用される既定の署名証明書です。<br />-既定の証明書設定をオーバーライドして代わりに別のパーティの異なる証明書を使用できます。 選択して行うことができます**グループ署名証明書を上書き**で、**署名証明書**の一方向アグリーメント タブのページ、**アグリーメントのプロパティ**ダイアログボックスの し、署名証明書を指定します。 このプロパティが設定されている場合、アグリーメントに解決される AS2 メッセージが署名で指定された証明書を使用して、**署名証明書**ページし、証明書ではなく、BizTalk グループのプロパティの一部として提供します。 |
| 署名の検証 (受信) | 取引先の公開キー (.cer) |    AS2 デコーダー     | 受信ハンドラに関連付けられているホスト インスタンスが使用するアカウント | 各ホスト インスタンス サービス アカウントとして AS2 デコーダー パイプラインをホストする各 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の "ローカル コンピューター\その他のユーザー" ストア |                                                                                                                                                                                                                                                           **証明書**のページ、**パーティ プロパティ** ダイアログ ボックス**注:** パーティは、その他の署名の確認に使用される証明書から一意である必要があります、署名の検証に使用する証明書パーティです。                                                                                                                                                                                                                                                            |
|      暗号化 (送信)       | 取引先の公開キー (.cer) |    AS2 エンコーダー     |  送信ハンドラに関連付けられているホスト インスタンスが使用するアカウント   |                    AS2 エンコーダー パイプラインをホストする各 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の "ローカル コンピューター\その他のユーザー" ストア                    |                                                                                                                                                                                                                                                                                                                                   **証明書**のページ、**送信ポートのプロパティ** ダイアログ ボックス                                                                                                                                                                                                                                                                                                                                    |
|       解読 (受信)       |       固有の秘密キー (.pfx)        |    AS2 デコーダー     | 受信ハンドラに関連付けられているホスト インスタンスが使用するアカウント |    各ホスト インスタンス サービス アカウントとして AS2 デコーダー パイプラインをホストする各 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] の "現在のユーザー\個人用" ストア    |                                                                                                                                                                                                                        メッセージに含まれている証明書情報に基づいて、AS2 デコーダが証明書を決定します。<br /><br /> BizTalk MIME デコーダーは、証明書である必要があります、**証明書**メッセージを受信するために使用するホストのページ。 AS2 デコーダの場合は必要ありません。                                                                                                                                                                                                                        |

## <a name="certificate-signing-for-outgoing-messages"></a>送信メッセージの証明書への署名  
 送信 AS2 メッセージへの署名には、BizTalk グループのプロパティに定義された既定の証明書が使用されます。 ただし、メッセージを受信するパーティの求めに応じて、そのパーティから提供されるプライベート証明書を使用して署名したり、そのパーティへの送信メッセージの署名時には別の証明書を使用する必要がある場合もあります。 選択した場合、このシナリオの他の証明書を使用して送信メッセージの署名が有効になっている、**グループ署名証明書を上書き**で、**署名証明書**一方向アグリーメント タブのページ**アグリーメントのプロパティ** ダイアログ ボックス、および署名証明書を指定します。 パーティの AS2 アグリーメントで証明書が指定されている場合、送信メッセージの署名にはその証明書が使用されます。 パーティに証明書が定義されていない場合、BizTalk グループのプロパティで指定された既定の証明書が使用されます。  

## <a name="adding-certificates-to-the-certificate-stores"></a>証明書ストアへの証明書の追加  
 詳細については、の「証明書管理コンソールの表示」セクションを参照してください。 [WCF アダプター用の証明書をインストールする](../core/installing-certificates-for-the-wcf-adapters.md)、だけでなく[証明書ウィザード ユーティリティ](../core/certificate-wizard-utility.md)トピック。  

> [!IMPORTANT]
>  個人証明書ストアは、ログオン資格情報がホスト インスタンスに関連付けられているユーザーのユーザー プロファイルが読み込まれた場合にのみ、メッセージ処理に使用できます。 個人証明書ストアは、証明書 (ユーザー独自の秘密キー) の署名と解読に使用されます。 ユーザー プロファイルは、インプロセス ホスト インスタンスでは既定で読み込まれますが、分離ホスト インスタンスでは既定で読み込まれません。 分離ホストのユーザー プロファイルは、アプリケーションで読み込むことができます。 インプロセス ホスト インスタンスと分離ホスト インスタンスに同じログオンを使用することで、この問題を回避することもできます。  

## <a name="generating-certificates"></a>証明書の生成  
 証明書は、証明機関 (CA) から取得できますが、証明書を要求する手順は CA ごとに異なります。 証明書の要求を送信する前に、目的の証明機関の Web サイトに記載された情報を確認してください。  

> [!IMPORTANT]
>  AS2 トランスポートに使用する証明書には、その使用目的に必要な属性が設定されている必要があります。 署名および署名の検証を行う、**キー使用法**証明書の属性である必要があります**デジタル署名**します。 暗号化と復号化、**キー使用法**証明書の属性である必要があります**データの暗号化**または**キーの暗号化**します。 確認することができます、**キー使用法**属性をクリックすると、証明書をダブルクリックして、**詳細** タブで、**証明書** ダイアログ ボックスとチェック、 **キー使用法**フィールド。  

 Windows Server 2008 の証明書サービスを使用して証明書を生成することもできます。ただし、このようにして生成された証明書はパブリック CA による署名ではなく自己署名入りのため、取引先はテスト目的でしか受け付けない可能性があります。 証明書を要求する証明書サービスの使用に関する詳細については、ダウンロード**Windows Server 2008 Active Directory 証明書サービス ステップ バイ ステップ ガイド**から[Windows Server 2008 ステップ バイ ステップ ガイド](http://go.microsoft.com/fwlink/?LinkId=187916) ([http://go.microsoft.com/fwlink/?LinkId=187916](http://go.microsoft.com/fwlink/?LinkId=187916)).  

### <a name="to-configure-a-certificate-for-signing-outgoing-as2-messages"></a>送信 AS2 メッセージの署名に使用する証明書を構成するには  

1. [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールを右クリックし、 **BizTalk グループ**ノード、およびクリック**プロパティ**します。  

2. コンソール ツリーで、**グループ プロパティ**ダイアログ ボックスで、をクリックして**証明書**します。  

3. **証明書**ウィンドウで、をクリックして**参照**では、署名を使用する証明書を検索し、クリックして**ok**します。  

   > [!NOTE]
   >  証明書の一般名を入力する代わりに、拇印だけを入力できます。 MMC でまたはをクリックすると、ファイル システム内の証明書ストアに証明書をダブルクリックして、拇印を取得する、**詳細** タブをクリックすると、**拇印**フィールド、および拇印をコピー.  

4. **[OK]** をクリックします。  

### <a name="to-configure-a-certificate-for-signing-outgoing-as2-messages-for-a-specific-party"></a>特定のパーティに対する送信 AS2 メッセージの署名に使用する証明書を構成するには  

1. [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールで、をクリックして、**パーティ**ノード。 **パーティとビジネス プロファイル**ウィンドウから、**契約**セクションで特定のパーティとメッセージの交換用に作成したアグリーメントを右クリックし、をクリックして**プロパティ**します。  

2. 一方向アグリーメント タブで、次のようにクリックします。**署名証明書**します。  

3. 選択、**上書きグループ署名証明書**送信 AS2 メッセージおよび MDN に署名するため、このページで指定された証明書を使用する チェック ボックス。  

4. クリックして**参照**を表示する、**証明書の選択** ダイアログ ボックスで、このパーティに送信されるメッセージに適用する署名証明書を選択します。  

5. **共通名**テキスト ボックスには、選択した証明書の説明が表示されます。  

6. **拇印**テキスト ボックスは、証明書の拇印を表示します。 証明書の拇印には、形式 HHHH HHHH HHHH HHHH HHHH HHHH HHHH HHHH HHHH HHHH、H は 16 進数の数字 (0 ~ 9 の数) または a ~ F の文字があります。  

7. クリックして**証明書の削除**を選択した証明書を削除します。  

8. クリックして**OK**変更を検証し、ダイアログ ボックスを閉じます。  

### <a name="to-configure-a-certificate-for-verifying-the-digital-signature-of-an-incoming-as2-messages"></a>受信 AS2 メッセージのデジタル署名の検証に使用する証明書を構成するには  

1. [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールを開き、 **BizTalk グループ**ノードをクリックして、**パーティ**ノード。  

2. **パーティとビジネス プロファイル** ウィンドウで、右クリックを受信するパーティ間でメッセージの署名し、クリックして**プロパティ**します。  

3. コンソール ツリーで、クリックして**証明書**します。  

4. **証明書**ウィンドウで、をクリックして**参照**、デジタル署名の検証に使用する証明書を検索し、クリックして**ok**します。  

   > [!NOTE]
   >  証明書の一般名を入力する代わりに、拇印だけを入力できます。 MMC でまたはをクリックすると、ファイル システム内の証明書ストアに証明書をダブルクリックして、拇印を取得する、**詳細** タブをクリックすると、**拇印**フィールド、および拇印をコピー.  

5. **[OK]** をクリックします。  

### <a name="to-configure-a-certificate-for-encrypting-an-outgoing-as2-messages"></a>送信 AS2 メッセージの暗号化に使用する証明書を構成するには  

1. [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理コンソールを開き、 **BizTalk グループ**ノード、**アプリケーション**ノードのノードを展開し、**アプリケーション**を格納している、暗号化されたメッセージで送信するポートを送信します。  

2. 開く、**送信ポート**ノードは、送信ポートを右クリックし、順にクリックします**プロパティ**します。  

3. コンソール ツリーで、クリックして**証明書**します。  

4. **証明書**ウィンドウで、をクリックして**参照**の暗号化に使用したい証明書を検索 **[ok]** します。  

   > [!NOTE]
   >  証明書の一般名を入力する代わりに、拇印だけを入力できます。 MMC でまたはをクリックすると、ファイル システム内の証明書ストアに証明書をダブルクリックして、拇印を取得する、**詳細** タブをクリックすると、**拇印**フィールド、および拇印をコピー.  

5. **[OK]** をクリックします。  

## <a name="see-also"></a>参照  
 [AS2 セキュリティ](../core/as2-security.md)   
 [署名、圧縮、および AS2 トランスポートでの暗号化の構成](../core/configuring-signing-compression-and-encryption-in-as2-transport.md)   
 [AS2 ソリューションのアーキテクチャ](../core/as2-solution-architecture.md)   
 [WCF アダプターの証明書のインストール](../core/installing-certificates-for-the-wcf-adapters.md)