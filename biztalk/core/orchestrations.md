---
title: オーケストレーション |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- orchestrations
- correlations, orchestrations
- orchestrations, correlations
- orchestrations, deploying
- deploying, orchestrations
- orchestrations, about orchestrations
ms.assetid: fb01f78a-b805-46be-a7d9-2b7597daab96
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a045aa332f567a757327015fb114b795be7e06bd
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65262712"
---
# <a name="orchestrations"></a>オーケストレーション
*オーケストレーション*(受信) がサブスクライブできる実行可能なビジネス プロセスとメッセージ ボックス データベースを介して (送信) メッセージを発行します。 さらに、オーケストレーションは、新しいメッセージを構築することができます。 メッセージを受信するサブスクリプションを使用して、ルーティング インフラストラクチャは、後ほど[メッセージのライフ サイクル](../core/lifecycle-of-a-message.md)します。 オーケストレーションのサブスクリプションがいっぱいになるの新しいインスタンスがアクティブ化し、メッセージを配信すると、必要に応じてインスタンスのサブスクリプションの場合、インスタンスがリハイド レートや、メッセージが配信されます。 オーケストレーションから送信されたメッセージは、ルーティングで使用するためのデータベースに挿入する適切なプロパティを持つ受信場所に到着したメッセージと同様に、メッセージ ボックスに発行されます。  
  
 オーケストレーションで構築されるメッセージをメッセージ ボックス データベースに配置し、オーケストレーション インスタンスによって参照される必要がありますが、公開してはならない、まだ送信されていないためです。 Xlang/s サブサービスでは、メッセージを直接挿入する、メッセージ エージェント API に対して呼び出しを行います。 これにより、メッセージ ボックスに、メッセージ本文を挿入し、実行中のオーケストレーション インスタンスに直接関連付けられているそのオーケストレーション エンジンができます。 メッセージ ボックス データベースで構築されたメッセージの永続化はデータベース操作の追加の最適化として、オーケストレーションの永続化ポイントと連携します。  
  
 公開およびサブスクライブするオーケストレーションの概念は、バインドは、異なる方法で動作するようです。 オーケストレーションのポートは、相互作用を表す論理ポートです。 メッセージが配信されますが、バインディング プロセスはメッセージのルーティングのサブスクリプションを構成できるように、物理ポートにこれらの論理ポートをバインドする必要があります。  
  
 これらのポートをバインドするための 4 つの基本的なオプションがあります。  
  
-   今指定する (オーケストレーションで直接指定するポート)  
  
-   後で (デプロイ時に指定するポート) を指定します。  
  
-   オーケストレーション コードで、アドレスが設定されている動的送信ポートを使用します。  
  
-   オーケストレーションからメッセージ ボックス データベース、または別のオーケストレーションに直接バインドを作成します。  
  
## <a name="deploying-orchestrations"></a>オーケストレーションの展開  
 デザイン時にバインディングを指定すると、オーケストレーションが展開されると、オーケストレーションで構成されているパラメーターに一致する物理ポートが作成されます。 デプロイ時にバインディングが構成されると、論理ポートの要件に一致する任意のポートがオーケストレーション ポートにバインドできます。 動的バインドは、今指定オプションと同様に、物理ポートが作成されたが、ポートは構成されているアドレス情報がない動的送信ポート。  
  
 混乱の概念は、物理送信ポートをオーケストレーションの送信ポートがバインドされているときに、他のサブスクライバーに配信されてからそのメッセージを妨害しないこのことです。 別の送信ポートの場合は、両方の送信ポート バインドのポートに送信されるメッセージが表示されるメッセージに対して、フィルターで、サブスクリプションが発生します。 バインドは、常に、オーケストレーションから送信されるメッセージには、バインド済み送信ポートに一致するように単純にサブスクリプションを作成します。 同様に、受信ポートにバインドされたオーケストレーション ポートはメッセージの種類と受信ポートの ID に基づく適切なサブスクリプションを作成します。 サブスクリプションでは、バインドのポートに配信される、オーケストレーションとの間のメッセージが、メッセージは引き続き同じ発行を移動し、前に説明したメカニズムをサブスクライブを保証します。  
  
 おそらく、誤解されやすく、誤用やバインドの使用率の低いオプションは、直接バインド オプションです。 直接バインドを使用できますルーティング プロパティをさまざまなメッセージ ボックス データベースにメッセージを公開するオーケストレーション多くメッセージの発行などでは、受信場所。 簡単な直接メッセージング、メッセージは、BizTalk Server に受信したその他の公開されたメッセージのようにルーティングされるようにする、昇格させたプロパティを持つメッセージ ボックスに公開されます。 これにより、このメッセージを受信するすべてのサブスクライバーが、少なくとも 1 つのサブスクライバーが存在して、オーケストレーションでは、ルーティング障害のエラーを受信する必要があります。  
  
 直接バインドの別のオプションでは、自己関連付けを行うポートを使用します。 自己関連付けを行うポートは一意の関連付けトークンを作成してインスタンス間でメッセージを相関させる場合にだけでそのトークンを使用するポートです。 自己関連付けポートの最も一般的な用途は、呼び出しまたはポート パラメーターを渡して、オーケストレーションを開始します。 呼び出されたオーケストレーションでは、呼び出し元のオーケストレーションで同じポートを使用してメッセージを受信するメッセージを送信するポートを使用できます。 ポートは一意の関連付けトークンがあるため、メッセージは、呼び出し元のオーケストレーションにルーティングされます。 自己関連付けポートは、オーケストレーション インスタンス間のプライベート通信チャネルとして機能します。  
  
 最後のオプションは、呼び出し元のオーケストレーションと呼び出し先のオーケストレーションの両方で、ポートが構成されている同じを使用してオーケストレーションのポートの種類の共有、パートナーを使用してポートの構成で同じポートが選択されています。 たとえば、Orch1 および Orch2 で Orch2.MyDirectPort を選択します。 この種類のバインドは、送信側のオーケストレーションの種類、ポート名、および操作名に基づいて受信オーケストレーションのサブスクリプションを設定します。 もう一度これにより、正しいインスタンスにメッセージをルーティングします。  
  
 直接のメッセージング オプションをすべて基になる公開 を使用し、サブスクライブ モデル。 これらのオプションの違いはサブスクリプションを作成して、ルーティングに使用されるプロパティであり、解決に役立つ、ユース ケースで。  
  
 オーケストレーションでの直接バインド ポートを使用する場合に発生した 1 つの一般的な問題は、オーケストレーションが、サブスクライブしていることも、メッセージを発行してはことです。 たとえば、オーケストレーションを PurchaseOrder メッセージによってアクティブ化に構成されます。 このオーケストレーションでは、直接ポートを使用して PurchaseOrder メッセージをメッセージ ボックス データベースに発行します。 ただし、期待どおりにメッセージを受信、だけでなく、オーケストレーションの別のインスタンスが開始されますがすぎる PurchaseOrder メッセージに対するサブスクリプションがあったため。 無限ループが処理を取得し、何が起こったかを図に、開発者の時間がかかる場合があります。  
  
## <a name="correlation"></a>Correlation  
 *相関関係*オーケストレーションでは、同じ実行中のオーケストレーション インスタンスに関連するメッセージを受信するためのメカニズムです。 オーケストレーション デザイナーで、開発者は、相関関係を使用する一般的な手順に従います。  
  
- メッセージの関連付けに使用される昇格させたプロパティが含まれる関連付けの種類を定義します。  
  
- 定義されているだけの関連付けの種類のインスタンスでは、関連付けセットを定義します。  
  
- 送信および受信ポートは、開始、または、指定された関連付けセットに従うかどうかを指定します。  
  
  インスタンスのサブスクリプションが作用する関連付けセットが開始されると、これは、この関連付けは、メッセージを受信するセットに従ってこれらのポートのすべてのサブスクリプションを作成するとき。 関連付けの種類は、関連付けに使用するプロパティを定義するため、オーケストレーション エンジンは、送信または開始アクションによって受信されるメッセージからこれらのプロパティを抽出できます。 これらの値は、この関連付けセットに従って他のアクションのすべてのサブスクリプションの定義に使用されます。  
  
  BizTalk Server を受信し、関連付けに使用するためのメッセージが正しく定義されており、メッセージ コンテキストに昇格させる、昇格させたプロパティにあることが重要です。 ほとんどのプロパティを昇格させるは、ときに、パイプラインの逆アセンブラー コンポーネントは、メッセージが最初に受信したときに、値を抽出します。 このため、ことはできません、パススルーを使用する受信パイプラインをオーケストレーションの実行中のインスタンスに関連付ける必要のあるメッセージを受信します。 この問題は、Web サービス公開ウィザードを使用する場合、パススルー パイプラインが受信パイプラインの既定値なので、関連付けられたメッセージを受信する、SOAP 受信アダプターを使用する場合に発生します。  
  
## <a name="see-also"></a>参照  
 [成果物](../core/artifacts.md)   
 [オーケストレーション デザイナーでのオーケストレーションの作成](../core/creating-orchestrations-using-orchestration-designer.md)