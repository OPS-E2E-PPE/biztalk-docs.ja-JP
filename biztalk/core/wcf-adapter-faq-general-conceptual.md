---
title: "WCF アダプター FAQ: 一般的概念 |Microsoft ドキュメント"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: bbeac135-3ba8-4b0b-a8ca-4eb5eb3d3ca3
caps.latest.revision: "8"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6a33e6ba26f0ba97cb10aa2f9ee728683719dd66
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/01/2017
---
# <a name="wcf-adapter-faq-general-conceptual"></a>WCF アダプターに関するよく寄せられる質問: 一般的概念
ここでは、Windows(R) Communication Foundation (WCF) アダプターに関してよく寄せられる一般的な質問および概念的な質問の一部に回答します。  
  
## <a name="what-is-a-wcf-adapter"></a>WCF アダプターとは何ですか。  
 BizTalk アダプターは、Microsoft(R) BizTalk(R) Server が外部と通信するときに中心的な役割を果たします。 WCF アダプターは、BizTalk アプリケーションで WCF エンドポイントとメッセージをやり取りする必要が生じた場合に、両者間の通信プロセスを管理するコンポーネントです。 BizTalk Server では、WCF アダプターは WCF バインドとして公開されます。 このため、WCF バインドを使用できるすべての WCF アプリケーションは、BizTalk Server を介さずに直接 WCF アダプターと通信できます。 しかし、BizTalk Server を介して WCF アダプターを使用することで、BizTalk Server によるアプリケーション インフラストラクチャ上のメリットを数多く享受できます。 ここでは、主に BizTalk Server 環境から WCF アダプターを使用する方法についてよく寄せられる質問にお答えします。  
  
 WCF アダプターを使用すると、BizTalk Server で WCF バインドを使用して WCF メッセージを送受信できます。 WCF クライアント アプリケーションは、WCF メッセージを BizTalk の受信場所に送信できます。ここでは、WCF 受信アダプターがメッセージを受信します。 WCF 受信アダプターは、受信した WCF メッセージを BizTalk メッセージに変換します。 変換のしくみは、BizTalk Server 管理コンソールを使用して構成される、アダプター構成の実際の設定によって異なります。 受信アダプターは、BizTalk メッセージを内部の BizTalk MessageBox データベースに送信します。 これに対応して、WCF アダプターを使用する BizTalk 送信ポートは、このメッセージの種類をサブスクライブして BizTalk メッセージを受信し、WCF メッセージに変換して、サポートされている WCF プロトコルのいずれかを使用して WCF サービス エンドポイントに送信します。  
  
 BizTalk Server から WCF アダプターを使用することで、BizTalk-WCF 併用のアプリケーション ソリューションに伴う煩雑な作業 (通信プロトコルの選択と実装、セキュリティ問題への対応、トランザクションの処理など) は不要になります。  
  
## <a name="what-are-the-wcf-adapter-bindings"></a>WCF アダプター バインドとは何ですか。  
 WCF バインドは、次の 2 つのカテゴリのいずれかに分類されます。  
  
-   **カスタム バインド:**特別なカスタム バインドが存在するバインドの柔軟性を向上させます。 カスタム バインドを使用することで、標準バインドでは対応できない通信状況に対応できます。 WCF-Custom アダプターおよび WCF-CustomIsolated アダプターを使用すると、バインドを広範囲にわたってカスタマイズできます。 これは、既存のバインド要素 (BindingElement クラス) を組み合わせて動作 (Behavior クラス) を適用できるようにすることで実現します。  
  
-   **標準バインド:**マイクロソフトの目標は、最も一般的な通信シナリオに焦点を当てたアダプターを開発することです。 標準バインドを使用することで、通信プロトコルに関する詳細な設定の多くが不要になるため、開発に必要な作業を簡略化できます。 BizTalk Server での WCF アダプターのセットでは、.NET Framework 4.0 WCF ライブラリで使用可能なバインドのセットが反映されます。 標準バインドは、一般的なバインドのパターンを簡単に使用できるようにするために、.NET WCF ライブラリに導入されました。 これらのバインドは、最も一般的に使用される通信シナリオに対応しており、次の種類に分類されます。  
  
    -   WCF-WsHttp  
  
    -   WCF-BasicHttp  
  
    -   WCF-NetTcp  
  
    -   WCF-NetMsmg  
  
    -   WCF-NetNamedPipe  
  
 BizTalk Server R2 には、次の WCF アダプターが用意されています。  
  
1.  **Wcf-wshttp アダプター:** Ws-* 標準の HTTP トランスポート経由でサポートされます。 WCF-WSHttp アダプターは、外部アプリケーションと MessageBox データベース間のトランザクション上の対話に WS-Transaction、メッセージ セキュリティと認証に WS-Security という仕様を実装します。 トランスポートは HTTP または HTTPS、およびメッセージのエンコードは、テキストまたはメッセージ Transmission Optimization Mechanism (MTOM) エンコードです。  
  
2.  **Wcf-basichttp アダプター:** ASMX ベースの Web サービスとクライアント、および、WS に準拠するその他のサービスとの通信の Basic Profile 1.1 です。 トランスポートは HTTP または HTTPS で、メッセージ エンコードは Text エンコードです。  
  
3.  **Wcf-nettcp アダプター:** Ws-* 標準を TCP トランスポート経由でサポートされます。 WCF-NetTcp アダプターは、通信の効率を向上させると共に、外部アプリケーションと MessageBox データベース間のトランザクション上の対話に WS-Transaction、メッセージ セキュリティと認証に WS-Security という仕様を実装します。 トランスポートは TCP で、メッセージのエンコードはバイナリ エンコードです。  
  
4.  **Wcf-netmsmq アダプター:**アプリケーション、失敗の切り分け、負荷平準化を組み合わせるし、操作の切断を活用してメッセージ キュー (MSMQ とも呼ばれます) のサポートをトランスポートとして疎キューのサポートを提供します。  
  
5.  **Wcf-netnamedpipe アダプター:**コンピューター上のプロセス間通信をセキュリティで保護の最適化を提供します。 WCF-NetNamedPipe アダプターはトランスポート セキュリティを使用して、転送時のセキュリティ、メッセージ配信の名前付きパイプ、メッセージのバイナリ エンコードを実現します。  
  
     これまでに説明した 5 つのアダプターは、WCF バインドに 1:1 で対応しています。 次に述べる 2 つのカスタム アダプターの構造は、1 つの WCF CustomBinding に 2 つのカスタム アダプターが対応しているという点で、WCF モデルからは少し外れます。  
  
6.  **Wcf-custom アダプター:** WCF 拡張機能の使用を有効にします。 このアダプターでは、受信場所、または BizTalk Server プロセスでホストされている送信ポートに対して、WCF バインドと動作情報を選択し、構成できます。  
  
7.  **Wcf-customisolated アダプター:** HTTP トランスポート経由で WCF 拡張機能の使用を有効にします。 このアダプターでは、インターネット インフォメーション サービス (IIS) の分離ホストで実行している受信場所に対して、WCF バインドと WCF 動作情報を選択し、構成できます。  
  
## <a name="what-is-the-difference-between-the-wcf-xxx-adapter-and-the-wcf-xxx-binding"></a>WCF-xxx アダプターと WCF-xxx バインドの違いは何ですか。  
 各 WCF アダプターは、組み込みの WCF バインドのいずれかに対応しています。 より高いレベルでは、"WCF-xxx アダプターは WCF-xxx バインドを使用しています" という表現で、これらの用語がほぼ同じ形で使用されています。 たとえば、WCF-BasicHttp アダプターは WCF BasicHttpBinding クラスを使用します。 WCF バインドは、WCF エンドポイントの定義の一部です。 WCF バインドは、WCF エンドポイントの "ABC" (アドレス、バインド、およびコントラクト) で定義されています。  
  
 バインドは、バインド要素の集まりで構成されています。 各要素は、エンドポイントがクライアントと通信する方法の特定の局面を表しています。 バインドに必要な要素は次のとおりです。  
  
-   1 つ以上のトランスポート バインド要素。  
  
-   1 つ以上のメッセージ エンコード バインド要素 (トランスポート バインド要素が既定で備えている場合もあります)。  
  
-   任意の数の他のプロトコル バインド要素。  
  
 この記述からランタイム環境を作成するプロセスによって、各バインド要素に基づくコードをその環境に追加できます。 クライアントは、多くの場合、呼び出し先の WCF サービスがサポートしているものと同じバインドの種類とアダプターを使用する必要があります。 WCF レベルでは、バインドは構成ファイルで宣言するか、コードで明示的に記述することによって定義します。 WCF アダプターは、特定の WCF バインドを使用することによって通信を円滑化するため、"アダプター" と "バインド" という 2 つの用語は、ほぼ同じ意味で使用される傾向があります。  
  
## <a name="when-using-the-wcf-adapters-how-do-you-decide-which-wcf-binding-to-use"></a>WCF アダプターを使用する場合、どのようにして WCF バインドを選択すればよいですか。  
 使用する WCF バインドを決定するときは、まずメッセージングのパターン、次に外部的な制約、3 番目にパフォーマンスという優先順位で考慮します。  
  
1.  **メッセージング パターン:**通信のパターンがどのように通信が発生したメッセージの流れを基準。 たとえば、メッセージが一方的 (要求) であるか双方向 (要求 - 応答) であるか、トランザクションやキューの対象となるのかどうか、などについて考慮します。  
  
    -   メッセージがキューの対象になる場合、キューおよびトランザクションの対象となる一方向の通信をサポートする WCF-NetMsmq アダプターを使用する必要があります。  
  
    -   2 つのコンピューター間を移動する双方向の要求 - 応答パターンの場合、HTTP (できる限り柔軟性を維持することを重視する場合) または WCF-NetTcp (パフォーマンスを重視する場合) を使用します。  
  
    -   メッセージが 1 台のコンピューター内でやり取りされ、複数のプロセス間を移動するだけの場合は、WCF-NetNamedPipe バインドを使用できます。  
  
2.  **外部的な制約:**特定のバインディングを使用するよう指示がある可能性があります。 たとえば、外部システムで SOAP Web サービス バージョン 1.2 とアドレス指定 1.0 が必須になっている場合があるとします。 ここでは、Wcf-wshttp アダプターを使用する WSHttpBinding がバインディング最適です。 また、外部システムでは、多くの場合、特定のセキュリティ モードの構成が必須になっています。 外部システムで Soap Web サービス 1.1 が必須になっている場合は、WCF-BasicHttp アダプター (HTTP バインド) を使用します。  
  
3.  **パフォーマンス:**でバインディングを選択を使用するアプリケーションで決定要因があります、呼び出しが行われた速度。  
  
    -   WCF サービスが BizTalk Server と同じコンピューター上にある場合は、WCF-NetNamedPipe のパフォーマンスが最も優れています。  
  
    -   WCF サービスがローカル ネットワーク上にある場合は、WCF-NetTcp のパフォーマンスが最も優れています。  
  
    -   パフォーマンスがそれほど重要な問題ではなく、呼び出しがインターネットを介して行われる場合は、HTTP ベースのアダプター (WCF-WsHttp または WCF-BasicHttp) のいずれかを使用することをお勧めします。  
  
         どちらのアダプターを使用するかは、HTTP の高度な機能を使用するか (WCF-WsHttp)、基本的な機能だけを使用するか (WCF-BasicHttp) に応じて決定します。  
  
## <a name="when-do-you-use-one-of-the-two-custom-wcf-adapters"></a>2 つのカスタム WCF アダプターを使用するのはどのような場合ですか。  
 BizTalk Server に付属する 2 つのカスタム WCF アダプターがあります。 カスタム アダプターが 2 つある理由は、BizTalk Server では、特定の種類のアダプターのホスティング状況をシステムに登録する必要があるためです。 WCF フレームワークには、カスタム バインドの種類が 1 つしかありませんが、BizTalk Server では、既存の BizTalk アダプター モデルによるこの制限に対応するため、2 つのカスタム アダプターが用意されています。 これらのカスタム アダプターでは、WCF チャネル スタックの構成を全面的に制御できるため、実際に必要になるのはこれらのアダプターだけです。  
  
 カスタム アダプターを使用する場合の唯一のデメリットは、WCF の構成やさまざまな機能拡張技法に関する詳しい知識がユーザーに必要とされることです。  標準 WCF バインドのアダプターが用意されているのは、構成を簡素化するためです。 標準バインドは、一般的な使用方法の大部分に対応すると共に、BizTalk Server を通じたメッセージの送受信をできるだけ簡単にするために、あらかじめ定義されています。 通常、カスタム アダプターのいずれかを使用する必要があるのは、実際の送信ポートまたは受信場所の要件に、標準バインドでは対応できない部分がある場合だけです。 たとえば、メッセージに独自の圧縮体系を使用するアプリケーションがあるとします。 これに対応するには、カスタムのバインド要素を作成する必要があります。 2 つの標準カスタム アダプターのいずれかを使用すると、そのような送信要件を処理するようにカスタム バインドを構成できます。 このように、カスタム アダプターを使用すると、チャネル スタック内のその通信プロセスのバインドの構成を、より詳細に制御できるようになります。  
  
 カスタム アダプターとカスタム分離アダプターの主な違いは、ホスティング方法にありますが、ホスティング方法が影響するのは、BizTalk Server の受信側だけです。 WCF-CustomIsolated アダプターは、受信場所でのみ使用され、送信ポートでは使用されません。 "Isolated (分離)" とは、BizTalk Server の BtsNtSvc.exe プロセス以外の場所でホストされていることを表す BizTalk の用語です。 このため、WCF-CustomIsolated アダプターは、インターネット インフォメーション サービス (IIS) 内で HTTP トランスポートを使用するトランスポートが、標準の BtsNtSvc.exe プロセス以外の場所でホストされている場合に使用します。 WCF-Custom アダプターは、受信場所と送信ポートのどちらでも使用できます。 このアダプターは、トランスポートが標準の BtsNtSvc.exe プロセス内でホストされている場合に使用します。  
  
## <a name="how-does-a-wcf-endpoint-relate-to-biztalk-server"></a>WCF エンドポイントは BizTalk Server とどのように関連していますか。  
 WCF エンドポイントは、アドレス、バインド、およびコントラクト (ABC) で構成されます。 BizTalk Server 内では、ユーザーが受信場所または送信ポートでアドレスを指定します。 バインドは、ユーザーが選択した WCF アダプターによって指定されます。 コントラクトは、エンドポイントによって公開されるインターフェイスを指定するもので、プログラマーが決定します。  
  
 実際のエンドポイントは、WCF メッセージの送信先となる受信場所として表されます。  BizTalk Server アプリケーションで WCF エンドポイントを公開するには、次のようなさまざまな方法があります。  
  
-   BizTalk WCF サービス公開ウィザードを使用して、BizTalk オーケストレーションを WCF エンドポイントとして公開します。  
  
-   BizTalk WCF サービス公開ウィザードを使用して、既存の BizTalk アプリケーション内に受信場所を作成します。  
  
-   コードで受信場所のバインドとアドレスを構成して、WCF エンドポイントを手動で作成します。  この場合、受信場所は実際には型指定されません。  コントラクトは、単純に WCF メッセージ クラスに基づいて指定されるため、任意の形式のメッセージを MessageBox データベースに受信できます。  
  
 WCF アダプターを使用する各 BizTalk 受信場所は、WCF クライアントの呼び出し先となる WCF エンドポイントとして公開されます。  受信場所は、独自の WCF ServiceHost を内部的に使用するため、さまざまな受信場所を互いに影響することなく有効化または無効化できます。 サービス エンドポイントの有効期限は、その受信場所が有効化されている間、継続します。 WCF ServiceHosts が、受信ポートではなく受信場所に対応しているのは、この有効期限があるためです。 WCF の設計により、個別の ServiceHost の実行時リソースとしてのコストを抑えることができるため、多くの ServiceHost を同じ実行可能ファイル内で問題なく実行できます。  
  
 WCF アダプターを使用する各 BizTalk 送信ポートは、WCF サービスに対する呼び出しに対応しています。 送信するメッセージがある場合、BizTalk Server は、これらのメッセージをアダプターに渡し、これに対応して BizTalk WCF アダプター内で WCF クライアント プロキシが作成されます。 メッセージの送信後、WCF クライアント プロキシは解放されます。 送信ポートにおける WCF の有効期限は、プロキシの作成、使用、および破棄に基づいて決定されます。