---
title: カスタム分析タスクを作成する方法 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- BAM, DTS tasks
- DTS tasks
- DTS packages, tasks
- BAM, processing
ms.assetid: 6046c113-fb58-4e72-8f48-5470e52be9a8
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 2afeae7dba801e1724e30e88d68ea454d87b228f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65340081"
---
# <a name="how-to-create-a-custom-analysis-task"></a><span data-ttu-id="b0058-102">カスタム分析タスクを作成する方法</span><span class="sxs-lookup"><span data-stu-id="b0058-102">How to Create a Custom Analysis Task</span></span>
<span data-ttu-id="b0058-103">BAM データを処理するためのカスタム DTS タスクを作成する最も簡単な方法では、BAM によって自動生成であるパッケージから始めることですし、実際のすべてのデータ処理を置き換えます。</span><span class="sxs-lookup"><span data-stu-id="b0058-103">The easiest way to create a custom DTS task for processing BAM data is to start from the package that is auto-generated by BAM and replace all the actual data processing.</span></span>  
  
### <a name="to-create-a-custom-dts-task"></a><span data-ttu-id="b0058-104">カスタム DTS タスクを作成するには</span><span class="sxs-lookup"><span data-stu-id="b0058-104">To create a custom DTS task</span></span>  
  
1. <span data-ttu-id="b0058-105">OLAP キューブを必要とする BAM 定義を作成します。</span><span class="sxs-lookup"><span data-stu-id="b0058-105">Create a BAM Definition that requires an OLAP cube.</span></span> <span data-ttu-id="b0058-106">たとえば、Excel のウィザードを使用し、1 つの PivotTable® レポートを RTA 以外のビューとしてのままにします。</span><span class="sxs-lookup"><span data-stu-id="b0058-106">For example use the Excel wizards, and leave one PivotTable® report as non-RTA view.</span></span>  
  
2. <span data-ttu-id="b0058-107">BAM を作成するキューブの処理のための DTS パッケージを開きます。</span><span class="sxs-lookup"><span data-stu-id="b0058-107">Open the DTS package for cube processing that BAM creates.</span></span> <span data-ttu-id="b0058-108">BAM では、各ビューは、bam_an _ と呼ばれるこのような 1 つのパッケージを作成します。\<*ビュー名*\>します。</span><span class="sxs-lookup"><span data-stu-id="b0058-108">BAM creates one such package for each view, known as BAM_AN_\<*View Name*\>.</span></span>  
  
3. <span data-ttu-id="b0058-109">DTS デザイナーでパッケージを開き、最初の 2 つの手順と、最後の手順を除くすべての手順を削除します。</span><span class="sxs-lookup"><span data-stu-id="b0058-109">Open the Package in the DTS Designer and remove all steps except the first two steps and the last step.</span></span> <span data-ttu-id="b0058-110">プライマリ インポート データベースへの接続を維持することもできます。</span><span class="sxs-lookup"><span data-stu-id="b0058-110">You may also want to keep the connection to the Primary Import database.</span></span>  
  
4. <span data-ttu-id="b0058-111">ActiveX® の最初のタスクのプロパティを編集します。</span><span class="sxs-lookup"><span data-stu-id="b0058-111">Edit the properties of the first ActiveX® task.</span></span> <span data-ttu-id="b0058-112">削除の手順を参照しているため、DTSGlobalVariables.Parent.Steps が含まれているすべての行を削除します。</span><span class="sxs-lookup"><span data-stu-id="b0058-112">Remove all lines that contain DTSGlobalVariables.Parent.Steps, because they refer to the deleted steps.</span></span> <span data-ttu-id="b0058-113">スクリプトから始まります。</span><span class="sxs-lookup"><span data-stu-id="b0058-113">The script begins with:</span></span>  
  
   ```  
   serverName = "<your server here>"   
   databaseName = "<your analysis database here>"  
   cubeName = "<your cube name here>"  
   ```  
  
   > [!NOTE]
   >  <span data-ttu-id="b0058-114">タスク データ分析開始""(パッケージ内の 2 番目のタスク) は、パッケージを提供するために非常に重要です。</span><span class="sxs-lookup"><span data-stu-id="b0058-114">The task "Begin Data Analysis" (the second task in the package) is very important because it gives your package:</span></span>  
   > 
   > - <span data-ttu-id="b0058-115">完了したアクティビティ (動的 SQL ビュー _ (BamView) _View (Activity) _CompletedInstancesWindow という名前の増分処理用の移動ウィンドウ</span><span class="sxs-lookup"><span data-stu-id="b0058-115">A moving window for incremental processing of the completed Activities (the dynamic SQL view named  bam_(BamView)_View(Activity)_CompletedInstancesWindow</span></span>  
   >   -   <span data-ttu-id="b0058-116">進行状況 - bam をという名前のテーブルに含まれるアクティビティのスナップショット\_(BamView) _View (Activity) _ActiveInstancesSnapshot します。</span><span class="sxs-lookup"><span data-stu-id="b0058-116">A Snapshot of the Activities that are in progress - a table named  bam\_(BamView)_View(Activity)_ActiveInstancesSnapshot.</span></span>  
  
5. <span data-ttu-id="b0058-117">ビューとテーブルを挿入しないデータ、データが、プライマリ インポート データベースの瞬間のスナップショットを表すように、短いトランザクションで取得します。</span><span class="sxs-lookup"><span data-stu-id="b0058-117">Obtain the view and table in a short transaction, during which you insert no data, so that the data represents a real instantaneous snapshot of the Primary Import database.</span></span> <span data-ttu-id="b0058-118">ビューとデータの入力としてテーブルに基づいて、実際のデータ変換の 1 つまたは複数の手順を実装します。</span><span class="sxs-lookup"><span data-stu-id="b0058-118">Implement one or more steps to do the actual data transformations based on the view and table as input data.</span></span> <span data-ttu-id="b0058-119">分析タスクの目的が OLAP キューブの設定以外の場合は、ジョブが、最後にコミットされ、最初の ActiveX タスクこのタイムスタンプをグローバル変数に代入するコードを置き換えますのタイムスタンプを保持ください"Completedcubelastprocesstime"に割り当てる。</span><span class="sxs-lookup"><span data-stu-id="b0058-119">If the purpose of your analysis task is something other than filling an OLAP cube, remember to keep a timestamp of when your job committed for the last time and replace the first ActiveX task with code that assigns this timestamp to the global variable "CompletedCubeLastProcessTime".</span></span> <span data-ttu-id="b0058-120">2 番目のタスクでは、この変数を使用して、失敗したデータがないことと、2 回、クラッシュが発生した場合にデータが処理があるかどうかを確認し、DTS パッケージの再起動します。</span><span class="sxs-lookup"><span data-stu-id="b0058-120">The second task uses this variable to make sure that there is no missed data and that no data processes twice in case of a crash and restart of the DTS package.</span></span>  
  
6. <span data-ttu-id="b0058-121">最後に、「データ分析終了」である最後のタスクを呼び出す必要があります。</span><span class="sxs-lookup"><span data-stu-id="b0058-121">Finally, you must call the last task, which is "end data analysis".</span></span> <span data-ttu-id="b0058-122">このタスクは、アーカイブして、オンライン時間帯外にあるときと、プライマリ インポートから削除できるように、処理された完了したアクティビティを解放します。</span><span class="sxs-lookup"><span data-stu-id="b0058-122">This task releases the completed activities that were processed, so that they can be archived and removed from the primary import once they are outside of the online window.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b0058-123">参照</span><span class="sxs-lookup"><span data-stu-id="b0058-123">See Also</span></span>  
 [<span data-ttu-id="b0058-124">ビジネス アクティビティの使用の監視</span><span class="sxs-lookup"><span data-stu-id="b0058-124">Using Business Activity Monitoring</span></span>](../core/using-business-activity-monitoring.md)