---
title: 付録 D:SMTP サーバーの作成 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f7441ba9-a498-42ec-a04d-7f2731407373
caps.latest.revision: 7
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 41bc8cc1e86dcf125640ad9997ed4bd8e315d85f
ms.sourcegitcommit: 381e83d43796a345488d54b3f7413e11d56ad7be
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65401474"
---
# <a name="appendix-d-create-the-smtp-server"></a>付録 D:SMTP サーバーを作成します。
SQL Server データベース メールによって使用される SMTP サーバーを作成します。  
  
次の SQL バージョンのいずれかを使用する場合は、BAM 警告を構成するのには、SQL Server Database Mail が必要です。 

* [!INCLUDE[sqlserver2016_md](../includes/sqlserver2016-md.md)]
* [!INCLUDE[sqlserver2014](../includes/sqlserver2014-md.md)]
* [!INCLUDE[sqlserver2012](../includes/sqlserver2012-md.md)] 
  
  SQL Server Database Mail では SMTP サーバーを使用して BAM 警告を送信します。 SMTP サーバーがインターネット インフォメーション サービス (IIS) に含まれています。 SMTP インストールできますローカル BizTalk サーバーまたは別のサーバーに iis をインストールします。  
  
> [!IMPORTANT]
>  通常、Windows 10、Windows 7 などのクライアント オペレーティング システムでは、SMTP サーバーの機能は含まれません。 使用して、Windows Server 上の既存の SMTP サーバーに接続することができます、 *SMTP 電子メール*IIS 内で機能します。 *SMTP 電子メール*機能は、SQL Server Database Mail を必要とされる SMTP サーバーではありません。 その結果、このトピックでは、インストールして、クライアント オペレーティング システムで SMTP サーバーを構成する手順は含まれません。  

## <a name="install-and-configure-the-smtp-server"></a>SMTP サーバー インストールし、構成  
  
次の手順が適用されます。

* Windows Server 2016
* Windows Server 2012 R2
* Windows Server 2012
  
### <a name="install-smtp-server"></a>SMTP サーバーをインストールします。  
   
1.  **サーバー マネージャー**、**ダッシュ ボード**左側のウィンドウでします。  
  
3.  選択**役割と機能の追加**します。 **役割と機能の追加**から開くこともできます、**管理**右上隅のメニュー。  
  
4.  **開始する前に**、**次**。  
  
5.  選択**役割ベースまたは機能ベースのインストール**を選択し、**次**します。  
  
6.  選択**サーバー プールからサーバーを選択**、目的のサーバーを選択し、**次**します。 **サーバーの選択**ウィンドウを使用して追加されているサーバーを一覧表示**サーバーの追加**で**サーバー マネージャー**します。 既定では、ローカル サーバーを選択します。  
  
7.  **サーバーの役割**を選択します**次**します。  
  
8.  **機能**、確認**SMTP サーバー**します。 選択を求められたら、**機能の追加**します。 **[次へ]** を選択します。  
  
9. **確認**を選択します**必要な場合に、移行先サーバーを自動的に再起動**、選択および**インストール**します。 完了すると、選択**閉じる**します。  

### <a name="configure-the-smtp-server"></a>SMTP サーバーを構成します。  
 次の手順では、IIS 6.0 マネージャーを使用して、SMTP 仮想サーバーを構成します。  
  
1.  IIS マネージャーを開きます。スタートでは、検索**inetmgr6.exe**、し、開きます。  
  
2.  コンピューター名を展開します。 右クリックして **[SMTP Virtual Server #1]**、選択と**プロパティ**します。  
  
3.  **アクセス**] タブで、[、**リレー**ボタンをクリックします。  
  
4.  選択**追加**します。 **1 台のコンピューター**、入力`127.0.0.1`を選択し、 **OK**。  
  
     127.0.0.1 を追加すると、この SMTP サーバーからメッセージを送信するローカル サーバーが許可されていること。 この SMTP サーバーからメッセージを送信する追加のコンピューターを設定する場合は、その IP アドレスを入力します。  
  
5.  **配信**] タブで [**送信セキュリティ**します。 次の中から選択します。  
  
     **匿名アクセス**:アカウント名やパスワードは必要ありません。 このオプションは、SMTP サーバーの認証を無効にします。  
  
     **基本認証**:アカウント名とパスワードはクリア テキストとして送信に接続しているサーバーの。 入力したこのアカウントからメールを送信します。 個人アカウントや Exchange アカウントに電子メールを送信するときに、基本認証を選択できます。 有効にするため、資格情報はクリア テキストで渡されるをお勧め**TLS 暗号化**します。  
  
     **統合 Windows 認証**:Windows ドメイン アカウント名とパスワードは、認証に使用されます。 入力したアカウントからメールを送信します。  
  
     **TLS 暗号化**:同様に、SSL、TLS には、接続がセキュリティで保護します。 有効なの SSL サーバー証明書がこのサーバーにインストールされている必要があります。  
  
    > [!TIP]
    >  Exchange アカウントを含む、個人用の電子メール アカウントを使用して SMTP のコア機能をテストする次のように選択します。**への匿名アクセス**します。 基本認証を選択すると、SMTP は AUTH コマンドを使用します。 一部の電子メール プロバイダーにより AUTH コマンドが失敗します。 AUTH コマンドが失敗した場合、エラーは、SMTP サーバー上の Windows イベント ログに記録されます。  
  
6.  **配信**] タブで [**送信接続**します。 既定では、TCP ポートは 25 です。 ファイアウォール内で開いている場合、別のポートを入力できます。 **[OK]** を選択します。  
  
7.  **配信**] タブで [**詳細**します。 既定で、**完全修飾ドメイン名**ローカル サーバーの一覧表示します。 インターネット プロバイダーによって、**スマート ホスト**プロパティを空にできます。 スマート ホストが必要なことを確認するインターネット プロバイダーに連絡する必要があります。 それ以外の場合、smtp を入力することができます。*EMailProvider*。 com です。  
  
    > [!NOTE]
    >  A**スマート ホスト**、リレー ホストでは、すべての送信メッセージをルーティングする、Exchange Server で使用する専用サーバーとも呼ばれます。 **スマートホスト**がメッセージを受信すると、**スマートホスト**はメッセージをリモートドメインに転送します。 目標、**スマート ホスト**Exchange Server のパフォーマンスを向上させることです。 スマート ホストにのみ、Exchange サーバーが送信されます。接続が確立されるまでは、繰り返しではなく、リモート ドメインお問い合わせください。  
  
8.  選択**OK**をすべてのウィンドウを閉じます。  
  
9. SMTP サーバーを再起動します。右クリック **[SMTP Virtual Server #1]** を選択します**停止**、し、**開始**します。 SMTP サーバー設定を適用するには、再起動が必要です。 

  
## <a name="windows-server-2008-r2-install-and-configure-smtp-server"></a>Windows Server 2008 R2:SMTP サーバー インストールし、構成  
  
### <a name="install-smtp-server"></a>SMTP サーバーをインストールします。  
 次の手順では、SMTP サーバーの機能をインストールします。  
  
1.  **サーバー マネージャー**を選択します**機能**、選び**機能の追加**します。  
  
3.  **機能の追加**、 **SMTP サーバー**します。 選択を求められたら、**必要な役割サービスの追加**を選択し、**次**します。  
  
4.  選択して、インストールを続行**次**します。  
  
5.  **インストール オプションの確認**ウィンドウで、**インストール**します。 完了すると、選択**閉じる**します。  
  
### <a name="configure-the-smtp-server"></a>SMTP サーバーを構成します。  
 次の手順では、IIS 6.0 マネージャーを使用して、SMTP 仮想サーバーを構成します。  
  
1.  開く、IIS 6.0 マネージャー。**開始**、検索**IIS**、選択および**インターネット インフォメーション サービス (IIS) 6.0 マネージャー**します。  
  
2.  コンピューター名を展開します。 右クリックして **[SMTP Virtual Server #1]**、選択と**プロパティ**します。  
  
3.  **アクセス**] タブで、[、**リレー**ボタンをクリックします。  
  
4.  選択**追加**します。 **1 台のコンピューター**、入力`127.0.0.1`を選択し、 **OK**。  
  
     127.0.0.1 を追加すると、この SMTP サーバーからメッセージを送信するローカル サーバーが許可されていること。 この SMTP サーバーからメッセージを送信する追加のコンピューターを設定する場合は、その IP アドレスを入力します。  
  
5.  **配信**] タブで [**送信セキュリティ**します。 次の中から選択します。  
  
     **匿名アクセス**:アカウント名やパスワードは必要ありません。 このオプションは、SMTP サーバーの認証を無効にします。  
  
     **基本認証**:アカウント名とパスワードはクリア テキストとして送信に接続しているサーバーの。 個人アカウントや Exchange アカウントに電子メールを送信するときに、基本認証を選択できます。 有効にするため、資格情報はクリア テキストで渡されるをお勧め**TLS 暗号化**します。  
  
     **統合 Windows 認証**:Windows ドメイン アカウント名とパスワードは、認証に使用されます。 入力したアカウントからメールを送信します。  
  
     **TLS 暗号化**:同様に、SSL、TLS には、接続がセキュリティで保護します。 有効なの SSL サーバー証明書がこのサーバーにインストールされている必要があります。  
  
    > [!TIP]
    >  Exchange アカウントを含む、個人用の電子メール アカウントを使用して SMTP のコア機能をテストする次のように選択します。**への匿名アクセス**します。 基本認証を選択すると、SMTP は AUTH コマンドを使用します。 一部の電子メール プロバイダーにより AUTH コマンドが失敗します。 AUTH コマンドが失敗した場合、エラーは、SMTP サーバー上の Windows イベント ログに記録されます。  
  
6.  **配信**] タブで [**送信接続**します。 既定では、TCP ポートは 25 です。 ファイアウォール内で開いている場合、別のポートを入力できます。 **[OK]** を選択します。  
  
    > [!TIP]
    >  TCP ポートは受信接続と送信接続に使用できます。  
  
7.  **配信**] タブで [**詳細**します。 既定で、**完全修飾ドメイン名**ローカル サーバーの一覧表示します。 インターネット プロバイダーによって、**スマート ホスト**プロパティを空にできます。 スマート ホストが必要なことを確認するインターネット プロバイダーに連絡する必要があります。 それ以外の場合、smtp を入力することができます。*EMailProvider*。 com です。  
  
    > [!NOTE]
    >  A**スマート ホスト**、リレー ホストでは、すべての送信メッセージをルーティングする、Exchange Server で使用する専用サーバーとも呼ばれます。 **スマートホスト**がメッセージを受信すると、**スマートホスト**はメッセージをリモートドメインに転送します。 目標、**スマート ホスト**Exchange Server のパフォーマンスを向上させることです。 スマート ホストにのみ、Exchange サーバーが送信されます。接続が確立されるまでは、繰り返しではなく、リモート ドメインお問い合わせください。  
  
8.  選択**OK**をすべてのウィンドウを閉じます。  
  
9. SMTP サーバー設定を適用するには、再起動が必要です。 SMTP サーバーを再起動するには。右クリック **[SMTP Virtual Server #1]** を選択します**停止**、し、**開始**します。  
  
  
## <a name="test-the-smtp-server"></a>SMTP サーバーをテストします。  
 Telnet を使用して、SMTP サーバーの構成をテストできます。 次の手順では、電子メール アドレスに構成されている SMTP サーバーを使用してメッセージを送信します。 [http://support.microsoft.com/kb/153119](http://support.microsoft.com/kb/153119) telnet コマンドの説明を示します。  
  
1. 管理者としてコマンド ウィンドウを開きます。
  
2. コマンド プロンプトで、次のように入力します:  
  
    `telnet localhost 25`  
  
    Telnet がインストールされていない場合は、」と入力してインストールします。  
  
    `pkgmgr /iu:"TelnetClient"`  
  
3. 」と入力して、通信を開始します。  
  
    `EHLO server`  
  
4. メール アドレスを入力します。  
  
    `MAIL FROM: *YourEmailAddress*@*YourProvider*.com`  
  
    たとえば、次のように入力します。  
  
    `MAIL FROM: EmailAddress@outlook.com`  
  
5. メール アドレスを入力します。  
  
    `RCPT TO: *YourEmailAddress*@*YourProvider*.com`  
  
    たとえば、次のように入力します。  
  
    `RCPT TO: EmailAddress@outlook.com`  
  
6. 」と入力してデータを送信する準備が完了したら、SMTP サーバーに指示します。  
  
    `DATA`  
  
7. 」と入力して件名を入力します。  
  
    `Subject: Test Message`  
  
8. Enter をキーを 2 回押します。  
  
9. 」と入力して、メッセージ本文を入力します。  
  
     `This is the message body of the test message.`  
  
10. Enter キーを押します、ピリオド (.) を入力し、Enter キーを押します。  
  
    電子メール メッセージの RCPT TO アドレスを確認します。 電子メールの配信 (フォルダーを確認して受信トレイと迷惑メール)、メッセージがない場合は正常に送信されませんし、SMTP Queue フォルダー (C:\inetpub\mailroot\Queue) に存在する可能性があります。  
  